const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index46.js","js/i18next-vendor.js","js/index16.js","js/index17.js","js/qwen-chat-design.js","js/antd-vendor.js","css/index21.css","css/index7.css","js/setting.util.js","js/useUpgradePlan.hook.js","js/utils-vendor.js","js/lodash-vendor.js","js/index31.js","css/index24.css","js/index38.js","css/index41.css","js/index12.js","css/index8.css","js/useDynamicHeight.js","js/aliyun-rtc-sdk-vendor.js","js/qwen-chat-components.js","js/xlsx-vendor.js","js/ali-oss-vendor.js","css/index42.css","js/index34.js","js/index10.js","js/index18.js","css/index10.css","css/index9.css","js/index.esm.js","css/index32.css","css/index27.css","js/index43.js","js/index3.js","css/index2.css","js/index5.js","css/index3.css","js/index9.js","css/index.css","css/index36.css","js/index24.js","js/verifyEmail.util.js","css/index16.css","js/index25.js","css/index17.css","js/index.js","js/index2.js","js/index4.js","js/index26.js","css/index18.css","js/index27.js","css/index19.css","js/index6.js","js/index.h5.js","css/index11.css","js/index28.js","css/index20.css","js/index37.js","css/index31.css","js/index30.js","js/languages.js","js/useAudioSpeaker.hook.js","css/index23.css","js/index45.js","js/monaco-vendor.js","css/monaco-vendor.css","css/index39.css","js/index11.js","css/index4.css","js/index13.js","js/index14.js","css/index12.css","css/index5.css","js/index15.js","css/index6.css","js/index35.js","css/index28.css","js/index41.js","css/index34.css","js/index32.js","js/index.type.js","js/index21.js","css/index40.css","css/index25.css","js/index19.js","css/index13.css","js/index29.js","css/index22.css","js/index39.js","js/index40.js","css/index38.css","css/index33.css","js/index36.js","js/index23.js","css/index30.css","css/index29.css","js/index42.js","css/index35.css","js/ModelsContainer.js","css/ModelsContainer.css","js/AccountContainer.js","css/AccountContainer.css","js/index7.js","js/index20.js","css/index14.css","js/index33.js","css/index26.css","js/index22.js","css/index15.css","js/index44.js","css/index37.css","js/index8.js"])))=>i.map(i=>d[i]);
var e,t,n,i,a,o,s,r,l,c,u,d=Object.defineProperty,h=Object.defineProperties,p=Object.getOwnPropertyDescriptors,m=Object.getOwnPropertySymbols,f=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable,y=Reflect.get,b=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),x=e=>{throw TypeError(e)},w=Math.pow,S=(e,t,n)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,_=(e,t)=>{for(var n in t||(t={}))g.call(t,n)&&S(e,n,t[n]);if(m)for(var n of m(t))v.call(t,n)&&S(e,n,t[n]);return e},C=(e,t)=>h(e,p(t)),E=(e,t)=>{var n={};for(var i in e)g.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&m)for(var i of m(e))t.indexOf(i)<0&&v.call(e,i)&&(n[i]=e[i]);return n},k=(e,t,n)=>S(e,"symbol"!=typeof t?t+"":t,n),I=(e,t,n)=>t.has(e)||x("Cannot "+n),T=(e,t,n)=>(I(e,t,"read from private field"),n?n.call(e):t.get(e)),j=(e,t,n)=>t.has(e)?x("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),N=(e,t,n,i)=>(I(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n),P=(e,t,n)=>new Promise((i,a)=>{var o=e=>{try{r(n.next(e))}catch(t){a(t)}},s=e=>{try{r(n.throw(e))}catch(t){a(t)}},r=e=>e.done?i(e.value):Promise.resolve(e.value).then(o,s);r((n=n.apply(e,t)).next())}),M=function(e,t){this[0]=e,this[1]=t},A=(e,t,n)=>{var i=(e,t,a,o)=>{try{var s=n[e](t),r=(t=s.value)instanceof M,l=s.done;Promise.resolve(r?t[0]:t).then(n=>r?i("return"===e?e:"next",t[1]?{done:n.done,value:n.value}:n,a,o):a({value:n,done:l})).catch(e=>i("throw",e,a,o))}catch(c){o(c)}},a=e=>o[e]=t=>new Promise((n,a)=>i(e,t,n,a)),o={};return n=n.apply(e,t),o[b("asyncIterator")]=()=>o,a("next"),a("throw"),a("return"),o},R=(e,t,n)=>(t=e[b("asyncIterator")])?t.call(e):(e=e[b("iterator")](),t={},(n=(n,i)=>(i=e[n])&&(t[n]=t=>new Promise((n,a,o)=>(t=i.call(e,t),o=t.done,Promise.resolve(t.value).then(e=>n({value:e,done:o}),a)))))("next"),n("return"),t);import{r as O,b as D,d as L,B as F,i as U,a as z,R as H,c as $,g as B,e as q,u as G,T as V,f as W,h as Q}from"./i18next-vendor.js";import{r as K,d as Y,s as X,e as J,F as Z,M as ee,h as te,D as ne,I as ie,P as ae,S as oe,i as se,j as re,b as le,B as ce,k as ue,l as de,m as he,n as pe,o as me,p as fe,q as ge,t as ve,v as ye,R as be,w as xe,T as we,u as Se}from"./antd-vendor.js";import{c2 as _e,bY as Ce,c3 as Ee,c4 as ke,c5 as Ie,c6 as Te,c7 as je,c8 as Ne,c9 as Pe,ca as Me,cb as Ae,cc as Re,cd as Oe,bX as De,ce as Le,cf as Fe,cg as Ue,ch as ze,ci as He,cj as $e,ck as Be,cl as qe,cm as Ge,cn as Ve,co as We,c1 as Qe,cp as Ke,A as Ye,cq as Xe,cr as Je,bW as Ze,cs as et,ct as tt,c0 as nt,b_ as it,b$ as at}from"./qwen-chat-components.js";import{v as ot,A as st,a as rt,b as lt,E as ct}from"./utils-vendor.js";import{J as ut,P as dt,I as ht,Q as pt,v as mt,c as ft,n as gt,a as vt,u as yt,$ as bt,r as xt,W as wt,d as St,b as _t,D as Ct}from"./qwen-chat-design.js";import{b as Et,o as kt,c as It,e as Tt,f as jt,g as Nt,m as Pt,i as Mt,h as At,j as Rt,d as Ot,t as Dt}from"./lodash-vendor.js";import{u as Lt,w as Ft}from"./xlsx-vendor.js";import{A as Ut}from"./ali-oss-vendor.js";import{K as zt,h as Ht,U as $t,n as Bt,x as qt,G as Gt,$ as Vt,k as Wt,p as Qt,_ as Kt}from"./aliyun-rtc-sdk-vendor.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var Yt={exports:{}},Xt={},Jt=Symbol.for("react.transitional.element"),Zt=Symbol.for("react.fragment");function en(e,t,n){var i=null;if(void 0!==n&&(i=""+n),void 0!==t.key&&(i=""+t.key),"key"in t)for(var a in n={},t)"key"!==a&&(n[a]=t[a]);else n=t;return t=n.ref,{$$typeof:Jt,type:e,key:i,ref:void 0!==t?t:null,props:n}}Xt.Fragment=Zt,Xt.jsx=en,Xt.jsxs=en,Yt.exports=Xt;var tn=Yt.exports,nn={exports:{}},an={},on={exports:{}},sn={};!function(e){function t(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,o=e[i];if(!(0<a(o,t)))break e;e[i]=t,e[n]=o,n=i}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,o=e.length,s=o>>>1;i<s;){var r=2*(i+1)-1,l=e[r],c=r+1,u=e[c];if(0>a(l,n))c<o&&0>a(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[r]=n,i=r);else{if(!(c<o&&0>a(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(e.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,r=s.now();e.unstable_now=function(){return s.now()-r}}var l=[],c=[],u=1,d=null,h=3,p=!1,m=!1,f=!1,g=!1,v="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function x(e){for(var a=n(c);null!==a;){if(null===a.callback)i(c);else{if(!(a.startTime<=e))break;i(c),a.sortIndex=a.expirationTime,t(l,a)}a=n(c)}}function w(e){if(f=!1,x(e),!m)if(null!==n(l))m=!0,_||(_=!0,S());else{var t=n(c);null!==t&&P(w,t.startTime-e)}}var S,_=!1,C=-1,E=5,k=-1;function I(){return!!g||!(e.unstable_now()-k<E)}function T(){if(g=!1,_){var t=e.unstable_now();k=t;var a=!0;try{e:{m=!1,f&&(f=!1,y(C),C=-1),p=!0;var o=h;try{t:{for(x(t),d=n(l);null!==d&&!(d.expirationTime>t&&I());){var s=d.callback;if("function"==typeof s){d.callback=null,h=d.priorityLevel;var r=s(d.expirationTime<=t);if(t=e.unstable_now(),"function"==typeof r){d.callback=r,x(t),a=!0;break t}d===n(l)&&i(l),x(t)}else i(l);d=n(l)}if(null!==d)a=!0;else{var u=n(c);null!==u&&P(w,u.startTime-t),a=!1}}break e}finally{d=null,h=o,p=!1}a=void 0}}finally{a?S():_=!1}}}if("function"==typeof b)S=function(){b(T)};else if("undefined"!=typeof MessageChannel){var j=new MessageChannel,N=j.port2;j.port1.onmessage=T,S=function(){N.postMessage(null)}}else S=function(){v(T,0)};function P(t,n){C=v(function(){t(e.unstable_now())},n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_forceFrameRate=function(e){0>e||125<e||(E=0<e?Math.floor(1e3/e):5)},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var n=h;h=t;try{return e()}finally{h=n}},e.unstable_requestPaint=function(){g=!0},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=h;h=e;try{return t()}finally{h=n}},e.unstable_scheduleCallback=function(i,a,o){var s=e.unstable_now();switch("object"==typeof o&&null!==o?o="number"==typeof(o=o.delay)&&0<o?s+o:s:o=s,i){case 1:var r=-1;break;case 2:r=250;break;case 5:r=1073741823;break;case 4:r=1e4;break;default:r=5e3}return i={id:u++,callback:a,priorityLevel:i,startTime:o,expirationTime:r=o+r,sortIndex:-1},o>s?(i.sortIndex=o,t(c,i),null===n(l)&&i===n(c)&&(f?(y(C),C=-1):f=!0,P(w,o-s))):(i.sortIndex=r,t(l,i),m||p||(m=!0,_||(_=!0,S()))),i},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(e){var t=h;return function(){var n=h;h=t;try{return e.apply(this,arguments)}finally{h=n}}}}(sn),on.exports=sn;var rn=on.exports,ln=O,cn=K;function un(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function dn(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function hn(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function pn(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function mn(e){if(hn(e)!==e)throw Error(un(188))}function fn(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=fn(e)))return t;e=e.sibling}return null}var gn=Object.assign,vn=Symbol.for("react.element"),yn=Symbol.for("react.transitional.element"),bn=Symbol.for("react.portal"),xn=Symbol.for("react.fragment"),wn=Symbol.for("react.strict_mode"),Sn=Symbol.for("react.profiler"),_n=Symbol.for("react.provider"),Cn=Symbol.for("react.consumer"),En=Symbol.for("react.context"),kn=Symbol.for("react.forward_ref"),In=Symbol.for("react.suspense"),Tn=Symbol.for("react.suspense_list"),jn=Symbol.for("react.memo"),Nn=Symbol.for("react.lazy"),Pn=Symbol.for("react.activity"),Mn=Symbol.for("react.memo_cache_sentinel"),An=Symbol.iterator;function Rn(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=An&&e[An]||e["@@iterator"])?e:null}var On=Symbol.for("react.client.reference");function Dn(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===On?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case xn:return"Fragment";case Sn:return"Profiler";case wn:return"StrictMode";case In:return"Suspense";case Tn:return"SuspenseList";case Pn:return"Activity"}if("object"==typeof e)switch(e.$$typeof){case bn:return"Portal";case En:return(e.displayName||"Context")+".Provider";case Cn:return(e._context.displayName||"Context")+".Consumer";case kn:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case jn:return null!==(t=e.displayName||null)?t:Dn(e.type)||"Memo";case Nn:t=e._payload,e=e._init;try{return Dn(e(t))}catch(n){}}return null}var Ln=Array.isArray,Fn=ln.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Un=cn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,zn={pending:!1,data:null,method:null,action:null},Hn=[],$n=-1;function Bn(e){return{current:e}}function qn(e){0>$n||(e.current=Hn[$n],Hn[$n]=null,$n--)}function Gn(e,t){$n++,Hn[$n]=e.current,e.current=t}var Vn=Bn(null),Wn=Bn(null),Qn=Bn(null),Kn=Bn(null);function Yn(e,t){switch(Gn(Qn,t),Gn(Wn,e),Gn(Vn,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?rm(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=lm(t=rm(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}qn(Vn),Gn(Vn,e)}function Xn(){qn(Vn),qn(Wn),qn(Qn)}function Jn(e){null!==e.memoizedState&&Gn(Kn,e);var t=Vn.current,n=lm(t,e.type);t!==n&&(Gn(Wn,e),Gn(Vn,n))}function Zn(e){Wn.current===e&&(qn(Vn),qn(Wn)),Kn.current===e&&(qn(Kn),Xm._currentValue=zn)}var ei=Object.prototype.hasOwnProperty,ti=rn.unstable_scheduleCallback,ni=rn.unstable_cancelCallback,ii=rn.unstable_shouldYield,ai=rn.unstable_requestPaint,oi=rn.unstable_now,si=rn.unstable_getCurrentPriorityLevel,ri=rn.unstable_ImmediatePriority,li=rn.unstable_UserBlockingPriority,ci=rn.unstable_NormalPriority,ui=rn.unstable_LowPriority,di=rn.unstable_IdlePriority,hi=rn.log,pi=rn.unstable_setDisableYieldValue,mi=null,fi=null;function gi(e){if("function"==typeof hi&&pi(e),fi&&"function"==typeof fi.setStrictMode)try{fi.setStrictMode(mi,e)}catch(t){}}var vi=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(yi(e)/bi|0)|0},yi=Math.log,bi=Math.LN2;var xi=256,wi=4194304;function Si(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function _i(e,t,n){var i=e.pendingLanes;if(0===i)return 0;var a=0,o=e.suspendedLanes,s=e.pingedLanes;e=e.warmLanes;var r=134217727&i;return 0!==r?0!==(i=r&~o)?a=Si(i):0!==(s&=r)?a=Si(s):n||0!==(n=r&~e)&&(a=Si(n)):0!==(r=i&~o)?a=Si(r):0!==s?a=Si(s):n||0!==(n=i&~e)&&(a=Si(n)),0===a?0:0!==t&&t!==a&&0===(t&o)&&((o=a&-a)>=(n=t&-t)||32===o&&4194048&n)?t:a}function Ci(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Ei(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ki(){var e=xi;return!(4194048&(xi<<=1))&&(xi=256),e}function Ii(){var e=wi;return!(62914560&(wi<<=1))&&(wi=4194304),e}function Ti(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function ji(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Ni(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-vi(t);e.entangledLanes|=t,e.entanglements[i]=1073741824|e.entanglements[i]|4194090&n}function Pi(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-vi(n),a=1<<i;a&t|e[i]&t&&(e[i]|=t),n&=~a}}function Mi(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ai(e){return 2<(e&=-e)?8<e?134217727&e?32:268435456:8:2}function Ri(){var e=Un.p;return 0!==e?e:void 0===(e=window.event)?32:pf(e.type)}var Oi=Math.random().toString(36).slice(2),Di="__reactFiber$"+Oi,Li="__reactProps$"+Oi,Fi="__reactContainer$"+Oi,Ui="__reactEvents$"+Oi,zi="__reactListeners$"+Oi,Hi="__reactHandles$"+Oi,$i="__reactResources$"+Oi,Bi="__reactMarker$"+Oi;function qi(e){delete e[Di],delete e[Li],delete e[Ui],delete e[zi],delete e[Hi]}function Gi(e){var t=e[Di];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Fi]||n[Di]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Sm(e);null!==e;){if(n=e[Di])return n;e=Sm(e)}return t}n=(e=n).parentNode}return null}function Vi(e){if(e=e[Di]||e[Fi]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function Wi(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(un(33))}function Qi(e){var t=e[$i];return t||(t=e[$i]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ki(e){e[Bi]=!0}var Yi=new Set,Xi={};function Ji(e,t){Zi(e,t),Zi(e+"Capture",t)}function Zi(e,t){for(Xi[e]=t,e=0;e<t.length;e++)Yi.add(t[e])}var ea,ta,na=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ia={},aa={};function oa(e,t,n){if(a=t,ei.call(aa,a)||!ei.call(ia,a)&&(na.test(a)?aa[a]=!0:(ia[a]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var i=t.toLowerCase().slice(0,5);if("data-"!==i&&"aria-"!==i)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var a}function sa(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function ra(e,t,n,i){if(null===i)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+i)}}function la(e){if(void 0===ea)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);ea=t&&t[1]||"",ta=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+ea+e+ta}var ca=!1;function ua(e,t){if(!e||ca)return"";ca=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(a){var i=a}Reflect.construct(e,[],n)}else{try{n.call()}catch(o){i=o}e.call(n.prototype)}}else{try{throw Error()}catch(s){i=s}(n=e())&&"function"==typeof n.catch&&n.catch(function(){})}}catch(r){if(r&&i&&"string"==typeof r.stack)return[r.stack,i.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var o=i.DetermineComponentFrameRoot(),s=o[0],r=o[1];if(s&&r){var l=s.split("\n"),c=r.split("\n");for(a=i=0;i<l.length&&!l[i].includes("DetermineComponentFrameRoot");)i++;for(;a<c.length&&!c[a].includes("DetermineComponentFrameRoot");)a++;if(i===l.length||a===c.length)for(i=l.length-1,a=c.length-1;1<=i&&0<=a&&l[i]!==c[a];)a--;for(;1<=i&&0<=a;i--,a--)if(l[i]!==c[a]){if(1!==i||1!==a)do{if(i--,0>--a||l[i]!==c[a]){var u="\n"+l[i].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=i&&0<=a);break}}}finally{ca=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?la(n):""}function da(e){switch(e.tag){case 26:case 27:case 5:return la(e.type);case 16:return la("Lazy");case 13:return la("Suspense");case 19:return la("SuspenseList");case 0:case 15:return ua(e.type,!1);case 11:return ua(e.type.render,!1);case 1:return ua(e.type,!0);case 31:return la("Activity");default:return""}}function ha(e){try{var t="";do{t+=da(e),e=e.return}while(e);return t}catch(n){return"\nError generating stack: "+n.message+"\n"+n.stack}}function pa(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ma(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function fa(e){e._valueTracker||(e._valueTracker=function(e){var t=ma(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var a=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){i=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function ga(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=ma(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function va(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var ya=/[\n"\\]/g;function ba(e){return e.replace(ya,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function xa(e,t,n,i,a,o,s,r){e.name="",null!=s&&"function"!=typeof s&&"symbol"!=typeof s&&"boolean"!=typeof s?e.type=s:e.removeAttribute("type"),null!=t?"number"===s?(0===t&&""===e.value||e.value!=t)&&(e.value=""+pa(t)):e.value!==""+pa(t)&&(e.value=""+pa(t)):"submit"!==s&&"reset"!==s||e.removeAttribute("value"),null!=t?Sa(e,s,pa(t)):null!=n?Sa(e,s,pa(n)):null!=i&&e.removeAttribute("value"),null==a&&null!=o&&(e.defaultChecked=!!o),null!=a&&(e.checked=a&&"function"!=typeof a&&"symbol"!=typeof a),null!=r&&"function"!=typeof r&&"symbol"!=typeof r&&"boolean"!=typeof r?e.name=""+pa(r):e.removeAttribute("name")}function wa(e,t,n,i,a,o,s,r){if(null!=o&&"function"!=typeof o&&"symbol"!=typeof o&&"boolean"!=typeof o&&(e.type=o),null!=t||null!=n){if(("submit"===o||"reset"===o)&&null==t)return;n=null!=n?""+pa(n):"",t=null!=t?""+pa(t):n,r||t===e.value||(e.value=t),e.defaultValue=t}i="function"!=typeof(i=null!=i?i:a)&&"symbol"!=typeof i&&!!i,e.checked=r?e.checked:!!i,e.defaultChecked=!!i,null!=s&&"function"!=typeof s&&"symbol"!=typeof s&&"boolean"!=typeof s&&(e.name=s)}function Sa(e,t,n){"number"===t&&va(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function _a(e,t,n,i){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&i&&(e[n].defaultSelected=!0)}else{for(n=""+pa(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(i&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function Ca(e,t,n){null==t||((t=""+pa(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+pa(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function Ea(e,t,n,i){if(null==t){if(null!=i){if(null!=n)throw Error(un(92));if(Ln(i)){if(1<i.length)throw Error(un(93));i=i[0]}n=i}null==n&&(n=""),t=n}n=pa(t),e.defaultValue=n,(i=e.textContent)===n&&""!==i&&null!==i&&(e.value=i)}function ka(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var Ia=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ta(e,t,n){var i=0===t.indexOf("--");null==n||"boolean"==typeof n||""===n?i?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":i?e.setProperty(t,n):"number"!=typeof n||0===n||Ia.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function ja(e,t,n){if(null!=t&&"object"!=typeof t)throw Error(un(62));if(e=e.style,null!=n){for(var i in n)!n.hasOwnProperty(i)||null!=t&&t.hasOwnProperty(i)||(0===i.indexOf("--")?e.setProperty(i,""):"float"===i?e.cssFloat="":e[i]="");for(var a in t)i=t[a],t.hasOwnProperty(a)&&n[a]!==i&&Ta(e,a,i)}else for(var o in t)t.hasOwnProperty(o)&&Ta(e,o,t[o])}function Na(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pa=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ma=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Aa(e){return Ma.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Ra=null;function Oa(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Da=null,La=null;function Fa(e){var t=Vi(e);if(t&&(e=t.stateNode)){var n=e[Li]||null;e:switch(e=t.stateNode,t.type){case"input":if(xa(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+ba(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var a=i[Li]||null;if(!a)throw Error(un(90));xa(i,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name)}}for(t=0;t<n.length;t++)(i=n[t]).form===e.form&&ga(i)}break e;case"textarea":Ca(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&_a(e,!!n.multiple,t,!1)}}}var Ua=!1;function za(e,t,n){if(Ua)return e(t,n);Ua=!0;try{return e(t)}finally{if(Ua=!1,(null!==Da||null!==La)&&(qh(),Da&&(t=Da,e=La,La=Da=null,Fa(t),e)))for(t=0;t<e.length;t++)Fa(e[t])}}function Ha(e,t){var n=e.stateNode;if(null===n)return null;var i=n[Li]||null;if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(un(231,t,typeof n));return n}var $a=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),Ba=!1;if($a)try{var qa={};Object.defineProperty(qa,"passive",{get:function(){Ba=!0}}),window.addEventListener("test",qa,qa),window.removeEventListener("test",qa,qa)}catch(qY){Ba=!1}var Ga=null,Va=null,Wa=null;function Qa(){if(Wa)return Wa;var e,t,n=Va,i=n.length,a="value"in Ga?Ga.value:Ga.textContent,o=a.length;for(e=0;e<i&&n[e]===a[e];e++);var s=i-e;for(t=1;t<=s&&n[i-t]===a[o-t];t++);return Wa=a.slice(e,1<t?1-t:void 0)}function Ka(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Ya(){return!0}function Xa(){return!1}function Ja(e){function t(t,n,i,a,o){for(var s in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(a):a[s]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?Ya:Xa,this.isPropagationStopped=Xa,this}return gn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Ya)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Ya)},persist:function(){},isPersistent:Ya}),t}var Za,eo,to,no={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},io=Ja(no),ao=gn({},no,{view:0,detail:0}),oo=Ja(ao),so=gn({},ao,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yo,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==to&&(to&&"mousemove"===e.type?(Za=e.screenX-to.screenX,eo=e.screenY-to.screenY):eo=Za=0,to=e),Za)},movementY:function(e){return"movementY"in e?e.movementY:eo}}),ro=Ja(so),lo=Ja(gn({},so,{dataTransfer:0})),co=Ja(gn({},ao,{relatedTarget:0})),uo=Ja(gn({},no,{animationName:0,elapsedTime:0,pseudoElement:0})),ho=Ja(gn({},no,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),po=Ja(gn({},no,{data:0})),mo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fo={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},go={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vo(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=go[e])&&!!t[e]}function yo(){return vo}var bo=Ja(gn({},ao,{key:function(e){if(e.key){var t=mo[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Ka(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?fo[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yo,charCode:function(e){return"keypress"===e.type?Ka(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Ka(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),xo=Ja(gn({},so,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),wo=Ja(gn({},ao,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yo})),So=Ja(gn({},no,{propertyName:0,elapsedTime:0,pseudoElement:0})),_o=Ja(gn({},so,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Co=Ja(gn({},no,{newState:0,oldState:0})),Eo=[9,13,27,32],ko=$a&&"CompositionEvent"in window,Io=null;$a&&"documentMode"in document&&(Io=document.documentMode);var To=$a&&"TextEvent"in window&&!Io,jo=$a&&(!ko||Io&&8<Io&&11>=Io),No=String.fromCharCode(32),Po=!1;function Mo(e,t){switch(e){case"keyup":return-1!==Eo.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ao(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Ro=!1;var Oo={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Do(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Oo[e.type]:"textarea"===t}function Lo(e,t,n,i){Da?La?La.push(i):La=[i]:Da=i,0<(t=Wp(t,"onChange")).length&&(n=new io("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Fo=null,Uo=null;function zo(e){Up(e,0)}function Ho(e){if(ga(Wi(e)))return e}function $o(e,t){if("change"===e)return t}var Bo=!1;if($a){var qo;if($a){var Go="oninput"in document;if(!Go){var Vo=document.createElement("div");Vo.setAttribute("oninput","return;"),Go="function"==typeof Vo.oninput}qo=Go}else qo=!1;Bo=qo&&(!document.documentMode||9<document.documentMode)}function Wo(){Fo&&(Fo.detachEvent("onpropertychange",Qo),Uo=Fo=null)}function Qo(e){if("value"===e.propertyName&&Ho(Uo)){var t=[];Lo(t,Uo,e,Oa(e)),za(zo,t)}}function Ko(e,t,n){"focusin"===e?(Wo(),Uo=n,(Fo=t).attachEvent("onpropertychange",Qo)):"focusout"===e&&Wo()}function Yo(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Ho(Uo)}function Xo(e,t){if("click"===e)return Ho(t)}function Jo(e,t){if("input"===e||"change"===e)return Ho(t)}var Zo="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function es(e,t){if(Zo(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var a=n[i];if(!ei.call(t,a)||!Zo(e[a],t[a]))return!1}return!0}function ts(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ns(e,t){var n,i=ts(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ts(i)}}function is(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?is(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function as(e){for(var t=va((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=va((e=t.contentWindow).document)}return t}function os(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var ss=$a&&"documentMode"in document&&11>=document.documentMode,rs=null,ls=null,cs=null,us=!1;function ds(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;us||null==rs||rs!==va(i)||("selectionStart"in(i=rs)&&os(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},cs&&es(cs,i)||(cs=i,0<(i=Wp(ls,"onSelect")).length&&(t=new io("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=rs)))}function hs(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ps={animationend:hs("Animation","AnimationEnd"),animationiteration:hs("Animation","AnimationIteration"),animationstart:hs("Animation","AnimationStart"),transitionrun:hs("Transition","TransitionRun"),transitionstart:hs("Transition","TransitionStart"),transitioncancel:hs("Transition","TransitionCancel"),transitionend:hs("Transition","TransitionEnd")},ms={},fs={};function gs(e){if(ms[e])return ms[e];if(!ps[e])return e;var t,n=ps[e];for(t in n)if(n.hasOwnProperty(t)&&t in fs)return ms[e]=n[t];return e}$a&&(fs=document.createElement("div").style,"AnimationEvent"in window||(delete ps.animationend.animation,delete ps.animationiteration.animation,delete ps.animationstart.animation),"TransitionEvent"in window||delete ps.transitionend.transition);var vs=gs("animationend"),ys=gs("animationiteration"),bs=gs("animationstart"),xs=gs("transitionrun"),ws=gs("transitionstart"),Ss=gs("transitioncancel"),_s=gs("transitionend"),Cs=new Map,Es="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ks(e,t){Cs.set(e,t),Ji(t,[e])}Es.push("scrollEnd");var Is=new WeakMap;function Ts(e,t){if("object"==typeof e&&null!==e){var n=Is.get(e);return void 0!==n?n:(t={value:e,source:t,stack:ha(t)},Is.set(e,t),t)}return{value:e,source:t,stack:ha(t)}}var js=[],Ns=0,Ps=0;function Ms(){for(var e=Ns,t=Ps=Ns=0;t<e;){var n=js[t];js[t++]=null;var i=js[t];js[t++]=null;var a=js[t];js[t++]=null;var o=js[t];if(js[t++]=null,null!==i&&null!==a){var s=i.pending;null===s?a.next=a:(a.next=s.next,s.next=a),i.pending=a}0!==o&&Ds(n,a,o)}}function As(e,t,n,i){js[Ns++]=e,js[Ns++]=t,js[Ns++]=n,js[Ns++]=i,Ps|=i,e.lanes|=i,null!==(e=e.alternate)&&(e.lanes|=i)}function Rs(e,t,n,i){return As(e,t,n,i),Ls(e)}function Os(e,t){return As(e,null,null,t),Ls(e)}function Ds(e,t,n){e.lanes|=n;var i=e.alternate;null!==i&&(i.lanes|=n);for(var a=!1,o=e.return;null!==o;)o.childLanes|=n,null!==(i=o.alternate)&&(i.childLanes|=n),22===o.tag&&(null===(e=o.stateNode)||1&e._visibility||(a=!0)),e=o,o=o.return;return 3===e.tag?(o=e.stateNode,a&&null!==t&&(a=31-vi(n),null===(i=(e=o.hiddenUpdates)[a])?e[a]=[t]:i.push(t),t.lane=536870912|n),o):null}function Ls(e){if(50<Oh)throw Oh=0,Dh=null,Error(un(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Fs={};function Us(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zs(e,t,n,i){return new Us(e,t,n,i)}function Hs(e){return!(!(e=e.prototype)||!e.isReactComponent)}function $s(e,t){var n=e.alternate;return null===n?((n=zs(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Bs(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function qs(e,t,n,i,a,o){var s=0;if(i=e,"function"==typeof e)Hs(e)&&(s=1);else if("string"==typeof e)s=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!=typeof t.precedence||"string"!=typeof t.href||""===t.href)break;return!0;case"link":if("string"!=typeof t.rel||"string"!=typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"==typeof t.precedence&&null==e);case"script":if(t.async&&"function"!=typeof t.async&&"symbol"!=typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"==typeof t.src)return!0}return!1}(e,n,Vn.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case Pn:return(e=zs(31,n,t,a)).elementType=Pn,e.lanes=o,e;case xn:return Gs(n.children,a,o,t);case wn:s=8,a|=24;break;case Sn:return(e=zs(12,n,t,2|a)).elementType=Sn,e.lanes=o,e;case In:return(e=zs(13,n,t,a)).elementType=In,e.lanes=o,e;case Tn:return(e=zs(19,n,t,a)).elementType=Tn,e.lanes=o,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case _n:case En:s=10;break e;case Cn:s=9;break e;case kn:s=11;break e;case jn:s=14;break e;case Nn:s=16,i=null;break e}s=29,n=Error(un(130,null===e?"null":typeof e,"")),i=null}return(t=zs(s,n,t,a)).elementType=e,t.type=i,t.lanes=o,t}function Gs(e,t,n,i){return(e=zs(7,e,i,t)).lanes=n,e}function Vs(e,t,n){return(e=zs(6,e,null,t)).lanes=n,e}function Ws(e,t,n){return(t=zs(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Qs=[],Ks=0,Ys=null,Xs=0,Js=[],Zs=0,er=null,tr=1,nr="";function ir(e,t){Qs[Ks++]=Xs,Qs[Ks++]=Ys,Ys=e,Xs=t}function ar(e,t,n){Js[Zs++]=tr,Js[Zs++]=nr,Js[Zs++]=er,er=e;var i=tr;e=nr;var a=32-vi(i)-1;i&=~(1<<a),n+=1;var o=32-vi(t)+a;if(30<o){var s=a-a%5;o=(i&(1<<s)-1).toString(32),i>>=s,a-=s,tr=1<<32-vi(t)+a|n<<a|i,nr=o+e}else tr=1<<o|n<<a|i,nr=e}function or(e){null!==e.return&&(ir(e,1),ar(e,1,0))}function sr(e){for(;e===Ys;)Ys=Qs[--Ks],Qs[Ks]=null,Xs=Qs[--Ks],Qs[Ks]=null;for(;e===er;)er=Js[--Zs],Js[Zs]=null,nr=Js[--Zs],Js[Zs]=null,tr=Js[--Zs],Js[Zs]=null}var rr=null,lr=null,cr=!1,ur=null,dr=!1,hr=Error(un(519));function pr(e){throw br(Ts(Error(un(418,"")),e)),hr}function mr(e){var t=e.stateNode,n=e.type,i=e.memoizedProps;switch(t[Di]=e,t[Li]=i,n){case"dialog":zp("cancel",t),zp("close",t);break;case"iframe":case"object":case"embed":zp("load",t);break;case"video":case"audio":for(n=0;n<Lp.length;n++)zp(Lp[n],t);break;case"source":zp("error",t);break;case"img":case"image":case"link":zp("error",t),zp("load",t);break;case"details":zp("toggle",t);break;case"input":zp("invalid",t),wa(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0),fa(t);break;case"select":zp("invalid",t);break;case"textarea":zp("invalid",t),Ea(t,i.value,i.defaultValue,i.children),fa(t)}"string"!=typeof(n=i.children)&&"number"!=typeof n&&"bigint"!=typeof n||t.textContent===""+n||!0===i.suppressHydrationWarning||Zp(t.textContent,n)?(null!=i.popover&&(zp("beforetoggle",t),zp("toggle",t)),null!=i.onScroll&&zp("scroll",t),null!=i.onScrollEnd&&zp("scrollend",t),null!=i.onClick&&(t.onclick=em),t=!0):t=!1,t||pr(e)}function fr(e){for(rr=e.return;rr;)switch(rr.tag){case 5:case 13:return void(dr=!1);case 27:case 3:return void(dr=!0);default:rr=rr.return}}function gr(e){if(e!==rr)return!1;if(!cr)return fr(e),cr=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||cm(e.type,e.memoizedProps)),t=!t),t&&lr&&pr(e),fr(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(un(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===n){lr=xm(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++;e=e.nextSibling}lr=null}}else 27===n?(n=lr,gm(e.type)?(e=wm,wm=null,lr=e):lr=n):lr=rr?xm(e.stateNode.nextSibling):null;return!0}function vr(){lr=rr=null,cr=!1}function yr(){var e=ur;return null!==e&&(null===Sh?Sh=e:Sh.push.apply(Sh,e),ur=null),e}function br(e){null===ur?ur=[e]:ur.push(e)}var xr=Bn(null),wr=null,Sr=null;function _r(e,t,n){Gn(xr,t._currentValue),t._currentValue=n}function Cr(e){e._currentValue=xr.current,qn(xr)}function Er(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function kr(e,t,n,i){var a=e.child;for(null!==a&&(a.return=e);null!==a;){var o=a.dependencies;if(null!==o){var s=a.child;o=o.firstContext;e:for(;null!==o;){var r=o;o=a;for(var l=0;l<t.length;l++)if(r.context===t[l]){o.lanes|=n,null!==(r=o.alternate)&&(r.lanes|=n),Er(o.return,n,e),i||(s=null);break e}o=r.next}}else if(18===a.tag){if(null===(s=a.return))throw Error(un(341));s.lanes|=n,null!==(o=s.alternate)&&(o.lanes|=n),Er(s,n,e),s=null}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===e){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}}function Ir(e,t,n,i){e=null;for(var a=t,o=!1;null!==a;){if(!o)if(524288&a.flags)o=!0;else if(262144&a.flags)break;if(10===a.tag){var s=a.alternate;if(null===s)throw Error(un(387));if(null!==(s=s.memoizedProps)){var r=a.type;Zo(a.pendingProps.value,s.value)||(null!==e?e.push(r):e=[r])}}else if(a===Kn.current){if(null===(s=a.alternate))throw Error(un(387));s.memoizedState.memoizedState!==a.memoizedState.memoizedState&&(null!==e?e.push(Xm):e=[Xm])}a=a.return}null!==e&&kr(t,e,n,i),t.flags|=262144}function Tr(e){for(e=e.firstContext;null!==e;){if(!Zo(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function jr(e){wr=e,Sr=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Nr(e){return Mr(wr,e)}function Pr(e,t){return null===wr&&jr(e),Mr(e,t)}function Mr(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===Sr){if(null===e)throw Error(un(308));Sr=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Sr=Sr.next=t;return n}var Ar="undefined"!=typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Rr=rn.unstable_scheduleCallback,Or=rn.unstable_NormalPriority,Dr={$$typeof:En,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Lr(){return{controller:new Ar,data:new Map,refCount:0}}function Fr(e){e.refCount--,0===e.refCount&&Rr(Or,function(){e.controller.abort()})}var Ur=null,zr=0,Hr=0,$r=null;function Br(){if(0===--zr&&null!==Ur){null!==$r&&($r.status="fulfilled");var e=Ur;Ur=null,Hr=0,$r=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var qr=Fn.S;Fn.S=function(e,t){"object"==typeof t&&null!==t&&"function"==typeof t.then&&function(e,t){if(null===Ur){var n=Ur=[];zr=0,Hr=Mp(),$r={status:"pending",value:void 0,then:function(e){n.push(e)}}}zr++,t.then(Br,Br)}(0,t),null!==qr&&qr(e,t)};var Gr=Bn(null);function Vr(){var e=Gr.current;return null!==e?e:sh.pooledCache}function Wr(e,t){Gn(Gr,null===t?Gr.current:t.pool)}function Qr(){var e=Vr();return null===e?null:{parent:Dr._currentValue,pool:e}}var Kr=Error(un(460)),Yr=Error(un(474)),Xr=Error(un(542)),Jr={then:function(){}};function Zr(e){return"fulfilled"===(e=e.status)||"rejected"===e}function el(){}function tl(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(el,el),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw al(e=t.reason),e;default:if("string"==typeof t.status)t.then(el,el);else{if(null!==(e=sh)&&100<e.shellSuspendCounter)throw Error(un(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw al(e=t.reason),e}throw nl=t,Kr}}var nl=null;function il(){if(null===nl)throw Error(un(459));var e=nl;return nl=null,e}function al(e){if(e===Kr||e===Xr)throw Error(un(483))}var ol=!1;function sl(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function rl(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ll(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function cl(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,2&oh){var a=i.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),i.pending=t,t=Ls(e),Ds(e,null,n),t}return As(e,i,t,n),Ls(e)}function ul(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194048&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,Pi(e,n)}}function dl(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var a=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===o?a=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?a=o=t:o=o.next=t}else a=o=t;return n={baseState:i.baseState,firstBaseUpdate:a,lastBaseUpdate:o,shared:i.shared,callbacks:i.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var hl=!1;function pl(){if(hl){if(null!==$r)throw $r}}function ml(e,t,n,i){hl=!1;var a=e.updateQueue;ol=!1;var o=a.firstBaseUpdate,s=a.lastBaseUpdate,r=a.shared.pending;if(null!==r){a.shared.pending=null;var l=r,c=l.next;l.next=null,null===s?o=c:s.next=c,s=l;var u=e.alternate;null!==u&&((r=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===r?u.firstBaseUpdate=c:r.next=c,u.lastBaseUpdate=l))}if(null!==o){var d=a.baseState;for(s=0,u=c=l=null,r=o;;){var h=-536870913&r.lane,p=h!==r.lane;if(p?(lh&h)===h:(i&h)===h){0!==h&&h===Hr&&(hl=!0),null!==u&&(u=u.next={lane:0,tag:r.tag,payload:r.payload,callback:null,next:null});e:{var m=e,f=r;h=t;var g=n;switch(f.tag){case 1:if("function"==typeof(m=f.payload)){d=m.call(g,d,h);break e}d=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null==(h="function"==typeof(m=f.payload)?m.call(g,d,h):m))break e;d=gn({},d,h);break e;case 2:ol=!0}}null!==(h=r.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=a.callbacks)?a.callbacks=[h]:p.push(h))}else p={lane:h,tag:r.tag,payload:r.payload,callback:r.callback,next:null},null===u?(c=u=p,l=d):u=u.next=p,s|=h;if(null===(r=r.next)){if(null===(r=a.shared.pending))break;r=(p=r).next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}null===u&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,null===o&&(a.shared.lanes=0),gh|=s,e.lanes=s,e.memoizedState=d}}function fl(e,t){if("function"!=typeof e)throw Error(un(191,e));e.call(t)}function gl(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)fl(n[e],t)}var vl=Bn(null),yl=Bn(0);function bl(e,t){Gn(yl,e=mh),Gn(vl,t),mh=e|t.baseLanes}function xl(){Gn(yl,mh),Gn(vl,vl.current)}function wl(){mh=yl.current,qn(vl),qn(yl)}var Sl=0,_l=null,Cl=null,El=null,kl=!1,Il=!1,Tl=!1,jl=0,Nl=0,Pl=null,Ml=0;function Al(){throw Error(un(321))}function Rl(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Zo(e[n],t[n]))return!1;return!0}function Ol(e,t,n,i,a,o){return Sl=o,_l=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Fn.H=null===e||null===e.memoizedState?Kc:Yc,Tl=!1,o=n(i,a),Tl=!1,Il&&(o=Ll(t,n,i,a)),Dl(e),o}function Dl(e){Fn.H=Qc;var t=null!==Cl&&null!==Cl.next;if(Sl=0,El=Cl=_l=null,kl=!1,Nl=0,Pl=null,t)throw Error(un(300));null===e||Nu||null!==(e=e.dependencies)&&Tr(e)&&(Nu=!0)}function Ll(e,t,n,i){_l=e;var a=0;do{if(Il&&(Pl=null),Nl=0,Il=!1,25<=a)throw Error(un(301));if(a+=1,El=Cl=null,null!=e.updateQueue){var o=e.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,null!=o.memoCache&&(o.memoCache.index=0)}Fn.H=Xc,o=t(n,i)}while(Il);return o}function Fl(){var e=Fn.H,t=e.useState()[0];return t="function"==typeof t.then?ql(t):t,e=e.useState()[0],(null!==Cl?Cl.memoizedState:null)!==e&&(_l.flags|=1024),t}function Ul(){var e=0!==jl;return jl=0,e}function zl(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Hl(e){if(kl){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}kl=!1}Sl=0,El=Cl=_l=null,Il=!1,Nl=jl=0,Pl=null}function $l(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===El?_l.memoizedState=El=e:El=El.next=e,El}function Bl(){if(null===Cl){var e=_l.alternate;e=null!==e?e.memoizedState:null}else e=Cl.next;var t=null===El?_l.memoizedState:El.next;if(null!==t)El=t,Cl=e;else{if(null===e){if(null===_l.alternate)throw Error(un(467));throw Error(un(310))}e={memoizedState:(Cl=e).memoizedState,baseState:Cl.baseState,baseQueue:Cl.baseQueue,queue:Cl.queue,next:null},null===El?_l.memoizedState=El=e:El=El.next=e}return El}function ql(e){var t=Nl;return Nl+=1,null===Pl&&(Pl=[]),e=tl(Pl,e,t),t=_l,null===(null===El?t.memoizedState:El.next)&&(t=t.alternate,Fn.H=null===t||null===t.memoizedState?Kc:Yc),e}function Gl(e){if(null!==e&&"object"==typeof e){if("function"==typeof e.then)return ql(e);if(e.$$typeof===En)return Nr(e)}throw Error(un(438,String(e)))}function Vl(e){var t=null,n=_l.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var i=_l.alternate;null!==i&&(null!==(i=i.updateQueue)&&(null!=(i=i.memoCache)&&(t={data:i.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},_l.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),i=0;i<e;i++)n[i]=Mn;return t.index++,n}function Wl(e,t){return"function"==typeof t?t(e):t}function Ql(e){return Kl(Bl(),Cl,e)}function Kl(e,t,n){var i=e.queue;if(null===i)throw Error(un(311));i.lastRenderedReducer=n;var a=e.baseQueue,o=i.pending;if(null!==o){if(null!==a){var s=a.next;a.next=o.next,o.next=s}t.baseQueue=a=o,i.pending=null}if(o=e.baseState,null===a)e.memoizedState=o;else{var r=s=null,l=null,c=t=a.next,u=!1;do{var d=-536870913&c.lane;if(d!==c.lane?(lh&d)===d:(Sl&d)===d){var h=c.revertLane;if(0===h)null!==l&&(l=l.next={lane:0,revertLane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),d===Hr&&(u=!0);else{if((Sl&h)===h){c=c.next,h===Hr&&(u=!0);continue}d={lane:0,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},null===l?(r=l=d,s=o):l=l.next=d,_l.lanes|=h,gh|=h}d=c.action,Tl&&n(o,d),o=c.hasEagerState?c.eagerState:n(o,d)}else h={lane:d,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},null===l?(r=l=h,s=o):l=l.next=h,_l.lanes|=d,gh|=d;c=c.next}while(null!==c&&c!==t);if(null===l?s=o:l.next=r,!Zo(o,e.memoizedState)&&(Nu=!0,u&&null!==(n=$r)))throw n;e.memoizedState=o,e.baseState=s,e.baseQueue=l,i.lastRenderedState=o}return null===a&&(i.lanes=0),[e.memoizedState,i.dispatch]}function Yl(e){var t=Bl(),n=t.queue;if(null===n)throw Error(un(311));n.lastRenderedReducer=e;var i=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{o=e(o,s.action),s=s.next}while(s!==a);Zo(o,t.memoizedState)||(Nu=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,i]}function Xl(e,t,n){var i=_l,a=Bl(),o=cr;if(o){if(void 0===n)throw Error(un(407));n=n()}else n=t();var s=!Zo((Cl||a).memoizedState,n);if(s&&(a.memoizedState=n,Nu=!0),a=a.queue,xc(2048,8,ec.bind(null,i,a,e),[e]),a.getSnapshot!==t||s||null!==El&&1&El.memoizedState.tag){if(i.flags|=2048,vc(9,{destroy:void 0,resource:void 0},Zl.bind(null,i,a,n,t),null),null===sh)throw Error(un(349));o||124&Sl||Jl(i,t,n)}return n}function Jl(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=_l.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},_l.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Zl(e,t,n,i){t.value=n,t.getSnapshot=i,tc(t)&&nc(e)}function ec(e,t,n){return n(function(){tc(t)&&nc(e)})}function tc(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Zo(e,n)}catch(i){return!0}}function nc(e){var t=Os(e,2);null!==t&&Uh(t,e,2)}function ic(e){var t=$l();if("function"==typeof e){var n=e;if(e=n(),Tl){gi(!0);try{n()}finally{gi(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wl,lastRenderedState:e},t}function ac(e,t,n,i){return e.baseState=n,Kl(e,Cl,"function"==typeof i?i:Wl)}function oc(e,t,n,i,a){if(Gc(e))throw Error(un(485));if(null!==(e=t.action)){var o={payload:a,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){o.listeners.push(e)}};null!==Fn.T?n(!0):o.isTransition=!1,i(o),null===(n=t.pending)?(o.next=t.pending=o,sc(t,o)):(o.next=n.next,t.pending=n.next=o)}}function sc(e,t){var n=t.action,i=t.payload,a=e.state;if(t.isTransition){var o=Fn.T,s={};Fn.T=s;try{var r=n(a,i),l=Fn.S;null!==l&&l(s,r),rc(e,t,r)}catch(c){cc(e,t,c)}finally{Fn.T=o}}else try{rc(e,t,o=n(a,i))}catch(u){cc(e,t,u)}}function rc(e,t,n){null!==n&&"object"==typeof n&&"function"==typeof n.then?n.then(function(n){lc(e,t,n)},function(n){return cc(e,t,n)}):lc(e,t,n)}function lc(e,t,n){t.status="fulfilled",t.value=n,uc(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,sc(e,n)))}function cc(e,t,n){var i=e.pending;if(e.pending=null,null!==i){i=i.next;do{t.status="rejected",t.reason=n,uc(t),t=t.next}while(t!==i)}e.action=null}function uc(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function dc(e,t){return t}function hc(e,t){if(cr){var n=sh.formState;if(null!==n){e:{var i=_l;if(cr){if(lr){t:{for(var a=lr,o=dr;8!==a.nodeType;){if(!o){a=null;break t}if(null===(a=xm(a.nextSibling))){a=null;break t}}a="F!"===(o=a.data)||"F"===o?a:null}if(a){lr=xm(a.nextSibling),i="F!"===a.data;break e}}pr(i)}i=!1}i&&(t=n[0])}}return(n=$l()).memoizedState=n.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:dc,lastRenderedState:t},n.queue=i,n=$c.bind(null,_l,i),i.dispatch=n,i=ic(!1),o=qc.bind(null,_l,!1,i.queue),a={state:t,dispatch:null,action:e,pending:null},(i=$l()).queue=a,n=oc.bind(null,_l,a,o,n),a.dispatch=n,i.memoizedState=e,[t,n,!1]}function pc(e){return mc(Bl(),Cl,e)}function mc(e,t,n){if(t=Kl(e,t,dc)[0],e=Ql(Wl)[0],"object"==typeof t&&null!==t&&"function"==typeof t.then)try{var i=ql(t)}catch(s){if(s===Kr)throw Xr;throw s}else i=t;var a=(t=Bl()).queue,o=a.dispatch;return n!==t.memoizedState&&(_l.flags|=2048,vc(9,{destroy:void 0,resource:void 0},fc.bind(null,a,n),null)),[i,o,e]}function fc(e,t){e.action=t}function gc(e){var t=Bl(),n=Cl;if(null!==n)return mc(t,n,e);Bl(),t=t.memoizedState;var i=(n=Bl()).queue.dispatch;return n.memoizedState=e,[t,i,!1]}function vc(e,t,n,i){return e={tag:e,create:n,deps:i,inst:t,next:null},null===(t=_l.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},_l.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function yc(){return Bl().memoizedState}function bc(e,t,n,i){var a=$l();i=void 0===i?null:i,_l.flags|=e,a.memoizedState=vc(1|t,{destroy:void 0,resource:void 0},n,i)}function xc(e,t,n,i){var a=Bl();i=void 0===i?null:i;var o=a.memoizedState.inst;null!==Cl&&null!==i&&Rl(i,Cl.memoizedState.deps)?a.memoizedState=vc(t,o,n,i):(_l.flags|=e,a.memoizedState=vc(1|t,o,n,i))}function wc(e,t){bc(8390656,8,e,t)}function Sc(e,t){xc(2048,8,e,t)}function _c(e,t){return xc(4,2,e,t)}function Cc(e,t){return xc(4,4,e,t)}function Ec(e,t){if("function"==typeof t){e=e();var n=t(e);return function(){"function"==typeof n?n():t(null)}}if(null!=t)return e=e(),t.current=e,function(){t.current=null}}function kc(e,t,n){n=null!=n?n.concat([e]):null,xc(4,4,Ec.bind(null,t,e),n)}function Ic(){}function Tc(e,t){var n=Bl();t=void 0===t?null:t;var i=n.memoizedState;return null!==t&&Rl(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function jc(e,t){var n=Bl();t=void 0===t?null:t;var i=n.memoizedState;if(null!==t&&Rl(t,i[1]))return i[0];if(i=e(),Tl){gi(!0);try{e()}finally{gi(!1)}}return n.memoizedState=[i,t],i}function Nc(e,t,n){return void 0===n||1073741824&Sl?e.memoizedState=t:(e.memoizedState=n,e=Fh(),_l.lanes|=e,gh|=e,n)}function Pc(e,t,n,i){return Zo(n,t)?n:null!==vl.current?(e=Nc(e,n,i),Zo(e,t)||(Nu=!0),e):42&Sl?(e=Fh(),_l.lanes|=e,gh|=e,t):(Nu=!0,e.memoizedState=n)}function Mc(e,t,n,i,a){var o=Un.p;Un.p=0!==o&&8>o?o:8;var s,r,l,c=Fn.T,u={};Fn.T=u,qc(e,!1,t,n);try{var d=a(),h=Fn.S;if(null!==h&&h(u,d),null!==d&&"object"==typeof d&&"function"==typeof d.then)Bc(e,t,(s=i,r=[],l={status:"pending",value:null,reason:null,then:function(e){r.push(e)}},d.then(function(){l.status="fulfilled",l.value=s;for(var e=0;e<r.length;e++)(0,r[e])(s)},function(e){for(l.status="rejected",l.reason=e,e=0;e<r.length;e++)(0,r[e])(void 0)}),l),Lh());else Bc(e,t,i,Lh())}catch(p){Bc(e,t,{then:function(){},status:"rejected",reason:p},Lh())}finally{Un.p=o,Fn.T=c}}function Ac(){}function Rc(e,t,n,i){if(5!==e.tag)throw Error(un(476));var a=Oc(e).queue;Mc(e,a,t,zn,null===n?Ac:function(){return Dc(e),n(i)})}function Oc(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:zn,baseState:zn,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wl,lastRenderedState:zn},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wl,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function Dc(e){Bc(e,Oc(e).next.queue,{},Lh())}function Lc(){return Nr(Xm)}function Fc(){return Bl().memoizedState}function Uc(){return Bl().memoizedState}function zc(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Lh(),i=cl(t,e=ll(n),n);return null!==i&&(Uh(i,t,n),ul(i,t,n)),t={cache:Lr()},void(e.payload=t)}t=t.return}}function Hc(e,t,n){var i=Lh();n={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},Gc(e)?Vc(t,n):null!==(n=Rs(e,t,n,i))&&(Uh(n,e,i),Wc(n,t,i))}function $c(e,t,n){Bc(e,t,n,Lh())}function Bc(e,t,n,i){var a={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(Gc(e))Vc(t,a);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,r=o(s,n);if(a.hasEagerState=!0,a.eagerState=r,Zo(r,s))return As(e,t,a,0),null===sh&&Ms(),!1}catch(l){}if(null!==(n=Rs(e,t,a,i)))return Uh(n,e,i),Wc(n,t,i),!0}return!1}function qc(e,t,n,i){if(i={lane:2,revertLane:Mp(),action:i,hasEagerState:!1,eagerState:null,next:null},Gc(e)){if(t)throw Error(un(479))}else null!==(t=Rs(e,n,i,2))&&Uh(t,e,2)}function Gc(e){var t=e.alternate;return e===_l||null!==t&&t===_l}function Vc(e,t){Il=kl=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Wc(e,t,n){if(4194048&n){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,Pi(e,n)}}var Qc={readContext:Nr,use:Gl,useCallback:Al,useContext:Al,useEffect:Al,useImperativeHandle:Al,useLayoutEffect:Al,useInsertionEffect:Al,useMemo:Al,useReducer:Al,useRef:Al,useState:Al,useDebugValue:Al,useDeferredValue:Al,useTransition:Al,useSyncExternalStore:Al,useId:Al,useHostTransitionStatus:Al,useFormState:Al,useActionState:Al,useOptimistic:Al,useMemoCache:Al,useCacheRefresh:Al},Kc={readContext:Nr,use:Gl,useCallback:function(e,t){return $l().memoizedState=[e,void 0===t?null:t],e},useContext:Nr,useEffect:wc,useImperativeHandle:function(e,t,n){n=null!=n?n.concat([e]):null,bc(4194308,4,Ec.bind(null,t,e),n)},useLayoutEffect:function(e,t){return bc(4194308,4,e,t)},useInsertionEffect:function(e,t){bc(4,2,e,t)},useMemo:function(e,t){var n=$l();t=void 0===t?null:t;var i=e();if(Tl){gi(!0);try{e()}finally{gi(!1)}}return n.memoizedState=[i,t],i},useReducer:function(e,t,n){var i=$l();if(void 0!==n){var a=n(t);if(Tl){gi(!0);try{n(t)}finally{gi(!1)}}}else a=t;return i.memoizedState=i.baseState=a,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:a},i.queue=e,e=e.dispatch=Hc.bind(null,_l,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},$l().memoizedState=e},useState:function(e){var t=(e=ic(e)).queue,n=$c.bind(null,_l,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Ic,useDeferredValue:function(e,t){return Nc($l(),e,t)},useTransition:function(){var e=ic(!1);return e=Mc.bind(null,_l,e.queue,!0,!1),$l().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var i=_l,a=$l();if(cr){if(void 0===n)throw Error(un(407));n=n()}else{if(n=t(),null===sh)throw Error(un(349));124&lh||Jl(i,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,wc(ec.bind(null,i,o,e),[e]),i.flags|=2048,vc(9,{destroy:void 0,resource:void 0},Zl.bind(null,i,o,n,t),null),n},useId:function(){var e=$l(),t=sh.identifierPrefix;if(cr){var n=nr;t=""+t+"R"+(n=(tr&~(1<<32-vi(tr)-1)).toString(32)+n),0<(n=jl++)&&(t+="H"+n.toString(32)),t+=""}else t=""+t+"r"+(n=Ml++).toString(32)+"";return e.memoizedState=t},useHostTransitionStatus:Lc,useFormState:hc,useActionState:hc,useOptimistic:function(e){var t=$l();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=qc.bind(null,_l,!0,n),n.dispatch=t,[e,t]},useMemoCache:Vl,useCacheRefresh:function(){return $l().memoizedState=zc.bind(null,_l)}},Yc={readContext:Nr,use:Gl,useCallback:Tc,useContext:Nr,useEffect:Sc,useImperativeHandle:kc,useInsertionEffect:_c,useLayoutEffect:Cc,useMemo:jc,useReducer:Ql,useRef:yc,useState:function(){return Ql(Wl)},useDebugValue:Ic,useDeferredValue:function(e,t){return Pc(Bl(),Cl.memoizedState,e,t)},useTransition:function(){var e=Ql(Wl)[0],t=Bl().memoizedState;return["boolean"==typeof e?e:ql(e),t]},useSyncExternalStore:Xl,useId:Fc,useHostTransitionStatus:Lc,useFormState:pc,useActionState:pc,useOptimistic:function(e,t){return ac(Bl(),0,e,t)},useMemoCache:Vl,useCacheRefresh:Uc},Xc={readContext:Nr,use:Gl,useCallback:Tc,useContext:Nr,useEffect:Sc,useImperativeHandle:kc,useInsertionEffect:_c,useLayoutEffect:Cc,useMemo:jc,useReducer:Yl,useRef:yc,useState:function(){return Yl(Wl)},useDebugValue:Ic,useDeferredValue:function(e,t){var n=Bl();return null===Cl?Nc(n,e,t):Pc(n,Cl.memoizedState,e,t)},useTransition:function(){var e=Yl(Wl)[0],t=Bl().memoizedState;return["boolean"==typeof e?e:ql(e),t]},useSyncExternalStore:Xl,useId:Fc,useHostTransitionStatus:Lc,useFormState:gc,useActionState:gc,useOptimistic:function(e,t){var n=Bl();return null!==Cl?ac(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Vl,useCacheRefresh:Uc},Jc=null,Zc=0;function eu(e){var t=Zc;return Zc+=1,null===Jc&&(Jc=[]),tl(Jc,e,t)}function tu(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function nu(e,t){if(t.$$typeof===vn)throw Error(un(525));throw e=Object.prototype.toString.call(t),Error(un(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function iu(e){return(0,e._init)(e._payload)}function au(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function a(e,t){return(e=$s(e,t)).index=0,e.sibling=null,e}function o(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=67108866,n):i:(t.flags|=67108866,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function r(e,t,n,i){return null===t||6!==t.tag?((t=Vs(n,e.mode,i)).return=e,t):((t=a(t,n)).return=e,t)}function l(e,t,n,i){var o=n.type;return o===xn?u(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===o||"object"==typeof o&&null!==o&&o.$$typeof===Nn&&iu(o)===t.type)?(tu(t=a(t,n.props),n),t.return=e,t):(tu(t=qs(n.type,n.key,n.props,null,e.mode,i),n),t.return=e,t)}function c(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Ws(n,e.mode,i)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function u(e,t,n,i,o){return null===t||7!==t.tag?((t=Gs(n,e.mode,i,o)).return=e,t):((t=a(t,n)).return=e,t)}function d(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t||"bigint"==typeof t)return(t=Vs(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case yn:return tu(n=qs(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case bn:return(t=Ws(t,e.mode,n)).return=e,t;case Nn:return d(e,t=(0,t._init)(t._payload),n)}if(Ln(t)||Rn(t))return(t=Gs(t,e.mode,n,null)).return=e,t;if("function"==typeof t.then)return d(e,eu(t),n);if(t.$$typeof===En)return d(e,Pr(e,t),n);nu(e,t)}return null}function h(e,t,n,i){var a=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n||"bigint"==typeof n)return null!==a?null:r(e,t,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case yn:return n.key===a?l(e,t,n,i):null;case bn:return n.key===a?c(e,t,n,i):null;case Nn:return h(e,t,n=(a=n._init)(n._payload),i)}if(Ln(n)||Rn(n))return null!==a?null:u(e,t,n,i,null);if("function"==typeof n.then)return h(e,t,eu(n),i);if(n.$$typeof===En)return h(e,t,Pr(e,n),i);nu(e,n)}return null}function p(e,t,n,i,a){if("string"==typeof i&&""!==i||"number"==typeof i||"bigint"==typeof i)return r(t,e=e.get(n)||null,""+i,a);if("object"==typeof i&&null!==i){switch(i.$$typeof){case yn:return l(t,e=e.get(null===i.key?n:i.key)||null,i,a);case bn:return c(t,e=e.get(null===i.key?n:i.key)||null,i,a);case Nn:return p(e,t,n,i=(0,i._init)(i._payload),a)}if(Ln(i)||Rn(i))return u(t,e=e.get(n)||null,i,a,null);if("function"==typeof i.then)return p(e,t,n,eu(i),a);if(i.$$typeof===En)return p(e,t,n,Pr(t,i),a);nu(t,i)}return null}function m(r,l,c,u){if("object"==typeof c&&null!==c&&c.type===xn&&null===c.key&&(c=c.props.children),"object"==typeof c&&null!==c){switch(c.$$typeof){case yn:e:{for(var f=c.key;null!==l;){if(l.key===f){if((f=c.type)===xn){if(7===l.tag){n(r,l.sibling),(u=a(l,c.props.children)).return=r,r=u;break e}}else if(l.elementType===f||"object"==typeof f&&null!==f&&f.$$typeof===Nn&&iu(f)===l.type){n(r,l.sibling),tu(u=a(l,c.props),c),u.return=r,r=u;break e}n(r,l);break}t(r,l),l=l.sibling}c.type===xn?((u=Gs(c.props.children,r.mode,u,c.key)).return=r,r=u):(tu(u=qs(c.type,c.key,c.props,null,r.mode,u),c),u.return=r,r=u)}return s(r);case bn:e:{for(f=c.key;null!==l;){if(l.key===f){if(4===l.tag&&l.stateNode.containerInfo===c.containerInfo&&l.stateNode.implementation===c.implementation){n(r,l.sibling),(u=a(l,c.children||[])).return=r,r=u;break e}n(r,l);break}t(r,l),l=l.sibling}(u=Ws(c,r.mode,u)).return=r,r=u}return s(r);case Nn:return m(r,l,c=(f=c._init)(c._payload),u)}if(Ln(c))return function(a,s,r,l){for(var c=null,u=null,m=s,f=s=0,g=null;null!==m&&f<r.length;f++){m.index>f?(g=m,m=null):g=m.sibling;var v=h(a,m,r[f],l);if(null===v){null===m&&(m=g);break}e&&m&&null===v.alternate&&t(a,m),s=o(v,s,f),null===u?c=v:u.sibling=v,u=v,m=g}if(f===r.length)return n(a,m),cr&&ir(a,f),c;if(null===m){for(;f<r.length;f++)null!==(m=d(a,r[f],l))&&(s=o(m,s,f),null===u?c=m:u.sibling=m,u=m);return cr&&ir(a,f),c}for(m=i(m);f<r.length;f++)null!==(g=p(m,a,f,r[f],l))&&(e&&null!==g.alternate&&m.delete(null===g.key?f:g.key),s=o(g,s,f),null===u?c=g:u.sibling=g,u=g);return e&&m.forEach(function(e){return t(a,e)}),cr&&ir(a,f),c}(r,l,c,u);if(Rn(c)){if("function"!=typeof(f=Rn(c)))throw Error(un(150));return function(a,s,r,l){if(null==r)throw Error(un(151));for(var c=null,u=null,m=s,f=s=0,g=null,v=r.next();null!==m&&!v.done;f++,v=r.next()){m.index>f?(g=m,m=null):g=m.sibling;var y=h(a,m,v.value,l);if(null===y){null===m&&(m=g);break}e&&m&&null===y.alternate&&t(a,m),s=o(y,s,f),null===u?c=y:u.sibling=y,u=y,m=g}if(v.done)return n(a,m),cr&&ir(a,f),c;if(null===m){for(;!v.done;f++,v=r.next())null!==(v=d(a,v.value,l))&&(s=o(v,s,f),null===u?c=v:u.sibling=v,u=v);return cr&&ir(a,f),c}for(m=i(m);!v.done;f++,v=r.next())null!==(v=p(m,a,f,v.value,l))&&(e&&null!==v.alternate&&m.delete(null===v.key?f:v.key),s=o(v,s,f),null===u?c=v:u.sibling=v,u=v);return e&&m.forEach(function(e){return t(a,e)}),cr&&ir(a,f),c}(r,l,c=f.call(c),u)}if("function"==typeof c.then)return m(r,l,eu(c),u);if(c.$$typeof===En)return m(r,l,Pr(r,c),u);nu(r,c)}return"string"==typeof c&&""!==c||"number"==typeof c||"bigint"==typeof c?(c=""+c,null!==l&&6===l.tag?(n(r,l.sibling),(u=a(l,c)).return=r,r=u):(n(r,l),(u=Vs(c,r.mode,u)).return=r,r=u),s(r)):n(r,l)}return function(e,t,n,i){try{Zc=0;var a=m(e,t,n,i);return Jc=null,a}catch(s){if(s===Kr||s===Xr)throw s;var o=zs(29,s,null,e.mode);return o.lanes=i,o.return=e,o}}}var ou=au(!0),su=au(!1),ru=Bn(null),lu=null;function cu(e){var t=e.alternate;Gn(pu,1&pu.current),Gn(ru,e),null===lu&&(null===t||null!==vl.current||null!==t.memoizedState)&&(lu=e)}function uu(e){if(22===e.tag){if(Gn(pu,pu.current),Gn(ru,e),null===lu){var t=e.alternate;null!==t&&null!==t.memoizedState&&(lu=e)}}else du()}function du(){Gn(pu,pu.current),Gn(ru,ru.current)}function hu(e){qn(ru),lu===e&&(lu=null),qn(pu)}var pu=Bn(0);function mu(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||bm(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function fu(e,t,n,i){n=null==(n=n(i,t=e.memoizedState))?t:gn({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var gu={enqueueSetState:function(e,t,n){e=e._reactInternals;var i=Lh(),a=ll(i);a.payload=t,null!=n&&(a.callback=n),null!==(t=cl(e,a,i))&&(Uh(t,e,i),ul(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=Lh(),a=ll(i);a.tag=1,a.payload=t,null!=n&&(a.callback=n),null!==(t=cl(e,a,i))&&(Uh(t,e,i),ul(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Lh(),i=ll(n);i.tag=2,null!=t&&(i.callback=t),null!==(t=cl(e,i,n))&&(Uh(t,e,n),ul(t,e,n))}};function vu(e,t,n,i,a,o,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!es(n,i)||!es(a,o))}function yu(e,t,n,i){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&gu.enqueueReplaceState(t,t.state,null)}function bu(e,t){var n=t;if("ref"in t)for(var i in n={},t)"ref"!==i&&(n[i]=t[i]);if(e=e.defaultProps)for(var a in n===t&&(n=gn({},n)),e)void 0===n[a]&&(n[a]=e[a]);return n}var xu="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e)};function wu(e){xu(e)}function Su(e){}function _u(e){xu(e)}function Cu(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Eu(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(i){setTimeout(function(){throw i})}}function ku(e,t,n){return(n=ll(n)).tag=3,n.payload={element:null},n.callback=function(){Cu(e,t)},n}function Iu(e){return(e=ll(e)).tag=3,e}function Tu(e,t,n,i){var a=n.type.getDerivedStateFromError;if("function"==typeof a){var o=i.value;e.payload=function(){return a(o)},e.callback=function(){Eu(t,n,i)}}var s=n.stateNode;null!==s&&"function"==typeof s.componentDidCatch&&(e.callback=function(){Eu(t,n,i),"function"!=typeof a&&(null===Ih?Ih=new Set([this]):Ih.add(this));var e=i.stack;this.componentDidCatch(i.value,{componentStack:null!==e?e:""})})}var ju=Error(un(461)),Nu=!1;function Pu(e,t,n,i){t.child=null===e?su(t,null,n,i):ou(t,e.child,n,i)}function Mu(e,t,n,i,a){n=n.render;var o=t.ref;if("ref"in i){var s={};for(var r in i)"ref"!==r&&(s[r]=i[r])}else s=i;return jr(t),i=Ol(e,t,n,s,o,a),r=Ul(),null===e||Nu?(cr&&r&&or(t),t.flags|=1,Pu(e,t,i,a),t.child):(zl(e,t,a),Ju(e,t,a))}function Au(e,t,n,i,a){if(null===e){var o=n.type;return"function"!=typeof o||Hs(o)||void 0!==o.defaultProps||null!==n.compare?((e=qs(n.type,null,i,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Ru(e,t,o,i,a))}if(o=e.child,!Zu(e,a)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:es)(s,i)&&e.ref===t.ref)return Ju(e,t,a)}return t.flags|=1,(e=$s(o,i)).ref=t.ref,e.return=t,t.child=e}function Ru(e,t,n,i,a){if(null!==e){var o=e.memoizedProps;if(es(o,i)&&e.ref===t.ref){if(Nu=!1,t.pendingProps=i=o,!Zu(e,a))return t.lanes=e.lanes,Ju(e,t,a);131072&e.flags&&(Nu=!0)}}return Fu(e,t,n,i,a)}function Ou(e,t,n){var i=t.pendingProps,a=i.children,o=null!==e?e.memoizedState:null;if("hidden"===i.mode){if(128&t.flags){if(i=null!==o?o.baseLanes|n:n,null!==e){for(a=t.child=e.child,o=0;null!==a;)o=o|a.lanes|a.childLanes,a=a.sibling;t.childLanes=o&~i}else t.childLanes=0,t.child=null;return Du(e,t,i,n)}if(!(536870912&n))return t.lanes=t.childLanes=536870912,Du(e,t,null!==o?o.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Wr(0,null!==o?o.cachePool:null),null!==o?bl(t,o):xl(),uu(t)}else null!==o?(Wr(0,o.cachePool),bl(t,o),du(),t.memoizedState=null):(null!==e&&Wr(0,null),xl(),du());return Pu(e,t,a,n),t.child}function Du(e,t,n,i){var a=Vr();return a=null===a?null:{parent:Dr._currentValue,pool:a},t.memoizedState={baseLanes:n,cachePool:a},null!==e&&Wr(0,null),xl(),uu(t),null!==e&&Ir(e,t,i,!0),null}function Lu(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!=typeof n&&"object"!=typeof n)throw Error(un(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Fu(e,t,n,i,a){return jr(t),n=Ol(e,t,n,i,void 0,a),i=Ul(),null===e||Nu?(cr&&i&&or(t),t.flags|=1,Pu(e,t,n,a),t.child):(zl(e,t,a),Ju(e,t,a))}function Uu(e,t,n,i,a,o){return jr(t),t.updateQueue=null,n=Ll(t,i,n,a),Dl(e),i=Ul(),null===e||Nu?(cr&&i&&or(t),t.flags|=1,Pu(e,t,n,o),t.child):(zl(e,t,o),Ju(e,t,o))}function zu(e,t,n,i,a){if(jr(t),null===t.stateNode){var o=Fs,s=n.contextType;"object"==typeof s&&null!==s&&(o=Nr(s)),o=new n(i,o),t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,o.updater=gu,t.stateNode=o,o._reactInternals=t,(o=t.stateNode).props=i,o.state=t.memoizedState,o.refs={},sl(t),s=n.contextType,o.context="object"==typeof s&&null!==s?Nr(s):Fs,o.state=t.memoizedState,"function"==typeof(s=n.getDerivedStateFromProps)&&(fu(t,n,s,i),o.state=t.memoizedState),"function"==typeof n.getDerivedStateFromProps||"function"==typeof o.getSnapshotBeforeUpdate||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||(s=o.state,"function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),s!==o.state&&gu.enqueueReplaceState(o,o.state,null),ml(t,i,o,a),pl(),o.state=t.memoizedState),"function"==typeof o.componentDidMount&&(t.flags|=4194308),i=!0}else if(null===e){o=t.stateNode;var r=t.memoizedProps,l=bu(n,r);o.props=l;var c=o.context,u=n.contextType;s=Fs,"object"==typeof u&&null!==u&&(s=Nr(u));var d=n.getDerivedStateFromProps;u="function"==typeof d||"function"==typeof o.getSnapshotBeforeUpdate,r=t.pendingProps!==r,u||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(r||c!==s)&&yu(t,o,i,s),ol=!1;var h=t.memoizedState;o.state=h,ml(t,i,o,a),pl(),c=t.memoizedState,r||h!==c||ol?("function"==typeof d&&(fu(t,n,d,i),c=t.memoizedState),(l=ol||vu(t,n,l,i,h,c,s))?(u||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||("function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"==typeof o.componentDidMount&&(t.flags|=4194308)):("function"==typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=c),o.props=i,o.state=c,o.context=s,i=l):("function"==typeof o.componentDidMount&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,rl(e,t),u=bu(n,s=t.memoizedProps),o.props=u,d=t.pendingProps,h=o.context,c=n.contextType,l=Fs,"object"==typeof c&&null!==c&&(l=Nr(c)),(c="function"==typeof(r=n.getDerivedStateFromProps)||"function"==typeof o.getSnapshotBeforeUpdate)||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(s!==d||h!==l)&&yu(t,o,i,l),ol=!1,h=t.memoizedState,o.state=h,ml(t,i,o,a),pl();var p=t.memoizedState;s!==d||h!==p||ol||null!==e&&null!==e.dependencies&&Tr(e.dependencies)?("function"==typeof r&&(fu(t,n,r,i),p=t.memoizedState),(u=ol||vu(t,n,u,i,h,p,l)||null!==e&&null!==e.dependencies&&Tr(e.dependencies))?(c||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||("function"==typeof o.componentWillUpdate&&o.componentWillUpdate(i,p,l),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,p,l)),"function"==typeof o.componentDidUpdate&&(t.flags|=4),"function"==typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=p),o.props=i,o.state=p,o.context=l,i=u):("function"!=typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),i=!1)}return o=i,Lu(e,t),i=!!(128&t.flags),o||i?(o=t.stateNode,n=i&&"function"!=typeof n.getDerivedStateFromError?null:o.render(),t.flags|=1,null!==e&&i?(t.child=ou(t,e.child,null,a),t.child=ou(t,null,n,a)):Pu(e,t,n,a),t.memoizedState=o.state,e=t.child):e=Ju(e,t,a),e}function Hu(e,t,n,i){return vr(),t.flags|=256,Pu(e,t,n,i),t.child}var $u={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Bu(e){return{baseLanes:e,cachePool:Qr()}}function qu(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=bh),e}function Gu(e,t,n){var i,a=t.pendingProps,o=!1,s=!!(128&t.flags);if((i=s)||(i=(null===e||null!==e.memoizedState)&&!!(2&pu.current)),i&&(o=!0,t.flags&=-129),i=!!(32&t.flags),t.flags&=-33,null===e){if(cr){if(o?cu(t):du(),cr){var r,l=lr;if(r=l){e:{for(r=l,l=dr;8!==r.nodeType;){if(!l){l=null;break e}if(null===(r=xm(r.nextSibling))){l=null;break e}}l=r}null!==l?(t.memoizedState={dehydrated:l,treeContext:null!==er?{id:tr,overflow:nr}:null,retryLane:536870912,hydrationErrors:null},(r=zs(18,null,null,0)).stateNode=l,r.return=t,t.child=r,rr=t,lr=null,r=!0):r=!1}r||pr(t)}if(null!==(l=t.memoizedState)&&null!==(l=l.dehydrated))return bm(l)?t.lanes=32:t.lanes=536870912,null;hu(t)}return l=a.children,a=a.fallback,o?(du(),l=Wu({mode:"hidden",children:l},o=t.mode),a=Gs(a,o,n,null),l.return=t,a.return=t,l.sibling=a,t.child=l,(o=t.child).memoizedState=Bu(n),o.childLanes=qu(e,i,n),t.memoizedState=$u,a):(cu(t),Vu(t,l))}if(null!==(r=e.memoizedState)&&null!==(l=r.dehydrated)){if(s)256&t.flags?(cu(t),t.flags&=-257,t=Qu(e,t,n)):null!==t.memoizedState?(du(),t.child=e.child,t.flags|=128,t=null):(du(),o=a.fallback,l=t.mode,a=Wu({mode:"visible",children:a.children},l),(o=Gs(o,l,n,null)).flags|=2,a.return=t,o.return=t,a.sibling=o,t.child=a,ou(t,e.child,null,n),(a=t.child).memoizedState=Bu(n),a.childLanes=qu(e,i,n),t.memoizedState=$u,t=o);else if(cu(t),bm(l)){if(i=l.nextSibling&&l.nextSibling.dataset)var c=i.dgst;i=c,(a=Error(un(419))).stack="",a.digest=i,br({value:a,source:null,stack:null}),t=Qu(e,t,n)}else if(Nu||Ir(e,t,n,!1),i=0!==(n&e.childLanes),Nu||i){if(null!==(i=sh)&&(0!==(a=0!==((a=42&(a=n&-n)?1:Mi(a))&(i.suspendedLanes|n))?0:a)&&a!==r.retryLane))throw r.retryLane=a,Os(e,a),Uh(i,e,a),ju;"$?"===l.data||Yh(),t=Qu(e,t,n)}else"$?"===l.data?(t.flags|=192,t.child=e.child,t=null):(e=r.treeContext,lr=xm(l.nextSibling),rr=t,cr=!0,ur=null,dr=!1,null!==e&&(Js[Zs++]=tr,Js[Zs++]=nr,Js[Zs++]=er,tr=e.id,nr=e.overflow,er=t),(t=Vu(t,a.children)).flags|=4096);return t}return o?(du(),o=a.fallback,l=t.mode,c=(r=e.child).sibling,(a=$s(r,{mode:"hidden",children:a.children})).subtreeFlags=65011712&r.subtreeFlags,null!==c?o=$s(c,o):(o=Gs(o,l,n,null)).flags|=2,o.return=t,a.return=t,a.sibling=o,t.child=a,a=o,o=t.child,null===(l=e.child.memoizedState)?l=Bu(n):(null!==(r=l.cachePool)?(c=Dr._currentValue,r=r.parent!==c?{parent:c,pool:c}:r):r=Qr(),l={baseLanes:l.baseLanes|n,cachePool:r}),o.memoizedState=l,o.childLanes=qu(e,i,n),t.memoizedState=$u,a):(cu(t),e=(n=e.child).sibling,(n=$s(n,{mode:"visible",children:a.children})).return=t,n.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=n,t.memoizedState=null,n)}function Vu(e,t){return(t=Wu({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Wu(e,t){return(e=zs(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Qu(e,t,n){return ou(t,e.child,null,n),(e=Vu(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ku(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Er(e.return,t,n)}function Yu(e,t,n,i,a){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:a}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=n,o.tailMode=a)}function Xu(e,t,n){var i=t.pendingProps,a=i.revealOrder,o=i.tail;if(Pu(e,t,i.children,n),2&(i=pu.current))i=1&i|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ku(e,n,t);else if(19===e.tag)Ku(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}switch(Gn(pu,i),a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===mu(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Yu(t,!1,a,n,o);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===mu(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Yu(t,!0,n,null,o);break;case"together":Yu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ju(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),gh|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Ir(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(un(153));if(null!==t.child){for(n=$s(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=$s(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Zu(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Tr(e))}function ed(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Nu=!0;else{if(!(Zu(e,n)||128&t.flags))return Nu=!1,function(e,t,n){switch(t.tag){case 3:Yn(t,t.stateNode.containerInfo),_r(0,Dr,e.memoizedState.cache),vr();break;case 27:case 5:Jn(t);break;case 4:Yn(t,t.stateNode.containerInfo);break;case 10:_r(0,t.type,t.memoizedProps.value);break;case 13:var i=t.memoizedState;if(null!==i)return null!==i.dehydrated?(cu(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Gu(e,t,n):(cu(t),null!==(e=Ju(e,t,n))?e.sibling:null);cu(t);break;case 19:var a=!!(128&e.flags);if((i=0!==(n&t.childLanes))||(Ir(e,t,n,!1),i=0!==(n&t.childLanes)),a){if(i)return Xu(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Gn(pu,pu.current),i)break;return null;case 22:case 23:return t.lanes=0,Ou(e,t,n);case 24:_r(0,Dr,e.memoizedState.cache)}return Ju(e,t,n)}(e,t,n);Nu=!!(131072&e.flags)}else Nu=!1,cr&&1048576&t.flags&&ar(t,Xs,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var i=t.elementType,a=i._init;if(i=a(i._payload),t.type=i,"function"!=typeof i){if(null!=i){if((a=i.$$typeof)===kn){t.tag=11,t=Mu(null,t,i,e,n);break e}if(a===jn){t.tag=14,t=Au(null,t,i,e,n);break e}}throw t=Dn(i)||i,Error(un(306,t,""))}Hs(i)?(e=bu(i,e),t.tag=1,t=zu(null,t,i,e,n)):(t.tag=0,t=Fu(null,t,i,e,n))}return t;case 0:return Fu(e,t,t.type,t.pendingProps,n);case 1:return zu(e,t,i=t.type,a=bu(i,t.pendingProps),n);case 3:e:{if(Yn(t,t.stateNode.containerInfo),null===e)throw Error(un(387));i=t.pendingProps;var o=t.memoizedState;a=o.element,rl(e,t),ml(t,i,null,n);var s=t.memoizedState;if(i=s.cache,_r(0,Dr,i),i!==o.cache&&kr(t,[Dr],n,!0),pl(),i=s.element,o.isDehydrated){if(o={element:i,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Hu(e,t,i,n);break e}if(i!==a){br(a=Ts(Error(un(424)),t)),t=Hu(e,t,i,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(lr=xm(e.firstChild),rr=t,cr=!0,ur=null,dr=!0,n=su(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(vr(),i===a){t=Ju(e,t,n);break e}Pu(e,t,i,n)}t=t.child}return t;case 26:return Lu(e,t),null===e?(n=Pm(t.type,null,t.pendingProps,null))?t.memoizedState=n:cr||(n=t.type,e=t.pendingProps,(i=sm(Qn.current).createElement(n))[Di]=t,i[Li]=e,im(i,n,e),Ki(i),t.stateNode=i):t.memoizedState=Pm(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Jn(t),null===e&&cr&&(i=t.stateNode=_m(t.type,t.pendingProps,Qn.current),rr=t,dr=!0,a=lr,gm(t.type)?(wm=a,lr=xm(i.firstChild)):lr=a),Pu(e,t,t.pendingProps.children,n),Lu(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&cr&&((a=i=lr)&&(null!==(i=function(e,t,n,i){for(;1===e.nodeType;){var a=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(i){if(!e[Bi])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(o=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(o!==a.rel||e.getAttribute("href")!==(null==a.href||""===a.href?null:a.href)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin)||e.getAttribute("title")!==(null==a.title?null:a.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((o=e.getAttribute("src"))!==(null==a.src?null:a.src)||e.getAttribute("type")!==(null==a.type?null:a.type)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin))&&o&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var o=null==a.name?null:""+a.name;if("hidden"===a.type&&e.getAttribute("name")===o)return e}if(null===(e=xm(e.nextSibling)))break}return null}(i,t.type,t.pendingProps,dr))?(t.stateNode=i,rr=t,lr=xm(i.firstChild),dr=!1,a=!0):a=!1),a||pr(t)),Jn(t),a=t.type,o=t.pendingProps,s=null!==e?e.memoizedProps:null,i=o.children,cm(a,o)?i=null:null!==s&&cm(a,s)&&(t.flags|=32),null!==t.memoizedState&&(a=Ol(e,t,Fl,null,null,n),Xm._currentValue=a),Lu(e,t),Pu(e,t,i,n),t.child;case 6:return null===e&&cr&&((e=n=lr)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=xm(e.nextSibling)))return null}return e}(n,t.pendingProps,dr))?(t.stateNode=n,rr=t,lr=null,e=!0):e=!1),e||pr(t)),null;case 13:return Gu(e,t,n);case 4:return Yn(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=ou(t,null,i,n):Pu(e,t,i,n),t.child;case 11:return Mu(e,t,t.type,t.pendingProps,n);case 7:return Pu(e,t,t.pendingProps,n),t.child;case 8:case 12:return Pu(e,t,t.pendingProps.children,n),t.child;case 10:return i=t.pendingProps,_r(0,t.type,i.value),Pu(e,t,i.children,n),t.child;case 9:return a=t.type._context,i=t.pendingProps.children,jr(t),i=i(a=Nr(a)),t.flags|=1,Pu(e,t,i,n),t.child;case 14:return Au(e,t,t.type,t.pendingProps,n);case 15:return Ru(e,t,t.type,t.pendingProps,n);case 19:return Xu(e,t,n);case 31:return i=t.pendingProps,n=t.mode,i={mode:i.mode,children:i.children},null===e?((n=Wu(i,n)).ref=t.ref,t.child=n,n.return=t,t=n):((n=$s(e.child,i)).ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return Ou(e,t,n);case 24:return jr(t),i=Nr(Dr),null===e?(null===(a=Vr())&&(a=sh,o=Lr(),a.pooledCache=o,o.refCount++,null!==o&&(a.pooledCacheLanes|=n),a=o),t.memoizedState={parent:i,cache:a},sl(t),_r(0,Dr,a)):(0!==(e.lanes&n)&&(rl(e,t),ml(t,null,null,n),pl()),a=e.memoizedState,o=t.memoizedState,a.parent!==i?(a={parent:i,cache:i},t.memoizedState=a,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=a),_r(0,Dr,i)):(i=o.cache,_r(0,Dr,i),i!==a.cache&&kr(t,[Dr],n,!0))),Pu(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(un(156,t.tag))}function td(e){e.flags|=4}function nd(e,t){if("stylesheet"!==t.type||4&t.state.loading)e.flags&=-16777217;else if(e.flags|=16777216,!qm(t)){if(null!==(t=ru.current)&&((4194048&lh)===lh?null!==lu:(62914560&lh)!==lh&&!(536870912&lh)||t!==lu))throw nl=Jr,Yr;e.flags|=8192}}function id(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Ii():536870912,e.lanes|=t,xh|=t)}function ad(e,t){if(!cr)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function od(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,i|=65011712&a.subtreeFlags,i|=65011712&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,i|=a.subtreeFlags,i|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function sd(e,t,n){var i=t.pendingProps;switch(sr(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return od(t),null;case 3:return n=t.stateNode,i=null,null!==e&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),Cr(Dr),Xn(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(gr(t)?td(t):null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,yr())),od(t),null;case 26:return n=t.memoizedState,null===e?(td(t),null!==n?(od(t),nd(t,n)):(od(t),t.flags&=-16777217)):n?n!==e.memoizedState?(td(t),od(t),nd(t,n)):(od(t),t.flags&=-16777217):(e.memoizedProps!==i&&td(t),od(t),t.flags&=-16777217),null;case 27:Zn(t),n=Qn.current;var a=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==i&&td(t);else{if(!i){if(null===t.stateNode)throw Error(un(166));return od(t),null}e=Vn.current,gr(t)?mr(t):(e=_m(a,i,n),t.stateNode=e,td(t))}return od(t),null;case 5:if(Zn(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==i&&td(t);else{if(!i){if(null===t.stateNode)throw Error(un(166));return od(t),null}if(e=Vn.current,gr(t))mr(t);else{switch(a=sm(Qn.current),e){case 1:e=a.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=a.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=a.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=a.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(e=a.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"==typeof i.is?a.createElement("select",{is:i.is}):a.createElement("select"),i.multiple?e.multiple=!0:i.size&&(e.size=i.size);break;default:e="string"==typeof i.is?a.createElement(n,{is:i.is}):a.createElement(n)}}e[Di]=t,e[Li]=i;e:for(a=t.child;null!==a;){if(5===a.tag||6===a.tag)e.appendChild(a.stateNode);else if(4!==a.tag&&27!==a.tag&&null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break e;for(;null===a.sibling;){if(null===a.return||a.return===t)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}t.stateNode=e;e:switch(im(e,n,i),n){case"button":case"input":case"select":case"textarea":e=!!i.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&td(t)}}return od(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==i&&td(t);else{if("string"!=typeof i&&null===t.stateNode)throw Error(un(166));if(e=Qn.current,gr(t)){if(e=t.stateNode,n=t.memoizedProps,i=null,null!==(a=rr))switch(a.tag){case 27:case 5:i=a.memoizedProps}e[Di]=t,(e=!!(e.nodeValue===n||null!==i&&!0===i.suppressHydrationWarning||Zp(e.nodeValue,n)))||pr(t)}else(e=sm(e).createTextNode(i))[Di]=t,t.stateNode=e}return od(t),null;case 13:if(i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(a=gr(t),null!==i&&null!==i.dehydrated){if(null===e){if(!a)throw Error(un(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(un(317));a[Di]=t}else vr(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;od(t),a=!1}else a=yr(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=a),a=!0;if(!a)return 256&t.flags?(hu(t),t):(hu(t),null)}if(hu(t),128&t.flags)return t.lanes=n,t;if(n=null!==i,e=null!==e&&null!==e.memoizedState,n){a=null,null!==(i=t.child).alternate&&null!==i.alternate.memoizedState&&null!==i.alternate.memoizedState.cachePool&&(a=i.alternate.memoizedState.cachePool.pool);var o=null;null!==i.memoizedState&&null!==i.memoizedState.cachePool&&(o=i.memoizedState.cachePool.pool),o!==a&&(i.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),id(t,t.updateQueue),od(t),null;case 4:return Xn(),null===e&&Bp(t.stateNode.containerInfo),od(t),null;case 10:return Cr(t.type),od(t),null;case 19:if(qn(pu),null===(a=t.memoizedState))return od(t),null;if(i=!!(128&t.flags),null===(o=a.rendering))if(i)ad(a,!1);else{if(0!==fh||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(o=mu(e))){for(t.flags|=128,ad(a,!1),e=o.updateQueue,t.updateQueue=e,id(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Bs(n,e),n=n.sibling;return Gn(pu,1&pu.current|2),t.child}e=e.sibling}null!==a.tail&&oi()>Eh&&(t.flags|=128,i=!0,ad(a,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=mu(o))){if(t.flags|=128,i=!0,e=e.updateQueue,t.updateQueue=e,id(t,e),ad(a,!0),null===a.tail&&"hidden"===a.tailMode&&!o.alternate&&!cr)return od(t),null}else 2*oi()-a.renderingStartTime>Eh&&536870912!==n&&(t.flags|=128,i=!0,ad(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(null!==(e=a.last)?e.sibling=o:t.child=o,a.last=o)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=oi(),t.sibling=null,e=pu.current,Gn(pu,i?1&e|2:1&e),t):(od(t),null);case 22:case 23:return hu(t),wl(),i=null!==t.memoizedState,null!==e?null!==e.memoizedState!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?!!(536870912&n)&&!(128&t.flags)&&(od(t),6&t.subtreeFlags&&(t.flags|=8192)):od(t),null!==(n=t.updateQueue)&&id(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),i=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(i=t.memoizedState.cachePool.pool),i!==n&&(t.flags|=2048),null!==e&&qn(Gr),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Cr(Dr),od(t),null;case 25:case 30:return null}throw Error(un(156,t.tag))}function rd(e,t){switch(sr(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Cr(Dr),Xn(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Zn(t),null;case 13:if(hu(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(un(340));vr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return qn(pu),null;case 4:return Xn(),null;case 10:return Cr(t.type),null;case 22:case 23:return hu(t),wl(),null!==e&&qn(Gr),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Cr(Dr),null;default:return null}}function ld(e,t){switch(sr(t),t.tag){case 3:Cr(Dr),Xn();break;case 26:case 27:case 5:Zn(t);break;case 4:Xn();break;case 13:hu(t);break;case 19:qn(pu);break;case 10:Cr(t.type);break;case 22:case 23:hu(t),wl(),null!==e&&qn(Gr);break;case 24:Cr(Dr)}}function cd(e,t){try{var n=t.updateQueue,i=null!==n?n.lastEffect:null;if(null!==i){var a=i.next;n=a;do{if((n.tag&e)===e){i=void 0;var o=n.create,s=n.inst;i=o(),s.destroy=i}n=n.next}while(n!==a)}}catch(r){pp(t,t.return,r)}}function ud(e,t,n){try{var i=t.updateQueue,a=null!==i?i.lastEffect:null;if(null!==a){var o=a.next;i=o;do{if((i.tag&e)===e){var s=i.inst,r=s.destroy;if(void 0!==r){s.destroy=void 0,a=t;var l=n,c=r;try{c()}catch(u){pp(a,l,u)}}}i=i.next}while(i!==o)}}catch(u){pp(t,t.return,u)}}function dd(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{gl(t,n)}catch(i){pp(e,e.return,i)}}}function hd(e,t,n){n.props=bu(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(i){pp(e,t,i)}}function pd(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var i=e.stateNode;break;default:i=e.stateNode}"function"==typeof n?e.refCleanup=n(i):n.current=i}}catch(a){pp(e,t,a)}}function md(e,t){var n=e.ref,i=e.refCleanup;if(null!==n)if("function"==typeof i)try{i()}catch(a){pp(e,t,a)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"==typeof n)try{n(null)}catch(o){pp(e,t,o)}else n.current=null}function fd(e){var t=e.type,n=e.memoizedProps,i=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(a){pp(e,e.return,a)}}function gd(e,t,n){try{var i=e.stateNode;!function(e,t,n,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var a=null,o=null,s=null,r=null,l=null,c=null,u=null;for(p in n){var d=n[p];if(n.hasOwnProperty(p)&&null!=d)switch(p){case"checked":case"value":break;case"defaultValue":l=d;default:i.hasOwnProperty(p)||tm(e,t,p,null,i,d)}}for(var h in i){var p=i[h];if(d=n[h],i.hasOwnProperty(h)&&(null!=p||null!=d))switch(h){case"type":o=p;break;case"name":a=p;break;case"checked":c=p;break;case"defaultChecked":u=p;break;case"value":s=p;break;case"defaultValue":r=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(un(137,t));break;default:p!==d&&tm(e,t,h,p,i,d)}}return void xa(e,s,r,l,c,u,o,a);case"select":for(o in p=s=r=h=null,n)if(l=n[o],n.hasOwnProperty(o)&&null!=l)switch(o){case"value":break;case"multiple":p=l;default:i.hasOwnProperty(o)||tm(e,t,o,null,i,l)}for(a in i)if(o=i[a],l=n[a],i.hasOwnProperty(a)&&(null!=o||null!=l))switch(a){case"value":h=o;break;case"defaultValue":r=o;break;case"multiple":s=o;default:o!==l&&tm(e,t,a,o,i,l)}return t=r,n=s,i=p,void(null!=h?_a(e,!!n,h,!1):!!i!=!!n&&(null!=t?_a(e,!!n,t,!0):_a(e,!!n,n?[]:"",!1)));case"textarea":for(r in p=h=null,n)if(a=n[r],n.hasOwnProperty(r)&&null!=a&&!i.hasOwnProperty(r))switch(r){case"value":case"children":break;default:tm(e,t,r,null,i,a)}for(s in i)if(a=i[s],o=n[s],i.hasOwnProperty(s)&&(null!=a||null!=o))switch(s){case"value":h=a;break;case"defaultValue":p=a;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=a)throw Error(un(91));break;default:a!==o&&tm(e,t,s,a,i,o)}return void Ca(e,h,p);case"option":for(var m in n)if(h=n[m],n.hasOwnProperty(m)&&null!=h&&!i.hasOwnProperty(m))if("selected"===m)e.selected=!1;else tm(e,t,m,null,i,h);for(l in i)if(h=i[l],p=n[l],i.hasOwnProperty(l)&&h!==p&&(null!=h||null!=p))if("selected"===l)e.selected=h&&"function"!=typeof h&&"symbol"!=typeof h;else tm(e,t,l,h,i,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var f in n)h=n[f],n.hasOwnProperty(f)&&null!=h&&!i.hasOwnProperty(f)&&tm(e,t,f,null,i,h);for(c in i)if(h=i[c],p=n[c],i.hasOwnProperty(c)&&h!==p&&(null!=h||null!=p))switch(c){case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(un(137,t));break;default:tm(e,t,c,h,i,p)}return;default:if(Na(t)){for(var g in n)h=n[g],n.hasOwnProperty(g)&&void 0!==h&&!i.hasOwnProperty(g)&&nm(e,t,g,void 0,i,h);for(u in i)h=i[u],p=n[u],!i.hasOwnProperty(u)||h===p||void 0===h&&void 0===p||nm(e,t,u,h,i,p);return}}for(var v in n)h=n[v],n.hasOwnProperty(v)&&null!=h&&!i.hasOwnProperty(v)&&tm(e,t,v,null,i,h);for(d in i)h=i[d],p=n[d],!i.hasOwnProperty(d)||h===p||null==h&&null==p||tm(e,t,d,h,i,p)}(i,e.type,n,t),i[Li]=t}catch(a){pp(e,e.return,a)}}function vd(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&gm(e.type)||4===e.tag}function yd(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||vd(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&gm(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function bd(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=em));else if(4!==i&&(27===i&&gm(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(bd(e,t,n),e=e.sibling;null!==e;)bd(e,t,n),e=e.sibling}function xd(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&(27===i&&gm(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(xd(e,t,n),e=e.sibling;null!==e;)xd(e,t,n),e=e.sibling}function wd(e){var t=e.stateNode,n=e.memoizedProps;try{for(var i=e.type,a=t.attributes;a.length;)t.removeAttributeNode(a[0]);im(t,i,n),t[Di]=e,t[Li]=n}catch(o){pp(e,e.return,o)}}var Sd=!1,_d=!1,Cd=!1,Ed="function"==typeof WeakSet?WeakSet:Set,kd=null;function Id(e,t,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:zd(e,n),4&i&&cd(5,n);break;case 1:if(zd(e,n),4&i)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(s){pp(n,n.return,s)}else{var a=bu(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(a,t,e.__reactInternalSnapshotBeforeUpdate)}catch(r){pp(n,n.return,r)}}64&i&&dd(n),512&i&&pd(n,n.return);break;case 3:if(zd(e,n),64&i&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{gl(e,t)}catch(s){pp(n,n.return,s)}}break;case 27:null===t&&4&i&&wd(n);case 26:case 5:zd(e,n),null===t&&4&i&&fd(n),512&i&&pd(n,n.return);break;case 12:zd(e,n);break;case 13:zd(e,n),4&i&&Ad(e,n),64&i&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$?"!==e.data||"complete"===n.readyState)t();else{var i=function(){t(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),e._reactRetry=i}}(e,n=vp.bind(null,n))));break;case 22:if(!(i=null!==n.memoizedState||Sd)){t=null!==t&&null!==t.memoizedState||_d,a=Sd;var o=_d;Sd=i,(_d=t)&&!o?$d(e,n,!!(8772&n.subtreeFlags)):zd(e,n),Sd=a,_d=o}break;case 30:break;default:zd(e,n)}}function Td(e){var t=e.alternate;null!==t&&(e.alternate=null,Td(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&qi(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var jd=null,Nd=!1;function Pd(e,t,n){for(n=n.child;null!==n;)Md(e,t,n),n=n.sibling}function Md(e,t,n){if(fi&&"function"==typeof fi.onCommitFiberUnmount)try{fi.onCommitFiberUnmount(mi,n)}catch(o){}switch(n.tag){case 26:_d||md(n,t),Pd(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:_d||md(n,t);var i=jd,a=Nd;gm(n.type)&&(jd=n.stateNode,Nd=!1),Pd(e,t,n),Cm(n.stateNode),jd=i,Nd=a;break;case 5:_d||md(n,t);case 6:if(i=jd,a=Nd,jd=null,Pd(e,t,n),Nd=a,null!==(jd=i))if(Nd)try{(9===jd.nodeType?jd.body:"HTML"===jd.nodeName?jd.ownerDocument.body:jd).removeChild(n.stateNode)}catch(s){pp(n,t,s)}else try{jd.removeChild(n.stateNode)}catch(s){pp(n,t,s)}break;case 18:null!==jd&&(Nd?(vm(9===(e=jd).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Pf(e)):vm(jd,n.stateNode));break;case 4:i=jd,a=Nd,jd=n.stateNode.containerInfo,Nd=!0,Pd(e,t,n),jd=i,Nd=a;break;case 0:case 11:case 14:case 15:_d||ud(2,n,t),_d||ud(4,n,t),Pd(e,t,n);break;case 1:_d||(md(n,t),"function"==typeof(i=n.stateNode).componentWillUnmount&&hd(n,t,i)),Pd(e,t,n);break;case 21:Pd(e,t,n);break;case 22:_d=(i=_d)||null!==n.memoizedState,Pd(e,t,n),_d=i;break;default:Pd(e,t,n)}}function Ad(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Pf(e)}catch(n){pp(t,t.return,n)}}function Rd(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Ed),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Ed),t;default:throw Error(un(435,e.tag))}}(e);t.forEach(function(t){var i=yp.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))})}function Od(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var a=n[i],o=e,s=t,r=s;e:for(;null!==r;){switch(r.tag){case 27:if(gm(r.type)){jd=r.stateNode,Nd=!1;break e}break;case 5:jd=r.stateNode,Nd=!1;break e;case 3:case 4:jd=r.stateNode.containerInfo,Nd=!0;break e}r=r.return}if(null===jd)throw Error(un(160));Md(o,s,a),jd=null,Nd=!1,null!==(o=a.alternate)&&(o.return=null),a.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)Ld(t,e),t=t.sibling}var Dd=null;function Ld(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Od(t,e),Fd(e),4&i&&(ud(3,e,e.return),cd(3,e),ud(5,e,e.return));break;case 1:Od(t,e),Fd(e),512&i&&(_d||null===n||md(n,n.return)),64&i&&Sd&&(null!==(e=e.updateQueue)&&(null!==(i=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?i:n.concat(i))));break;case 26:var a=Dd;if(Od(t,e),Fd(e),512&i&&(_d||null===n||md(n,n.return)),4&i){var o=null!==n?n.memoizedState:null;if(i=e.memoizedState,null===n)if(null===i)if(null===e.stateNode){e:{i=e.type,n=e.memoizedProps,a=a.ownerDocument||a;t:switch(i){case"title":(!(o=a.getElementsByTagName("title")[0])||o[Bi]||o[Di]||"http://www.w3.org/2000/svg"===o.namespaceURI||o.hasAttribute("itemprop"))&&(o=a.createElement(i),a.head.insertBefore(o,a.querySelector("head > title"))),im(o,i,n),o[Di]=e,Ki(o),i=o;break e;case"link":var s=$m("link","href",a).get(i+(n.href||""));if(s)for(var r=0;r<s.length;r++)if((o=s[r]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&o.getAttribute("rel")===(null==n.rel?null:n.rel)&&o.getAttribute("title")===(null==n.title?null:n.title)&&o.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){s.splice(r,1);break t}im(o=a.createElement(i),i,n),a.head.appendChild(o);break;case"meta":if(s=$m("meta","content",a).get(i+(n.content||"")))for(r=0;r<s.length;r++)if((o=s[r]).getAttribute("content")===(null==n.content?null:""+n.content)&&o.getAttribute("name")===(null==n.name?null:n.name)&&o.getAttribute("property")===(null==n.property?null:n.property)&&o.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&o.getAttribute("charset")===(null==n.charSet?null:n.charSet)){s.splice(r,1);break t}im(o=a.createElement(i),i,n),a.head.appendChild(o);break;default:throw Error(un(468,i))}o[Di]=e,Ki(o),i=o}e.stateNode=i}else Bm(a,e.type,e.stateNode);else e.stateNode=Lm(a,i,e.memoizedProps);else o!==i?(null===o?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):o.count--,null===i?Bm(a,e.type,e.stateNode):Lm(a,i,e.memoizedProps)):null===i&&null!==e.stateNode&&gd(e,e.memoizedProps,n.memoizedProps)}break;case 27:Od(t,e),Fd(e),512&i&&(_d||null===n||md(n,n.return)),null!==n&&4&i&&gd(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Od(t,e),Fd(e),512&i&&(_d||null===n||md(n,n.return)),32&e.flags){a=e.stateNode;try{ka(a,"")}catch(p){pp(e,e.return,p)}}4&i&&null!=e.stateNode&&gd(e,a=e.memoizedProps,null!==n?n.memoizedProps:a),1024&i&&(Cd=!0);break;case 6:if(Od(t,e),Fd(e),4&i){if(null===e.stateNode)throw Error(un(162));i=e.memoizedProps,n=e.stateNode;try{n.nodeValue=i}catch(p){pp(e,e.return,p)}}break;case 3:if(Hm=null,a=Dd,Dd=Im(t.containerInfo),Od(t,e),Dd=a,Fd(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Pf(t.containerInfo)}catch(p){pp(e,e.return,p)}Cd&&(Cd=!1,Ud(e));break;case 4:i=Dd,Dd=Im(e.stateNode.containerInfo),Od(t,e),Fd(e),Dd=i;break;case 12:default:Od(t,e),Fd(e);break;case 13:Od(t,e),Fd(e),8192&e.child.flags&&null!==e.memoizedState!=(null!==n&&null!==n.memoizedState)&&(Ch=oi()),4&i&&(null!==(i=e.updateQueue)&&(e.updateQueue=null,Rd(e,i)));break;case 22:a=null!==e.memoizedState;var l=null!==n&&null!==n.memoizedState,c=Sd,u=_d;if(Sd=c||a,_d=u||l,Od(t,e),_d=u,Sd=c,Fd(e),8192&i)e:for(t=e.stateNode,t._visibility=a?-2&t._visibility:1|t._visibility,a&&(null===n||l||Sd||_d||Hd(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){l=n=t;try{if(o=l.stateNode,a)"function"==typeof(s=o.style).setProperty?s.setProperty("display","none","important"):s.display="none";else{r=l.stateNode;var d=l.memoizedProps.style,h=null!=d&&d.hasOwnProperty("display")?d.display:null;r.style.display=null==h||"boolean"==typeof h?"":(""+h).trim()}}catch(p){pp(l,l.return,p)}}}else if(6===t.tag){if(null===n){l=t;try{l.stateNode.nodeValue=a?"":l.memoizedProps}catch(p){pp(l,l.return,p)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&i&&(null!==(i=e.updateQueue)&&(null!==(n=i.retryQueue)&&(i.retryQueue=null,Rd(e,n))));break;case 19:Od(t,e),Fd(e),4&i&&(null!==(i=e.updateQueue)&&(e.updateQueue=null,Rd(e,i)));case 30:case 21:}}function Fd(e){var t=e.flags;if(2&t){try{for(var n,i=e.return;null!==i;){if(vd(i)){n=i;break}i=i.return}if(null==n)throw Error(un(160));switch(n.tag){case 27:var a=n.stateNode;xd(e,yd(e),a);break;case 5:var o=n.stateNode;32&n.flags&&(ka(o,""),n.flags&=-33),xd(e,yd(e),o);break;case 3:case 4:var s=n.stateNode.containerInfo;bd(e,yd(e),s);break;default:throw Error(un(161))}}catch(r){pp(e,e.return,r)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Ud(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Ud(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function zd(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Id(e,t.alternate,t),t=t.sibling}function Hd(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ud(4,t,t.return),Hd(t);break;case 1:md(t,t.return);var n=t.stateNode;"function"==typeof n.componentWillUnmount&&hd(t,t.return,n),Hd(t);break;case 27:Cm(t.stateNode);case 26:case 5:md(t,t.return),Hd(t);break;case 22:null===t.memoizedState&&Hd(t);break;default:Hd(t)}e=e.sibling}}function $d(e,t,n){for(n=n&&!!(8772&t.subtreeFlags),t=t.child;null!==t;){var i=t.alternate,a=e,o=t,s=o.flags;switch(o.tag){case 0:case 11:case 15:$d(a,o,n),cd(4,o);break;case 1:if($d(a,o,n),"function"==typeof(a=(i=o).stateNode).componentDidMount)try{a.componentDidMount()}catch(c){pp(i,i.return,c)}if(null!==(a=(i=o).updateQueue)){var r=i.stateNode;try{var l=a.shared.hiddenCallbacks;if(null!==l)for(a.shared.hiddenCallbacks=null,a=0;a<l.length;a++)fl(l[a],r)}catch(c){pp(i,i.return,c)}}n&&64&s&&dd(o),pd(o,o.return);break;case 27:wd(o);case 26:case 5:$d(a,o,n),n&&null===i&&4&s&&fd(o),pd(o,o.return);break;case 12:$d(a,o,n);break;case 13:$d(a,o,n),n&&4&s&&Ad(a,o);break;case 22:null===o.memoizedState&&$d(a,o,n),pd(o,o.return);break;case 30:break;default:$d(a,o,n)}t=t.sibling}}function Bd(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Fr(n))}function qd(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Fr(e))}function Gd(e,t,n,i){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Vd(e,t,n,i),t=t.sibling}function Vd(e,t,n,i){var a=t.flags;switch(t.tag){case 0:case 11:case 15:Gd(e,t,n,i),2048&a&&cd(9,t);break;case 1:case 13:default:Gd(e,t,n,i);break;case 3:Gd(e,t,n,i),2048&a&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Fr(e)));break;case 12:if(2048&a){Gd(e,t,n,i),e=t.stateNode;try{var o=t.memoizedProps,s=o.id,r=o.onPostCommit;"function"==typeof r&&r(s,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){pp(t,t.return,l)}}else Gd(e,t,n,i);break;case 23:break;case 22:o=t.stateNode,s=t.alternate,null!==t.memoizedState?2&o._visibility?Gd(e,t,n,i):Qd(e,t):2&o._visibility?Gd(e,t,n,i):(o._visibility|=2,Wd(e,t,n,i,!!(10256&t.subtreeFlags))),2048&a&&Bd(s,t);break;case 24:Gd(e,t,n,i),2048&a&&qd(t.alternate,t)}}function Wd(e,t,n,i,a){for(a=a&&!!(10256&t.subtreeFlags),t=t.child;null!==t;){var o=e,s=t,r=n,l=i,c=s.flags;switch(s.tag){case 0:case 11:case 15:Wd(o,s,r,l,a),cd(8,s);break;case 23:break;case 22:var u=s.stateNode;null!==s.memoizedState?2&u._visibility?Wd(o,s,r,l,a):Qd(o,s):(u._visibility|=2,Wd(o,s,r,l,a)),a&&2048&c&&Bd(s.alternate,s);break;case 24:Wd(o,s,r,l,a),a&&2048&c&&qd(s.alternate,s);break;default:Wd(o,s,r,l,a)}t=t.sibling}}function Qd(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,i=t,a=i.flags;switch(i.tag){case 22:Qd(n,i),2048&a&&Bd(i.alternate,i);break;case 24:Qd(n,i),2048&a&&qd(i.alternate,i);break;default:Qd(n,i)}t=t.sibling}}var Kd=8192;function Yd(e){if(e.subtreeFlags&Kd)for(e=e.child;null!==e;)Xd(e),e=e.sibling}function Xd(e){switch(e.tag){case 26:Yd(e),e.flags&Kd&&null!==e.memoizedState&&function(e,t,n){if(null===Gm)throw Error(un(475));var i=Gm;if(!("stylesheet"!==t.type||"string"==typeof n.media&&!1===matchMedia(n.media).matches||4&t.state.loading)){if(null===t.instance){var a=Mm(n.href),o=e.querySelector(Am(a));if(o)return null!==(e=o._p)&&"object"==typeof e&&"function"==typeof e.then&&(i.count++,i=Wm.bind(i),e.then(i,i)),t.state.loading|=4,t.instance=o,void Ki(o);o=e.ownerDocument||e,n=Rm(n),(a=Em.get(a))&&Um(n,a),Ki(o=o.createElement("link"));var s=o;s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),im(o,"link",n),t.instance=o}null===i.stylesheets&&(i.stylesheets=new Map),i.stylesheets.set(t,e),(e=t.state.preload)&&!(3&t.state.loading)&&(i.count++,t=Wm.bind(i),e.addEventListener("load",t),e.addEventListener("error",t))}}(Dd,e.memoizedState,e.memoizedProps);break;case 5:default:Yd(e);break;case 3:case 4:var t=Dd;Dd=Im(e.stateNode.containerInfo),Yd(e),Dd=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Kd,Kd=16777216,Yd(e),Kd=t):Yd(e))}}function Jd(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Zd(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var i=t[n];kd=i,nh(i,e)}Jd(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)eh(e),e=e.sibling}function eh(e){switch(e.tag){case 0:case 11:case 15:Zd(e),2048&e.flags&&ud(9,e,e.return);break;case 3:case 12:default:Zd(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,th(e)):Zd(e)}}function th(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var i=t[n];kd=i,nh(i,e)}Jd(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:ud(8,t,t.return),th(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,th(t));break;default:th(t)}e=e.sibling}}function nh(e,t){for(;null!==kd;){var n=kd;switch(n.tag){case 0:case 11:case 15:ud(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var i=n.memoizedState.cachePool.pool;null!=i&&i.refCount++}break;case 24:Fr(n.memoizedState.cache)}if(null!==(i=n.child))i.return=n,kd=i;else e:for(n=e;null!==kd;){var a=(i=kd).sibling,o=i.return;if(Td(i),i===n){kd=null;break e}if(null!==a){a.return=o,kd=a;break e}kd=o}}}var ih={getCacheForType:function(e){var t=Nr(Dr),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},ah="function"==typeof WeakMap?WeakMap:Map,oh=0,sh=null,rh=null,lh=0,ch=0,uh=null,dh=!1,hh=!1,ph=!1,mh=0,fh=0,gh=0,vh=0,yh=0,bh=0,xh=0,wh=null,Sh=null,_h=!1,Ch=0,Eh=1/0,kh=null,Ih=null,Th=0,jh=null,Nh=null,Ph=0,Mh=0,Ah=null,Rh=null,Oh=0,Dh=null;function Lh(){if(2&oh&&0!==lh)return lh&-lh;if(null!==Fn.T){return 0!==Hr?Hr:Mp()}return Ri()}function Fh(){0===bh&&(bh=536870912&lh&&!cr?536870912:ki());var e=ru.current;return null!==e&&(e.flags|=32),bh}function Uh(e,t,n){(e!==sh||2!==ch&&9!==ch)&&null===e.cancelPendingCommit||(Vh(e,0),Bh(e,lh,bh,!1)),ji(e,n),2&oh&&e===sh||(e===sh&&(!(2&oh)&&(vh|=n),4===fh&&Bh(e,lh,bh,!1)),Ep(e))}function zh(e,t,n){if(6&oh)throw Error(un(327));for(var i=!n&&!(124&t)&&0===(t&e.expiredLanes)||Ci(e,t),a=i?function(e,t){var n=oh;oh|=2;var i=Qh(),a=Kh();sh!==e||lh!==t?(kh=null,Eh=oi()+500,Vh(e,t)):hh=Ci(e,t);e:for(;;)try{if(0!==ch&&null!==rh){t=rh;var o=uh;t:switch(ch){case 1:ch=0,uh=null,np(e,t,o,1);break;case 2:case 9:if(Zr(o)){ch=0,uh=null,tp(t);break}t=function(){2!==ch&&9!==ch||sh!==e||(ch=7),Ep(e)},o.then(t,t);break e;case 3:ch=7;break e;case 4:ch=5;break e;case 7:Zr(o)?(ch=0,uh=null,tp(t)):(ch=0,uh=null,np(e,t,o,7));break;case 5:var s=null;switch(rh.tag){case 26:s=rh.memoizedState;case 5:case 27:var r=rh;if(!s||qm(s)){ch=0,uh=null;var l=r.sibling;if(null!==l)rh=l;else{var c=r.return;null!==c?(rh=c,ip(c)):rh=null}break t}}ch=0,uh=null,np(e,t,o,5);break;case 6:ch=0,uh=null,np(e,t,o,6);break;case 8:Gh(),fh=6;break e;default:throw Error(un(462))}}Zh();break}catch(u){Wh(e,u)}return Sr=wr=null,Fn.H=i,Fn.A=a,oh=n,null!==rh?0:(sh=null,lh=0,Ms(),fh)}(e,t):Xh(e,t,!0),o=i;;){if(0===a){hh&&!i&&Bh(e,t,0,!1);break}if(n=e.current.alternate,!o||$h(n)){if(2===a){if(o=t,e.errorRecoveryDisabledLanes&o)var s=0;else s=0!==(s=-536870913&e.pendingLanes)?s:536870912&s?536870912:0;if(0!==s){t=s;e:{var r=e;a=wh;var l=r.current.memoizedState.isDehydrated;if(l&&(Vh(r,s).flags|=256),2!==(s=Xh(r,s,!1))){if(ph&&!l){r.errorRecoveryDisabledLanes|=o,vh|=o,a=4;break e}o=Sh,Sh=a,null!==o&&(null===Sh?Sh=o:Sh.push.apply(Sh,o))}a=s}if(o=!1,2!==a)continue}}if(1===a){Vh(e,0),Bh(e,t,0,!0);break}e:{switch(i=e,o=a){case 0:case 1:throw Error(un(345));case 4:if((4194048&t)!==t)break;case 6:Bh(i,t,bh,!dh);break e;case 2:Sh=null;break;case 3:case 5:break;default:throw Error(un(329))}if((62914560&t)===t&&10<(a=Ch+300-oi())){if(Bh(i,t,bh,!dh),0!==_i(i,0,!0))break e;i.timeoutHandle=dm(Hh.bind(null,i,n,Sh,kh,_h,t,bh,vh,xh,dh,o,2,-0,0),a)}else Hh(i,n,Sh,kh,_h,t,bh,vh,xh,dh,o,0,-0,0)}break}a=Xh(e,t,!1),o=!1}Ep(e)}function Hh(e,t,n,i,a,o,s,r,l,c,u,d,h,p){if(e.timeoutHandle=-1,(8192&(d=t.subtreeFlags)||!(16785408&~d))&&(Gm={stylesheets:null,count:0,unsuspend:Vm},Xd(t),null!==(d=function(){if(null===Gm)throw Error(un(475));var e=Gm;return e.stylesheets&&0===e.count&&Km(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&Km(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}())))return e.cancelPendingCommit=d(op.bind(null,e,t,o,n,i,a,s,r,l,u,1,h,p)),void Bh(e,o,s,!c);op(e,t,o,n,i,a,s,r,l)}function $h(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var i=0;i<n.length;i++){var a=n[i],o=a.getSnapshot;a=a.value;try{if(!Zo(o(),a))return!1}catch(s){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Bh(e,t,n,i){t&=~yh,t&=~vh,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var a=t;0<a;){var o=31-vi(a),s=1<<o;i[o]=-1,a&=~s}0!==n&&Ni(e,n,t)}function qh(){return!!(6&oh)||(kp(0),!1)}function Gh(){if(null!==rh){if(0===ch)var e=rh.return;else Sr=wr=null,Hl(e=rh),Jc=null,Zc=0,e=rh;for(;null!==e;)ld(e.alternate,e),e=e.return;rh=null}}function Vh(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,hm(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Gh(),sh=e,rh=n=$s(e.current,null),lh=t,ch=0,uh=null,dh=!1,hh=Ci(e,t),ph=!1,xh=bh=yh=vh=gh=fh=0,Sh=wh=null,_h=!1,8&t&&(t|=32&t);var i=e.entangledLanes;if(0!==i)for(e=e.entanglements,i&=t;0<i;){var a=31-vi(i),o=1<<a;t|=e[a],i&=~o}return mh=t,Ms(),n}function Wh(e,t){_l=null,Fn.H=Qc,t===Kr||t===Xr?(t=il(),ch=3):t===Yr?(t=il(),ch=4):ch=t===ju?8:null!==t&&"object"==typeof t&&"function"==typeof t.then?6:1,uh=t,null===rh&&(fh=1,Cu(e,Ts(t,e.current)))}function Qh(){var e=Fn.H;return Fn.H=Qc,null===e?Qc:e}function Kh(){var e=Fn.A;return Fn.A=ih,e}function Yh(){fh=4,dh||(4194048&lh)!==lh&&null!==ru.current||(hh=!0),!(134217727&gh)&&!(134217727&vh)||null===sh||Bh(sh,lh,bh,!1)}function Xh(e,t,n){var i=oh;oh|=2;var a=Qh(),o=Kh();sh===e&&lh===t||(kh=null,Vh(e,t)),t=!1;var s=fh;e:for(;;)try{if(0!==ch&&null!==rh){var r=rh,l=uh;switch(ch){case 8:Gh(),s=6;break e;case 3:case 2:case 9:case 6:null===ru.current&&(t=!0);var c=ch;if(ch=0,uh=null,np(e,r,l,c),n&&hh){s=0;break e}break;default:c=ch,ch=0,uh=null,np(e,r,l,c)}}Jh(),s=fh;break}catch(u){Wh(e,u)}return t&&e.shellSuspendCounter++,Sr=wr=null,oh=i,Fn.H=a,Fn.A=o,null===rh&&(sh=null,lh=0,Ms()),s}function Jh(){for(;null!==rh;)ep(rh)}function Zh(){for(;null!==rh&&!ii();)ep(rh)}function ep(e){var t=ed(e.alternate,e,mh);e.memoizedProps=e.pendingProps,null===t?ip(e):rh=t}function tp(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Uu(n,t,t.pendingProps,t.type,void 0,lh);break;case 11:t=Uu(n,t,t.pendingProps,t.type.render,t.ref,lh);break;case 5:Hl(t);default:ld(n,t),t=ed(n,t=rh=Bs(t,mh),mh)}e.memoizedProps=e.pendingProps,null===t?ip(e):rh=t}function np(e,t,n,i){Sr=wr=null,Hl(t),Jc=null,Zc=0;var a=t.return;try{if(function(e,t,n,i,a){if(n.flags|=32768,null!==i&&"object"==typeof i&&"function"==typeof i.then){if(null!==(t=n.alternate)&&Ir(t,n,a,!0),null!==(n=ru.current)){switch(n.tag){case 13:return null===lu?Yh():null===n.alternate&&0===fh&&(fh=3),n.flags&=-257,n.flags|=65536,n.lanes=a,i===Jr?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([i]):t.add(i),mp(e,i,a)),!1;case 22:return n.flags|=65536,i===Jr?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([i]):n.add(i),mp(e,i,a)),!1}throw Error(un(435,n.tag))}return mp(e,i,a),Yh(),!1}if(cr)return null!==(t=ru.current)?(!(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=a,i!==hr&&br(Ts(e=Error(un(422),{cause:i}),n))):(i!==hr&&br(Ts(t=Error(un(423),{cause:i}),n)),(e=e.current.alternate).flags|=65536,a&=-a,e.lanes|=a,i=Ts(i,n),dl(e,a=ku(e.stateNode,i,a)),4!==fh&&(fh=2)),!1;var o=Error(un(520),{cause:i});if(o=Ts(o,n),null===wh?wh=[o]:wh.push(o),4!==fh&&(fh=2),null===t)return!0;i=Ts(i,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=a&-a,n.lanes|=e,dl(n,e=ku(n.stateNode,i,e)),!1;case 1:if(t=n.type,o=n.stateNode,!(128&n.flags||"function"!=typeof t.getDerivedStateFromError&&(null===o||"function"!=typeof o.componentDidCatch||null!==Ih&&Ih.has(o))))return n.flags|=65536,a&=-a,n.lanes|=a,Tu(a=Iu(a),e,n,i),dl(n,a),!1}n=n.return}while(null!==n);return!1}(e,a,t,n,lh))return fh=1,Cu(e,Ts(n,e.current)),void(rh=null)}catch(o){if(null!==a)throw rh=a,o;return fh=1,Cu(e,Ts(n,e.current)),void(rh=null)}32768&t.flags?(cr||1===i?e=!0:hh||536870912&lh?e=!1:(dh=e=!0,(2===i||9===i||3===i||6===i)&&(null!==(i=ru.current)&&13===i.tag&&(i.flags|=16384))),ap(t,e)):ip(t)}function ip(e){var t=e;do{if(32768&t.flags)return void ap(t,dh);e=t.return;var n=sd(t.alternate,t,mh);if(null!==n)return void(rh=n);if(null!==(t=t.sibling))return void(rh=t);rh=t=e}while(null!==t);0===fh&&(fh=5)}function ap(e,t){do{var n=rd(e.alternate,e);if(null!==n)return n.flags&=32767,void(rh=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(rh=e);rh=e=n}while(null!==e);fh=6,rh=null}function op(e,t,n,i,a,o,s,r,l){e.cancelPendingCommit=null;do{up()}while(0!==Th);if(6&oh)throw Error(un(327));if(null!==t){if(t===e.current)throw Error(un(177));if(o=t.lanes|t.childLanes,function(e,t,n,i,a,o){var s=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var r=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=s&~n;0<n;){var u=31-vi(n),d=1<<u;r[u]=0,l[u]=-1;var h=c[u];if(null!==h)for(c[u]=null,u=0;u<h.length;u++){var p=h[u];null!==p&&(p.lane&=-536870913)}n&=~d}0!==i&&Ni(e,i,0),0!==o&&0===a&&0!==e.tag&&(e.suspendedLanes|=o&~(s&~t))}(e,n,o|=Ps,s,r,l),e===sh&&(rh=sh=null,lh=0),Nh=t,jh=e,Ph=n,Mh=o,Ah=a,Rh=i,10256&t.subtreeFlags||10256&t.flags?(e.callbackNode=null,e.callbackPriority=0,ti(ci,function(){return dp(),null})):(e.callbackNode=null,e.callbackPriority=0),i=!!(13878&t.flags),13878&t.subtreeFlags||i){i=Fn.T,Fn.T=null,a=Un.p,Un.p=2,s=oh,oh|=4;try{!function(e,t){if(e=e.containerInfo,am=sf,os(e=as(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var a=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch(f){n=null;break e}var s=0,r=-1,l=-1,c=0,u=0,d=e,h=null;t:for(;;){for(var p;d!==n||0!==a&&3!==d.nodeType||(r=s+a),d!==o||0!==i&&3!==d.nodeType||(l=s+i),3===d.nodeType&&(s+=d.nodeValue.length),null!==(p=d.firstChild);)h=d,d=p;for(;;){if(d===e)break t;if(h===n&&++c===a&&(r=s),h===o&&++u===i&&(l=s),null!==(p=d.nextSibling))break;h=(d=h).parentNode}d=p}n=-1===r||-1===l?null:{start:r,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(om={focusedElem:e,selectionRange:n},sf=!1,kd=t;null!==kd;)if(e=(t=kd).child,1024&t.subtreeFlags&&null!==e)e.return=t,kd=e;else for(;null!==kd;){switch(o=(t=kd).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(1024&e&&null!==o){e=void 0,n=t,a=o.memoizedProps,o=o.memoizedState,i=n.stateNode;try{var m=bu(n.type,a,(n.elementType,n.type));e=i.getSnapshotBeforeUpdate(m,o),i.__reactInternalSnapshotBeforeUpdate=e}catch(g){pp(n,n.return,g)}}break;case 3:if(1024&e)if(9===(n=(e=t.stateNode.containerInfo).nodeType))ym(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":ym(e);break;default:e.textContent=""}break;default:if(1024&e)throw Error(un(163))}if(null!==(e=t.sibling)){e.return=t.return,kd=e;break}kd=t.return}}(e,t)}finally{oh=s,Un.p=a,Fn.T=i}}Th=1,sp(),rp(),lp()}}function sp(){if(1===Th){Th=0;var e=jh,t=Nh,n=!!(13878&t.flags);if(13878&t.subtreeFlags||n){n=Fn.T,Fn.T=null;var i=Un.p;Un.p=2;var a=oh;oh|=4;try{Ld(t,e);var o=om,s=as(e.containerInfo),r=o.focusedElem,l=o.selectionRange;if(s!==r&&r&&r.ownerDocument&&is(r.ownerDocument.documentElement,r)){if(null!==l&&os(r)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in r)r.selectionStart=c,r.selectionEnd=Math.min(u,r.value.length);else{var d=r.ownerDocument||document,h=d&&d.defaultView||window;if(h.getSelection){var p=h.getSelection(),m=r.textContent.length,f=Math.min(l.start,m),g=void 0===l.end?f:Math.min(l.end,m);!p.extend&&f>g&&(s=g,g=f,f=s);var v=ns(r,f),y=ns(r,g);if(v&&y&&(1!==p.rangeCount||p.anchorNode!==v.node||p.anchorOffset!==v.offset||p.focusNode!==y.node||p.focusOffset!==y.offset)){var b=d.createRange();b.setStart(v.node,v.offset),p.removeAllRanges(),f>g?(p.addRange(b),p.extend(y.node,y.offset)):(b.setEnd(y.node,y.offset),p.addRange(b))}}}}for(d=[],p=r;p=p.parentNode;)1===p.nodeType&&d.push({element:p,left:p.scrollLeft,top:p.scrollTop});for("function"==typeof r.focus&&r.focus(),r=0;r<d.length;r++){var x=d[r];x.element.scrollLeft=x.left,x.element.scrollTop=x.top}}sf=!!am,om=am=null}finally{oh=a,Un.p=i,Fn.T=n}}e.current=t,Th=2}}function rp(){if(2===Th){Th=0;var e=jh,t=Nh,n=!!(8772&t.flags);if(8772&t.subtreeFlags||n){n=Fn.T,Fn.T=null;var i=Un.p;Un.p=2;var a=oh;oh|=4;try{Id(e,t.alternate,t)}finally{oh=a,Un.p=i,Fn.T=n}}Th=3}}function lp(){if(4===Th||3===Th){Th=0,ai();var e=jh,t=Nh,n=Ph,i=Rh;10256&t.subtreeFlags||10256&t.flags?Th=5:(Th=0,Nh=jh=null,cp(e,e.pendingLanes));var a=e.pendingLanes;if(0===a&&(Ih=null),Ai(n),t=t.stateNode,fi&&"function"==typeof fi.onCommitFiberRoot)try{fi.onCommitFiberRoot(mi,t,void 0,!(128&~t.current.flags))}catch(l){}if(null!==i){t=Fn.T,a=Un.p,Un.p=2,Fn.T=null;try{for(var o=e.onRecoverableError,s=0;s<i.length;s++){var r=i[s];o(r.value,{componentStack:r.stack})}}finally{Fn.T=t,Un.p=a}}3&Ph&&up(),Ep(e),a=e.pendingLanes,4194090&n&&42&a?e===Dh?Oh++:(Oh=0,Dh=e):Oh=0,kp(0)}}function cp(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Fr(t)))}function up(e){return sp(),rp(),lp(),dp()}function dp(){if(5!==Th)return!1;var e=jh,t=Mh;Mh=0;var n=Ai(Ph),i=Fn.T,a=Un.p;try{Un.p=32>n?32:n,Fn.T=null,n=Ah,Ah=null;var o=jh,s=Ph;if(Th=0,Nh=jh=null,Ph=0,6&oh)throw Error(un(331));var r=oh;if(oh|=4,eh(o.current),Vd(o,o.current,s,n),oh=r,kp(0,!1),fi&&"function"==typeof fi.onPostCommitFiberRoot)try{fi.onPostCommitFiberRoot(mi,o)}catch(l){}return!0}finally{Un.p=a,Fn.T=i,cp(e,t)}}function hp(e,t,n){t=Ts(n,t),null!==(e=cl(e,t=ku(e.stateNode,t,2),2))&&(ji(e,2),Ep(e))}function pp(e,t,n){if(3===e.tag)hp(e,e,n);else for(;null!==t;){if(3===t.tag){hp(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof i.componentDidCatch&&(null===Ih||!Ih.has(i))){e=Ts(n,e),null!==(i=cl(t,n=Iu(2),2))&&(Tu(n,i,t,e),ji(i,2),Ep(i));break}}t=t.return}}function mp(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new ah;var a=new Set;i.set(t,a)}else void 0===(a=i.get(t))&&(a=new Set,i.set(t,a));a.has(n)||(ph=!0,a.add(n),e=fp.bind(null,e,t,n),t.then(e,e))}function fp(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,sh===e&&(lh&n)===n&&(4===fh||3===fh&&(62914560&lh)===lh&&300>oi()-Ch?!(2&oh)&&Vh(e,0):yh|=n,xh===lh&&(xh=0)),Ep(e)}function gp(e,t){0===t&&(t=Ii()),null!==(e=Os(e,t))&&(ji(e,t),Ep(e))}function vp(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),gp(e,n)}function yp(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(un(314))}null!==i&&i.delete(t),gp(e,n)}var bp=null,xp=null,wp=!1,Sp=!1,_p=!1,Cp=0;function Ep(e){e!==xp&&null===e.next&&(null===xp?bp=xp=e:xp=xp.next=e),Sp=!0,wp||(wp=!0,mm(function(){6&oh?ti(ri,Ip):Tp()}))}function kp(e,t){if(!_p&&Sp){_p=!0;do{for(var n=!1,i=bp;null!==i;){if(0!==e){var a=i.pendingLanes;if(0===a)var o=0;else{var s=i.suspendedLanes,r=i.pingedLanes;o=(1<<31-vi(42|e)+1)-1,o=201326741&(o&=a&~(s&~r))?201326741&o|1:o?2|o:0}0!==o&&(n=!0,Pp(i,o))}else o=lh,!(3&(o=_i(i,i===sh?o:0,null!==i.cancelPendingCommit||-1!==i.timeoutHandle)))||Ci(i,o)||(n=!0,Pp(i,o));i=i.next}}while(n);_p=!1}}function Ip(){Tp()}function Tp(){Sp=wp=!1;var e=0;0!==Cp&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==um&&(um=e,!0);return um=null,!1}()&&(e=Cp),Cp=0);for(var t=oi(),n=null,i=bp;null!==i;){var a=i.next,o=jp(i,t);0===o?(i.next=null,null===n?bp=a:n.next=a,null===a&&(xp=n)):(n=i,(0!==e||3&o)&&(Sp=!0)),i=a}kp(e)}function jp(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,a=e.expirationTimes,o=-62914561&e.pendingLanes;0<o;){var s=31-vi(o),r=1<<s,l=a[s];-1===l?0!==(r&n)&&0===(r&i)||(a[s]=Ei(r,t)):l<=t&&(e.expiredLanes|=r),o&=~r}if(n=lh,n=_i(e,e===(t=sh)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),i=e.callbackNode,0===n||e===t&&(2===ch||9===ch)||null!==e.cancelPendingCommit)return null!==i&&null!==i&&ni(i),e.callbackNode=null,e.callbackPriority=0;if(!(3&n)||Ci(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==i&&ni(i),Ai(n)){case 2:case 8:n=li;break;case 32:default:n=ci;break;case 268435456:n=di}return i=Np.bind(null,e),n=ti(n,i),e.callbackPriority=t,e.callbackNode=n,t}return null!==i&&null!==i&&ni(i),e.callbackPriority=2,e.callbackNode=null,2}function Np(e,t){if(0!==Th&&5!==Th)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(up()&&e.callbackNode!==n)return null;var i=lh;return 0===(i=_i(e,e===sh?i:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(zh(e,i,t),jp(e,oi()),null!=e.callbackNode&&e.callbackNode===n?Np.bind(null,e):null)}function Pp(e,t){if(up())return null;zh(e,t,!0)}function Mp(){return 0===Cp&&(Cp=ki()),Cp}function Ap(e){return null==e||"symbol"==typeof e||"boolean"==typeof e?null:"function"==typeof e?e:Aa(""+e)}function Rp(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Op=0;Op<Es.length;Op++){var Dp=Es[Op];ks(Dp.toLowerCase(),"on"+(Dp[0].toUpperCase()+Dp.slice(1)))}ks(vs,"onAnimationEnd"),ks(ys,"onAnimationIteration"),ks(bs,"onAnimationStart"),ks("dblclick","onDoubleClick"),ks("focusin","onFocus"),ks("focusout","onBlur"),ks(xs,"onTransitionRun"),ks(ws,"onTransitionStart"),ks(Ss,"onTransitionCancel"),ks(_s,"onTransitionEnd"),Zi("onMouseEnter",["mouseout","mouseover"]),Zi("onMouseLeave",["mouseout","mouseover"]),Zi("onPointerEnter",["pointerout","pointerover"]),Zi("onPointerLeave",["pointerout","pointerover"]),Ji("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ji("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ji("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ji("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ji("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ji("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fp=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Lp));function Up(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var i=e[n],a=i.event;i=i.listeners;e:{var o=void 0;if(t)for(var s=i.length-1;0<=s;s--){var r=i[s],l=r.instance,c=r.currentTarget;if(r=r.listener,l!==o&&a.isPropagationStopped())break e;o=r,a.currentTarget=c;try{o(a)}catch(u){xu(u)}a.currentTarget=null,o=l}else for(s=0;s<i.length;s++){if(l=(r=i[s]).instance,c=r.currentTarget,r=r.listener,l!==o&&a.isPropagationStopped())break e;o=r,a.currentTarget=c;try{o(a)}catch(u){xu(u)}a.currentTarget=null,o=l}}}}function zp(e,t){var n=t[Ui];void 0===n&&(n=t[Ui]=new Set);var i=e+"__bubble";n.has(i)||(qp(t,e,2,!1),n.add(i))}function Hp(e,t,n){var i=0;t&&(i|=4),qp(n,e,i,t)}var $p="_reactListening"+Math.random().toString(36).slice(2);function Bp(e){if(!e[$p]){e[$p]=!0,Yi.forEach(function(t){"selectionchange"!==t&&(Fp.has(t)||Hp(t,!1,e),Hp(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[$p]||(t[$p]=!0,Hp("selectionchange",!1,t))}}function qp(e,t,n,i){switch(pf(t)){case 2:var a=rf;break;case 8:a=lf;break;default:a=cf}n=a.bind(null,t,n,e),a=void 0,!Ba||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),i?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Gp(e,t,n,i,a){var o=i;if(!(1&t||2&t||null===i))e:for(;;){if(null===i)return;var s=i.tag;if(3===s||4===s){var r=i.stateNode.containerInfo;if(r===a)break;if(4===s)for(s=i.return;null!==s;){var l=s.tag;if((3===l||4===l)&&s.stateNode.containerInfo===a)return;s=s.return}for(;null!==r;){if(null===(s=Gi(r)))return;if(5===(l=s.tag)||6===l||26===l||27===l){i=o=s;continue e}r=r.parentNode}}i=i.return}za(function(){var i=o,a=Oa(n),s=[];e:{var r=Cs.get(e);if(void 0!==r){var l=io,c=e;switch(e){case"keypress":if(0===Ka(n))break e;case"keydown":case"keyup":l=bo;break;case"focusin":c="focus",l=co;break;case"focusout":c="blur",l=co;break;case"beforeblur":case"afterblur":l=co;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=ro;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=lo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=wo;break;case vs:case ys:case bs:l=uo;break;case _s:l=So;break;case"scroll":case"scrollend":l=oo;break;case"wheel":l=_o;break;case"copy":case"cut":case"paste":l=ho;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=xo;break;case"toggle":case"beforetoggle":l=Co}var u=!!(4&t),d=!u&&("scroll"===e||"scrollend"===e),h=u?null!==r?r+"Capture":null:r;u=[];for(var p,m=i;null!==m;){var f=m;if(p=f.stateNode,5!==(f=f.tag)&&26!==f&&27!==f||null===p||null===h||null!=(f=Ha(m,h))&&u.push(Vp(m,f,p)),d)break;m=m.return}0<u.length&&(r=new l(r,c,null,n,a),s.push({event:r,listeners:u}))}}if(!(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(r="mouseover"===e||"pointerover"===e)||n===Ra||!(c=n.relatedTarget||n.fromElement)||!Gi(c)&&!c[Fi])&&(l||r)&&(r=a.window===a?a:(r=a.ownerDocument)?r.defaultView||r.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?Gi(c):null)&&(d=hn(c),u=c.tag,c!==d||5!==u&&27!==u&&6!==u)&&(c=null)):(l=null,c=i),l!==c)){if(u=ro,f="onMouseLeave",h="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(u=xo,f="onPointerLeave",h="onPointerEnter",m="pointer"),d=null==l?r:Wi(l),p=null==c?r:Wi(c),(r=new u(f,m+"leave",l,n,a)).target=d,r.relatedTarget=p,f=null,Gi(a)===i&&((u=new u(h,m+"enter",c,n,a)).target=p,u.relatedTarget=d,f=u),d=f,l&&c)e:{for(h=c,m=0,p=u=l;p;p=Qp(p))m++;for(p=0,f=h;f;f=Qp(f))p++;for(;0<m-p;)u=Qp(u),m--;for(;0<p-m;)h=Qp(h),p--;for(;m--;){if(u===h||null!==h&&u===h.alternate)break e;u=Qp(u),h=Qp(h)}u=null}else u=null;null!==l&&Kp(s,r,l,u,!1),null!==c&&null!==d&&Kp(s,d,c,u,!0)}if("select"===(l=(r=i?Wi(i):window).nodeName&&r.nodeName.toLowerCase())||"input"===l&&"file"===r.type)var g=$o;else if(Do(r))if(Bo)g=Jo;else{g=Yo;var v=Ko}else!(l=r.nodeName)||"input"!==l.toLowerCase()||"checkbox"!==r.type&&"radio"!==r.type?i&&Na(i.elementType)&&(g=$o):g=Xo;switch(g&&(g=g(e,i))?Lo(s,g,n,a):(v&&v(e,r,i),"focusout"===e&&i&&"number"===r.type&&null!=i.memoizedProps.value&&Sa(r,"number",r.value)),v=i?Wi(i):window,e){case"focusin":(Do(v)||"true"===v.contentEditable)&&(rs=v,ls=i,cs=null);break;case"focusout":cs=ls=rs=null;break;case"mousedown":us=!0;break;case"contextmenu":case"mouseup":case"dragend":us=!1,ds(s,n,a);break;case"selectionchange":if(ss)break;case"keydown":case"keyup":ds(s,n,a)}var y;if(ko)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Ro?Mo(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(jo&&"ko"!==n.locale&&(Ro||"onCompositionStart"!==b?"onCompositionEnd"===b&&Ro&&(y=Qa()):(Va="value"in(Ga=a)?Ga.value:Ga.textContent,Ro=!0)),0<(v=Wp(i,b)).length&&(b=new po(b,e,null,n,a),s.push({event:b,listeners:v}),y?b.data=y:null!==(y=Ao(n))&&(b.data=y))),(y=To?function(e,t){switch(e){case"compositionend":return Ao(t);case"keypress":return 32!==t.which?null:(Po=!0,No);case"textInput":return(e=t.data)===No&&Po?null:e;default:return null}}(e,n):function(e,t){if(Ro)return"compositionend"===e||!ko&&Mo(e,t)?(e=Qa(),Wa=Va=Ga=null,Ro=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return jo&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(b=Wp(i,"onBeforeInput")).length&&(v=new po("onBeforeInput","beforeinput",null,n,a),s.push({event:v,listeners:b}),v.data=y)),function(e,t,n,i,a){if("submit"===t&&n&&n.stateNode===a){var o=Ap((a[Li]||null).action),s=i.submitter;s&&null!==(t=(t=s[Li]||null)?Ap(t.formAction):s.getAttribute("formAction"))&&(o=t,s=null);var r=new io("action","action",null,i,a);e.push({event:r,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(0!==Cp){var e=s?Rp(a,s):new FormData(a);Rc(n,{pending:!0,data:e,method:a.method,action:o},null,e)}}else"function"==typeof o&&(r.preventDefault(),e=s?Rp(a,s):new FormData(a),Rc(n,{pending:!0,data:e,method:a.method,action:o},o,e))},currentTarget:a}]})}}(s,e,i,n,a)}Up(s,t)})}function Vp(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wp(e,t){for(var n=t+"Capture",i=[];null!==e;){var a=e,o=a.stateNode;if(5!==(a=a.tag)&&26!==a&&27!==a||null===o||(null!=(a=Ha(e,n))&&i.unshift(Vp(e,a,o)),null!=(a=Ha(e,t))&&i.push(Vp(e,a,o))),3===e.tag)return i;e=e.return}return[]}function Qp(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Kp(e,t,n,i,a){for(var o=t._reactName,s=[];null!==n&&n!==i;){var r=n,l=r.alternate,c=r.stateNode;if(r=r.tag,null!==l&&l===i)break;5!==r&&26!==r&&27!==r||null===c||(l=c,a?null!=(c=Ha(n,o))&&s.unshift(Vp(n,c,l)):a||null!=(c=Ha(n,o))&&s.push(Vp(n,c,l))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Yp=/\r\n?/g,Xp=/\u0000|\uFFFD/g;function Jp(e){return("string"==typeof e?e:""+e).replace(Yp,"\n").replace(Xp,"")}function Zp(e,t){return t=Jp(t),Jp(e)===t}function em(){}function tm(e,t,n,i,a,o){switch(n){case"children":"string"==typeof i?"body"===t||"textarea"===t&&""===i||ka(e,i):("number"==typeof i||"bigint"==typeof i)&&"body"!==t&&ka(e,""+i);break;case"className":sa(e,"class",i);break;case"tabIndex":sa(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":sa(e,n,i);break;case"style":ja(e,i,o);break;case"data":if("object"!==t){sa(e,"data",i);break}case"src":case"href":if(""===i&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==i||"function"==typeof i||"symbol"==typeof i||"boolean"==typeof i){e.removeAttribute(n);break}i=Aa(""+i),e.setAttribute(n,i);break;case"action":case"formAction":if("function"==typeof i){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"==typeof o&&("formAction"===n?("input"!==t&&tm(e,t,"name",a.name,a,null),tm(e,t,"formEncType",a.formEncType,a,null),tm(e,t,"formMethod",a.formMethod,a,null),tm(e,t,"formTarget",a.formTarget,a,null)):(tm(e,t,"encType",a.encType,a,null),tm(e,t,"method",a.method,a,null),tm(e,t,"target",a.target,a,null))),null==i||"symbol"==typeof i||"boolean"==typeof i){e.removeAttribute(n);break}i=Aa(""+i),e.setAttribute(n,i);break;case"onClick":null!=i&&(e.onclick=em);break;case"onScroll":null!=i&&zp("scroll",e);break;case"onScrollEnd":null!=i&&zp("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=i){if("object"!=typeof i||!("__html"in i))throw Error(un(61));if(null!=(n=i.__html)){if(null!=a.children)throw Error(un(60));e.innerHTML=n}}break;case"multiple":e.multiple=i&&"function"!=typeof i&&"symbol"!=typeof i;break;case"muted":e.muted=i&&"function"!=typeof i&&"symbol"!=typeof i;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==i||"function"==typeof i||"boolean"==typeof i||"symbol"==typeof i){e.removeAttribute("xlink:href");break}n=Aa(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=i&&"function"!=typeof i&&"symbol"!=typeof i?e.setAttribute(n,""+i):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&"function"!=typeof i&&"symbol"!=typeof i?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===i?e.setAttribute(n,""):!1!==i&&null!=i&&"function"!=typeof i&&"symbol"!=typeof i?e.setAttribute(n,i):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=i&&"function"!=typeof i&&"symbol"!=typeof i&&!isNaN(i)&&1<=i?e.setAttribute(n,i):e.removeAttribute(n);break;case"rowSpan":case"start":null==i||"function"==typeof i||"symbol"==typeof i||isNaN(i)?e.removeAttribute(n):e.setAttribute(n,i);break;case"popover":zp("beforetoggle",e),zp("toggle",e),oa(e,"popover",i);break;case"xlinkActuate":ra(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":ra(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":ra(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":ra(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":ra(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":ra(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":ra(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":ra(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":ra(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":oa(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&oa(e,n=Pa.get(n)||n,i)}}function nm(e,t,n,i,a,o){switch(n){case"style":ja(e,i,o);break;case"dangerouslySetInnerHTML":if(null!=i){if("object"!=typeof i||!("__html"in i))throw Error(un(61));if(null!=(n=i.__html)){if(null!=a.children)throw Error(un(60));e.innerHTML=n}}break;case"children":"string"==typeof i?ka(e,i):("number"==typeof i||"bigint"==typeof i)&&ka(e,""+i);break;case"onScroll":null!=i&&zp("scroll",e);break;case"onScrollEnd":null!=i&&zp("scrollend",e);break;case"onClick":null!=i&&(e.onclick=em);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Xi.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(a=n.endsWith("Capture"),t=n.slice(2,a?n.length-7:void 0),"function"==typeof(o=null!=(o=e[Li]||null)?o[n]:null)&&e.removeEventListener(t,o,a),"function"!=typeof i)?n in e?e[n]=i:!0===i?e.setAttribute(n,""):oa(e,n,i):("function"!=typeof o&&null!==o&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,i,a)))}}function im(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":zp("error",e),zp("load",e);var i,a=!1,o=!1;for(i in n)if(n.hasOwnProperty(i)){var s=n[i];if(null!=s)switch(i){case"src":a=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(un(137,t));default:tm(e,t,i,s,n,null)}}return o&&tm(e,t,"srcSet",n.srcSet,n,null),void(a&&tm(e,t,"src",n.src,n,null));case"input":zp("invalid",e);var r=i=s=o=null,l=null,c=null;for(a in n)if(n.hasOwnProperty(a)){var u=n[a];if(null!=u)switch(a){case"name":o=u;break;case"type":s=u;break;case"checked":l=u;break;case"defaultChecked":c=u;break;case"value":i=u;break;case"defaultValue":r=u;break;case"children":case"dangerouslySetInnerHTML":if(null!=u)throw Error(un(137,t));break;default:tm(e,t,a,u,n,null)}}return wa(e,i,r,l,c,s,o,!1),void fa(e);case"select":for(o in zp("invalid",e),a=s=i=null,n)if(n.hasOwnProperty(o)&&null!=(r=n[o]))switch(o){case"value":i=r;break;case"defaultValue":s=r;break;case"multiple":a=r;default:tm(e,t,o,r,n,null)}return t=i,n=s,e.multiple=!!a,void(null!=t?_a(e,!!a,t,!1):null!=n&&_a(e,!!a,n,!0));case"textarea":for(s in zp("invalid",e),i=o=a=null,n)if(n.hasOwnProperty(s)&&null!=(r=n[s]))switch(s){case"value":a=r;break;case"defaultValue":o=r;break;case"children":i=r;break;case"dangerouslySetInnerHTML":if(null!=r)throw Error(un(91));break;default:tm(e,t,s,r,n,null)}return Ea(e,a,o,i),void fa(e);case"option":for(l in n)if(n.hasOwnProperty(l)&&null!=(a=n[l]))if("selected"===l)e.selected=a&&"function"!=typeof a&&"symbol"!=typeof a;else tm(e,t,l,a,n,null);return;case"dialog":zp("beforetoggle",e),zp("toggle",e),zp("cancel",e),zp("close",e);break;case"iframe":case"object":zp("load",e);break;case"video":case"audio":for(a=0;a<Lp.length;a++)zp(Lp[a],e);break;case"image":zp("error",e),zp("load",e);break;case"details":zp("toggle",e);break;case"embed":case"source":case"link":zp("error",e),zp("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(c in n)if(n.hasOwnProperty(c)&&null!=(a=n[c]))switch(c){case"children":case"dangerouslySetInnerHTML":throw Error(un(137,t));default:tm(e,t,c,a,n,null)}return;default:if(Na(t)){for(u in n)n.hasOwnProperty(u)&&(void 0!==(a=n[u])&&nm(e,t,u,a,n,void 0));return}}for(r in n)n.hasOwnProperty(r)&&(null!=(a=n[r])&&tm(e,t,r,a,n,null))}var am=null,om=null;function sm(e){return 9===e.nodeType?e:e.ownerDocument}function rm(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function lm(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function cm(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"bigint"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var um=null;var dm="function"==typeof setTimeout?setTimeout:void 0,hm="function"==typeof clearTimeout?clearTimeout:void 0,pm="function"==typeof Promise?Promise:void 0,mm="function"==typeof queueMicrotask?queueMicrotask:void 0!==pm?function(e){return pm.resolve(null).then(e).catch(fm)}:dm;function fm(e){setTimeout(function(){throw e})}function gm(e){return"head"===e}function vm(e,t){var n=t,i=0,a=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&8===o.nodeType)if("/$"===(n=o.data)){if(0<i&&8>i){n=i;var s=e.ownerDocument;if(1&n&&Cm(s.documentElement),2&n&&Cm(s.body),4&n)for(Cm(n=s.head),s=n.firstChild;s;){var r=s.nextSibling,l=s.nodeName;s[Bi]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===s.rel.toLowerCase()||n.removeChild(s),s=r}}if(0===a)return e.removeChild(o),void Pf(t);a--}else"$"===n||"$?"===n||"$!"===n?a++:i=n.charCodeAt(0)-48;else i=0;n=o}while(n);Pf(t)}function ym(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":ym(n),qi(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function bm(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function xm(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var wm=null;function Sm(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function _m(e,t,n){switch(t=sm(n),e){case"html":if(!(e=t.documentElement))throw Error(un(452));return e;case"head":if(!(e=t.head))throw Error(un(453));return e;case"body":if(!(e=t.body))throw Error(un(454));return e;default:throw Error(un(451))}}function Cm(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);qi(e)}var Em=new Map,km=new Set;function Im(e){return"function"==typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Tm=Un.d;Un.d={f:function(){var e=Tm.f(),t=qh();return e||t},r:function(e){var t=Vi(e);null!==t&&5===t.tag&&"form"===t.type?Dc(t):Tm.r(e)},D:function(e){Tm.D(e),Nm("dns-prefetch",e,null)},C:function(e,t){Tm.C(e,t),Nm("preconnect",e,t)},L:function(e,t,n){Tm.L(e,t,n);var i=jm;if(i&&e&&t){var a='link[rel="preload"][as="'+ba(t)+'"]';"image"===t&&n&&n.imageSrcSet?(a+='[imagesrcset="'+ba(n.imageSrcSet)+'"]',"string"==typeof n.imageSizes&&(a+='[imagesizes="'+ba(n.imageSizes)+'"]')):a+='[href="'+ba(e)+'"]';var o=a;switch(t){case"style":o=Mm(e);break;case"script":o=Om(e)}Em.has(o)||(e=gn({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Em.set(o,e),null!==i.querySelector(a)||"style"===t&&i.querySelector(Am(o))||"script"===t&&i.querySelector(Dm(o))||(im(t=i.createElement("link"),"link",e),Ki(t),i.head.appendChild(t)))}},m:function(e,t){Tm.m(e,t);var n=jm;if(n&&e){var i=t&&"string"==typeof t.as?t.as:"script",a='link[rel="modulepreload"][as="'+ba(i)+'"][href="'+ba(e)+'"]',o=a;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":o=Om(e)}if(!Em.has(o)&&(e=gn({rel:"modulepreload",href:e},t),Em.set(o,e),null===n.querySelector(a))){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Dm(o)))return}im(i=n.createElement("link"),"link",e),Ki(i),n.head.appendChild(i)}}},X:function(e,t){Tm.X(e,t);var n=jm;if(n&&e){var i=Qi(n).hoistableScripts,a=Om(e),o=i.get(a);o||((o=n.querySelector(Dm(a)))||(e=gn({src:e,async:!0},t),(t=Em.get(a))&&zm(e,t),Ki(o=n.createElement("script")),im(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},i.set(a,o))}},S:function(e,t,n){Tm.S(e,t,n);var i=jm;if(i&&e){var a=Qi(i).hoistableStyles,o=Mm(e);t=t||"default";var s=a.get(o);if(!s){var r={loading:0,preload:null};if(s=i.querySelector(Am(o)))r.loading=5;else{e=gn({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Em.get(o))&&Um(e,n);var l=s=i.createElement("link");Ki(l),im(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){r.loading|=1}),l.addEventListener("error",function(){r.loading|=2}),r.loading|=4,Fm(s,t,i)}s={type:"stylesheet",instance:s,count:1,state:r},a.set(o,s)}}},M:function(e,t){Tm.M(e,t);var n=jm;if(n&&e){var i=Qi(n).hoistableScripts,a=Om(e),o=i.get(a);o||((o=n.querySelector(Dm(a)))||(e=gn({src:e,async:!0,type:"module"},t),(t=Em.get(a))&&zm(e,t),Ki(o=n.createElement("script")),im(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},i.set(a,o))}}};var jm="undefined"==typeof document?null:document;function Nm(e,t,n){var i=jm;if(i&&"string"==typeof t&&t){var a=ba(t);a='link[rel="'+e+'"][href="'+a+'"]',"string"==typeof n&&(a+='[crossorigin="'+n+'"]'),km.has(a)||(km.add(a),e={rel:e,crossOrigin:n,href:t},null===i.querySelector(a)&&(im(t=i.createElement("link"),"link",e),Ki(t),i.head.appendChild(t)))}}function Pm(e,t,n,i){var a,o,s,r,l=(l=Qn.current)?Im(l):null;if(!l)throw Error(un(446));switch(e){case"meta":case"title":return null;case"style":return"string"==typeof n.precedence&&"string"==typeof n.href?(t=Mm(n.href),(i=(n=Qi(l).hoistableStyles).get(t))||(i={type:"style",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"==typeof n.href&&"string"==typeof n.precedence){e=Mm(n.href);var c=Qi(l).hoistableStyles,u=c.get(e);if(u||(l=l.ownerDocument||l,u={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},c.set(e,u),(c=l.querySelector(Am(e)))&&!c._p&&(u.instance=c,u.state.loading=5),Em.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Em.set(e,n),c||(a=l,o=e,s=n,r=u.state,a.querySelector('link[rel="preload"][as="style"]['+o+"]")?r.loading=1:(o=a.createElement("link"),r.preload=o,o.addEventListener("load",function(){return r.loading|=1}),o.addEventListener("error",function(){return r.loading|=2}),im(o,"link",s),Ki(o),a.head.appendChild(o))))),t&&null===i)throw Error(un(528,""));return u}if(t&&null!==i)throw Error(un(529,""));return null;case"script":return t=n.async,"string"==typeof(n=n.src)&&t&&"function"!=typeof t&&"symbol"!=typeof t?(t=Om(n),(i=(n=Qi(l).hoistableScripts).get(t))||(i={type:"script",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(un(444,e))}}function Mm(e){return'href="'+ba(e)+'"'}function Am(e){return'link[rel="stylesheet"]['+e+"]"}function Rm(e){return gn({},e,{"data-precedence":e.precedence,precedence:null})}function Om(e){return'[src="'+ba(e)+'"]'}function Dm(e){return"script[async]"+e}function Lm(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+ba(n.href)+'"]');if(i)return t.instance=i,Ki(i),i;var a=gn({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return Ki(i=(e.ownerDocument||e).createElement("style")),im(i,"style",a),Fm(i,n.precedence,e),t.instance=i;case"stylesheet":a=Mm(n.href);var o=e.querySelector(Am(a));if(o)return t.state.loading|=4,t.instance=o,Ki(o),o;i=Rm(n),(a=Em.get(a))&&Um(i,a),Ki(o=(e.ownerDocument||e).createElement("link"));var s=o;return s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),im(o,"link",i),t.state.loading|=4,Fm(o,n.precedence,e),t.instance=o;case"script":return o=Om(n.src),(a=e.querySelector(Dm(o)))?(t.instance=a,Ki(a),a):(i=n,(a=Em.get(o))&&zm(i=gn({},n),a),Ki(a=(e=e.ownerDocument||e).createElement("script")),im(a,"link",i),e.head.appendChild(a),t.instance=a);case"void":return null;default:throw Error(un(443,t.type))}else"stylesheet"===t.type&&!(4&t.state.loading)&&(i=t.instance,t.state.loading|=4,Fm(i,n.precedence,e));return t.instance}function Fm(e,t,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),a=i.length?i[i.length-1]:null,o=a,s=0;s<i.length;s++){var r=i[s];if(r.dataset.precedence===t)o=r;else if(o!==a)break}o?o.parentNode.insertBefore(e,o.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Um(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function zm(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Hm=null;function $m(e,t,n){if(null===Hm){var i=new Map,a=Hm=new Map;a.set(n,i)}else(i=(a=Hm).get(n))||(i=new Map,a.set(n,i));if(i.has(e))return i;for(i.set(e,null),n=n.getElementsByTagName(e),a=0;a<n.length;a++){var o=n[a];if(!(o[Bi]||o[Di]||"link"===e&&"stylesheet"===o.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==o.namespaceURI){var s=o.getAttribute(t)||"";s=e+s;var r=i.get(s);r?r.push(o):i.set(s,[o])}}return i}function Bm(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function qm(e){return!!("stylesheet"!==e.type||3&e.state.loading)}var Gm=null;function Vm(){}function Wm(){if(this.count--,0===this.count)if(this.stylesheets)Km(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Qm=null;function Km(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Qm=new Map,t.forEach(Ym,e),Qm=null,Wm.call(e))}function Ym(e,t){if(!(4&t.state.loading)){var n=Qm.get(e);if(n)var i=n.get(null);else{n=new Map,Qm.set(e,n);for(var a=e.querySelectorAll("link[data-precedence],style[data-precedence]"),o=0;o<a.length;o++){var s=a[o];"LINK"!==s.nodeName&&"not all"===s.getAttribute("media")||(n.set(s.dataset.precedence,s),i=s)}i&&n.set(null,i)}s=(a=t.instance).getAttribute("data-precedence"),(o=n.get(s)||i)===i&&n.set(null,a),n.set(s,a),this.count++,i=Wm.bind(this),a.addEventListener("load",i),a.addEventListener("error",i),o?o.parentNode.insertBefore(a,o.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(a,e.firstChild),t.state.loading|=4}}var Xm={$$typeof:En,Provider:null,Consumer:null,_currentValue:zn,_currentValue2:zn,_threadCount:0};function Jm(e,t,n,i,a,o,s,r){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ti(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ti(0),this.hiddenUpdates=Ti(null),this.identifierPrefix=i,this.onUncaughtError=a,this.onCaughtError=o,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=r,this.incompleteTransitions=new Map}function Zm(e,t,n,i,a,o,s,r,l,c,u,d){return e=new Jm(e,t,n,s,r,l,c,d),t=1,!0===o&&(t|=24),o=zs(3,null,null,t),e.current=o,o.stateNode=e,(t=Lr()).refCount++,e.pooledCache=t,t.refCount++,o.memoizedState={element:i,isDehydrated:n,cache:t},sl(o),e}function ef(e){return e?e=Fs:Fs}function tf(e,t,n,i,a,o){a=ef(a),null===i.context?i.context=a:i.pendingContext=a,(i=ll(t)).payload={element:n},null!==(o=void 0===o?null:o)&&(i.callback=o),null!==(n=cl(e,i,t))&&(Uh(n,0,t),ul(n,e,t))}function nf(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function af(e,t){nf(e,t),(e=e.alternate)&&nf(e,t)}function of(e){if(13===e.tag){var t=Os(e,67108864);null!==t&&Uh(t,0,67108864),af(e,67108864)}}var sf=!0;function rf(e,t,n,i){var a=Fn.T;Fn.T=null;var o=Un.p;try{Un.p=2,cf(e,t,n,i)}finally{Un.p=o,Fn.T=a}}function lf(e,t,n,i){var a=Fn.T;Fn.T=null;var o=Un.p;try{Un.p=8,cf(e,t,n,i)}finally{Un.p=o,Fn.T=a}}function cf(e,t,n,i){if(sf){var a=uf(i);if(null===a)Gp(e,t,i,df,n),Sf(e,i);else if(function(e,t,n,i,a){switch(t){case"focusin":return ff=_f(ff,e,t,n,i,a),!0;case"dragenter":return gf=_f(gf,e,t,n,i,a),!0;case"mouseover":return vf=_f(vf,e,t,n,i,a),!0;case"pointerover":var o=a.pointerId;return yf.set(o,_f(yf.get(o)||null,e,t,n,i,a)),!0;case"gotpointercapture":return o=a.pointerId,bf.set(o,_f(bf.get(o)||null,e,t,n,i,a)),!0}return!1}(a,e,t,n,i))i.stopPropagation();else if(Sf(e,i),4&t&&-1<wf.indexOf(e)){for(;null!==a;){var o=Vi(a);if(null!==o)switch(o.tag){case 3:if((o=o.stateNode).current.memoizedState.isDehydrated){var s=Si(o.pendingLanes);if(0!==s){var r=o;for(r.pendingLanes|=2,r.entangledLanes|=2;s;){var l=1<<31-vi(s);r.entanglements[1]|=l,s&=~l}Ep(o),!(6&oh)&&(Eh=oi()+500,kp(0))}}break;case 13:null!==(r=Os(o,2))&&Uh(r,0,2),qh(),af(o,2)}if(null===(o=uf(i))&&Gp(e,t,i,df,n),o===a)break;a=o}null!==a&&i.stopPropagation()}else Gp(e,t,i,null,n)}}function uf(e){return hf(e=Oa(e))}var df=null;function hf(e){if(df=null,null!==(e=Gi(e))){var t=hn(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=pn(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return df=e,null}function pf(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(si()){case ri:return 2;case li:return 8;case ci:case ui:return 32;case di:return 268435456;default:return 32}default:return 32}}var mf=!1,ff=null,gf=null,vf=null,yf=new Map,bf=new Map,xf=[],wf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Sf(e,t){switch(e){case"focusin":case"focusout":ff=null;break;case"dragenter":case"dragleave":gf=null;break;case"mouseover":case"mouseout":vf=null;break;case"pointerover":case"pointerout":yf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":bf.delete(t.pointerId)}}function _f(e,t,n,i,a,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:o,targetContainers:[a]},null!==t&&(null!==(t=Vi(t))&&of(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Cf(e){var t=Gi(e.target);if(null!==t){var n=hn(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=pn(n)))return e.blockedOn=t,void function(e,t){var n=Un.p;try{return Un.p=e,t()}finally{Un.p=n}}(e.priority,function(){if(13===n.tag){var e=Lh();e=Mi(e);var t=Os(n,e);null!==t&&Uh(t,0,e),af(n,e)}})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ef(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=uf(e.nativeEvent);if(null!==n)return null!==(t=Vi(n))&&of(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);Ra=i,n.target.dispatchEvent(i),Ra=null,t.shift()}return!0}function kf(e,t,n){Ef(e)&&n.delete(t)}function If(){mf=!1,null!==ff&&Ef(ff)&&(ff=null),null!==gf&&Ef(gf)&&(gf=null),null!==vf&&Ef(vf)&&(vf=null),yf.forEach(kf),bf.forEach(kf)}function Tf(e,t){e.blockedOn===t&&(e.blockedOn=null,mf||(mf=!0,rn.unstable_scheduleCallback(rn.unstable_NormalPriority,If)))}var jf=null;function Nf(e){jf!==e&&(jf=e,rn.unstable_scheduleCallback(rn.unstable_NormalPriority,function(){jf===e&&(jf=null);for(var t=0;t<e.length;t+=3){var n=e[t],i=e[t+1],a=e[t+2];if("function"!=typeof i){if(null===hf(i||n))continue;break}var o=Vi(n);null!==o&&(e.splice(t,3),t-=3,Rc(o,{pending:!0,data:a,method:n.method,action:i},i,a))}}))}function Pf(e){function t(t){return Tf(t,e)}null!==ff&&Tf(ff,e),null!==gf&&Tf(gf,e),null!==vf&&Tf(vf,e),yf.forEach(t),bf.forEach(t);for(var n=0;n<xf.length;n++){var i=xf[n];i.blockedOn===e&&(i.blockedOn=null)}for(;0<xf.length&&null===(n=xf[0]).blockedOn;)Cf(n),null===n.blockedOn&&xf.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(i=0;i<n.length;i+=3){var a=n[i],o=n[i+1],s=a[Li]||null;if("function"==typeof o)s||Nf(n);else if(s){var r=null;if(o&&o.hasAttribute("formAction")){if(a=o,s=o[Li]||null)r=s.formAction;else if(null!==hf(a))continue}else r=s.action;"function"==typeof r?n[i+1]=r:(n.splice(i,3),i-=3),Nf(n)}}}function Mf(e){this._internalRoot=e}function Af(e){this._internalRoot=e}Af.prototype.render=Mf.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(un(409));tf(t.current,Lh(),e,t,null,null)},Af.prototype.unmount=Mf.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;tf(e.current,2,null,e,null,null),qh(),t[Fi]=null}},Af.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ri();e={blockedOn:null,target:e,priority:t};for(var n=0;n<xf.length&&0!==t&&t<xf[n].priority;n++);xf.splice(n,0,e),0===n&&Cf(e)}};var Rf=ln.version;if("19.1.1"!==Rf)throw Error(un(527,Rf,"19.1.1"));Un.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(un(188));throw e=Object.keys(e).join(","),Error(un(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=hn(e)))throw Error(un(188));return t!==e?null:e}for(var n=e,i=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(i=a.return)){n=i;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return mn(a),e;if(o===i)return mn(a),t;o=o.sibling}throw Error(un(188))}if(n.return!==i.return)n=a,i=o;else{for(var s=!1,r=a.child;r;){if(r===n){s=!0,n=a,i=o;break}if(r===i){s=!0,i=a,n=o;break}r=r.sibling}if(!s){for(r=o.child;r;){if(r===n){s=!0,n=o,i=a;break}if(r===i){s=!0,i=o,n=a;break}r=r.sibling}if(!s)throw Error(un(189))}}if(n.alternate!==i)throw Error(un(190))}if(3!==n.tag)throw Error(un(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?fn(e):null)?null:e.stateNode};var Of={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:Fn,reconcilerVersion:"19.1.1"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Df=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Df.isDisabled&&Df.supportsFiber)try{mi=Df.inject(Of),fi=Df}catch(GY){}}an.createRoot=function(e,t){if(!dn(e))throw Error(un(299));var n=!1,i="",a=wu,o=Su,s=_u;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onUncaughtError&&(a=t.onUncaughtError),void 0!==t.onCaughtError&&(o=t.onCaughtError),void 0!==t.onRecoverableError&&(s=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Zm(e,1,!1,null,0,n,i,a,o,s,0,null),e[Fi]=t.current,Bp(e),new Mf(t)},an.hydrateRoot=function(e,t,n){if(!dn(e))throw Error(un(299));var i=!1,a="",o=wu,s=Su,r=_u,l=null;return null!=n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onUncaughtError&&(o=n.onUncaughtError),void 0!==n.onCaughtError&&(s=n.onCaughtError),void 0!==n.onRecoverableError&&(r=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(l=n.formState)),(t=Zm(e,1,!0,t,0,i,a,o,s,r,0,l)).context=ef(null),n=t.current,(a=ll(i=Mi(i=Lh()))).callback=null,cl(n,a,i),n=i,t.current.lanes=n,ji(t,n),Ep(t),e[Fi]=t.current,Bp(e),new Af(t)},an.version="19.1.1",function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(GY){}}(),nn.exports=an;var Lf=nn.exports;let Ff=null;const Uf=()=>(Ff||(Ff=D()),Ff),zf="",Hf="/api/v1",$f="/api/v2",Bf="DPO_qwenlm-intl@service.alibaba.com";var qf=(e=>(e.SIDEBAR_NEW_CHAT_BUTTON="sidebar-new-chat-button",e.CHAT_INPUT="chat-input",e.COPY_CODE_BUTTON="copy-code-button",e.COPY_RESPONSE_BUTTON="copy-response-button",e.SIDEBAR_TOGGLE_BUTTON="sidebar-toggle-button",e.DELETE_CHAT_BUTTON="delete-chat-button",e.SETTING_TOGGLE_BUTTON="setting-toggle-button",e.SHOW_SHORTCUTS_BUTTON="show-shortcuts-button",e))(qf||{});const Gf=760,Vf="manually_close_sidebar";var Wf=(e=>(e.IOS="ios",e.ANDROID="android",e.WEB="web",e.DESKTOP="desktop",e.UNKNOWN="unknown",e))(Wf||{}),Qf=(e=>(e.RECCOMMAND="recommendation",e.CHAT="chat",e.RETRY="retry",e.EDIT="edit",e.ASK="ask",e.EXPLAIN="explain",e.TRANSLATE="translate",e))(Qf||{}),Kf=(e=>(e.SETAPP="setapp",e.DESKTOP="desktop",e))(Kf||{}),Yf=(e=>(e.CODE_INTERPRETER="code_interpreter_http",e.WEB_SEARCH="web_search",e))(Yf||{}),Xf=(e=>(e.TIMEOUT="timeout",e.NETWORK="network",e.VALIDATION="validation",e.UNKNOWN="unknown",e))(Xf||{});class Jf extends Error{constructor(e,t="unknown",n="error",i,a){super(e),k(this,"type"),k(this,"messageId"),k(this,"details"),k(this,"priority"),this.name="ChatError",this.type=t,this.messageId=i,this.details=a,this.priority=n}}var Zf=(e=>(e.DeepResearch="deep_research",e.DeepThinking="deep_thinking",e.Artifacts="artifacts",e.WebSearch="search",e.ImageGeneration="t2i",e.VideoGeneration="t2v",e.Image2Video="i2v",e.Txt2Txt="t2t",e.WebDev="web_dev",e.TRANSLATE="translate",e.Thinking="thinking",e.Mcp="mcp",e.ImageEdit="image_edit",e.DeepResearchWebDev="deep_research_webdev",e.Podcast="aipodcast",e.TRAVEL_FEEDBACK="travel_feedback",e.Travel="travel",e.TRAVEL_RESEARCH="travel_research",e.LEARN="learn",e.INTERRUPT="interrupt",e.Slides="slides",e))(Zf||{}),eg=(e=>(e.OmniAudio="omni_audio",e.OmniVideo="omni_video",e))(eg||{}),tg=(e=>(e.PdfViewer="pdf_viewer",e.DeepResearch="deep_research",e.Artifacts="artifacts",e.Overview="overview",e.Settings="settings",e.Feedback="feedback",e.None="none",e.DeepResearchLinkSource="DeepResearchLinkSource",e.WebDev="web_dev",e.WebSearch="search",e.Thinking="thinking",e.ThinkingAndSearch="thinking_and_search",e.ImageReason="imageReason",e.DeepResearchDetail="deep_research_detail",e.ThinkingAndSources="thinking_and_sources",e.Slides="slides",e))(tg||{}),ng=(e=>(e.THINK="think",e.TOOL="tool",e.ANSWER="answer",e.DEEPTHINKING="DeepThinking",e.RESEARCHPLANNING="ResearchPlanning",e.PdfMdGen="PdfMdGen",e.ReportGeneration="ReportGeneration",e.KEEPALIVE="KeepAlive",e.LOCAL_TOOL="local_tool",e.IMAGE_GEN_THINK="image_gen_think",e.IMAGE_GEN_WEB_SEARCH="image_gen_websearch",e.IMAGE_GEN="image_gen",e.IMAGE_EDIT="image_edit",e.IMAGE_GEN_TOOL="image_gen_tool",e.IMAGE_EDIT_TOOL="image_edit_tool",e.WEB_SEARCH="web_search",e.WEB_SEARCH_IMAGE="web_search_image",e.IMAGE_SEARCH="image_search",e.IMAGE="image",e.IMAGE_ZOOM_IN_TOOL="image_zoom_in_tool",e.CODE_INTERPRETER="code_interpreter",e.THINKING_SUMMARY="thinking_summary",e.WEB_EXTRACTOR="web_extractor",e.HISTORY_RETRIEVER="history_retriever",e.BIO="bio",e.INTERRUPT="interrupt",e.INTERRUPTRECEIVED="InterruptReceived",e.RESEARCHNOTICE="ResearchNotice",e.SLIDES="slides",e.FINISHED="finished",e))(ng||{}),ig=(e=>(e.TYPING="typing",e.FINISHED="finished",e.ERROR="error",e.PAUSE="pause",e))(ig||{}),ag=(e=>(e.text="text",e.url="url",e))(ag||{}),og=(e=>(e.SUCCESS="success",e.FAIL="failed",e.OUT_OF_LIMIT="out_of_limit",e.PARSING="parsing",e))(og||{});const sg=40960,rg={"1:1":"1:1","4:3":"4:3","3:4":"3:4","16:9":"16:9","9:16":"9:16"},lg=!0;var cg=(e=>(e.DeepResearch="deep_research",e.Artifacts="artifacts",e.WebSearch="search",e.ImageGeneration="t2i",e.VideoGeneration="t2v",e.Image2Video="i2v",e.Txt2Txt="t2t",e.Travel="travel",e))(cg||{}),ug=(e=>(e.ReportGeneration="ReportGeneration",e.ResearchPlanning="ResearchPlanning",e.PdfMdGen="PdfMdGen",e))(ug||{});const dg=[{title:"Model issue",content:[{label:"Inconsistent with the facts",value:"Inconsistent with the facts"},{label:"Inconsistent with the instruction",value:"Inconsistent with the instruction"},{label:"Offensive/Unsafe",value:"Offensive/Unsafe"},{label:"Language error",value:"Language error"},{label:"Unreasonable format",value:"Unreasonable format"},{label:"The content is mediocre/boring",value:"The content is mediocre/boring"},{label:"Output lagging",value:"Output lagging"},{label:"Other",value:"Other"}]},{title:"UI issue",content:[{label:"Laggy UI",value:"Laggy UI"},{label:"Poor readability",value:"Poor readability"},{label:"Hard-to-find features",value:"Hard-to-find features"},{label:"Inconsistent interactions",value:"Inconsistent interactions"},{label:"Missing guidance",value:"Missing guidance"}]}],hg="Cherry",pg=[tg.PdfViewer,tg.DeepResearchDetail,tg.DeepResearch],mg=e=>[Zf.DeepResearch,Zf.TRAVEL_RESEARCH].includes(e),fg=e=>["deep_research","travel"].includes(e),gg="chat-messages-scroll-container",vg="NATIVE_NEW_BRANCH",yg=["text/plain"],bg=["image/gif","image/webp","image/jpeg","image/png","image/bmp","image/x-bmp","image/x-ms-bmp","image/icns","image/jp2","image/sgi","image/tiff","image/x-icon"],xg=["video/mp4","video/avi","video/x-ms-wmv","video/x-flv","video/x-matroska","video/quicktime"],wg=["audio/amr","audio/wav","audio/x-wav","audio/aac","audio/mpeg","audio/x-m4a"],Sg=["text/x-java-source","text/x-kotlin","text/x-scala","text/x-groovy","application/javascript","text/javascript","application/typescript","text/jsx","text/tsx","application/javascript","text/x-vue","text/x-python","application/x-ipynb+json","text/html","text/css","text/x-sass","text/x-less","text/x-stylus","image/svg+xml","application/x-shellscript","text/x-powershell","application/x-msdownload","text/x-dockerfile-config","text/x-go","text/x-rust","text/x-swift","application/x-httpd-php","application/x-ruby","text/x-csharp","text/x-vb","text/x-fsharp","application/sql","text/x-lua","text/x-r","text/x-perl","application/x-tcl","text/x-awk","application/x-fish-script","application/xml","application/json","application/x-yaml","application/toml","text/x-groovy","text/x-kotlin","text/x-markdown","text/x-matlab","text/x-julia","text/x-sas","text/x-gdscript","text/x-glsl","text/x-hlsl","text/x-asm","text/x-verilog","text/x-vhdl","application/x-ipynb+json","text/x-quarto","text/markdown","text/x-protobuf","text/x-thrift","application/graphql","application/wasm","application/json","text/x-c","text/x-c++src","text/x-c++hdr","text/x-arduino","text/x-csrc","application/x-tex","text/x-tex","application/x-latex"],_g=["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword","text/csv","text/comma-separated-values","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/markdown","text/plain",...Sg],Cg=["txt","TXT"],Eg=["gif","webp","jpg","jpeg","png","bmp","icns","jp2","sgi","tif","tiff","dib","ico","jfif","j2c","j2k","jpc","jpf","jpx","apng","bw","rgb","rgba"],kg=["mp4","avi","wmv","flv","mkv","mov"],Ig=["amr","wav","aac","mp3","m4a"],Tg=["c","h","cc","cxx","hpp","hh","hxx","ino","java","kt","kts","scala","groovy","js","ts","jsx","tsx","vue","mjs","cjs","py","pyi","ipynb","html","htm","css","scss","sass","less","styl","svg","sh","bash","zsh","ps1","bat","cmd","dockerfile","containerfile","go","rs","swift","php","rb","cs","vb","fs","csproj","sln","sql","lua","r","pl","tcl","awk","fish","xml","json","jsonc","yaml","yml","toml","ini","env","gradle","kts","pom","mk","cmake","lock","rmd","m","jl","sas","asm","s","v","sv","vhd","vhdl","gd","shader","glsl","hlsl","proto","thrift","graphql","gql","wasm","asmdef","qmd","cpp","lock","smali","tex"],jg=["pdf","doc","docx","csv","xlsx","xls","md",...Tg],Ng=1/0,Pg="qwen2.5-omni-7b",Mg=1/0;var Ag=(e=>(e.DEFAULT="default",e.IMAGE="vision",e.VIDEO="video",e.AUDIO="audio",e.DOC="document",e.CAMERA="camera",e))(Ag||{}),Rg=(e=>(e.FILE="file",e.IMAGE="image",e.VIDEO="video",e.AUDIO="audio",e))(Rg||{});const Og={default:{max_count:Ng,max_size:20,accept_extension:Cg,accept_type:yg},document:{max_count:5,max_size:20,accept_extension:jg,accept_type:_g},vision:{max_count:5,max_size:20,accept_extension:Eg,accept_type:bg},video:{max_count:1,max_size:500,accept_extension:kg,accept_type:xg,max_duration:600},audio:{max_count:1,max_size:100,accept_extension:Ig,accept_type:wg,max_duration:180}},Dg=_({"application/epub+zip":{icon:"iconepub1",bg:"#9BC751"},"application/pdf":{icon:"iconpdf1",bg:"#DE5A5E"},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{icon:"iconppt1",bg:"#E4785F"},"text/plain":{icon:"icontxt1",bg:"#61B6ED"},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{icon:"iconexcel1",bg:"#6BBF6D"},others:{icon:"iconothers1",bg:"#A0A3BA"},"text/html":{icon:"iconhtml1",bg:"#F1B94A"},"text/htm":{icon:"iconhtml1",bg:"#F1B94A"},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{icon:"iconword1",bg:"#4B8EF7"},"text/md":{icon:"iconmd1",bg:"#7BC8C3"},"text/markdown":{icon:"iconmd1",bg:"#7BC8C3"},"video/mp4":{icon:"iconvideo1",bg:"#407FFD"},"video/avi":{icon:"iconvideo1",bg:"#407FFD"},"video/quicktime":{icon:"iconvideo1",bg:"#407FFD"},"video/x-flv":{icon:"iconvideo1",bg:"#407FFD"},"video/x-matroska":{icon:"iconvideo1",bg:"#407FFD"},"video/x-ms-wmv":{icon:"iconvideo1",bg:"#407FFD"}},[...wg].reduce((e,t)=>(e[t]={icon:"iconaudio",bg:"#FFAB19"},e),{}));var Lg=(e=>(e.Default="Default",e.Error="Error",e.Listening="Listening",e.Connecting="Connecting",e.Thinking="Thinking",e.Speaking="Speaking",e))(Lg||{}),Fg=(e=>(e.NoMicphonePermission="NoMicphonePermission",e.ConnectionLost="ConnectionLost",e.UnknownError="UnknownError",e.CallingTooFrequently="CallingTooFrequently",e.InternalServerError="InternalServerError",e.DataInputInspectionFailed="DataInputInspectionFailed",e.CurrentConversationTimeout="CurrentConversationTimeout",e.DailyConversationTimeout="DailyConversationTimeout",e.TodayExhausted="TodayExhausted",e.NotSupported="NotSupported",e.Limited="Limited",e))(Fg||{});class Ug extends Error{constructor(e){super(),k(this,"payload"),this.payload={error:e}}}const zg="//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.2.8/static/audio",Hg=[{imgUrl:"https://img.alicdn.com/imgextra/i2/O1CN01wTLOYq1kJFZ4YsxwN_!!6000000004662-2-tps-96-96.png",breathConfig:{timestamp:"2025-01-15_19-12-47",background:"f6f1c3",palette:["b3eeff","a2ffff","bbcfff","60c6ff","e2dfff"],offsets:[2,2,2,1.17,.65,.7,-.54,.9,2,-.9],twist:[4,0,.36,5.7,.6,.15,2.1,1,.14,.04],symbolColor:"#1B58F4"},breathVideo:`${zg}/MP4-F245.mp4`},{imgUrl:"https://img.alicdn.com/imgextra/i3/O1CN01gzeD5Z1mBaAKBRD9t_!!6000000004916-2-tps-96-96.png",breathConfig:{timestamp:"2025-01-17_16-58-53",background:"fff6f6",palette:["ffb5b7","ffc2ed","faf1ff","fff2fa","ffb9ec"],offsets:[.1,-.77,.01,1.36,2,1.13,2,2,-1.01,-1.39],twist:[-2,-2,.96,2.5,.67,1,2.36,1,.12,0],symbolColor:"#8340F2"},breathVideo:`${zg}/MP4-F05.mp4`},{imgUrl:"https://img.alicdn.com/imgextra/i2/O1CN01sdDcX31h2oVI9jUiL_!!6000000004220-2-tps-96-96.png",breathConfig:{timestamp:"2025-01-15_17-51-55",background:"B7CCFB",palette:["928ef3","5E82D1","DCDCFB","8CB5F9","ACB4F7"],offsets:[1.02,1.5,1.05,-.95,-1.75,.27,.99,-1.5,.95,.54],twist:[2,0,.24,5.7,.6,.15,1.5,1,.32,.05],symbolColor:"#6483FF"},breathVideo:`${zg}/MP4-M02.mp4`},{imgUrl:"https://img.alicdn.com/imgextra/i1/O1CN01LDtR50268dwIq0QLW_!!6000000007617-2-tps-96-96.png",breathConfig:{timestamp:"2025-01-17_16-56-39",background:"d3b5fe",palette:["fb98be","ed478c","e2cadc","ba70fb","e7adff"],offsets:[2,2,2,1.17,.65,.7,-.54,.9,2,-.9],twist:[4,0,.37,5.7,.6,.15,1.5,1,.127,0],symbolColor:"#1B58F4"},breathVideo:`${zg}/MP4-F030.mp4`}],$g={[Lg.Connecting]:{animate:"pointAnimate",text:"Connecting"},[Lg.Listening]:{animate:"jumpAnimate",text:"I'm listening"},[Lg.Thinking]:{animate:"pointAnimate",text:"Let me think"},[Lg.Speaking]:{animate:"jumpAnimate",text:"I'm speaking"}},Bg={[Fg.ConnectionLost]:()=>sv("Connection failed, please retry."),[Fg.NoMicphonePermission]:()=>sv("No microphone permission, please check permission settings"),[Fg.UnknownError]:()=>sv("An error occurred during the call. Please try again."),[Fg.CallingTooFrequently]:()=>sv("The call frequency is too high, please try again later ({{number}} times/minute).",{number:1}),[Fg.InternalServerError]:()=>sv("An error occurred during the call. Please try again."),[Fg.DataInputInspectionFailed]:()=>sv("The call content includes non-compliant content, please try again."),[Fg.CurrentConversationTimeout]:()=>sv("The current call has exceeded {{time}} minutes, please restart the session ({{time}} minutes/session).",{time:3}),[Fg.DailyConversationTimeout]:()=>sv("The call today exceeded {{time}} minutes, please come back tomorrow to use it ({{time}} minutes/day).",{time:30}),[Fg.TodayExhausted]:()=>sv("Today's chat limit has been reached"),[Fg.NotSupported]:()=>sv("Voice and video chat are not supported in this version of the web browser."),[Fg.Limited]:()=>sv("Oops, it's overcrowded! Please try again later.")},qg=["internal-qwenlm.alibaba-inc.com","qwenlm.io","chat.qwenlm.ai","qwenlm.ai","qwen.ai","chat.qwen.ai","qwenchat.com"].some(e=>location.host===e)?"prod":"pre",Gg="/api/v2",Vg="prod"===qg?"https://qwenlm.io/":"https://pre-qwenlm-box.alibaba-inc.com/",Wg=["model","thinking","search","t2v","t2i","deep_research_deep_research","artifacts_deploy_artifacts","artifacts_deploy_web_dev","artifacts_deploy_deep_research","audio_chat_AudioOnly","audio_chat_AudioAndVideo","deep_research_aipodcast","code","image_edit","deep_research_deep_research_advanced"],Qg=[{key:"upload",icon:"icon-line-upload-03",value:"Upload attachment"},{key:Zf.DeepResearch,icon:"icon-line-deepresearch-02",value:"Deep Research",chatType:Zf.DeepResearch,subChatType:Zf.DeepResearch},{key:Zf.ImageGeneration,icon:"icon-line-image-generation-01",value:"Create image",chatType:Zf.ImageGeneration,subChatType:Zf.ImageGeneration},{key:Zf.VideoGeneration,icon:"icon-line-video-generation-01",value:"Create video",chatType:Zf.VideoGeneration,subChatType:Zf.VideoGeneration},{key:Zf.WebDev,icon:"icon-a-line-webdev",value:"Web Dev",chatType:Zf.Artifacts,subChatType:Zf.WebDev},{key:"mcp",icon:"icon-line-star-02",value:"MCP"},{key:Zf.Slides,icon:"icon-line-presentation-01",value:"Slides",chatType:Zf.Slides,subChatType:Zf.Slides},{key:Zf.WebSearch,icon:"icon-line-globe-01",value:"Web search",chatType:Zf.WebSearch,subChatType:Zf.WebSearch},{key:Zf.Artifacts,icon:"icon-a-line-package-0211",value:"Artifacts",chatType:Zf.Artifacts,subChatType:Zf.Artifacts},{key:Zf.LEARN,icon:"icon-line-homework",value:"Learn",chatType:Zf.LEARN,subChatType:Zf.LEARN},{key:Zf.Travel,icon:"icon-line-Travel",value:"Travel Planner",chatType:Zf.Travel,subChatType:Zf.Travel}],Kg="NATIVE_NEW_PROJECT_ID",Yg=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Xg=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Jg={"":"","":"","":"","":navigator.userAgent.includes("Windows")?"":"","":navigator.userAgent.includes("Windows")?"":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},Zg=e=>{const t=new Date,n=new Date(1e3*e),i=(t.getTime()-n.getTime())/864e5,a=t.getDate(),o=t.getMonth(),s=t.getFullYear(),r=n.getDate(),l=n.getMonth(),c=n.getFullYear();return s===c&&o===l&&a===r?"Today":s===c&&o===l&&a-r===1?"Yesterday":i<=7?"Previous 7 days":i<=30?"Previous 30 days":s===c?n.toLocaleString("default",{month:"long"}):n.getFullYear().toString()},ev=(e="",t="subscript")=>{let n=e;switch(t){case"subscript":n=e.replace(/\[\[\d+\]\]/g,"");break;case"numberAndEntry":n=e.replace(/(\d+)[\r\n]+/g,"")}return n},tv=(e,t,n)=>{const i=e.map(e=>e.code);if(!t||0===t.length)return n;const a=t[0],o=i.find(e=>e===a);return o||n},nv=(e,t)=>{const n=_({},e);return Object.keys(t).forEach(e=>{const i=t[e],a=n[e];i&&"object"==typeof i&&!Array.isArray(i)&&a&&"object"==typeof a&&!Array.isArray(a)?n[e]=nv(a,i):n[e]=i}),n};let iv;const av=()=>P(void 0,null,function*(){return(yield _e(()=>P(void 0,null,function*(){const{default:e}=yield import("./languages.js");return{default:e}}),[])).default}),ov=e=>P(void 0,null,function*(){iv=Uf();const e=localStorage.getItem("locale"),t=yield av(),n=navigator.languages||[navigator.language||navigator.userLanguage],i=e||tv(t,n,"en-US");return iv.use(L((e,t)=>((e,t,n)=>{const i=e[t];return i?"function"==typeof i?i():Promise.resolve(i):new Promise((e,i)=>{("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(i.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==n?". Note that variables only represent file names one level deep.":""))))})})(Object.assign({"./locales/ar-BH/translation.json":()=>_e(()=>import("./translation.js"),[]),"./locales/de-DE/translation.json":()=>_e(()=>import("./translation2.js"),[]),"./locales/en-US/translation.json":()=>_e(()=>import("./translation3.js"),[]),"./locales/es-ES/translation.json":()=>_e(()=>import("./translation4.js"),[]),"./locales/fr-FR/translation.json":()=>_e(()=>import("./translation5.js"),[]),"./locales/it-IT/translation.json":()=>_e(()=>import("./translation6.js"),[]),"./locales/ja-JP/translation.json":()=>_e(()=>import("./translation7.js"),[]),"./locales/ko-KR/translation.json":()=>_e(()=>import("./translation8.js"),[]),"./locales/pt-PT/translation.json":()=>_e(()=>import("./translation9.js"),[]),"./locales/ru-RU/translation.json":()=>_e(()=>import("./translation10.js"),[]),"./locales/zh-CN/translation.json":()=>_e(()=>import("./translation11.js"),[]),"./locales/zh-TW/translation.json":()=>_e(()=>import("./translation12.js"),[])}),`./locales/${e}/${t}.json`,4).then(e=>e.default))).use(F).use(U).init({lng:i,debug:!1,detection:{order:["querystring","localStorage","navigator"],caches:["localStorage"],lookupQuerystring:"lang",lookupLocalStorage:"locale"},fallbackLng:{default:[""]},ns:"translation",returnEmptyString:!1,interpolation:{escapeValue:!1}},e=>{}),iv.on("languageChanged",e=>{}),iv}),sv=(e,t)=>{const n=Uf();return t?n.t(e,t):n.t(e)};function rv(){return rv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},rv.apply(this,arguments)}var lv,cv;(cv=lv||(lv={})).Pop="POP",cv.Push="PUSH",cv.Replace="REPLACE";const uv="popstate";function dv(e){return void 0===e&&(e={}),function(e,t,n,i){void 0===i&&(i={});let{window:a=document.defaultView,v5Compat:o=!1}=i,s=a.history,r=lv.Pop,l=null,c=u();null==c&&(c=0,s.replaceState(rv({},s.state,{idx:c}),""));function u(){return(s.state||{idx:null}).idx}function d(){r=lv.Pop;let e=u(),t=null==e?null:e-c;c=e,l&&l({action:r,location:f.location,delta:t})}function h(e,t){r=lv.Push;let n=fv(f.location,e,t);c=u()+1;let i=mv(n,c),d=f.createHref(n);try{s.pushState(i,"",d)}catch(h){if(h instanceof DOMException&&"DataCloneError"===h.name)throw h;a.location.assign(d)}o&&l&&l({action:r,location:f.location,delta:1})}function p(e,t){r=lv.Replace;let n=fv(f.location,e,t);c=u();let i=mv(n,c),a=f.createHref(n);s.replaceState(i,"",a),o&&l&&l({action:r,location:f.location,delta:0})}function m(e){let t="null"!==a.location.origin?a.location.origin:a.location.href,n="string"==typeof e?e:gv(e);return n=n.replace(/ $/,"%20"),hv(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}let f={get action(){return r},get location(){return e(a,s)},listen(e){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(uv,d),l=e,()=>{a.removeEventListener(uv,d),l=null}},createHref:e=>t(a,e),createURL:m,encodeLocation(e){let t=m(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:h,replace:p,go:e=>s.go(e)};return f}(function(e,t){let{pathname:n,search:i,hash:a}=e.location;return fv("",{pathname:n,search:i,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"==typeof t?t:gv(t)},0,e)}function hv(e,t){if(!1===e||null==e)throw new Error(t)}function pv(e,t){if(!e)try{throw new Error(t)}catch(qY){}}function mv(e,t){return{usr:e.state,key:e.key,idx:t}}function fv(e,t,n,i){return void 0===n&&(n=null),rv({pathname:"string"==typeof e?e:e.pathname,search:"",hash:""},"string"==typeof t?vv(t):t,{state:n,key:t&&t.key||i||Math.random().toString(36).substr(2,8)})}function gv(e){let{pathname:t="/",search:n="",hash:i=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),i&&"#"!==i&&(t+="#"===i.charAt(0)?i:"#"+i),t}function vv(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substr(i),e=e.substr(0,i)),e&&(t.pathname=e)}return t}var yv,bv;function xv(e,t,n){return void 0===n&&(n="/"),function(e,t,n){let i="string"==typeof t?vv(t):t,a=Rv(i.pathname||"/",n);if(null==a)return null;let o=wv(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(o);let s=null;for(let r=0;null==s&&r<o.length;++r){let e=Av(a);s=Pv(o[r],e)}return s}(e,t,n)}function wv(e,t,n,i){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===i&&(i="");let a=(e,a,o)=>{let s={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};s.relativePath.startsWith("/")&&(hv(s.relativePath.startsWith(i),'Absolute route path "'+s.relativePath+'" nested under path "'+i+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),s.relativePath=s.relativePath.slice(i.length));let r=Hv([i,s.relativePath]),l=n.concat(s);e.children&&e.children.length>0&&(hv(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+r+'".'),wv(e.children,t,l,r)),(null!=e.path||e.index)&&t.push({path:r,score:Nv(r,e.index),routesMeta:l})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let i of Sv(e.path))a(e,t,i);else a(e,t)}),t}function Sv(e){let t=e.split("/");if(0===t.length)return[];let[n,...i]=t,a=n.endsWith("?"),o=n.replace(/\?$/,"");if(0===i.length)return a?[o,""]:[o];let s=Sv(i.join("/")),r=[];return r.push(...s.map(e=>""===e?o:[o,e].join("/"))),a&&r.push(...s),r.map(t=>e.startsWith("/")&&""===t?"/":t)}(bv=yv||(yv={})).data="data",bv.deferred="deferred",bv.redirect="redirect",bv.error="error";const _v=/^:[\w-]+$/,Cv=3,Ev=2,kv=1,Iv=10,Tv=-2,jv=e=>"*"===e;function Nv(e,t){let n=e.split("/"),i=n.length;return n.some(jv)&&(i+=Tv),t&&(i+=Ev),n.filter(e=>!jv(e)).reduce((e,t)=>e+(_v.test(t)?Cv:""===t?kv:Iv),i)}function Pv(e,t,n){let{routesMeta:i}=e,a={},o="/",s=[];for(let r=0;r<i.length;++r){let e=i[r],n=r===i.length-1,l="/"===o?t:t.slice(o.length)||"/",c=Mv({path:e.relativePath,caseSensitive:e.caseSensitive,end:n},l),u=e.route;if(!c)return null;Object.assign(a,c.params),s.push({params:a,pathname:Hv([o,c.pathname]),pathnameBase:$v(Hv([o,c.pathnameBase])),route:u}),"/"!==c.pathnameBase&&(o=Hv([o,c.pathnameBase]))}return s}function Mv(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);pv("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let i=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(i.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(i.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");let o=new RegExp(a,t?void 0:"i");return[o,i]}(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let o=a[0],s=o.replace(/(.)\/+$/,"$1"),r=a.slice(1);return{params:i.reduce((e,t,n)=>{let{paramName:i,isOptional:a}=t;if("*"===i){let e=r[n]||"";s=o.slice(0,o.length-e.length).replace(/(.)\/+$/,"$1")}const l=r[n];return e[i]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:o,pathnameBase:s,pattern:e}}function Av(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return pv(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function Rv(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&"/"!==i?null:e.slice(n)||"/"}const Ov=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function Dv(e,t){void 0===t&&(t="/");let n,{pathname:i,search:a="",hash:o=""}="string"==typeof e?vv(e):e;if(i)if(s=i,Ov.test(s))n=i;else{if(i.includes("//")){let e=i;i=i.replace(/\/\/+/g,"/"),pv(!1,"Pathnames cannot have embedded double slashes - normalizing "+e+" -> "+i)}n=i.startsWith("/")?Lv(i.substring(1),"/"):Lv(i,t)}else n=t;var s;return{pathname:n,search:Bv(a),hash:qv(o)}}function Lv(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}function Fv(e,t,n,i){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function Uv(e,t){let n=function(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}(e);return t?n.map((e,t)=>t===n.length-1?e.pathname:e.pathnameBase):n.map(e=>e.pathnameBase)}function zv(e,t,n,i){let a;void 0===i&&(i=!1),"string"==typeof e?a=vv(e):(a=rv({},e),hv(!a.pathname||!a.pathname.includes("?"),Fv("?","pathname","search",a)),hv(!a.pathname||!a.pathname.includes("#"),Fv("#","pathname","hash",a)),hv(!a.search||!a.search.includes("#"),Fv("#","search","hash",a)));let o,s=""===e||""===a.pathname,r=s?"/":a.pathname;if(null==r)o=n;else{let e=t.length-1;if(!i&&r.startsWith("..")){let t=r.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}o=e>=0?t[e]:"/"}let l=Dv(a,o),c=r&&"/"!==r&&r.endsWith("/"),u=(s||"."===r)&&n.endsWith("/");return l.pathname.endsWith("/")||!c&&!u||(l.pathname+="/"),l}const Hv=e=>e.join("/").replace(/\/\/+/g,"/"),$v=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Bv=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",qv=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";const Gv=["post","put","patch","delete"];new Set(Gv);const Vv=["get",...Gv];function Wv(){return Wv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Wv.apply(this,arguments)}new Set(Vv);const Qv=O.createContext(null),Kv=O.createContext(null),Yv=O.createContext(null),Xv=O.createContext(null),Jv=O.createContext({outlet:null,matches:[],isDataRoute:!1}),Zv=O.createContext(null);function ey(){return null!=O.useContext(Xv)}function ty(){return ey()||hv(!1),O.useContext(Xv).location}function ny(e){O.useContext(Yv).static||O.useLayoutEffect(e)}function iy(){let{isDataRoute:e}=O.useContext(Jv);return e?function(){let{router:e}=function(){let e=O.useContext(Qv);return e||hv(!1),e}(hy.UseNavigateStable),t=my(py.UseNavigateStable),n=O.useRef(!1);ny(()=>{n.current=!0});let i=O.useCallback(function(i,a){void 0===a&&(a={}),n.current&&("number"==typeof i?e.navigate(i):e.navigate(i,Wv({fromRouteId:t},a)))},[e,t]);return i}():function(){ey()||hv(!1);let e=O.useContext(Qv),{basename:t,future:n,navigator:i}=O.useContext(Yv),{matches:a}=O.useContext(Jv),{pathname:o}=ty(),s=JSON.stringify(Uv(a,n.v7_relativeSplatPath)),r=O.useRef(!1);ny(()=>{r.current=!0});let l=O.useCallback(function(n,a){if(void 0===a&&(a={}),!r.current)return;if("number"==typeof n)return void i.go(n);let l=zv(n,JSON.parse(s),o,"path"===a.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:Hv([t,l.pathname])),(a.replace?i.replace:i.push)(l,a.state,a)},[t,i,s,o,e]);return l}()}const ay=O.createContext(null);function oy(){let{matches:e}=O.useContext(Jv),t=e[e.length-1];return t?t.params:{}}function sy(e,t){let{relative:n}=void 0===t?{}:t,{future:i}=O.useContext(Yv),{matches:a}=O.useContext(Jv),{pathname:o}=ty(),s=JSON.stringify(Uv(a,i.v7_relativeSplatPath));return O.useMemo(()=>zv(e,JSON.parse(s),o,"path"===n),[e,s,o,n])}function ry(e,t){return function(e,t,n,i){ey()||hv(!1);let{navigator:a}=O.useContext(Yv),{matches:o}=O.useContext(Jv),s=o[o.length-1],r=s?s.params:{};!s||s.pathname;let l=s?s.pathnameBase:"/";s&&s.route;let c,u=ty();if(t){var d;let e="string"==typeof t?vv(t):t;"/"===l||(null==(d=e.pathname)?void 0:d.startsWith(l))||hv(!1),c=e}else c=u;let h=c.pathname||"/",p=h;if("/"!==l){let e=l.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(e.length).join("/")}let m=xv(e,{pathname:p}),f=function(e,t,n,i){var a;void 0===t&&(t=[]);void 0===n&&(n=null);void 0===i&&(i=null);if(null==e){var o;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(o=i)&&o.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let s=e,r=null==(a=n)?void 0:a.errors;if(null!=r){let e=s.findIndex(e=>e.route.id&&void 0!==(null==r?void 0:r[e.route.id]));e>=0||hv(!1),s=s.slice(0,Math.min(s.length,e+1))}let l=!1,c=-1;if(n&&i&&i.v7_partialHydration)for(let u=0;u<s.length;u++){let e=s[u];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(c=u),e.route.id){let{loaderData:t,errors:i}=n,a=e.route.loader&&void 0===t[e.route.id]&&(!i||void 0===i[e.route.id]);if(e.route.lazy||a){l=!0,s=c>=0?s.slice(0,c+1):[s[0]];break}}}return s.reduceRight((e,i,a)=>{let o,u=!1,d=null,h=null;var p;n&&(o=r&&i.route.id?r[i.route.id]:void 0,d=i.route.errorElement||cy,l&&(c<0&&0===a?(fy[p="route-fallback"]||(fy[p]=!0),u=!0,h=null):c===a&&(u=!0,h=i.route.hydrateFallbackElement||null)));let m=t.concat(s.slice(0,a+1)),f=()=>{let t;return t=o?d:u?h:i.route.Component?O.createElement(i.route.Component,null):i.route.element?i.route.element:e,O.createElement(dy,{match:i,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(i.route.ErrorBoundary||i.route.errorElement||0===a)?O.createElement(uy,{location:n.location,revalidation:n.revalidation,component:d,error:o,children:f(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):f()},null)}(m&&m.map(e=>Object.assign({},e,{params:Object.assign({},r,e.params),pathname:Hv([l,a.encodeLocation?a.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?l:Hv([l,a.encodeLocation?a.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),o,n,i);if(t&&f)return O.createElement(Xv.Provider,{value:{location:Wv({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:lv.Pop}},f);return f}(e,t)}function ly(){let e=function(){var e;let t=O.useContext(Zv),n=function(){let e=O.useContext(Kv);return e||hv(!1),e}(),i=my();if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[i]}(),t=function(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return O.createElement(O.Fragment,null,O.createElement("h2",null,"Unexpected Application Error!"),O.createElement("h3",{style:{fontStyle:"italic"}},t),n?O.createElement("pre",{style:i},n):null,null)}const cy=O.createElement(ly,null);class uy extends O.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){}render(){return void 0!==this.state.error?O.createElement(Jv.Provider,{value:this.props.routeContext},O.createElement(Zv.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function dy(e){let{routeContext:t,match:n,children:i}=e,a=O.useContext(Qv);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),O.createElement(Jv.Provider,{value:t},i)}var hy=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(hy||{}),py=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(py||{});function my(e){let t=function(){let e=O.useContext(Jv);return e||hv(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||hv(!1),n.route.id}const fy={};function gy(e){return function(e){let t=O.useContext(Jv).outlet;return t?O.createElement(ay.Provider,{value:e},t):t}(e.context)}function vy(e){hv(!1)}function yy(e){let{basename:t="/",children:n=null,location:i,navigationType:a=lv.Pop,navigator:o,static:s=!1,future:r}=e;ey()&&hv(!1);let l=t.replace(/^\/*/,"/"),c=O.useMemo(()=>({basename:l,navigator:o,static:s,future:Wv({v7_relativeSplatPath:!1},r)}),[l,r,o,s]);"string"==typeof i&&(i=vv(i));let{pathname:u="/",search:d="",hash:h="",state:p=null,key:m="default"}=i,f=O.useMemo(()=>{let e=Rv(u,l);return null==e?null:{location:{pathname:e,search:d,hash:h,state:p,key:m},navigationType:a}},[l,u,d,h,p,m,a]);return null==f?null:O.createElement(Yv.Provider,{value:c},O.createElement(Xv.Provider,{children:n,value:f}))}function by(e){let{children:t,location:n}=e;return ry(xy(t),n)}function xy(e,t){void 0===t&&(t=[]);let n=[];return O.Children.forEach(e,(e,i)=>{if(!O.isValidElement(e))return;let a=[...t,i];if(e.type===O.Fragment)return void n.push.apply(n,xy(e.props.children,a));e.type!==vy&&hv(!1),e.props.index&&e.props.children&&hv(!1);let o={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=xy(e.props.children,a)),n.push(o)}),n}function wy(){return wy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},wy.apply(this,arguments)}function Sy(e){return void 0===e&&(e=""),new URLSearchParams("string"==typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let i=e[n];return t.concat(Array.isArray(i)?i.map(e=>[n,e]):[[n,i]])},[]))}new Promise(()=>{});const _y=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(qY){}const Cy=z.startTransition;function Ey(e){let{basename:t,children:n,future:i,window:a}=e,o=O.useRef();null==o.current&&(o.current=dv({window:a,v5Compat:!0}));let s=o.current,[r,l]=O.useState({action:s.action,location:s.location}),{v7_startTransition:c}=i||{},u=O.useCallback(e=>{c&&Cy?Cy(()=>l(e)):l(e)},[l,c]);return O.useLayoutEffect(()=>s.listen(u),[s,u]),O.useEffect(()=>{return null==(e=i)||e.v7_startTransition,void(null==e||e.v7_relativeSplatPath);var e},[i]),O.createElement(yy,{basename:t,children:n,location:r.location,navigationType:r.action,navigator:s,future:i})}const ky="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,Iy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ty=O.forwardRef(function(e,t){let n,{onClick:i,relative:a,reloadDocument:o,replace:s,state:r,target:l,to:c,preventScrollReset:u,viewTransition:d}=e,h=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,_y),{basename:p}=O.useContext(Yv),m=!1;if("string"==typeof c&&Iy.test(c)&&(n=c,ky))try{let e=new URL(window.location.href),t=c.startsWith("//")?new URL(e.protocol+c):new URL(c),n=Rv(t.pathname,p);t.origin===e.origin&&null!=n?c=n+t.search+t.hash:m=!0}catch(qY){}let f=function(e,t){let{relative:n}=void 0===t?{}:t;ey()||hv(!1);let{basename:i,navigator:a}=O.useContext(Yv),{hash:o,pathname:s,search:r}=sy(e,{relative:n}),l=s;return"/"!==i&&(l="/"===s?i:Hv([i,s])),a.createHref({pathname:l,search:r,hash:o})}(c,{relative:a}),g=function(e,t){let{target:n,replace:i,state:a,preventScrollReset:o,relative:s,viewTransition:r}=void 0===t?{}:t,l=iy(),c=ty(),u=sy(e,{relative:s});return O.useCallback(t=>{if(function(e,t){return!(0!==e.button||t&&"_self"!==t||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))}(t,n)){t.preventDefault();let n=void 0!==i?i:gv(c)===gv(u);l(e,{replace:n,state:a,preventScrollReset:o,relative:s,viewTransition:r})}},[c,l,u,i,a,n,e,o,s,r])}(c,{replace:s,state:r,target:l,preventScrollReset:u,relative:a,viewTransition:d});return O.createElement("a",wy({},h,{href:n||f,onClick:m||o?i:function(e){i&&i(e),e.defaultPrevented||g(e)},ref:t,target:l}))});var jy,Ny,Py,My;function Ay(e){let t=O.useRef(Sy(e)),n=O.useRef(!1),i=ty(),a=O.useMemo(()=>function(e,t){let n=Sy(e);return t&&t.forEach((e,i)=>{n.has(i)||t.getAll(i).forEach(e=>{n.append(i,e)})}),n}(i.search,n.current?null:t.current),[i.search]),o=iy(),s=O.useCallback((e,t)=>{const i=Sy("function"==typeof e?e(a):e);n.current=!0,o("?"+i,t)},[o,a]);return[a,s]}(Ny=jy||(jy={})).UseScrollRestoration="useScrollRestoration",Ny.UseSubmit="useSubmit",Ny.UseSubmitFetcher="useSubmitFetcher",Ny.UseFetcher="useFetcher",Ny.useViewTransitionState="useViewTransitionState",(My=Py||(Py={})).UseFetcher="useFetcher",My.UseFetchers="useFetchers",My.UseScrollRestoration="useScrollRestoration";var Ry={d:(e,t)=>{for(var n in t)Ry.o(t,n)&&!Ry.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},Oy={};Ry.d(Oy,{A:()=>Uy,k:()=>Fy});var Dy=function(e,t,n,i){return new(n||(n=Promise))(function(t,a){function o(e){try{r(i.next(e))}catch(t){a(t)}}function s(e){try{r(i.throw(e))}catch(t){a(t)}}function r(e){var i;e.done?t(e.value):(i=e.value,i instanceof n?i:new n(function(e){e(i)})).then(o,s)}r((i=i.apply(e,[])).next())})},Ly=function(e,t){var n,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(r){return function(l){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(s=0)),s;)try{if(n=1,i&&(a=2&r[0]?i.return:r[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,r[1])).done)return a;switch(i=0,a&&(r=[2&r[0],a.value]),r[0]){case 0:case 1:a=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((a=(a=s.trys).length>0&&a[a.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){s.label=r[1];break}if(6===r[0]&&s.label<a[1]){s.label=a[1],a=r;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(r);break}a[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(l){r=[6,l],i=0}finally{n=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,l])}}};function Fy(){return Dy(this,void 0,Promise,function(){return Ly(this,function(e){switch(e.label){case 0:return[4,new Promise(function(e,t){var n="Unknown",i=!1;function a(t){i||(i=!0,e({isPrivate:t,browserName:n}))}function o(){var e=0,t=parseInt("-1");try{t.toFixed(t)}catch(n){e=n.message.length}return e}function s(){return Dy(this,void 0,void 0,function(){var e;return Ly(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,navigator.storage.getDirectory()];case 1:return t.sent(),a(!1),[3,3];case 2:return e=t.sent(),a((e instanceof Error&&"string"==typeof e.message?e.message:String(e)).includes("unknown transient reason")),[3,3];case 3:return[2]}})})}function r(){var e;return Dy(this,void 0,Promise,function(){return Ly(this,function(t){switch(t.label){case 0:return"function"!=typeof(null===(e=navigator.storage)||void 0===e?void 0:e.getDirectory)?[3,2]:[4,s()];case 1:return t.sent(),[3,3];case 2:void 0!==navigator.maxTouchPoints?function(){var e=String(Math.random());try{var t=indexedDB.open(e,1);t.onupgradeneeded=function(t){var n=t.target.result,i=function(e){a(e)};try{n.createObjectStore("t",{autoIncrement:!0}).put(new Blob),i(!1)}catch(o){(o instanceof Error&&"string"==typeof o.message?o.message:String(o)).includes("are not yet supported")?i(!0):i(!1)}finally{n.close(),indexedDB.deleteDatabase(e)}},t.onerror=function(){return a(!1)}}catch(n){a(!1)}}():function(){var e=window.openDatabase,t=window.localStorage;try{e(null,null,null,null)}catch(n){return void a(!0)}try{t.setItem("test","1"),t.removeItem("test")}catch(n){return void a(!0)}a(!1)}(),t.label=3;case 3:return[2]}})})}function l(){void 0!==self.Promise&&void 0!==self.Promise.allSettled?navigator.webkitTemporaryStorage.queryUsageAndQuota(function(e,t){var n,i,o,s;a(Math.round(t/1048576)<2*Math.round((null!==(o=null===(i=null===(n=null==(s=window)?void 0:s.performance)||void 0===n?void 0:n.memory)||void 0===i?void 0:i.jsHeapSizeLimit)&&void 0!==o?o:1073741824)/1048576))},function(e){t(new Error("detectIncognito somehow failed to query storage quota: "+e.message))}):(0,window.webkitRequestFileSystem)(0,1,function(){a(!1)},function(){a(!0)})}function c(){var e;return Dy(this,void 0,Promise,function(){var t,n;return Ly(this,function(i){switch(i.label){case 0:if("function"!=typeof(null===(e=navigator.storage)||void 0===e?void 0:e.getDirectory))return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,navigator.storage.getDirectory()];case 2:return i.sent(),a(!1),[3,4];case 3:return t=i.sent(),a((t instanceof Error&&"string"==typeof t.message?t.message:String(t)).includes("Security error")),[2];case 4:return[3,6];case 5:(n=indexedDB.open("inPrivate")).onerror=function(e){n.error&&"InvalidStateError"===n.error.name&&e.preventDefault(),a(!0)},n.onsuccess=function(){indexedDB.deleteDatabase("inPrivate"),a(!1)},i.label=6;case 6:return[2]}})})}(function(){return Dy(this,void 0,Promise,function(){return Ly(this,function(e){switch(e.label){case 0:return 44!==o()&&43!==o()?[3,2]:(n="Safari",[4,r()]);case 1:return e.sent(),[3,6];case 2:return 51!==o()?[3,3]:(i=navigator.userAgent,n=i.match(/Chrome/)?void 0!==navigator.brave?"Brave":i.match(/Edg/)?"Edge":i.match(/OPR/)?"Opera":"Chrome":"Chromium",l(),[3,6]);case 3:return 25!==o()?[3,5]:(n="Firefox",[4,c()]);case 4:return e.sent(),[3,6];case 5:void 0!==navigator.msSaveBlob?(n="Internet Explorer",a(void 0===window.indexedDB)):t(new Error("detectIncognito cannot determine the browser")),e.label=6;case 6:return[2]}var i})})})().catch(t)})];case 1:return[2,e.sent()]}})})}"undefined"!=typeof window&&(window.detectIncognito=Fy);const Uy=Fy,zy=Oy.k,Hy={chrome:93,firefox:105,edge:110,safari:16},$y=(e=Hy,t=!1)=>{if(t)return!0;const n=window.navigator.userAgent,i=n.match(/Chrome\/(\d+)/),a=n.match(/Firefox\/(\d+)/),o=n.match(/Edg\/(\d+)/),s=n.includes("Safari")&&!n.includes("Chrome"),r=n.match(/Version\/(\d+)/);if(i){const t=Number.parseInt(i[1],10);return!!(t&&t>=e.chrome)}if(a){const t=Number.parseInt(a[1],10);return!!(t&&t>=e.firefox)}if(o){const t=Number.parseInt(o[1],10);return!!(t&&t>=e.edge)}if(s&&r){const t=Number.parseInt(r[1],10);return!!(t&&t>=e.safari)}return!0},By=e=>{let t;const n=new Set,i=(e,i)=>{const a="function"==typeof e?e(t):e;if(!Object.is(a,t)){const e=t;t=(null!=i?i:"object"!=typeof a||null===a)?a:Object.assign({},t,a),n.forEach(n=>n(t,e))}},a=()=>t,o={setState:i,getState:a,getInitialState:()=>s,subscribe:e=>(n.add(e),()=>n.delete(e))},s=t=e(i,a,o);return o},qy=e=>e?By(e):By,Gy=e=>e;const Vy=e=>{const t=qy(e),n=e=>function(e,t=Gy){const n=H.useSyncExternalStore(e.subscribe,H.useCallback(()=>t(e.getState()),[e,t]),H.useCallback(()=>t(e.getInitialState()),[e,t]));return H.useDebugValue(n),n}(t,e);return Object.assign(n,t),n},Wy=e=>Vy;var Qy=Symbol.for("immer-nothing"),Ky=Symbol.for("immer-draftable"),Yy=Symbol.for("immer-state");function Xy(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Jy=Object.getPrototypeOf;function Zy(e){return!!e&&!!e[Yy]}function eb(e){var t;return!!e&&(ib(e)||Array.isArray(e)||!!e[Ky]||!!(null==(t=e.constructor)?void 0:t[Ky])||lb(e)||cb(e))}var tb=Object.prototype.constructor.toString(),nb=new WeakMap;function ib(e){if(!e||"object"!=typeof e)return!1;const t=Object.getPrototypeOf(e);if(null===t||t===Object.prototype)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(n===Object)return!0;if("function"!=typeof n)return!1;let i=nb.get(n);return void 0===i&&(i=Function.toString.call(n),nb.set(n,i)),i===tb}function ab(e,t,n=!0){if(0===ob(e)){(n?Reflect.ownKeys(e):Object.keys(e)).forEach(n=>{t(n,e[n],e)})}else e.forEach((n,i)=>t(i,n,e))}function ob(e){const t=e[Yy];return t?t.type_:Array.isArray(e)?1:lb(e)?2:cb(e)?3:0}function sb(e,t){return 2===ob(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function rb(e,t,n){const i=ob(e);2===i?e.set(t,n):3===i?e.add(n):e[t]=n}function lb(e){return e instanceof Map}function cb(e){return e instanceof Set}function ub(e){return e.copy_||e.base_}function db(e,t){if(lb(e))return new Map(e);if(cb(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=ib(e);if(!0===t||"class_only"===t&&!n){const t=Object.getOwnPropertyDescriptors(e);delete t[Yy];let n=Reflect.ownKeys(t);for(let i=0;i<n.length;i++){const a=n[i],o=t[a];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[a]})}return Object.create(Jy(e),t)}{const t=Jy(e);if(null!==t&&n)return _({},e);const i=Object.create(t);return Object.assign(i,e)}}function hb(e,t=!1){return mb(e)||Zy(e)||!eb(e)||(ob(e)>1&&Object.defineProperties(e,{set:pb,add:pb,clear:pb,delete:pb}),Object.freeze(e),t&&Object.values(e).forEach(e=>hb(e,!0))),e}var pb={value:function(){Xy(2)}};function mb(e){return null===e||"object"!=typeof e||Object.isFrozen(e)}var fb,gb={};function vb(e){const t=gb[e];return t||Xy(0),t}function yb(){return fb}function bb(e,t){t&&(vb("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function xb(e){wb(e),e.drafts_.forEach(_b),e.drafts_=null}function wb(e){e===fb&&(fb=e.parent_)}function Sb(e){return fb={drafts_:[],parent_:fb,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function _b(e){const t=e[Yy];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function Cb(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return void 0!==e&&e!==n?(n[Yy].modified_&&(xb(t),Xy(4)),eb(e)&&(e=Eb(t,e),t.parent_||Ib(t,e)),t.patches_&&vb("Patches").generateReplacementPatches_(n[Yy].base_,e,t.patches_,t.inversePatches_)):e=Eb(t,n,[]),xb(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Qy?e:void 0}function Eb(e,t,n){if(mb(t))return t;const i=e.immer_.shouldUseStrictIteration(),a=t[Yy];if(!a)return ab(t,(i,o)=>kb(e,a,t,i,o,n),i),t;if(a.scope_!==e)return t;if(!a.modified_)return Ib(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const t=a.copy_;let o=t,s=!1;3===a.type_&&(o=new Set(t),t.clear(),s=!0),ab(o,(i,o)=>kb(e,a,t,i,o,n,s),i),Ib(e,t,!1),n&&e.patches_&&vb("Patches").generatePatches_(a,n,e.patches_,e.inversePatches_)}return a.copy_}function kb(e,t,n,i,a,o,s){if(null==a)return;if("object"!=typeof a&&!s)return;const r=mb(a);if(!r||s){if(Zy(a)){const s=Eb(e,a,o&&t&&3!==t.type_&&!sb(t.assigned_,i)?o.concat(i):void 0);if(rb(n,i,s),!Zy(s))return;e.canAutoFreeze_=!1}else s&&n.add(a);if(eb(a)&&!r){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;if(t&&t.base_&&t.base_[i]===a&&r)return;Eb(e,a),t&&t.scope_.parent_||"symbol"==typeof i||!(lb(n)?n.has(i):Object.prototype.propertyIsEnumerable.call(n,i))||Ib(e,a)}}}function Ib(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&hb(t,n)}var Tb={get(e,t){if(t===Yy)return e;const n=ub(e);if(!sb(n,t))return function(e,t,n){var i;const a=Pb(t,n);return a?"value"in a?a.value:null==(i=a.get)?void 0:i.call(e.draft_):void 0}(e,n,t);const i=n[t];return e.finalized_||!eb(i)?i:i===Nb(e.base_,t)?(Ab(e),e.copy_[t]=Rb(i,e)):i},has:(e,t)=>t in ub(e),ownKeys:e=>Reflect.ownKeys(ub(e)),set(e,t,n){const i=Pb(ub(e),t);if(null==i?void 0:i.set)return i.set.call(e.draft_,n),!0;if(!e.modified_){const i=Nb(ub(e),t),s=null==i?void 0:i[Yy];if(s&&s.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(((a=n)===(o=i)?0!==a||1/a==1/o:a!=a&&o!=o)&&(void 0!==n||sb(e.base_,t)))return!0;Ab(e),Mb(e)}var a,o;return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==Nb(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,Ab(e),Mb(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const n=ub(e),i=Reflect.getOwnPropertyDescriptor(n,t);return i?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:i.enumerable,value:n[t]}:i},defineProperty(){Xy(11)},getPrototypeOf:e=>Jy(e.base_),setPrototypeOf(){Xy(12)}},jb={};function Nb(e,t){const n=e[Yy];return(n?ub(n):e)[t]}function Pb(e,t){if(!(t in e))return;let n=Jy(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=Jy(n)}}function Mb(e){e.modified_||(e.modified_=!0,e.parent_&&Mb(e.parent_))}function Ab(e){e.copy_||(e.copy_=db(e.base_,e.scope_.immer_.useStrictShallowCopy_))}ab(Tb,(e,t)=>{jb[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),jb.deleteProperty=function(e,t){return jb.set.call(this,e,t,void 0)},jb.set=function(e,t,n){return Tb.set.call(this,e[0],t,n,e[0])};function Rb(e,t){const n=lb(e)?vb("MapSet").proxyMap_(e,t):cb(e)?vb("MapSet").proxySet_(e,t):function(e,t){const n=Array.isArray(e),i={type_:n?1:0,scope_:t?t.scope_:yb(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=i,o=Tb;n&&(a=[i],o=jb);const{revoke:s,proxy:r}=Proxy.revocable(a,o);return i.draft_=r,i.revoke_=s,r}(e,t);return(t?t.scope_:yb()).drafts_.push(n),n}function Ob(e){if(!eb(e)||mb(e))return e;const t=e[Yy];let n,i=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=db(e,t.scope_.immer_.useStrictShallowCopy_),i=t.scope_.immer_.shouldUseStrictIteration()}else n=db(e,!0);return ab(n,(e,t)=>{rb(n,e,Ob(t))},i),t&&(t.finalized_=!1),n}var Db=(new class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,n)=>{if("function"==typeof e&&"function"!=typeof t){const n=t;t=e;const i=this;return function(e=n,...a){return i.produce(e,e=>t.call(this,e,...a))}}let i;if("function"!=typeof t&&Xy(6),void 0!==n&&"function"!=typeof n&&Xy(7),eb(e)){const a=Sb(this),o=Rb(e,void 0);let s=!0;try{i=t(o),s=!1}finally{s?xb(a):wb(a)}return bb(a,n),Cb(i,a)}if(!e||"object"!=typeof e){if(i=t(e),void 0===i&&(i=e),i===Qy&&(i=void 0),this.autoFreeze_&&hb(i,!0),n){const t=[],a=[];vb("Patches").generateReplacementPatches_(e,i,t,a),n(t,a)}return i}Xy(1)},this.produceWithPatches=(e,t)=>{if("function"==typeof e)return(t,...n)=>this.produceWithPatches(t,t=>e(t,...n));let n,i;return[this.produce(e,t,(e,t)=>{n=e,i=t}),n,i]},"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof(null==e?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),"boolean"==typeof(null==e?void 0:e.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){eb(e)||Xy(8),Zy(e)&&(e=function(e){Zy(e)||Xy(10);return Ob(e)}(e));const t=Sb(this),n=Rb(e,void 0);return n[Yy].isManual_=!0,wb(t),n}finishDraft(e,t){const n=e&&e[Yy];n&&n.isManual_||Xy(9);const{scope_:i}=n;return bb(i,t),Cb(void 0,i)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const i=t[n];if(0===i.path.length&&"replace"===i.op){e=i.value;break}}n>-1&&(t=t.slice(n+1));const i=vb("Patches").applyPatches_;return Zy(e)?i(e,t):this.produce(e,e=>i(e,t))}}).produce;const Lb=e=>(t,n,i)=>(i.setState=(e,n,...i)=>{const a="function"==typeof e?Db(e):e;return t(a,n,...i)},e(i.setState,n,i)),Fb={BASE_URL:"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.2.8/",DEV:!1,LEGACY:!1,MODE:"production",PROD:!0,SSR:!1},Ub=e=>!!e.dispatchFromDevtools&&"function"==typeof e.dispatch,zb=new Map,Hb=e=>{const t=zb.get(e);return t?Object.fromEntries(Object.entries(t.stores).map(([e,t])=>[e,t.getState()])):{}},$b=e=>{var t,n;if(!e)return;const i=e.split("\n"),a=i.findIndex(e=>e.includes("api.setState"));if(a<0)return;const o=(null==(t=i[a+1])?void 0:t.trim())||"";return null==(n=/.+ (.+) .+/.exec(o))?void 0:n[1]},Bb=(e,t={})=>(n,i,a)=>{const o=t,{enabled:s,anonymousActionType:r,store:l}=o,c=E(o,["enabled","anonymousActionType","store"]);let u;try{u=(null!=s?s:"production"!==(Fb?"production":void 0))&&window.__REDUX_DEVTOOLS_EXTENSION__}catch(qY){}if(!u)return e(n,i,a);const d=((e,t,n)=>{if(void 0===e)return{type:"untracked",connection:t.connect(n)};const i=zb.get(n.name);if(i)return _({type:"tracked",store:e},i);const a={connection:t.connect(n),stores:{}};return zb.set(n.name,a),_({type:"tracked",store:e},a)})(l,u,c),{connection:h}=d,p=E(d,["connection"]);let m=!0;a.setState=(e,t,o)=>{const s=n(e,t);if(!m)return s;const u=void 0===o?{type:r||$b((new Error).stack)||"anonymous"}:"string"==typeof o?{type:o}:o;return void 0===l?(null==h||h.send(u,i()),s):(null==h||h.send(C(_({},u),{type:`${l}/${u.type}`}),C(_({},Hb(c.name)),{[l]:a.getState()})),s)},a.devtools={cleanup:()=>{h&&"function"==typeof h.unsubscribe&&h.unsubscribe(),((e,t)=>{if(void 0===t)return;const n=zb.get(e);n&&(delete n.stores[t],0===Object.keys(n.stores).length&&zb.delete(e))})(c.name,l)}};const f=(...e)=>{const t=m;m=!1,n(...e),m=t},g=e(a.setState,i,a);if("untracked"===p.type?null==h||h.init(g):(p.stores[p.store]=a,null==h||h.init(Object.fromEntries(Object.entries(p.stores).map(([e,t])=>[e,e===p.store?g:t.getState()])))),Ub(a)){let e=!1;const t=a.dispatch;a.dispatch=(...n)=>{"production"===(Fb?"production":void 0)||"__setState"!==n[0].type||e||(e=!0),t(...n)}}return h.subscribe(e=>{var t;switch(e.type){case"ACTION":if("string"!=typeof e.payload)return;return qb(e.payload,e=>{if("__setState"===e.type){if(void 0===l)return void f(e.state);Object.keys(e.state).length;const t=e.state[l];if(null==t)return;return void(JSON.stringify(a.getState())!==JSON.stringify(t)&&f(t))}Ub(a)&&a.dispatch(e)});case"DISPATCH":switch(e.payload.type){case"RESET":return f(g),void 0===l?null==h?void 0:h.init(a.getState()):null==h?void 0:h.init(Hb(c.name));case"COMMIT":return void 0===l?void(null==h||h.init(a.getState())):null==h?void 0:h.init(Hb(c.name));case"ROLLBACK":return qb(e.state,e=>{if(void 0===l)return f(e),void(null==h||h.init(a.getState()));f(e[l]),null==h||h.init(Hb(c.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return qb(e.state,e=>{void 0!==l?JSON.stringify(a.getState())!==JSON.stringify(e[l])&&f(e[l]):f(e)});case"IMPORT_STATE":{const{nextLiftedState:n}=e.payload,i=null==(t=n.computedStates.slice(-1)[0])?void 0:t.state;if(!i)return;return f(void 0===l?i:i[l]),void(null==h||h.send(null,n))}case"PAUSE_RECORDING":return m=!m}return}}),g},qb=(e,t)=>{let n;try{n=JSON.parse(e)}catch(qY){}void 0!==n&&t(n)},Gb=e=>(t,n,i)=>{const a=i.subscribe;i.subscribe=(e,t,n)=>{let o=e;if(t){const a=(null==n?void 0:n.equalityFn)||Object.is;let s=e(i.getState());o=n=>{const i=e(n);if(!a(s,i)){const e=s;t(s=i,e)}},(null==n?void 0:n.fireImmediately)&&t(s,s)}return a(o)};return e(t,n,i)},Vb=()=>({isStopDisabled:!1,currentChatPage:1,chatLoaded:!1,isChat:!1,chatPermission:{local_mcp:"prompt"},chatId:"",chatTitle:"",emitSendPromptType:"chat",chatParams:null,history:{messages:{},currentId:null,currentResponseIds:[]},historyCurrentId:"",projectId:"",currentInputFeature:cg.Txt2Txt,currentInputSubType:void 0,currentCitationInfo:{messageId:"",citationIndex:0},currentSearchSource:{},currentSearchLists:{},allSearchAndThinkLists:{},temporarySource:{},shareChatError:"",chatMode:"normal",imageReasonData:{status:"",imageUrl:""},branchInfo:null,callBackInfo:null,isCompareVersion:!0,badFeedbackVisible:!1}),Wb=Wy()(Lb(Bb((e,t)=>_(_({},Vb()),(e=>({setIsStopDisabled:t=>e({isStopDisabled:t}),setCurrentChatPage:t=>e({currentChatPage:t}),setChatLoaded:t=>e({chatLoaded:t}),setIsChat:t=>e({isChat:t}),setChatPermission:t=>e({chatPermission:t}),setChatId:t=>e({chatId:t}),setChatTitle:t=>e({chatTitle:t}),setProjectId:t=>e({projectId:t}),setEmitSendPromptType:t=>e({emitSendPromptType:t}),setChatParams:t=>e({chatParams:t}),setHistory:t=>e({history:t}),updateHistoryByImmer:t=>{e("function"==typeof t?e=>{t(e.history)}:{history:t})},setHistoryCurrentId:t=>e({historyCurrentId:t}),setAllSearchAndThinkLists:t=>e({allSearchAndThinkLists:t}),setCurrentInputFeature:t=>e({currentInputFeature:t}),setCurrentInputSubType:t=>e({currentInputSubType:t}),setCurrentCitationInfo:t=>e({currentCitationInfo:t}),setCurrentSearchSource:t=>e({currentSearchSource:t}),setTemporarySource:t=>e({temporarySource:t}),setCurrentArtifactsMessage:t=>e({currentArtifactsMessage:t}),resetChatState:()=>e(Vb()),setCurrentSearchLists:t=>e({currentSearchLists:t}),setShareChatError:t=>e({shareChatError:t}),setChatMode:t=>e({chatMode:t}),setImageReasonData:t=>e({imageReasonData:t}),setBranchInfo:t=>e({branchInfo:t}),setCallBackInfo:t=>e({callBackInfo:t}),setIsCompareVersion:t=>e({isCompareVersion:t}),setBadFeedbackVisible:t=>e({badFeedbackVisible:t})}))(e)),{name:"chatStore",store:"chatStore",enabled:!1}))),Qb={chats:[],pinnedChats:[]},Kb=Wy()(Bb(e=>_(_({},Qb),(e=>({setChats:t=>e({chats:t}),setPinnedChats:t=>e({pinnedChats:t})}))(e)),{name:"chatConfigStore",store:"chatConfigStore",enabled:!1})),Yb={"zh-cht":"zh-TW",zh:"zh-CN",en:"en-US",fr:"fr-FR",de:"de-DE",it:"it-IT",ja:"ja-JP",ko:"ko-KR",pt:"pt-PT",ar:"ar-BH",ru:"ru-RU",es:"es-ES"},Xb=(e=!1,t="light")=>"dark"===t?e?"https://img.alicdn.com/imgextra/i2/O1CN01J8AmJN1cZGSJ5xFjV_!!6000000003614-54-tps-60-60.apng":"https://img.alicdn.com/imgextra/i1/O1CN01lSOiPA1VfwvV2cZw6_!!6000000002681-54-tps-60-60.apng":"light"===t?e?"https://img.alicdn.com/imgextra/i4/O1CN01Jwyf191eaIa5xowFe_!!6000000003887-54-tps-60-60.apng":"https://img.alicdn.com/imgextra/i1/O1CN01pNHavt1CykU9z9sPI_!!6000000000150-54-tps-60-60.apng":void 0,Jb={showDeleteDeployConfirm:!1,reUpdateFolders:!1,taskRunning:!1,hasChatIsRunning:!1,visionGenerating:!1,showArchivedChats:!1,showChangelog:!1,showModelSelect:!1,showMCPconfig:!1,showUserLongPressChat:!1,showResLongPressChat:!1,showMcpServerModal:!1,showMcpJsonNewModal:!1,showMcpDetailModal:!1,showMcpDeleteModal:!1,thinkingEnabled:!1,thinkingMode:"Auto",supportThinkingModes:[],searchEnabled:!1,researchMode:"normal",featureConfig:"",imageGenerateEnabled:!1,mcpEnabled:!1,videoGenerateEnabled:!1,disableOtherFeature:!1,currentShowControl:tg.None,temporaryChatEnabled:!1,reUpdateMessagesScroll:!1,selectedArtifactsMessageId:"",historyCurrentId:"",welcomeModalShow:!1,isHongkong:!1,isRussia:!1,isShowGetTheApp:!1,isPdfVisible:!1,isSourcesVisible:!1,pdfViewInfo:null,isPdfCardVisible:!1,selectedModels:[],folders:{},currentDPLanguageCode:Yb.en,podcastCount:0,deepResearchVersion:"",omniType:"",selectedText:"",selectedTextPosition:null,selectedTextId:null,selectedTextIndex:null,currentActionMessageId:"",locateTheSearchSource:!1,currentControlsId:"",currentSlidesInfo:null,currentPhaseContentId:""},Zb=Wy()(Gb(Bb(e=>_(_({},Jb),(e=>({setShowDeleteDeployConfirm:t=>e({showDeleteDeployConfirm:t}),setReUpdateFolders:t=>e({reUpdateFolders:t}),setTaskRunning:t=>e({taskRunning:t}),setHasChatIsRunning:t=>e({hasChatIsRunning:t}),setVisionGenerating:t=>e({visionGenerating:t}),setShowArchivedChats:t=>e({showArchivedChats:t}),setShowChangelog:t=>e({showChangelog:t}),setShowModelSelect:t=>e({showModelSelect:t}),setShowMCPconfig:t=>e({showMCPconfig:t}),setShowUserLongPressChat:t=>e({showUserLongPressChat:t}),setShowResLongPressChat:t=>e({showResLongPressChat:t}),setShowMcpServerModal:t=>e({showMcpServerModal:t}),setShowMcpJsonNewModal:t=>e({showMcpJsonNewModal:t}),setShowMcpDetailModal:t=>e({showMcpDetailModal:t}),setShowMcpDeleteModal:t=>e({showMcpDeleteModal:t}),setThinkingEnabled:t=>e({thinkingEnabled:t}),setSupportThinkingModes:t=>e({supportThinkingModes:t}),setSearchEnabled:t=>e({searchEnabled:t}),setResearchMode:t=>e({researchMode:t}),setFeatureConfig:t=>e({featureConfig:t}),setImageGenerateEnabled:t=>e({imageGenerateEnabled:t}),setMcpEnabled:t=>e({mcpEnabled:t}),setVideoGenerateEnabled:t=>e({videoGenerateEnabled:t}),setDisableOtherFeature:t=>e({disableOtherFeature:t}),setCurrentShowControl:t=>e({currentShowControl:t}),setTemporaryChatEnabled:t=>e({temporaryChatEnabled:t}),setReUpdateMessagesScroll:t=>e({reUpdateMessagesScroll:t}),setSelectedArtifactsMessageId:t=>e({selectedArtifactsMessageId:t}),setHistoryCurrentId:t=>e({historyCurrentId:t}),setWelcomeModalShow:t=>e({welcomeModalShow:t}),setIsHongkong:t=>e({isHongkong:t}),setIsRussia:t=>e({isRussia:t}),setIsShowGetTheApp:t=>e({isShowGetTheApp:t}),setIsPdfVisible:t=>e({isPdfVisible:t}),setIsSourcesVisible:t=>e({isSourcesVisible:t}),setPDFViewInfo:t=>e({pdfViewInfo:t}),setIsPdfCardVisible:t=>e({isPdfCardVisible:t}),setSelectedModels:t=>e({selectedModels:t}),setCurrentDPLanguageCode:t=>e({currentDPLanguageCode:t}),setPodcastCount:t=>e({podcastCount:t}),setDeepResearchVersion:t=>e({deepResearchVersion:t}),setOmniType:t=>e({omniType:t}),setPdfCardType:t=>e({pdfCardType:t}),setCurrentActionMessageId:t=>e({currentActionMessageId:t}),setCurrentPhaseContentId:t=>e({currentPhaseContentId:t}),resetFeatureState:(t={})=>e(_(_({},Jb),t)),setFolders:t=>e({folders:t}),setSelectedText:t=>e({selectedText:t}),setSelectedTextPosition:t=>e({selectedTextPosition:t}),setSelectedTextId:t=>e({selectedTextId:t}),setSelectedTextIndex:t=>e({selectedTextIndex:t}),setLocateTheSearchSource:t=>e({locateTheSearchSource:t}),setCurrentControlsId:t=>e({currentControlsId:t}),setCurrentSlidesInfo:t=>e({currentSlidesInfo:t}),setThinkingMode:t=>{switch(t){case"Auto":case"Fast":e({thinkingEnabled:!1});break;case"Thinking":e({thinkingEnabled:!0})}e({thinkingMode:t})}}))(e)),{name:"featureStore",store:"featureStore",enabled:!1}))),ex={webuiName:"",config:void 0,mobile:!1,pad:!1,modelDownloadPool:{},globalGuestTracker:null,isDisableGuestAccess:!1},tx=Wy()(Bb(e=>_(_({},ex),(e=>({setWebuiName:t=>e({webuiName:t}),setConfig:t=>{var n;e({config:t}),!1===(null==(n=null==t?void 0:t.features)?void 0:n.enable_anonymous)&&e({isDisableGuestAccess:!0})},setMobile:t=>e({mobile:t}),setPad:t=>e({pad:t}),setModelDownloadPool:t=>e({modelDownloadPool:t}),setGlobalGuestTracker:t=>e({globalGuestTracker:t}),setIsDisableGuestAccess:t=>e({isDisableGuestAccess:t})}))(e)),{name:"globalConfigStore",store:"globalConfigStore",enabled:!1}));var nx,ix={exports:{}};nx=ix,function(){function e(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function t(e,t,n){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){s(i.response,t,n)},i.onerror=function(){},i.send()}function n(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(n){}return 200<=t.status&&299>=t.status}function i(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof $&&$.global===$?$:void 0,o=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(e,o,s){var r=a.URL||a.webkitURL,l=document.createElement("a");o=o||e.name||"download",l.download=o,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?i(l):n(l.href)?t(e,o,s):i(l,l.target="_blank")):(l.href=r.createObjectURL(e),setTimeout(function(){r.revokeObjectURL(l.href)},4e4),setTimeout(function(){i(l)},0))}:"msSaveOrOpenBlob"in navigator?function(a,o,s){if(o=o||a.name||"download","string"!=typeof a)navigator.msSaveOrOpenBlob(e(a,s),o);else if(n(a))t(a,o,s);else{var r=document.createElement("a");r.href=a,r.target="_blank",setTimeout(function(){i(r)})}}:function(e,n,i,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,i);var r="application/octet-stream"===e.type,l=/constructor/i.test(a.HTMLElement)||a.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||r&&l||o)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=e:location=e,s=null},u.readAsDataURL(e)}else{var d=a.URL||a.webkitURL,h=d.createObjectURL(e);s?s.location=h:location.href=h,s=null,setTimeout(function(){d.revokeObjectURL(h)},4e4)}});a.saveAs=s.saveAs=s,nx.exports=s}();const ax=B(ix.exports);function ox(){const e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}const sx=e=>"number"==typeof e&&!Number.isNaN(e);function rx(){const{userAgent:e}=navigator;return Boolean(e.match(/iPad Simulator|iPhone Simulator|iPod Simulator|iPad|iPhone|iPod/)||e.includes("Mac")&&"ontouchend"in document)}const lx=()=>{const e=navigator.userAgent.toLowerCase();return/iphone/.test(e)},cx=()=>-1!==navigator.userAgent.toLowerCase().indexOf("android"),ux=()=>{const e=navigator.userAgent,t=/(iPad|Macintosh.*AppleWebKit(?!.*Chrome))/.test(e)&&!/iPhone|iPod/.test(e)&&rx(),n=/Android/.test(e)&&!/Mobile/.test(e),i=/Windows/.test(e)&&/Touch/.test(e);return t?"iPad":n||i?"tablet":/iPhone|Android/.test(e)?"mobile":"pc"},dx=()=>-1!==navigator.userAgent.toLowerCase().indexOf("micromessenger"),hx=()=>cx()&&dx(),px=()=>{const e=ux();return["iPad","mobile","tablet"].includes(e)},mx=()=>"pc"===ux(),fx=()=>/AliApp\(QWENCHAT\/[^)]*\)/.test(navigator.userAgent),gx=()=>!mx()&&!fx(),vx=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent),yx=()=>{const e=navigator.userAgent.match(/AliApp\(QWENCHAT\/([\d.]+)\)/);return e?e[1]:"1.0.0"},bx=()=>{const e=navigator.userAgent.match(/AliApp\(QWENCHAT\/(\d+\.\d+\.\d+)/),t=e?e[1]:null;return t&&!(e=>{const t=e.split(".").map(e=>parseInt(e,10));for(;t.length<3;)t.push(0);return t[0]<1||!(t[0]>1)&&t[1]<2})(t)},xx=()=>!mx()&&!bx(),wx=()=>!!window.electronAPI&&/AliDesktop\(QWENCHAT\/\d+\.\d+\.\d+\)/.test(navigator.userAgent),Sx=()=>rx()&&fx()||cx()&&fx(),_x=()=>{const e=window.navigator.userAgent,t=window.navigator.platform;let n="";return-1!==["Macintosh","MacIntel","MacPPC","Mac68K"].indexOf(t)?n="MACOS":-1!==["iPhone","iPad","iPod"].indexOf(t)?n="IOS":-1!==["Win32","Win64","Windows","WinCE"].indexOf(t)?n="WINDOWS":/Android/.test(e)?n="ANDROID":!n&&/Linux/.test(t)&&(n="LINUX"),n},Cx=()=>{var e;if(!fx()||bx())return"0px";const t=null==(e=null==window?void 0:window.QwenChat)?void 0:e.safeAreaInsetTop;return lx()?sx(t)?`${t}px`:"env(safe-area-inset-top)":sx(t)?`${t}px`:"33px"},Ex=()=>{var e;if(!fx()||bx())return"0px";const t=null==(e=null==window?void 0:window.QwenChat)?void 0:e.safeAreaInsetBottom;return lx()?sx(t)?`${t}px`:"env(safe-area-inset-bottom)":sx(t)?`${t}px`:"38px"},kx=(e,t=!1)=>{const n=yx(),i=e.split(".").map(Number),a=n.split(".").map(Number);for(let o=0;o<3;o++){const e=i[o]||0,t=a[o]||0;if(t<e)return!0;if(t>e)return!1}return t},Ix=()=>{const e=navigator.userAgent;let t,n;if(e.indexOf("Firefox")>-1){t="Firefox";const i=e.match(/Firefox\/([\d.]+)/);n=i?i[1]:"Unknown"}else if(e.indexOf("Opera")>-1||e.indexOf("OPR")>-1){t="Opera";const i=e.match(/(Opera|OPR)\/([\d.]+)/);n=i?i[2]:"Unknown"}else if(e.indexOf("Edge")>-1){t="Edge";const i=e.match(/Edge\/([\d.]+)/);n=i?i[1]:"Unknown"}else if(e.indexOf("Chrome")>-1){t="Chrome";const i=e.match(/Chrome\/([\d.]+)/);n=i?i[1]:"Unknown"}else if(e.indexOf("Safari")>-1&&!e.match("Chrome")){t="Safari";const i=e.match(/Version\/([\d.]+)/);n=i?i[1]:"Unknown"}return{name:t,version:n}},Tx=(e,t)=>{var n;wx()&&(null==(n=window.electronAPI)?void 0:n.open_external_link)&&(e.preventDefault(),window.electronAPI.open_external_link(t))},jx=e=>{const t=(e=>{const{url:t,headers:n}=e;null==t||t.indexOf(Vg),n.getAccept()||n.set("Accept","application/json"),n.getContentType()||n.set("Content-Type","application/json"),n.set("Version","0.2.8");let i="h5";mx()&&(i="web"),fx()&&(i="app"),wx()&&(i="desktop"),n.set("source",i);const a=localStorage.getItem("token");return a&&!["web","h5"].includes(i)&&n.set("Authorization",`Bearer ${a}`),n.get("X-Request-Id")||n.set("X-Request-Id",ot()),["web","h5"].includes(i)&&n.has("Authorization")&&n.delete("Authorization"),!yT()||["web","h5"].includes(i)||n.has("Authorization")||n.set("Authorization",`Bearer ${yT()}`),n.set("Timezone",(new Date).toString().replace(/\s*\(.+\)$/,"")),_({},e)})(e);return(e=>{const{url:t,headers:n}=e,i=new Date;String(i.getMilliseconds()).padStart(3,"0"),i.toLocaleDateString(),i.toLocaleTimeString()})(e),_({},t)},Nx=(e,t)=>{const n=null==e?void 0:e.stage,i=null==e?void 0:e.modality,a=null==i?void 0:i.map(e=>t.t(e)).join(", ");let o="Content security warning: output data may contain inappropriate content!",s={};return"input"===n?a?(o="Content security warning: input {{fileType}} data may contain inappropriate content!",s={fileType:a}):o="Content security warning: input data may contain inappropriate content!":a&&(o="Content security warning: output {{fileType}} data may contain inappropriate content!",s={fileType:a}),t.t(o,s)},Px=[{urls:["chats/share/"]},{urls:["share/message/"]},{urls:["notifications/latest"]}],Mx=(e,t)=>{var n,i;const a=Uf(),o=e.status,s=(null==e?void 0:e.code)||"ERR_UNKNOWN_ERROR";let r=null==e?void 0:e.message;const l=null==e?void 0:e.name,c=e.config;let u=!(Px.find(({code:e,urls:n})=>{const i=!e||e.includes(s),a=n.find(e=>(t.url||"").includes(e));return i&&!!a})||null!=(n=t.toast)&&!n);const{user:d,setUser:h}=xE.getState(),{mobile:p}=tx.getState();switch(401!==o&&"Invalid token"!==s||(null==(i=(null==t?void 0:t.url)||"")?void 0:i.indexOf("/auths/"))>-1||(oT.adapter.clearCookie(Kf.SETAPP),h(void 0),bx()&&(oT.adapter.invoke({method:"showAlert",params:{type:"login"}}),oT.adapter.invoke({method:"showToast",params:{type:"warning",text:r}})),window.location.href=p?"/auth":"/"),o){case 401:break;case 403:"access_prohibited"===s&&d&&(h(C(_({},d),{role:"disabled"})),u=!1)}if("ACCOUNT_PENDING"===s)return{success:!1,data:{code:s,message:r,account_info:c}};if(!r)switch(s){case"ERR_NETWORK":r=a.t("Network error");break;case"ERR_UNKNOWN_ERROR":"TypeError"!==l&&"AxiosError"!==l||(r=a.t("Network error"))}switch("data_inspection_failed"===s&&(r=(null==e?void 0:e.message)?e.message:Nx(e,a)),r){case"Too Many Requests":r="Your operation is too frequent, please try again later.";break;case"Invalid token":r="Your session has expired, or the token is no longer valid. Please sign in again to proceed.";break;case"[ERROR: Folder already exists]":r="The folder already exists.";break;case"[ERROR: File already exists]":r="The file already exists.";break;case"[ERROR: You are not authorized to access this share]":r="Access deniedthis share link is private. Redirecting to the homepage in 5 seconds.";break;case"[ERROR: Share not found]":r="Access deniedthis share link is expired or disabled. Redirecting to the homepage in 5 seconds.";break;case"Network Error":r=a.t("Network error")}return u&&ut.openOnce({type:"error",content:a.t(r)}),{success:!1,data:{code:s,message:r}}},Ax=e=>{var t,n;const i=Uf(),a=e,{data:o,status:s}=a,r=(null==o?void 0:o.code)||"";let l=null==o?void 0:o.details;switch("detail"in o&&"string"==typeof o.detail?["data_inspection_passed"].includes(o.detail)||(l=null==o?void 0:o.detail):"error"in o?l=o.error&&"object"==typeof o.error&&"message"in o.error?o.error.message:o.error:"message"in o?l=o.message:(null==(t=null==o?void 0:o.detail)?void 0:t.code)&&(l=null==(n=null==o?void 0:o.detail)?void 0:n.message),r){case"data_inspection_failed":l=Nx(o,i);break;case"access_prohibited":l=null==o?void 0:o.message}return r||l?(l||(l=`${i.t("Network error")}: ${s}`),a.data={success:!1,data:{code:r,details:l}}):a.data={success:!0,data:_({},e.data)},a};const Rx=lt.create({baseURL:Gg,method:"GET",withCredentials:!0});Rx.interceptors.request.use(e=>jx(e)),Rx.interceptors.response.use(e=>e);const Ox=(e,t)=>P(void 0,null,function*(){var n,i;const a=!!(null==t?void 0:t.baseURL),o=localStorage.getItem("locale")||navigator.language||"en-US",s=`${o},${o.split("-")[0]};q=0.9`;try{if("stream"===(null==t?void 0:t.responseType))return yield function(e,t){return P(this,null,function*(){var n;const{headers:i}=t||{},a=jx(C(_({},t),{headers:new rt(i||{})})),{params:o={},data:s}=a,r=new URLSearchParams(o).toString();try{const i={method:(null==t?void 0:t.method)||"GET",headers:a.headers.toJSON()};"GET"!==(null==(n=null==t?void 0:t.method)?void 0:n.toUpperCase())&&s&&(i.body=JSON.stringify(s||{}));const o=yield fetch(`${Gg}${e}${r?`?${r}`:""}`,i),l=o.headers.get("content-type");if(null==l?void 0:l.includes("text/event-stream"))return{success:!0,data:o.body,isStream:!0};if(null==l?void 0:l.includes("application/json"))return{success:!0,data:yield o.json()};throw new st("Unknown error","ERR_UNKNOWN_ERROR")}catch(l){return Mx(new st(l.message,l.code),Object.assign({},t,{url:e}))}})}(e,C(_({},t||{}),{headers:_({"Accept-Language":s},null==t?void 0:t.headers)}));let n=yield Rx(C(_({url:e},t||{}),{headers:_({"Accept-Language":s},null==t?void 0:t.headers)}));return a&&(n=Ax(n)),(e=>{var t,n,i;const{data:a}=e;if(!a.success){const e=(null==(t=a.data)?void 0:t.code)||"ERR_UNKNOWN_ERROR",o=(null==(n=a.data)?void 0:n.details)||"Unknown error",s=(null==(i=a.data)?void 0:i.account_info)||"Unknown error";throw new st(o,e,s)}return a})(n)}catch(r){const o=null==r?void 0:r.response;if(o&&a){const{data:a}=Ax(o);if(!a.success)return Mx(new st(null==(n=a.data)?void 0:n.details,null==(i=a.data)?void 0:i.code),Object.assign({},t,{url:e}))}return Mx(r,Object.assign({},t,{url:e}))}}),Dx=["/api/chat/completions","/api/chats/new","/api/chat/completed","/api/v1/chats","/api/v1/chats/all/tags","/api/task/suggestions/completions","/api/v1/tasks/status","/api/v1/files/getstsToken","/api/task/title/completions","/api/task/tags/completions","/api/parse_url","/api/v2/chats","/api/v2/chat/completions","/api/v2/task/suggestions/completions","/api/v2/files/getstsToken","/api/v2/community","/api/v2/tts/completions","/api/v2/files/getfilelink","/api/v2/files/parse","/api/v2/files/parse/status"],Lx=e=>new Promise(t=>{setTimeout(t,e)}),Fx=()=>P(void 0,null,function*(){var e;return window.baxiaCommon&&(null==(e=window.__baxia__)?void 0:e.baxiaPromptInit)?yield zx():yield new Promise(e=>{!function(e,t){var n;const i="script",a=document.getElementsByTagName(i)[0],o=document.createElement(i);if(o.async=!0,o.src=e,o.crossOrigin="anonymous",t){let e=!1;o.onload=function(){e||(o.onload=null,e=!0,t("success"))}}o.onerror=function(){t("error")},null==(n=a.parentNode)||n.insertBefore(o,a)}("https://assets.alicdn.com/g/??/AWSC/AWSC/awsc.js,/sd/baxia-entry/baxiaCommon.js",t=>P(void 0,null,function*(){!function(){const e=new Date;String(e.getMilliseconds()).padStart(3,"0");e.toLocaleDateString(),e.toLocaleTimeString()}(),"success"===t&&(yield zx()),e(!0)}))})});let Ux=0;const zx=()=>P(void 0,null,function*(){var e,t,n;return Ux++,!!(window.baxiaCommon&&(null==(e=window.__baxia__)?void 0:e.baxiaPromptInit)&&window.baxiaInitialized)||(window.baxiaCommon&&(null==(t=window.__baxia__)?void 0:t.baxiaPromptInit)&&!window.baxiaInitialized?window.baxiaNeedDelay?(yield Lx(1500),yield zx()):(yield P(void 0,null,function*(){var e;window.baxiaCommon&&(null==(e=window.__baxia__)?void 0:e.baxiaPromptInit)&&(window.baxiaCommon.init({appendTo:"header",uabOptions:{location:"sea"},checkApiPath:function(e){return Dx.some(t=>e.indexOf(t)>-1)},paramstype:["uab","umid"],autoSize:!0}),bx()&&(window.baxiaNeedDelay=!0,yield Lx(1500),window.baxiaNeedDelay=!1),window.baxiaInitialized=!0)}),yield zx()):Ux<6&&Ux>3&&!window.baxiaCommon&&!(null==(n=window.__baxia__)?void 0:n.baxiaPromptInit)?yield Fx():Ux>6||(yield Lx(1e3),yield zx()))}),Hx=e=>P(void 0,null,function*(){return yield zx(),yield Ox(`/share/artifacts/${e.share_id}`,{baseURL:"/api/v1",toast:!1})}),$x=e=>P(void 0,null,function*(){return yield Ox("/share/artifacts/report",{method:"POST",data:e})}),Bx="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",qx="ARRAYBUFFER not supported by this environment",Gx="UINT8ARRAY not supported by this environment";function Vx(e,t,n,i){let a,o,s;const r=t||[0],l=(n=n||0)>>>3,c=-1===i?3:0;for(a=0;a<e.length;a+=1)s=a+l,o=s>>>2,r.length<=o&&r.push(0),r[o]|=e[a]<<8*(c+i*(s%4));return{value:r,binLen:8*e.length+n}}function Wx(e,t,n){switch(t){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(e){case"HEX":return function(e,t,i){return function(e,t,n,i){let a,o,s,r;if(0!=e.length%2)throw new Error("String of HEX type must be in byte increments");const l=t||[0],c=(n=n||0)>>>3,u=-1===i?3:0;for(a=0;a<e.length;a+=2){if(o=parseInt(e.substr(a,2),16),isNaN(o))throw new Error("String of HEX type contains invalid characters");for(r=(a>>>1)+c,s=r>>>2;l.length<=s;)l.push(0);l[s]|=o<<8*(u+i*(r%4))}return{value:l,binLen:4*e.length+n}}(e,t,i,n)};case"TEXT":return function(e,i,a){return function(e,t,n,i,a){let o,s,r,l,c,u,d,h,p=0;const m=n||[0],f=(i=i||0)>>>3;if("UTF8"===t)for(d=-1===a?3:0,r=0;r<e.length;r+=1)for(o=e.charCodeAt(r),s=[],128>o?s.push(o):2048>o?(s.push(192|o>>>6),s.push(128|63&o)):55296>o||57344<=o?s.push(224|o>>>12,128|o>>>6&63,128|63&o):(r+=1,o=65536+((1023&o)<<10|1023&e.charCodeAt(r)),s.push(240|o>>>18,128|o>>>12&63,128|o>>>6&63,128|63&o)),l=0;l<s.length;l+=1){for(u=p+f,c=u>>>2;m.length<=c;)m.push(0);m[c]|=s[l]<<8*(d+a*(u%4)),p+=1}else for(d=-1===a?2:0,h="UTF16LE"===t&&1!==a||"UTF16LE"!==t&&1===a,r=0;r<e.length;r+=1){for(o=e.charCodeAt(r),!0===h&&(l=255&o,o=l<<8|o>>>8),u=p+f,c=u>>>2;m.length<=c;)m.push(0);m[c]|=o<<8*(d+a*(u%4)),p+=2}return{value:m,binLen:8*p+i}}(e,t,i,a,n)};case"B64":return function(e,t,i){return function(e,t,n,i){let a,o,s,r,l,c,u,d=0;const h=t||[0],p=(n=n||0)>>>3,m=-1===i?3:0,f=e.indexOf("=");if(-1===e.search(/^[a-zA-Z0-9=+/]+$/))throw new Error("Invalid character in base-64 string");if(e=e.replace(/=/g,""),-1!==f&&f<e.length)throw new Error("Invalid '=' found in base-64 string");for(o=0;o<e.length;o+=4){for(l=e.substr(o,4),r=0,s=0;s<l.length;s+=1)a=Bx.indexOf(l.charAt(s)),r|=a<<18-6*s;for(s=0;s<l.length-1;s+=1){for(u=d+p,c=u>>>2;h.length<=c;)h.push(0);h[c]|=(r>>>16-8*s&255)<<8*(m+i*(u%4)),d+=1}}return{value:h,binLen:8*d+n}}(e,t,i,n)};case"BYTES":return function(e,t,i){return function(e,t,n,i){let a,o,s,r;const l=t||[0],c=(n=n||0)>>>3,u=-1===i?3:0;for(o=0;o<e.length;o+=1)a=e.charCodeAt(o),r=o+c,s=r>>>2,l.length<=s&&l.push(0),l[s]|=a<<8*(u+i*(r%4));return{value:l,binLen:8*e.length+n}}(e,t,i,n)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(uI){throw new Error(qx)}return function(e,t,i){return a=t,o=i,s=n,Vx(new Uint8Array(e),a,o,s);var a,o,s};case"UINT8ARRAY":try{new Uint8Array(0)}catch(uI){throw new Error(Gx)}return function(e,t,i){return Vx(e,t,i,n)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function Qx(e,t,n,i){switch(e){case"HEX":return function(e){return function(e,t,n,i){const a="0123456789abcdef";let o,s,r="";const l=t/8,c=-1===n?3:0;for(o=0;o<l;o+=1)s=e[o>>>2]>>>8*(c+n*(o%4)),r+=a.charAt(s>>>4&15)+a.charAt(15&s);return i.outputUpper?r.toUpperCase():r}(e,t,n,i)};case"B64":return function(e){return function(e,t,n,i){let a,o,s,r,l,c="";const u=t/8,d=-1===n?3:0;for(a=0;a<u;a+=3)for(r=a+1<u?e[a+1>>>2]:0,l=a+2<u?e[a+2>>>2]:0,s=(e[a>>>2]>>>8*(d+n*(a%4))&255)<<16|(r>>>8*(d+n*((a+1)%4))&255)<<8|l>>>8*(d+n*((a+2)%4))&255,o=0;o<4;o+=1)c+=8*a+6*o<=t?Bx.charAt(s>>>6*(3-o)&63):i.b64Pad;return c}(e,t,n,i)};case"BYTES":return function(e){return function(e,t,n){let i,a,o="";const s=t/8,r=-1===n?3:0;for(i=0;i<s;i+=1)a=e[i>>>2]>>>8*(r+n*(i%4))&255,o+=String.fromCharCode(a);return o}(e,t,n)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(uI){throw new Error(qx)}return function(e){return function(e,t,n){let i;const a=t/8,o=new ArrayBuffer(a),s=new Uint8Array(o),r=-1===n?3:0;for(i=0;i<a;i+=1)s[i]=e[i>>>2]>>>8*(r+n*(i%4))&255;return o}(e,t,n)};case"UINT8ARRAY":try{new Uint8Array(0)}catch(uI){throw new Error(Gx)}return function(e){return function(e,t,n){let i;const a=t/8,o=-1===n?3:0,s=new Uint8Array(a);for(i=0;i<a;i+=1)s[i]=e[i>>>2]>>>8*(o+n*(i%4))&255;return s}(e,t,n)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}const Kx=4294967296,Yx=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Xx=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],Jx=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],Zx="Chosen SHA variant is not supported",ew="Cannot set numRounds with MAC";function tw(e,t){let n,i;const a=e.binLen>>>3,o=t.binLen>>>3,s=a<<3,r=4-a<<3;if(a%4!=0){for(n=0;n<o;n+=4)i=a+n>>>2,e.value[i]|=t.value[n>>>2]<<s,e.value.push(0),e.value[i+1]|=t.value[n>>>2]>>>r;return(e.value.length<<2)-4>=o+a&&e.value.pop(),{value:e.value,binLen:e.binLen+t.binLen}}return{value:e.value.concat(t.value),binLen:e.binLen+t.binLen}}function nw(e){const t={outputUpper:!1,b64Pad:"=",outputLen:-1},n=e||{},i="Output length must be a multiple of 8";if(t.outputUpper=n.outputUpper||!1,n.b64Pad&&(t.b64Pad=n.b64Pad),n.outputLen){if(n.outputLen%8!=0)throw new Error(i);t.outputLen=n.outputLen}else if(n.shakeLen){if(n.shakeLen%8!=0)throw new Error(i);t.outputLen=n.shakeLen}if("boolean"!=typeof t.outputUpper)throw new Error("Invalid outputUpper formatting option");if("string"!=typeof t.b64Pad)throw new Error("Invalid b64Pad formatting option");return t}function iw(e,t,n,i){const a=e+" must include a value and format";if(!t){if(!i)throw new Error(a);return i}if(void 0===t.value||!t.format)throw new Error(a);return Wx(t.format,t.encoding||"UTF8",n)(t.value)}class aw{constructor(e,t,n){const i=n||{};if(this.t=t,this.i=i.encoding||"UTF8",this.numRounds=i.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.o=e,this.h=[],this.u=0,this.l=!1,this.A=0,this.H=!1,this.S=[],this.p=[]}update(e){let t,n=0;const i=this.m>>>5,a=this.C(e,this.h,this.u),o=a.binLen,s=a.value,r=o>>>5;for(t=0;t<r;t+=i)n+this.m<=o&&(this.U=this.v(s.slice(t,t+i),this.U),n+=this.m);return this.A+=n,this.h=s.slice(n>>>5),this.u=o%this.m,this.l=!0,this}getHash(e,t){let n,i,a=this.R;const o=nw(t);if(this.K){if(-1===o.outputLen)throw new Error("Output length must be specified in options");a=o.outputLen}const s=Qx(e,a,this.T,o);if(this.H&&this.g)return s(this.g(o));for(i=this.F(this.h.slice(),this.u,this.A,this.L(this.U),a),n=1;n<this.numRounds;n+=1)this.K&&a%32!=0&&(i[i.length-1]&=16777215>>>24-a%32),i=this.F(i,a,0,this.B(this.o),a);return s(i)}setHMACKey(e,t,n){if(!this.M)throw new Error("Variant does not support HMAC");if(this.l)throw new Error("Cannot set MAC key after calling update");const i=Wx(t,(n||{}).encoding||"UTF8",this.T);this.k(i(e))}k(e){const t=this.m>>>3,n=t/4-1;let i;if(1!==this.numRounds)throw new Error(ew);if(this.H)throw new Error("MAC key already set");for(t<e.binLen/8&&(e.value=this.F(e.value,e.binLen,0,this.B(this.o),this.R));e.value.length<=n;)e.value.push(0);for(i=0;i<=n;i+=1)this.S[i]=909522486^e.value[i],this.p[i]=1549556828^e.value[i];this.U=this.v(this.S,this.U),this.A=this.m,this.H=!0}getHMAC(e,t){const n=nw(t);return Qx(e,this.R,this.T,n)(this.Y())}Y(){let e;if(!this.H)throw new Error("Cannot call getHMAC without first setting MAC key");const t=this.F(this.h.slice(),this.u,this.A,this.L(this.U),this.R);return e=this.v(this.p,this.B(this.o)),e=this.F(t,this.R,this.m,e,this.R),e}}function ow(e,t){return e<<t|e>>>32-t}function sw(e,t){return e>>>t|e<<32-t}function rw(e,t){return e>>>t}function lw(e,t,n){return e^t^n}function cw(e,t,n){return e&t^~e&n}function uw(e,t,n){return e&t^e&n^t&n}function dw(e){return sw(e,2)^sw(e,13)^sw(e,22)}function hw(e,t){const n=(65535&e)+(65535&t);return(65535&(e>>>16)+(t>>>16)+(n>>>16))<<16|65535&n}function pw(e,t,n,i){const a=(65535&e)+(65535&t)+(65535&n)+(65535&i);return(65535&(e>>>16)+(t>>>16)+(n>>>16)+(i>>>16)+(a>>>16))<<16|65535&a}function mw(e,t,n,i,a){const o=(65535&e)+(65535&t)+(65535&n)+(65535&i)+(65535&a);return(65535&(e>>>16)+(t>>>16)+(n>>>16)+(i>>>16)+(a>>>16)+(o>>>16))<<16|65535&o}function fw(e){return sw(e,7)^sw(e,18)^rw(e,3)}function gw(e){return sw(e,6)^sw(e,11)^sw(e,25)}function vw(e){return[1732584193,4023233417,2562383102,271733878,3285377520]}function yw(e,t){let n,i,a,o,s,r,l;const c=[];for(n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=0;l<80;l+=1)c[l]=l<16?e[l]:ow(c[l-3]^c[l-8]^c[l-14]^c[l-16],1),r=l<20?mw(ow(n,5),cw(i,a,o),s,1518500249,c[l]):l<40?mw(ow(n,5),lw(i,a,o),s,1859775393,c[l]):l<60?mw(ow(n,5),uw(i,a,o),s,2400959708,c[l]):mw(ow(n,5),lw(i,a,o),s,3395469782,c[l]),s=o,o=a,a=ow(i,30),i=n,n=r;return t[0]=hw(n,t[0]),t[1]=hw(i,t[1]),t[2]=hw(a,t[2]),t[3]=hw(o,t[3]),t[4]=hw(s,t[4]),t}function bw(e,t,n,i){let a;const o=15+(t+65>>>9<<4),s=t+n;for(;e.length<=o;)e.push(0);for(e[t>>>5]|=128<<24-t%32,e[o]=4294967295&s,e[o-1]=s/Kx|0,a=0;a<e.length;a+=16)i=yw(e.slice(a,a+16),i);return i}let xw=class extends aw{constructor(e,t,n){if("SHA-1"!==e)throw new Error(Zx);super(e,t,n);const i=n||{};this.M=!0,this.g=this.Y,this.T=-1,this.C=Wx(this.t,this.i,this.T),this.v=yw,this.L=function(e){return e.slice()},this.B=vw,this.F=bw,this.U=[1732584193,4023233417,2562383102,271733878,3285377520],this.m=512,this.R=160,this.K=!1,i.hmacKey&&this.k(iw("hmacKey",i.hmacKey,this.T))}};function ww(e){let t;return t="SHA-224"==e?Xx.slice():Jx.slice(),t}function Sw(e,t){let n,i,a,o,s,r,l,c,u,d,h;const p=[];for(n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],r=t[5],l=t[6],c=t[7],h=0;h<64;h+=1)p[h]=h<16?e[h]:pw(sw(m=p[h-2],17)^sw(m,19)^rw(m,10),p[h-7],fw(p[h-15]),p[h-16]),u=mw(c,gw(s),cw(s,r,l),Yx[h],p[h]),d=hw(dw(n),uw(n,i,a)),c=l,l=r,r=s,s=hw(o,u),o=a,a=i,i=n,n=hw(u,d);var m;return t[0]=hw(n,t[0]),t[1]=hw(i,t[1]),t[2]=hw(a,t[2]),t[3]=hw(o,t[3]),t[4]=hw(s,t[4]),t[5]=hw(r,t[5]),t[6]=hw(l,t[6]),t[7]=hw(c,t[7]),t}let _w=class extends aw{constructor(e,t,n){if("SHA-224"!==e&&"SHA-256"!==e)throw new Error(Zx);super(e,t,n);const i=n||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=Wx(this.t,this.i,this.T),this.v=Sw,this.L=function(e){return e.slice()},this.B=ww,this.F=function(t,n,i,a){return function(e,t,n,i,a){let o,s;const r=15+(t+65>>>9<<4),l=t+n;for(;e.length<=r;)e.push(0);for(e[t>>>5]|=128<<24-t%32,e[r]=4294967295&l,e[r-1]=l/Kx|0,o=0;o<e.length;o+=16)i=Sw(e.slice(o,o+16),i);return s="SHA-224"===a?[i[0],i[1],i[2],i[3],i[4],i[5],i[6]]:i,s}(t,n,i,a,e)},this.U=ww(e),this.m=512,this.R="SHA-224"===e?224:256,this.K=!1,i.hmacKey&&this.k(iw("hmacKey",i.hmacKey,this.T))}};class Cw{constructor(e,t){this.N=e,this.I=t}}function Ew(e,t){let n;return t>32?(n=64-t,new Cw(e.I<<t|e.N>>>n,e.N<<t|e.I>>>n)):0!==t?(n=32-t,new Cw(e.N<<t|e.I>>>n,e.I<<t|e.N>>>n)):e}function kw(e,t){let n;return t<32?(n=32-t,new Cw(e.N>>>t|e.I<<n,e.I>>>t|e.N<<n)):(n=64-t,new Cw(e.I>>>t|e.N<<n,e.N>>>t|e.I<<n))}function Iw(e,t){return new Cw(e.N>>>t,e.I>>>t|e.N<<32-t)}function Tw(e,t,n){return new Cw(e.N&t.N^e.N&n.N^t.N&n.N,e.I&t.I^e.I&n.I^t.I&n.I)}function jw(e){const t=kw(e,28),n=kw(e,34),i=kw(e,39);return new Cw(t.N^n.N^i.N,t.I^n.I^i.I)}function Nw(e,t){let n,i;n=(65535&e.I)+(65535&t.I),i=(e.I>>>16)+(t.I>>>16)+(n>>>16);const a=(65535&i)<<16|65535&n;return n=(65535&e.N)+(65535&t.N)+(i>>>16),i=(e.N>>>16)+(t.N>>>16)+(n>>>16),new Cw((65535&i)<<16|65535&n,a)}function Pw(e,t,n,i){let a,o;a=(65535&e.I)+(65535&t.I)+(65535&n.I)+(65535&i.I),o=(e.I>>>16)+(t.I>>>16)+(n.I>>>16)+(i.I>>>16)+(a>>>16);const s=(65535&o)<<16|65535&a;return a=(65535&e.N)+(65535&t.N)+(65535&n.N)+(65535&i.N)+(o>>>16),o=(e.N>>>16)+(t.N>>>16)+(n.N>>>16)+(i.N>>>16)+(a>>>16),new Cw((65535&o)<<16|65535&a,s)}function Mw(e,t,n,i,a){let o,s;o=(65535&e.I)+(65535&t.I)+(65535&n.I)+(65535&i.I)+(65535&a.I),s=(e.I>>>16)+(t.I>>>16)+(n.I>>>16)+(i.I>>>16)+(a.I>>>16)+(o>>>16);const r=(65535&s)<<16|65535&o;return o=(65535&e.N)+(65535&t.N)+(65535&n.N)+(65535&i.N)+(65535&a.N)+(s>>>16),s=(e.N>>>16)+(t.N>>>16)+(n.N>>>16)+(i.N>>>16)+(a.N>>>16)+(o>>>16),new Cw((65535&s)<<16|65535&o,r)}function Aw(e,t){return new Cw(e.N^t.N,e.I^t.I)}function Rw(e){const t=kw(e,19),n=kw(e,61),i=Iw(e,6);return new Cw(t.N^n.N^i.N,t.I^n.I^i.I)}function Ow(e){const t=kw(e,1),n=kw(e,8),i=Iw(e,7);return new Cw(t.N^n.N^i.N,t.I^n.I^i.I)}function Dw(e){const t=kw(e,14),n=kw(e,18),i=kw(e,41);return new Cw(t.N^n.N^i.N,t.I^n.I^i.I)}const Lw=[new Cw(Yx[0],3609767458),new Cw(Yx[1],602891725),new Cw(Yx[2],3964484399),new Cw(Yx[3],2173295548),new Cw(Yx[4],4081628472),new Cw(Yx[5],3053834265),new Cw(Yx[6],2937671579),new Cw(Yx[7],3664609560),new Cw(Yx[8],2734883394),new Cw(Yx[9],1164996542),new Cw(Yx[10],1323610764),new Cw(Yx[11],3590304994),new Cw(Yx[12],4068182383),new Cw(Yx[13],991336113),new Cw(Yx[14],633803317),new Cw(Yx[15],3479774868),new Cw(Yx[16],2666613458),new Cw(Yx[17],944711139),new Cw(Yx[18],2341262773),new Cw(Yx[19],2007800933),new Cw(Yx[20],1495990901),new Cw(Yx[21],1856431235),new Cw(Yx[22],3175218132),new Cw(Yx[23],2198950837),new Cw(Yx[24],3999719339),new Cw(Yx[25],766784016),new Cw(Yx[26],2566594879),new Cw(Yx[27],3203337956),new Cw(Yx[28],1034457026),new Cw(Yx[29],2466948901),new Cw(Yx[30],3758326383),new Cw(Yx[31],168717936),new Cw(Yx[32],1188179964),new Cw(Yx[33],1546045734),new Cw(Yx[34],1522805485),new Cw(Yx[35],2643833823),new Cw(Yx[36],2343527390),new Cw(Yx[37],1014477480),new Cw(Yx[38],1206759142),new Cw(Yx[39],344077627),new Cw(Yx[40],1290863460),new Cw(Yx[41],3158454273),new Cw(Yx[42],3505952657),new Cw(Yx[43],106217008),new Cw(Yx[44],3606008344),new Cw(Yx[45],1432725776),new Cw(Yx[46],1467031594),new Cw(Yx[47],851169720),new Cw(Yx[48],3100823752),new Cw(Yx[49],1363258195),new Cw(Yx[50],3750685593),new Cw(Yx[51],3785050280),new Cw(Yx[52],3318307427),new Cw(Yx[53],3812723403),new Cw(Yx[54],2003034995),new Cw(Yx[55],3602036899),new Cw(Yx[56],1575990012),new Cw(Yx[57],1125592928),new Cw(Yx[58],2716904306),new Cw(Yx[59],442776044),new Cw(Yx[60],593698344),new Cw(Yx[61],3733110249),new Cw(Yx[62],2999351573),new Cw(Yx[63],3815920427),new Cw(3391569614,3928383900),new Cw(3515267271,566280711),new Cw(3940187606,3454069534),new Cw(4118630271,4000239992),new Cw(116418474,1914138554),new Cw(174292421,2731055270),new Cw(289380356,3203993006),new Cw(460393269,320620315),new Cw(685471733,587496836),new Cw(852142971,1086792851),new Cw(1017036298,365543100),new Cw(1126000580,2618297676),new Cw(1288033470,3409855158),new Cw(1501505948,4234509866),new Cw(1607167915,987167468),new Cw(1816402316,1246189591)];function Fw(e){return"SHA-384"===e?[new Cw(3418070365,Xx[0]),new Cw(1654270250,Xx[1]),new Cw(2438529370,Xx[2]),new Cw(355462360,Xx[3]),new Cw(1731405415,Xx[4]),new Cw(41048885895,Xx[5]),new Cw(3675008525,Xx[6]),new Cw(1203062813,Xx[7])]:[new Cw(Jx[0],4089235720),new Cw(Jx[1],2227873595),new Cw(Jx[2],4271175723),new Cw(Jx[3],1595750129),new Cw(Jx[4],2917565137),new Cw(Jx[5],725511199),new Cw(Jx[6],4215389547),new Cw(Jx[7],327033209)]}function Uw(e,t){let n,i,a,o,s,r,l,c,u,d,h,p;const m=[];for(n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],r=t[5],l=t[6],c=t[7],h=0;h<80;h+=1)h<16?(p=2*h,m[h]=new Cw(e[p],e[p+1])):m[h]=Pw(Rw(m[h-2]),m[h-7],Ow(m[h-15]),m[h-16]),u=Mw(c,Dw(s),(g=r,v=l,new Cw((f=s).N&g.N^~f.N&v.N,f.I&g.I^~f.I&v.I)),Lw[h],m[h]),d=Nw(jw(n),Tw(n,i,a)),c=l,l=r,r=s,s=Nw(o,u),o=a,a=i,i=n,n=Nw(u,d);var f,g,v;return t[0]=Nw(n,t[0]),t[1]=Nw(i,t[1]),t[2]=Nw(a,t[2]),t[3]=Nw(o,t[3]),t[4]=Nw(s,t[4]),t[5]=Nw(r,t[5]),t[6]=Nw(l,t[6]),t[7]=Nw(c,t[7]),t}let zw=class extends aw{constructor(e,t,n){if("SHA-384"!==e&&"SHA-512"!==e)throw new Error(Zx);super(e,t,n);const i=n||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=Wx(this.t,this.i,this.T),this.v=Uw,this.L=function(e){return e.slice()},this.B=Fw,this.F=function(t,n,i,a){return function(e,t,n,i,a){let o,s;const r=31+(t+129>>>10<<5),l=t+n;for(;e.length<=r;)e.push(0);for(e[t>>>5]|=128<<24-t%32,e[r]=4294967295&l,e[r-1]=l/Kx|0,o=0;o<e.length;o+=32)i=Uw(e.slice(o,o+32),i);return s="SHA-384"===a?[i[0].N,i[0].I,i[1].N,i[1].I,i[2].N,i[2].I,i[3].N,i[3].I,i[4].N,i[4].I,i[5].N,i[5].I]:[i[0].N,i[0].I,i[1].N,i[1].I,i[2].N,i[2].I,i[3].N,i[3].I,i[4].N,i[4].I,i[5].N,i[5].I,i[6].N,i[6].I,i[7].N,i[7].I],s}(t,n,i,a,e)},this.U=Fw(e),this.m=1024,this.R="SHA-384"===e?384:512,this.K=!1,i.hmacKey&&this.k(iw("hmacKey",i.hmacKey,this.T))}};const Hw=[new Cw(0,1),new Cw(0,32898),new Cw(2147483648,32906),new Cw(2147483648,2147516416),new Cw(0,32907),new Cw(0,2147483649),new Cw(2147483648,2147516545),new Cw(2147483648,32777),new Cw(0,138),new Cw(0,136),new Cw(0,2147516425),new Cw(0,2147483658),new Cw(0,2147516555),new Cw(2147483648,139),new Cw(2147483648,32905),new Cw(2147483648,32771),new Cw(2147483648,32770),new Cw(2147483648,128),new Cw(0,32778),new Cw(2147483648,2147483658),new Cw(2147483648,2147516545),new Cw(2147483648,32896),new Cw(0,2147483649),new Cw(2147483648,2147516424)],$w=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function Bw(e){let t;const n=[];for(t=0;t<5;t+=1)n[t]=[new Cw(0,0),new Cw(0,0),new Cw(0,0),new Cw(0,0),new Cw(0,0)];return n}function qw(e){let t;const n=[];for(t=0;t<5;t+=1)n[t]=e[t].slice();return n}function Gw(e,t){let n,i,a,o;const s=[],r=[];if(null!==e)for(i=0;i<e.length;i+=2)t[(i>>>1)%5][(i>>>1)/5|0]=Aw(t[(i>>>1)%5][(i>>>1)/5|0],new Cw(e[i+1],e[i]));for(n=0;n<24;n+=1){for(o=Bw(),i=0;i<5;i+=1)s[i]=(l=t[i][0],c=t[i][1],u=t[i][2],d=t[i][3],h=t[i][4],new Cw(l.N^c.N^u.N^d.N^h.N,l.I^c.I^u.I^d.I^h.I));for(i=0;i<5;i+=1)r[i]=Aw(s[(i+4)%5],Ew(s[(i+1)%5],1));for(i=0;i<5;i+=1)for(a=0;a<5;a+=1)t[i][a]=Aw(t[i][a],r[i]);for(i=0;i<5;i+=1)for(a=0;a<5;a+=1)o[a][(2*i+3*a)%5]=Ew(t[i][a],$w[i][a]);for(i=0;i<5;i+=1)for(a=0;a<5;a+=1)t[i][a]=Aw(o[i][a],new Cw(~o[(i+1)%5][a].N&o[(i+2)%5][a].N,~o[(i+1)%5][a].I&o[(i+2)%5][a].I));t[0][0]=Aw(t[0][0],Hw[n])}var l,c,u,d,h;return t}function Vw(e){let t,n,i=0;const a=[0,0],o=[4294967295&e,e/Kx&2097151];for(t=6;t>=0;t--)n=o[t>>2]>>>8*t&255,0===n&&0===i||(a[i+1>>2]|=n<<8*(i+1),i+=1);return i=0!==i?i:1,a[0]|=i,{value:i+1>4?a:[a[0]],binLen:8+8*i}}function Ww(e){return tw(Vw(e.binLen),e)}function Qw(e,t){let n,i=Vw(t);i=tw(i,e);const a=t>>>2,o=(a-i.value.length%a)%a;for(n=0;n<o;n++)i.value.push(0);return i.value}let Kw=class extends aw{constructor(e,t,n){let i=6,a=0;super(e,t,n);const o=n||{};if(1!==this.numRounds){if(o.kmacKey||o.hmacKey)throw new Error(ew);if("CSHAKE128"===this.o||"CSHAKE256"===this.o)throw new Error("Cannot set numRounds for CSHAKE variants")}switch(this.T=1,this.C=Wx(this.t,this.i,this.T),this.v=Gw,this.L=qw,this.B=Bw,this.U=Bw(),this.K=!1,e){case"SHA3-224":this.m=a=1152,this.R=224,this.M=!0,this.g=this.Y;break;case"SHA3-256":this.m=a=1088,this.R=256,this.M=!0,this.g=this.Y;break;case"SHA3-384":this.m=a=832,this.R=384,this.M=!0,this.g=this.Y;break;case"SHA3-512":this.m=a=576,this.R=512,this.M=!0,this.g=this.Y;break;case"SHAKE128":i=31,this.m=a=1344,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"SHAKE256":i=31,this.m=a=1088,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"KMAC128":i=4,this.m=a=1344,this.X(n),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"KMAC256":i=4,this.m=a=1088,this.X(n),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"CSHAKE128":this.m=a=1344,i=this.O(n),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"CSHAKE256":this.m=a=1088,i=this.O(n),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;default:throw new Error(Zx)}this.F=function(e,t,n,o,s){return function(e,t,n,i,a,o,s){let r,l,c=0;const u=[],d=a>>>5,h=t>>>5;for(r=0;r<h&&t>=a;r+=d)i=Gw(e.slice(r,r+d),i),t-=a;for(e=e.slice(r),t%=a;e.length<d;)e.push(0);for(r=t>>>3,e[r>>2]^=o<<r%4*8,e[d-1]^=2147483648,i=Gw(e,i);32*u.length<s&&(l=i[c%5][c/5|0],u.push(l.I),!(32*u.length>=s));)u.push(l.N),c+=1,0==64*c%a&&(Gw(null,i),c=0);return u}(e,t,0,o,a,i,s)},o.hmacKey&&this.k(iw("hmacKey",o.hmacKey,this.T))}O(e,t){const n=function(e){const t=e||{};return{funcName:iw("funcName",t.funcName,1,{value:[],binLen:0}),customization:iw("Customization",t.customization,1,{value:[],binLen:0})}}(e||{});t&&(n.funcName=t);const i=tw(Ww(n.funcName),Ww(n.customization));if(0!==n.customization.binLen||0!==n.funcName.binLen){const e=Qw(i,this.m>>>3);for(let t=0;t<e.length;t+=this.m>>>5)this.U=this.v(e.slice(t,t+(this.m>>>5)),this.U),this.A+=this.m;return 4}return 31}X(e){const t=function(e){const t=e||{};return{kmacKey:iw("kmacKey",t.kmacKey,1),funcName:{value:[1128353099],binLen:32},customization:iw("Customization",t.customization,1,{value:[],binLen:0})}}(e||{});this.O(e,t.funcName);const n=Qw(Ww(t.kmacKey),this.m>>>3);for(let i=0;i<n.length;i+=this.m>>>5)this.U=this.v(n.slice(i,i+(this.m>>>5)),this.U),this.A+=this.m;this.H=!0}_(e){const t=tw({value:this.h.slice(),binLen:this.u},function(e){let t,n,i=0;const a=[0,0],o=[4294967295&e,e/Kx&2097151];for(t=6;t>=0;t--)n=o[t>>2]>>>8*t&255,0===n&&0===i||(a[i>>2]|=n<<8*i,i+=1);return i=0!==i?i:1,a[i>>2]|=i<<8*i,{value:i+1>4?a:[a[0]],binLen:8+8*i}}(e.outputLen));return this.F(t.value,t.binLen,this.A,this.L(this.U),e.outputLen)}};class Yw{constructor(e,t,n){if("SHA-1"==e)this.P=new xw(e,t,n);else if("SHA-224"==e||"SHA-256"==e)this.P=new _w(e,t,n);else if("SHA-384"==e||"SHA-512"==e)this.P=new zw(e,t,n);else{if("SHA3-224"!=e&&"SHA3-256"!=e&&"SHA3-384"!=e&&"SHA3-512"!=e&&"SHAKE128"!=e&&"SHAKE256"!=e&&"CSHAKE128"!=e&&"CSHAKE256"!=e&&"KMAC128"!=e&&"KMAC256"!=e)throw new Error(Zx);this.P=new Kw(e,t,n)}}update(e){return this.P.update(e),this}getHash(e,t){return this.P.getHash(e,t)}setHMACKey(e,t,n){this.P.setHMACKey(e,t,n)}getHMAC(e,t){return this.P.getHMAC(e,t)}}const Xw=e=>{const t=new Yw("SHA-256","TEXT",{numRounds:1});return t.update(e),t.getHash("HEX")},Jw=()=>P(void 0,null,function*(){return yield Ox("/configs/")}),Zw=(e=!0)=>P(void 0,null,function*(){return yield Ox("/auths/",{baseURL:"/api/v1",toast:e})}),eS=e=>P(void 0,null,function*(){const t=Xw(e.password),n={email:e.email,password:t};return yield Ox("/auths/signin",{method:"POST",data:n})}),tS=e=>P(void 0,null,function*(){const t=Xw(e.password),n=C(_({},e),{password:t});return yield Ox("/auths/signup",{baseURL:"/api/v1",method:"POST",data:n})}),nS=e=>P(void 0,null,function*(){return yield Ox(`/users/logout/${e.userId}`,{method:"POST"})}),iS=()=>P(void 0,null,function*(){return yield Ox("/auths/signout").then(()=>P(void 0,null,function*(){let e=null;try{const{data:t}=(yield Jw())||{};e=t}catch(t){e=null}e&&(tx.getState().setConfig(e),aI.getState().fetchModels(!0))}))}),aS=e=>P(void 0,null,function*(){return yield Ox("/auths/reset/password",{baseURL:"/api/v1",method:"POST",data:e})}),oS=e=>P(void 0,null,function*(){const t=Xw(e.password),n=Xw(e.newPassword);return yield Ox("/auths/update/password",{method:"POST",data:{password:t,new_password:n}})}),sS=e=>P(void 0,null,function*(){return yield Ox("/auths/update/profile",{method:"POST",data:e})}),rS=e=>P(void 0,null,function*(){return yield Ox("/auths/resendactivationemail",{method:"POST",data:e})}),lS=()=>P(void 0,null,function*(){return yield Ox("/chats/",{method:"DELETE"})}),cS=()=>P(void 0,null,function*(){return yield Ox("/chats/all")}),uS=e=>P(void 0,null,function*(){return yield zx(),yield Ox("/chats/",{params:e})}),dS=()=>P(void 0,null,function*(){return yield Ox("/chats/pinned")}),hS=e=>P(void 0,null,function*(){return yield Ox("/chats/search",{params:e})}),pS=(e,t)=>P(void 0,null,function*(){var n;const i=C(_({},t),{toast:null!=(n=null==t?void 0:t.toast)?n:!bx()});return yield zx(),yield Ox(`/chats/${e.chat_id}`,i)}),mS=e=>P(void 0,null,function*(){const{chat_id:t,chat:n}=e,{title:i,tags:a,history:o,permission:s}=n||{},{currentId:r,currentResponseIds:l}=o||{},c={};return i&&(c.title=i),r&&(c.currentId=r),l&&(c.currentResponseIds=l),a&&(c.tags=a),s&&(c.permission=s),yield Ox(`/chats/${t}`,{method:"POST",data:c})}),fS=e=>P(void 0,null,function*(){return yield Ox(`/chats/${e.chat_id}/folder`,{method:"POST",data:{folder_id:e.folder_id}})}),gS=e=>P(void 0,null,function*(){return yield Ox(`/chats/${e.chat_id}/messages/${e.message_id}`,{method:"POST",data:{content:e.content,content_list:e.content_list}})}),vS=e=>P(void 0,null,function*(){const t=new FormData;return t.append("file",e.file),yield Ox("/chats/import",{method:"POST",headers:{"Content-Type":"multipart/form-data"},transformRequest:[e=>e],data:t})}),yS=e=>P(void 0,null,function*(){return yield Ox(`/chats/folder/${e.folder_id}`)}),bS=()=>P(void 0,null,function*(){return yield Ox("/chats/all/archived")}),xS=()=>P(void 0,null,function*(){return yield Ox("/chats/archive/all",{method:"POST"})}),wS=()=>P(void 0,null,function*(){return yield Ox("/chats/archived")}),SS=e=>P(void 0,null,function*(){return yield Ox(`/chats/${e||"all"}/archive`,{method:"POST"})}),_S=e=>P(void 0,null,function*(){return yield Ox(`/chats/${e}`,{method:"DELETE"})}),CS=e=>P(void 0,null,function*(){return yield Ox(`/chats/${e}/pin`,{method:"POST"})}),ES=e=>P(void 0,null,function*(){return yield Ox(`/chats/${e}/clone`,{method:"POST"})}),kS=e=>P(void 0,null,function*(){return yield Ox(`/chats/${e}/share`,{method:"DELETE"})}),IS=e=>P(void 0,null,function*(){return yield Ox("/filter/content",{baseURL:"/api",method:"POST",data:e})}),TS=e=>P(void 0,null,function*(){return yield Ox("/share/message/cancel",{method:"POST",data:{share_id:e.id}})}),jS=e=>P(void 0,null,function*(){return yield zx(),yield Ox(`/chats/${e.chatId}/check`,{method:"GET"})}),NS=()=>{const e=location.pathname,t={[String("/"===e)]:{spmB:"29997169",pageId:`//${window.location.host}/`},[String("/c/new-chat"===e)]:{spmB:"29997170",pageId:`//${window.location.host}/c/new-chat`},[String("/c/new-branch"===e)]:{spmB:"29997171",pageId:`//${window.location.host}/c/new-branch`},[String(e.startsWith("/c/")&&"/c/new-branch"!==e&&"/c/new-chat"!==e)]:{spmB:"29997173",pageId:`//${window.location.host}/c/`},[String(e.startsWith("/s/"))]:{spmB:"29997178",pageId:`//${window.location.host}/s/`},[String(e.startsWith("/p/"))]:{spmB:"41591450",pageId:`//${window.location.host}/p/`},[String("/auth"===e)]:{spmB:"29997180",pageId:`//${window.location.host}/auth`},[String("/authorize"===e)]:{spmB:"30620387",pageId:`//${window.location.host}/authorize`},[String("/error"===e||e.startsWith("/error"))]:{spmB:"29997183",pageId:`//${window.location.host}/error`},[String("/legal-agreement/privacy-policy"===e||e.startsWith("/legal-agreement/privacy-policy"))]:{spmB:"29997187",pageId:`//${window.location.host}/legal-agreement/privacy-policy`},[String("/legal-agreement/terms-of-service"===e||e.startsWith("/legal-agreement/terms-of-service"))]:{spmB:"29997190",pageId:`//${window.location.host}/legal-agreement/terms-of-service`},[String("/forget"===e||e.startsWith("/forget"))]:{spmB:"29997194",pageId:`//${window.location.host}/forget`},[String("/reset"===e||e.startsWith("/reset"))]:{spmB:"29997199",pageId:`//${window.location.host}/reset`},[String(e.startsWith("/mobile/chat"))]:{spmB:"29997173",pageId:`//${window.location.host}/mobile/chat`},[String(e.startsWith("/settings/general"))]:{spmB:"30233031",pageId:`//${window.location.host}/settings/general`},[String(e.startsWith("/settings/interface"))]:{spmB:"30233032",pageId:`//${window.location.host}/settings/interface`},[String(e.startsWith("/settings/privacy-policy"))]:{spmB:"29997187",pageId:`//${window.location.host}/settings/privacy-policy`},[String(e.startsWith("/settings/terms-of-service"))]:{spmB:"29997190",pageId:`//${window.location.host}/settings/terms-of-service`},[String(e.startsWith("/settings/model"))]:{spmB:"30233033",pageId:`//${window.location.host}/settings/model`},[String(e.startsWith("/settings/chats"))]:{spmB:"30233034",pageId:`//${window.location.host}/settings/chats`},[String(e.startsWith("/settings/personalization/memory"))]:{spmB:"30233038",pageId:`//${window.location.host}/settings/personalization/memory`},[String(e.startsWith("/settings/personalization/custom-instr"))]:{spmB:"30233039",pageId:`//${window.location.host}/settings/personalization/custom-instr`},[String("/settings/personalization"===e)]:{spmB:"30233035",pageId:`//${window.location.host}/settings/personalization`},[String(e.startsWith("/settings/account"))]:{spmB:"30233036",pageId:`//${window.location.host}/settings/account`},[String(e.startsWith("/settings/about"))]:{spmB:"30233037",pageId:`//${window.location.host}/settings/about`},[String(e.startsWith("/settings/languages"))]:{spmB:"30233051",pageId:`//${window.location.host}/settings/languages`},[String(e.startsWith("/settings/theme"))]:{spmB:"30233052",pageId:`//${window.location.host}/settings/theme`},[String(e.startsWith("/settings/voice"))]:{spmB:"30233053",pageId:`//${window.location.host}/settings/voice`},[String(e.startsWith("/settings/contact-us"))]:{spmB:"30233054",pageId:`//${window.location.host}/settings/contact-us`},[String(e.startsWith("/settings/change-password"))]:{spmB:"30233055",pageId:`//${window.location.host}/settings/change-password`},[String("/settings"===e)]:{spmB:"30233050",pageId:`//${window.location.host}/settings`}};return t.true||{spmB:"not exist",pageId:"not exist"}},PS=e=>{const t=window.location.search.slice(1);if(!t)return null;return new URLSearchParams(t).get(e)||null},MS=()=>window.userId||"";let AS=window.aes||null;const RS=window.location.host;let OS=[],DS=[],LS=null,FS=null,US=null;const zS={"internal-qwenlm.alibaba-inc.com":"prod","chat.qwenlm.ai":"prod","qwenlm.ai":"prod","qwen.ai":"prod","chat.qwen.ai":"prod","qwenchat.com":"prod","pre-chat.qwenlm.ai":"pre","pre-qwenlm.alibaba-inc.com":"pre","pre-chat.qwen.ai":"pre","pre2-chat.qwen.ai":"pre","pre2-chat.qwenlm.ai":"pre","dev.aliyun.com":"dev"}[RS]||"dev";LS=setInterval(()=>{if(AS){clearInterval(LS),FS=AS.use(window.AESPluginEvent),US=AS.use(window.AESPluginPV,{autoPV:!1,enableHistory:!0});for(let e=0;e<DS.length;e++)US.switchPage({page_id:DS[e].page_id,dim1:DS[e].userId});DS=[];for(let e=0;e<OS.length;e++)FS(OS[e].eventId,OS[e].params);OS=[]}else AS=window.aes},500);const HS=(e,t)=>{const{params:n,aesParams:i}=t||{};AS&&FS?FS(e,C(_(_({c1:MS()},n),i),{c10:"0.2.8"})):OS.push({eventId:e,params:_({c1:MS()},n)})},$S=e=>{var t,n;const i=window.aplus_queue||(window.aplus_queue=[]),a={};if(a.typarm1=fx()?"app":wx()?"desktop":"pc"===ux()?"web":"h5",a.typarm2=e||MS(),i.push({action:"aplus.setUserProfile",arguments:[{uidaplus:e||MS()}]}),a.typarm3=zS,a.typarm4="qwen_chat",a.typarm5=location.pathname.startsWith("/s/")?"share":"product",a.orgid="tongyi",(null==(t=NS())?void 0:t.pageId)===`//${window.location.host}/s/`){const e=location.pathname.replace(/\/s\//g,"");a.share_id=e.replace(/\//g,"")}if((null==(n=NS())?void 0:n.pageId)===`//${window.location.host}/p/`){const e=location.pathname.replace(/\/p\//g,"");a.project_id=e.replace(/\//g,"")}return PS("qsrc")&&(a.channel_type=PS("qsrc")),"share"===PS("qsrc")&&PS("share_id")&&(a.from_id=PS("share_id")),a.cdn_version="0.2.8",a},BS=(e,t)=>{((e,t)=>{const{params:n,paramsExtend:i}=t,{et:a}=n,o=$S(),s=_(_(_({},o),n),i);let r="";for(const c in s){const e=s[c];"et"!==c&&e&&(r+=`&${c}=${e}`)}let l=a;"OTHER"===a&&(l="self_define"),(window.aplus_queue||(window.aplus_queue=[])).push({action:"aplus.record",arguments:[`/tongyi-sg.qwen_chat.${e}`,l,r]})})(e,t),HS(e,t)},qS=e=>{var t,n;if(((e="a2ty_o01")=>{const{spmB:t}=NS()||{};if(!t)return;(window.aplus_queue||(window.aplus_queue=[])).push({action:"aplus.setPageSPM",arguments:[e,`${t}`]})})(),bx())return;(e=>{let t=$S(e);t=_({},t),(window.aplus_queue||(window.aplus_queue=[])).push({action:"aplus.appendMetaInfo",arguments:["aplus-cpvdata",t]})})(e||""),(window.aplus_queue||(window.aplus_queue=[])).push({action:"aplus.sendPV",arguments:[{is_auto:!1},{}]});const{spmB:i,pageId:a}=NS()||{};var o;o=C(_({},$S(e)),{spmId:`a2ty_o01.${i}`,aemPageId:a,domain:RS}),P(void 0,null,function*(){return yield Ox("/users/status",{method:"POST",data:{typarms:o}})}),AS&&US?US.switchPage({page_id:null==(n=NS())?void 0:n.pageId,dim1:e||""}):DS.push({userId:e||"",page_id:null==(t=NS())?void 0:t.pageId})},GS=e=>P(void 0,null,function*(){return yield Ox("/chat/completions/stop",{method:"post",params:{chat_id:e.chat_id},headers:{"X-Accel-Buffering":"no"},data:e})}),VS=e=>P(void 0,null,function*(){return yield zx(),yield Ox("files/getfilelink",{method:"POST",data:e})}),WS=e=>P(void 0,null,function*(){return yield Ox("/folders/",{method:"POST",data:e})}),QS=e=>P(void 0,null,function*(){return yield Ox(`/folders/${e.id}/update`,{method:"POST",data:{name:e.name}})}),KS=e=>P(void 0,null,function*(){return yield Ox(`/folders/${e.id}/update/expanded`,{method:"POST",data:{is_expanded:e.is_expanded}})}),YS=e=>P(void 0,null,function*(){return yield Ox(`/folders/${e.id}/update/parent`,{method:"POST",data:{parent_id:e.parent_id}})}),XS=e=>P(void 0,null,function*(){return yield Ox(`/folders/${e.id}`,{method:"DELETE"})}),JS=(...e)=>P(void 0,[...e],function*(e={page_size:50,page_num:1}){return yield Ox(`memories/?page_size=${e.page_size}&page_num=${e.page_num}`,{method:"GET"})}),ZS=e=>P(void 0,null,function*(){return yield Ox("/memories/delete",{method:"POST",data:e})}),e_=e=>P(void 0,null,function*(){const t=(()=>{const e={os_group:_x()};return fx()?(e.terminal_type="app",e.app_version=yx()):ox()?e.terminal_type="h5":e.terminal_type="web",e})();return yield Ox("/users/user/audio_chat_token",{method:"POST",data:C(_({},e),{client_info:t})})}),t_=e=>P(void 0,null,function*(){return yield Ox("/users/user/settings/update",{method:"POST",data:e})}),n_=e=>P(void 0,null,function*(){const t=Xw(null==e?void 0:e.new_password);return yield Ox("/users/reset/password",{baseURL:"/api/v1",method:"POST",data:C(_({},e),{new_password:t})})}),i_=(e,t)=>P(void 0,null,function*(){return yield Ox(`/projects/${t}`,{method:"PUT",data:e})}),a_=e=>P(void 0,null,function*(){return yield Ox(`/projects/${e}/files`)}),o_=(e,t)=>P(void 0,null,function*(){return yield Ox(`/chats/?project_id=${e}&page=${t}`)}),s_=(e,t)=>P(void 0,null,function*(){return yield Ox("/projects/add_chat",{method:"POST",data:JSON.stringify({chat_ids:t,project_id:e})})}),r_=e=>P(void 0,null,function*(){return yield Ox(`/projects/${e}`)}),l_=(...e)=>P(void 0,[...e],function*(e=window.location.origin){return yield Ox("/payment/subscribe",{method:"POST",data:{root_path:e}})}),c_=(...e)=>P(void 0,[...e],function*(e=window.location.origin){return yield Ox("/payment/compensation_subscription",{method:"POST",data:{root_path:e}})}),u_=e=>P(void 0,null,function*(){return yield Ox(`/payment/payment_status?payment_request_id=${e}`)}),d_=()=>P(void 0,null,function*(){return yield Ox("/payment/cancel_subscription",{method:"POST"})}),h_=()=>P(void 0,null,function*(){return yield Ox("/payment/active_subscription",{method:"POST"})}),p_=()=>P(void 0,null,function*(){return yield Ox("/payment/payment_method")}),m_=(...e)=>P(void 0,[...e],function*(e=window.location.origin){return yield Ox("/payment/add_payment_method",{method:"POST",data:{root_path:e}})}),f_=e=>P(void 0,null,function*(){return yield Ox(`/payment/add_payment_method_status?vaulting_request_id=${e}`)}),g_=e=>P(void 0,null,function*(){return yield Ox("/payment/update_default_method",{method:"POST",data:{payment_method_id:e}})}),v_=e=>P(void 0,null,function*(){return yield Ox("/payment/delete_payment_method",{method:"POST",data:{payment_method_id:e}})}),y_=(e=1,t=10)=>P(void 0,null,function*(){return yield Ox(`/payment/invoice?page_no=${e}&page_size=${t}`)}),b_=e=>P(void 0,null,function*(){return yield Ox("/notifications/delete_notification",{method:"POST",data:{types:e}})}),x_=()=>P(void 0,null,function*(){return yield Ox("/payment/clear",{method:"POST",data:{}})}),w_=()=>P(void 0,null,function*(){return yield Ox("/payment/disable_default_payment_method",{method:"POST",data:{}})}),S_=()=>{var e;return(null==(e=window.performance)?void 0:e.now)?window.performance.now():Date.now()};const __=e=>{var t;let n=!1;const i=document.createElement("div");i.id="selectableDiv",i.textContent=e,i.style.top="0",i.style.left="0",i.style.position="fixed",document.body.appendChild(i);try{const e=window.getSelection(),a=document.createRange();a.selectNodeContents(i),null==e||e.removeAllRanges(),null==e||e.addRange(a);document.execCommand("copy")&&(n=!0),null==(t=null==window?void 0:window.getSelection())||t.removeAllRanges(),i.blur()}catch(GY){}finally{document.body.removeChild(i)}return n},C_=e=>P(void 0,null,function*(){let t=!1;const n=function(){const e=navigator.userAgent||navigator.vendor||window.opera||"";return/DingTalk/i.test(e)}();if(!navigator.clipboard||n)return t=__(e),t;try{yield navigator.clipboard.writeText(e),t=!0}catch(i){try{const n=new ClipboardItem({"text/plain":new Blob([e],{type:"text/plain"})});yield navigator.clipboard.write([n]),t=!0}catch(a){t=__(e)}}return t}),E_=(e,...t)=>P(void 0,[e,...t],function*(e,t=sv("Copying to clipboard was successful!")){(yield C_(e))&&ut.open({type:"success",content:t})});function k_(e,t=null){try{return JSON.parse(e)}catch(qY){return t}}const I_=e=>{var t;return!!(null==(t=null==e?void 0:e.meta)?void 0:t.translateLanguage)},T_=(e,t)=>{const n=e=>"string"!=typeof e?e:e.includes(",")||e.includes('"')||e.includes("\n")?`"${e.replace(/"/g,'""')}"`:e,i=e.header.map(e=>e.tokens.map(e=>n(e.text)).join("")),a=e.rows.map(e=>e.map(e=>e.tokens.map(e=>n(e.text)).join(""))),o=i.join(","),s=a.map(e=>e.join(",")).join("\n"),r=new Blob(["\ufeff"+o+"\n"+s],{type:"text/csv;charset=UTF-8"});ax(r,t)},j_=(e,t)=>P(void 0,null,function*(){const n=e.header.map(e=>e.text),i=e.rows.map(e=>{const t={};return e.forEach((e,i)=>{t[n[i]]=e.text}),t}),a=Lt.json_to_sheet(i),o=Lt.book_new();Lt.book_append_sheet(o,a),Lt.sheet_add_aoa(a,[n],{origin:"A1"});const s=e=>{let t=0;for(let n=0;n<e.length;n++){t+=e.charCodeAt(n)<=127?1:2.5}return t},r=n.map(e=>({wch:Math.max(10,Math.min(30,Math.max(s(e),...i.map(t=>s(t[e])))))}));a["!cols"]=r,Ft(o,`${t}`,{compression:!0})});function N_(e){return e?Y(1e3*e).format("DD/MM/YYYY HH:mm"):""}function P_(e){try{const t=new URL(e),n=t.pathname.split("/").pop(),i=null==n?void 0:n.split(".").pop();return i===n?"":null==i?void 0:i.toLowerCase()}catch(qY){return""}}const M_=(e,t)=>P(void 0,null,function*(){var n;const i=new File([e],t,{lastModified:(new Date).getTime()}),a=yield(e=>P(void 0,null,function*(){const t=new FormData;t.append("file",e);let n=null;const i=yield Ox(`${Hf}/files/`,{method:"POST",data:t}).then(e=>P(void 0,null,function*(){if(!e.ok)throw yield e.json();return e.json()})).catch(e=>(n=e.detail,null));if(n)throw n;return i}))(i);if(a.error)throw a.error;const o=`${Hf}/files/${a.id}/content`;null==(n=window.open(o,"_self"))||n.focus()}),A_=e=>{if(null==e)return"Unknown size";if("number"!=typeof e||e<0)return"Invalid size";if(0===e)return"0 B";const t=["B","KB","MB","GB","TB"];let n=0;for(;e>=1024&&n<t.length-1;)e/=1024,n++;return`${e.toFixed(1)} ${t[n]}`};class R_{constructor(e,t){k(this,"extensions"),k(this,"fileTypes"),this.extensions=e,this.fileTypes=t}getAcceptSuffix(){const e=[...this.extensions].map(e=>`.${e}`);return e.push(...this.fileTypes),e}}class O_ extends R_{constructor(){super([...jg,...Cg],[..._g,...yg])}}class D_ extends R_{constructor(){super(Eg,bg)}getAcceptSuffix(){let e=super.getAcceptSuffix();const t=["image/tiff",".tif",".tiff",".dib"],n=[".dib"];return rx()&&(e=e.filter(e=>!n.includes(e))),cx()&&(e=e.filter(e=>!t.includes(e))),e}}class L_ extends R_{constructor(){super(kg,xg)}}class F_ extends R_{constructor(){super(Ig,wg)}}const U_=e=>{let t,n=[];switch(e){case"document":t=new O_,n=t.getAcceptSuffix();break;case"vision":t=new D_,n=t.getAcceptSuffix();break;case"video":t=new L_,n=t.getAcceptSuffix();break;case"audio":t=new F_,n=t.getAcceptSuffix();break;case"camera":n=["image/*"]}return n},z_=(e,t)=>{if("web"===e||!e)return"web";const n=P_(t||"");return n?Cg.includes(n)?"txt":jg.includes(n)?"doc":Ig.includes(n)?"audio":kg.includes(n)?"video":Eg.includes(n)?"vision":n:"web"},H_=(e,t,n)=>P(void 0,null,function*(){try{return yield Ox("/files/share_url",{method:"POST",headers:{"Content-Type":"application/json",authorization:localStorage.token?`Bearer ${localStorage.token}`:"Bearer"},data:{file_source:e,cdn_url:t,file_id:n},baseURL:Hf})}catch(GY){}return null}),$_=e=>!!e.includes("/api/v1/files"),B_=e=>!!e.includes("?key="),q_=e=>!!e.includes("x-oss-expires"),G_=(e,t,n)=>P(void 0,null,function*(){let i;if("user"===e){if(!$_(t))return t;i=yield H_("upload","",n)}else{if(B_(t))return t;i=yield H_("generate",t,"")}return(null==i?void 0:i.url)||""}),V_=(e,t)=>{e.forEach(e=>{const t=e.substring(e.lastIndexOf("/")+1);try{const n=document.createElement("a");n.href=e,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),e.startsWith("blob:")&&window.URL.revokeObjectURL(e)}catch(n){}})},W_=e=>P(void 0,null,function*(){return yield fetch(e).then(e=>e.blob()).then(e=>{const t=window.URL.createObjectURL(e);try{return V_([t]),!0}catch(n){return!1}}).catch(e=>!1)});let Q_=!1;const K_=e=>P(void 0,[e],function*({role:e="",url:t,isFile:n=!1,errorTexts:i}){if(!t&&i)return ut.openOnce({type:"error",content:(null==i?void 0:i.urlError)||sv("Download failed: url error")}),!1;try{if($_(t))t.startsWith("https://")||(t=`${t}/content`);else if(q_(t)){const{success:e,data:n}=yield VS({fileUrl:t});if(!e||!(null==n?void 0:n.fileUrl))return!1;t=n.fileUrl}else{B_(t)||(t=yield G_(e,t));const n=new URL(t);n.searchParams.append("download","true"),n.searchParams.append("timestamp",Date.now().toString()),t=n.toString()}if(!Q_&&fx()){if(n)return!1;Q_=!0}if(!(yield(e=>P(void 0,null,function*(){try{const t=yield fetch(e);if(!t.ok)throw new Error(t.statusText);return!0}catch(t){return!1}}))(t)))return ut.openOnce({type:"error",content:sv("Download failed")}),!1;const i=document.createElement("a");i.href=t;const a=null==t?void 0:t.toString().match(/[^/\\?]+(?=\?|$)/),o=a?decodeURIComponent(a[0]):null;return o&&(i.download=o),document.body.appendChild(i),i.click(),t.startsWith("blob:")&&window.URL.revokeObjectURL(t),document.body.removeChild(i),!0}catch(a){return i&&ut.openOnce({type:"error",content:(null==i?void 0:i.downloadError)||sv("Download failed")}),!1}}),Y_=e=>{var t,n;if(!e.currentId)return!1;const i=e.messages[e.currentId];if("assistant"!==(null==i?void 0:i.role))return!1;const a=null==i?void 0:i.content_list;if(!Array.isArray(a))return!1;const o=null==(t=a.slice(-1))?void 0:t[0];return(null==o?void 0:o.phase)===ng.LOCAL_TOOL&&(null==(n=null==o?void 0:o.extra)?void 0:n.local_mcp)},X_=[{name:"Fetch",type:"stdio",params:{command:"uvx",args:["mcp-server-fetch"]},description:"This server enables large language models to retrieve and process content from web pages, and convert HTML to markdown for easier use."},{name:"Filesystem",type:"stdio",params:{command:"npx",args:["-y","@modelcontextprotocol/server-filesystem@latest","/Users"]},description:"A model context protocol (MCP) implemented for file system operations."},{name:"Sequential-Thinking",type:"stdio",params:{command:"npx",args:["-y","@modelcontextprotocol/server-sequential-thinking"]},description:"An MCP server implementation that provides tools for dynamic and reflective problem-solving through a structured thinking process."}],J_=()=>X_.map(({name:e,type:t,params:n,description:i})=>({id:ot(),name:e,description:i,type:t,params:n,enabled:!1,default:!0,connectionStatus:"failed",errorMessage:"",tools:[]})),Z_=Uf(),eC="LOCAL_MCP_SERVER",tC={initDefaultMCPServers:()=>{const e=tC.getMCPServers(),t=e.filter(e=>!!e.default),n=e.filter(e=>!e.default),i=J_();return i.forEach(e=>{t.find(t=>{t.name===e.name&&(e.id=t.id,e.enabled=t.enabled,e.connectionStatus=t.connectionStatus,e.tools=t.tools)})}),window.localStorage.setItem(eC,JSON.stringify([...i,...n])),i},getMCPServer:e=>{const t=tC.getMCPServers(),n=t.findIndex(t=>t.name===e);return t[n]},getMCPServerById:e=>{const t=tC.getMCPServers(),n=t.findIndex(t=>t.id===e);return t[n]},getMCPServers:()=>JSON.parse(window.localStorage.getItem(eC)||"[]"),getEnabledServers:()=>tC.getMCPServers().filter(e=>e.enabled),getFormatAvailableServerMap:()=>tC.getEnabledServers().filter(e=>"available"===e.connectionStatus).reduce((e,t)=>{const n=t.tools.reduce((e,t)=>t?C(_({},e),{[t.name]:{description:t.description,input_schema:t.inputSchema}}):e,{});return C(_({},e),{[t.name]:n})},{}),addMCPServer:e=>{const t=tC.getMCPServers();t.push(e),window.localStorage.setItem(eC,JSON.stringify(t))},removeMCPServer:e=>{const t=tC.getMCPServers(),n=t.findIndex(t=>t.id===e);n>-1&&t.splice(n,1),window.localStorage.setItem(eC,JSON.stringify(t))},updateMCPServer:(e,t)=>{const n=tC.getMCPServers(),i=n.findIndex(t=>t.id===e);i>-1&&(Object.assign(n[i],t),window.localStorage.setItem(eC,JSON.stringify(n)))}},nC=e=>{const t=e.match(/Error invoking remote method '.+': (.*)/);let n=(null==t?void 0:t[1])||e||"Tool call failed";return tC.getMCPServers().forEach(e=>{n.includes(e.id)&&(n=n.replace(e.id,e.name))}),n},iC={connect:(...e)=>P(void 0,[...e],function*(e=[]){const t=[];if(!wx())return t;const n=tC.getEnabledServers(),i=[];e.length?i.push(...n.filter(t=>e.includes(t.name))):i.push(...n.filter(e=>"failed"!==e.connectionStatus));const a=i.reduce((e,t)=>{const{type:n,name:i,params:a}=t;return C(_({},e),{[i]:C(_({name:i},a),{transportType:n})})},{});try{yield window.electronAPI.mcp_client_update_config(a);const e=[],n=[];i.forEach(t=>{e.push(t.id),n.push(window.electronAPI.mcp_client_tool_list(t.name))});(yield Promise.allSettled(n)).forEach((n,i)=>{var a;const{status:o}=n;if("fulfilled"===o&&n.value.tools&&Array.isArray(n.value.tools))tC.updateMCPServer(e[i],{tools:n.value.tools,connectionStatus:"available"});else{const s=tC.getMCPServerById(e[i]);if(s){const r="rejected"===o?null==(a=n.reason)?void 0:a.message:Z_.t("Failed to connect to the MCP server.");tC.updateMCPServer(e[i],{connectionStatus:"failed",errorMessage:nC(r||"")}),t.push(s)}}})}catch(qY){t.push(...i)}return t}),isAvailable:e=>P(void 0,null,function*(){if(!wx())return;const{id:t,type:n,name:i,params:a}=e,o={connectionStatus:"connecting",errorMessage:""};try{const e={[i]:C(_({},a),{transportType:n})};yield window.electronAPI.mcp_client_update_config(e);const{tools:s}=yield window.electronAPI.mcp_client_tool_list(i),r=Array.isArray(s)?"available":"failed";o.connectionStatus=r,"available"===r?tC.updateMCPServer(t,{tools:s}):o.errorMessage=Z_.t("Failed to connect to the MCP server.")}catch(s){o.connectionStatus="failed",o.errorMessage=nC((null==s?void 0:s.message)||"")}tC.updateMCPServer(t,o)}),callTool:e=>P(void 0,null,function*(){if(wx())try{return yield window.electronAPI.mcp_client_tool_call(e)}catch(t){return{content:nC((null==t?void 0:t.message)||"")}}})},aC=_(_({},tC),iC),oC=e=>P(void 0,null,function*(){if(bT())return;const{onlyLocal:t,updateData:n}=e||{},i=cT.getState().settings,a=cT.getState().mcpSettingList,o=cT.getState().setMcpSettingList,s=cT.getState().setSettings;if(t){const e=a.filter(e=>!e.type);o([...aC.getMCPServers(),...e])}else if(n){const e=a.findIndex(e=>e.id===n.id),t=Et({},a[e],n),r=[...a];if(r[e]=t,o(r),!t.type&&"enabled"in n){const{success:e,data:t}=yield t_(C(_({},i),{mcp:C(_({},i.mcp),{[n.id]:n.enabled})}));e&&s(t)}}else{const e=aC.initDefaultMCPServers();if(location.pathname.includes("settings"))for(let n=0;n<e.length;n++){const t=e[n];"failed"!==t.connectionStatus&&0!==t.tools.length||(yield aC.isAvailable(t))}const[t]=yield Promise.all([P(void 0,null,function*(){const e=Uf();return yield Ox(`/mcp/list?language=${e.language}`)})]);if(t.success){const e=Object.keys(t.data).map(e=>{var n,a,o,s;return{id:e,name:(null==(n=t.data[e])?void 0:n.name)||"",description:(null==(a=t.data[e])?void 0:a.description)||"",tools:((null==(o=t.data[e])?void 0:o.tools)||[]).map(e=>Object.keys(e).map(t=>{var n;return{name:t,description:(null==(n=e[t])?void 0:n.description)||""}})[0]),enabled:(null==(s=null==i?void 0:i.mcp)?void 0:s[e])||!1,connectionStatus:"available"}});o([...aC.getMCPServers(),...e])}}}),sC=(e,t)=>{var n;if(null===e)return[];const i=null==(n=null==t?void 0:t.messages)?void 0:n[e];return i?(null==i?void 0:i.parentId)?[...sC(i.parentId,t),i]:[i]:[]},rC=e=>P(void 0,null,function*(){const t=e.chat.history;return sC(t.currentId,t).reduce((e,t)=>{var n;if("assistant"===t.role)if(t.content_list&&Array.isArray(t.content_list)){const e=null==(n=t.content_list)?void 0:n.find(e=>(null==e?void 0:e.phase)===ng.ANSWER||(null==e?void 0:e.phase)===ng.DEEPTHINKING);t.content=(null==e?void 0:e.content.replace(/\[\[\d+\]\]/g,""))||""}else t.content=t.content.replace(/\[\[\d+\]\]/g,"")||"";return`${e}### ${t.role.toUpperCase()}\n${t.content}\n\n`},"").trim()}),lC=e=>{const t=e.content_list;if(!t)return e;const n=[ng.ANSWER,ng.SLIDES],i=[ng.THINK,ng.THINKING_SUMMARY];let a=0;return t.forEach((e,o)=>{var s,r,l;const c=t[o-1],u="function"===e.role||!!e.function_id;(0!==o&&(n.includes(e.phase)||n.includes(null==(s=t[o-1])?void 0:s.phase))||u&&"answer"===(null==(r=e.extra)?void 0:r.display_position)||"answer"===(null==(l=null==c?void 0:c.extra)?void 0:l.display_position)&&i.includes(e.phase))&&a++,e.groupIndex=a}),e},cC=e=>{const t=Object.values(e.messages||{}),n=t.find(t=>t.id===e.currentId),i=(null==n?void 0:n.chat_type)||Zf.Txt2Txt;return t.forEach(e=>{e.fid=e.fid||e.id||"",e.parentId=e.parentId||e.parent_id||null}),t.forEach(e=>{e.childrenIds=t.filter(t=>t.parentId===e.id).map(e=>e.id||"")}),t.forEach(e=>{if(e.parentId){const n=t.find(t=>t.id===e.parentId);n&&(!e.extra&&n.extra&&(e.extra=n.extra),!e.feature_config&&n.feature_config&&(e.feature_config=n.feature_config))}}),t.forEach(e=>{var t,n,i,a,o,s;(null==(i=null==(n=null==(t=e.content_list)?void 0:t[0])?void 0:n.extra)?void 0:i.web_search_info)&&(e.webSearchInfo=null==(s=null==(o=null==(a=e.content_list)?void 0:a[0])?void 0:o.extra)?void 0:s.web_search_info)}),t.forEach(e=>{e.chat_type&&e.chat_type===Zf.Image2Video&&(e.chat_type=Zf.VideoGeneration,"assistant"===e.role&&(e.sub_chat_type=Zf.VideoGeneration))}),(i===Zf.VideoGeneration&&!(null==n?void 0:n.content)&&!(null==n?void 0:n.error)||Y_(e))&&(n.done=!1),t.forEach(e=>{"assistant"===e.role&&lC(e)}),C(_({},e),{messages:t.reduce((e,t)=>(t.id&&(e[t.id]=t),e),{})})};function uC(){const e=document.getElementById("app-container");e&&!fx()&&(e.style.height=window.innerHeight+"px")}const dC=()=>P(void 0,null,function*(){const{setCurrentChatPage:e}=Wb.getState();e(1),yield P(void 0,null,function*(){try{const e=Wb.getState().currentChatPage,t=yE.getState().sideBarSearchText,n=e,i=t,{data:a}=i?yield hS({text:i,page:n}):yield uS({page:n,exclude_project:!0});"ERR_NETWORK"!==(null==a?void 0:a.code)&&Kb.setState({chats:a})}catch(e){}})}),hC=()=>P(void 0,null,function*(){const e=fT.getState().activeProjectId,t=fT.getState().setProjectExpandChats;if(!e)return;const n=yield o_(e,1);n.success&&Array.isArray(n.data)&&t(n.data)}),pC=e=>{let t=e;return t===Zf.Image2Video&&(t=Zf.VideoGeneration),t},mC=e=>P(void 0,null,function*(){const t=yield(e=>P(void 0,null,function*(){return yield Ox("/task/suggestions/completions",{method:"POST",data:e})}))(e).catch(e=>[]);return t});function fC(e,t,n=""){if(jt(n))return e;if(Array.isArray(null==e?void 0:e.sortKeys)||(e.sortKeys=[]),t in e){if("string"==typeof n){const i="string"==typeof e[t]?e[t]:"";e[t]=i+n}else if(Nt(n)){const i=e[t]||{};e[t]=function(e,t){const n={};for(const i in _(_({},e),t))Object.prototype.hasOwnProperty.call(e,i)&&Object.prototype.hasOwnProperty.call(t,i)?n[i]=e[i]+t[i]:Object.prototype.hasOwnProperty.call(e,i)?n[i]=e[i]:n[i]=t[i];return n}(i,n)}}else e[t]=n,e.sortKeys.push(t);return e}const gC=(e=[],t)=>{const n=new Set(e.map(e=>e.url)),i=(null==t?void 0:t.filter(e=>!n.has(e.url)))||[];return[...e,...i]},vC=(e,t)=>{const{query:n,index:i,status:a,phase:o}=t,s=It(e);if(!i||i-1<0)return e;let r,l=s.findIndex(e=>e.index===i);const{id:c,query:u,learnings:d,researchGoal:h,webSites:p,pageContent:m,codeContent:f,searchContent:g}=n||{};-1===l?(r=C(_({},n),{index:i,status:a,phase:o}),l=s.length,s.push(r)):(r=s[l],fC(r,"searchContent",g),fC(r,"codeContent",f),fC(r,"pageContent",m),fC(r,"learnings",d),fC(r,"researchGoal",h),fC(r,"query","string"==typeof u?u:"")),(null==r?void 0:r.id)||(r.id=c),Tt(null==r?void 0:r.query)&&(r.query="");const v=Array.isArray(p)?p:null==p?void 0:p.webSites;return(null==r?void 0:r.webSites)?r.webSites=gC(r.webSites,v||[]):r.webSites=v,s[l]=C(_({},r),{status:a,phase:o}),s},yC=(e,t)=>{const n=It(e);return t.forEach(e=>{const{query:t,index:i,status:a,phase:o}=e;if(!i||i<1)return;const s=n.findIndex(e=>(null==e?void 0:e.index)===i);if(-1===s)return void n.push(e);const r=n[s];if("finished"===(null==r?void 0:r.status)||"WebResultFinished"===(null==r?void 0:r.status))return;const{id:l,query:c,learnings:u,researchGoal:d,webSites:h,pageContent:p,codeContent:m,searchContent:f}="object"==typeof t?t:e||{};fC(r,"searchContent",f),fC(r,"codeContent",m),fC(r,"pageContent",p),fC(r,"learnings",u),fC(r,"researchGoal",d),fC(r,"query","string"==typeof c?c:""),!(null==r?void 0:r.id)&&l&&(r.id=l);const g=Array.isArray(h)?h:null==h?void 0:h.webSites;g&&((null==r?void 0:r.webSites)?r.webSites=gC(r.webSites,g||[]):r.webSites=g),n[s]=C(_({},r),{status:a,phase:o})}),n},bC=e=>e.filter(e=>e.phase===ng.WEB_SEARCH).reduce((e,t)=>{var n;return e.push(...(null==(n=t.extra)?void 0:n.web_search_info)||[]),e},[]).map(e=>C(_({},e),{icon:e.hostlogo||e.icon,description:e.description||e.snippet})),xC=e=>{var t,n,i;return null==(i=null==(n=null==(t=e.find(e=>e.phase===ng.ANSWER))?void 0:t.extra)?void 0:n.deep_research)?void 0:i.references},wC=(e,t="web")=>{if(e){if(bx()){if("web"!==t){if(!e){const e=Uf();return void ut.openOnce({type:"error",content:e.t("Download failed: url error")})}try{K_({url:e,errorTexts:!0})}catch(n){const e=Uf();ut.openOnce({type:"error",content:e.t("Download failed")})}return}const i=`qwen://web?url=${encodeURIComponent(e)}`;oT.adapter.invoke({method:"openWindow",params:{uri:i}})}wx()?oT.adapter.openWindow(e):window.open(e,"_blank")}},SC=e=>{var t,n,i,a;return 0===(null==(n=null==(t=null==e?void 0:e.permissions)?void 0:t.chat)?void 0:n.deep_research)||!(null==(a=null==(i=null==e?void 0:e.permissions)?void 0:i.chat)?void 0:a.deep_research)},_C=(e,t)=>bT()?e:t?"temporary":e,CC=e=>{var t,n,i,a;const o=Wb.getState().history,s=o.messages[e||""];if(!s)return[];return(null!==(null==s?void 0:s.parentId)?null!=(i=null==(n=o.messages[null!=(t=s.parentId)?t:""])?void 0:n.childrenIds)?i:[]:null!=(a=Object.values(o.messages).filter(e=>null===e.parentId&&"user"===e.role).map(e=>e.id||e.fid))?a:[]).filter(e=>void 0!==e)},EC=e=>{var t;const n=Wb.getState().history.messages[e];return(null==(t=null==n?void 0:n.models)?void 0:t.length)>1},kC=e=>{var t;return(null==(t=(e?Object.values(e||{}):[]).filter(e=>"assistant"===e.role&&e.sub_chat_type===Zf.Podcast))?void 0:t.length)||0},IC=(e,t)=>P(void 0,null,function*(){var n,i;const{chatId:a}=Wb.getState(),o=tx.getState().mobile,s=Uf();let r=!1,l="";if(a&&e){try{const t=yield(c={chat_id:a,message_id:e,scope:1},P(void 0,null,function*(){return yield zx(),yield Ox("/community/share",{method:"POST",data:_({},c),toast:!1})}));r=!!(null==(n=null==t?void 0:t.data)?void 0:n.share_id),l=(null==(i=null==t?void 0:t.data)?void 0:i.message)||""}catch(u){}var c;return r?(ut.open({type:"success",content:t?t():s.t("Published successfully"),closable:!1,className:o?"message-publish":""}),setTimeout(()=>{X.destroy()},3e3)):ut.open({type:"error",content:l,closable:!1,className:o?"message-publish message-publish-error":"",duration:3e3}),{success:r}}}),TC=(e,t,n,i)=>{const a=(e||[]).map(e=>n.find(t=>t.id===e)).filter(Boolean);if(a.length||t)return a;if(n.length){const e=n.find(e=>e.name===i);return e?[e]:(ut.open({type:"error",content:sv("The model used in this history has been deleted. Switching to the default model to continue.")}),[n[0]])}};let jC=!1;const NC=(e,t={})=>{var n,i;const a="system"===(o=e)?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":o;var o;jC="system"===e,wx()&&(null==(n=null==window?void 0:window.electronAPI)?void 0:n.switch_theme)&&(null==(i=null==window?void 0:window.electronAPI)||i.switch_theme(e)),document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(a);let s=e;"system"===e&&(s=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),yE.setState({theme:e,realTheme:s});const{isPersistence:r=!0}=t;localStorage&&r&&(localStorage.theme=e)};window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{jC&&NC("system")});const PC=e=>{let t=null;switch(e){case"loading":t=tn.jsx(dt,{type:"icon-jiazaizhong",className:"qwen-message-icon"});break;case"error":t=tn.jsx(dt,{type:"icon-line-x-circle-contained",className:"qwen-message-icon"});break;case"caution":case"info":case"warning":t=tn.jsx(dt,{type:"icon-line-alert-circle",className:"qwen-message-icon"});break;case"success":t=tn.jsx(dt,{type:"icon-line-check-contained1",className:"qwen-message-icon"});break;default:t=tn.jsx(tn.Fragment,{})}return t},MC=({type:e="info",content:t,duration:n=3e3,onCancel:i,hideIcon:a,className:o="",style:s=""})=>{const r=`qwen-message-${Date.now()}`,l=`${s}`,c=`qwen-design-message qwen-design-message-${e} ${o}`,u=tn.jsxs("div",{className:"qwen-message-content",children:[tn.jsxs("div",{className:"qwen-message-content-text",children:[t," "]}),i&&tn.jsx(dt,{type:"icon-close-4",className:"qwen-message-content-close-icon",onClick:()=>{X.destroy(r),i&&i()}})]});(X[e]||X.info)({content:u,icon:a?tn.jsx(tn.Fragment,{}):PC(e),duration:n/1e3,key:r,className:c,style:l})},AC={open:MC,openOnce:e=>{X.destroy(),MC(e)}};const RC=e=>new Promise(t=>{setTimeout(t,e)});class OC{constructor(){k(this,"ready",!1),k(this,"platform",Wf.WEB),this.init()}init(){this.ready=!0}isReady(){return this.ready}invoke(e){return this.ready?new Promise(e=>{e(!0)}):Promise.reject("-base")}openWindow(e){window.open(e,"_blank","noopener,noreferrer")}routeTologin(){KT.navigate("/auth")}}class DC extends OC{getVersionMethodBlocklist(){return this.getDefaultVersionMethodBlocklist()}getDefaultVersionMethodBlocklist(){return{"1.3.0":new Set(["getStoredInfo"]),"1.5.1":new Set(["postContentToMainChat"]),"1.6.0":new Set(["openPodcastWindow","openMediaRateWindow"]),"1.7.0":new Set(["openMemoryWindow"]),"1.8.0":new Set(["controlAudioPlayer","downloadFile"])}}mergeVersionMethodBlocklist(...e){const t={};for(const n of e)if(n)for(const e in n){if(!Object.prototype.hasOwnProperty.call(n,e))continue;const i=n[e];if(t[e])for(const n of i)t[e].add(n);else t[e]=new Set(i)}return t}optionPatch(e){var t,n;"openHalfWindow"!==e.method||"openUrl"!==(null==(t=null==e?void 0:e.params)?void 0:t.type)||(null==(n=e.params)?void 0:n.windowSize)||(e.params.windowSize=100)}invoke(e){var t;if(!this.ready)return Promise.reject("");if(this.optionPatch(e),this.isMethodBlockedForCurrentVersion(e.method)){if(this.platform===Wf.IOS&&"openHalfWindow"===e.method&&"openUrl"===(null==(t=null==e?void 0:e.params)?void 0:t.type)&&e.params.windowSize)return delete e.params.windowSize,this.doInvoke(e);const n=yx();return Promise.reject(` APP ${n} ${e.method}`)}return this.doInvoke(e)}isMethodBlockedForCurrentVersion(e){const t=this.getVersionMethodBlocklist();for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&!this.isCurrentVersionGte(n)){const i=t[n];if(i.has("*")||i.has(e))return!0}return!1}isCurrentVersionGte(e){const t=yx(),n=(e||"0").split(".").map(e=>parseInt(e,10)||0),i=(t||"0").split(".").map(e=>parseInt(e,10)||0);for(let a=0;a<3;a++){const e=i[a]||0,t=n[a]||0;if(e>t)return!0;if(e<t)return!1}return!0}}class LC extends DC{constructor(){super(),k(this,"ready",!1),k(this,"platform",Wf.ANDROID),k(this,"nativeBridge",null),this.init()}init(){return this.setupBridge().then(()=>{}).catch(e=>{})}invoke(e){return P(this,null,function*(){return this.ready||(yield RC(1e3),this.ready)?(t=LC.prototype,n=this,i="invoke",y(f(t),i,n)).call(this,e):Promise.reject(` - ${null==e?void 0:e.method}`);var t,n,i})}getVersionMethodBlocklist(){return this.mergeVersionMethodBlocklist(this.getDefaultVersionMethodBlocklist(),{})}doInvoke(e){return this.invokeHandler(e)}setupBridge(){return new Promise((e,t)=>{setTimeout(()=>{(null==window?void 0:window.QwenChat)?(this.nativeBridge=null==window?void 0:window.QwenChat,this.ready=!0,e()):this.startPolling(e,t)},1e3)})}startPolling(e,t){let n=0,i=null;i=setInterval(()=>{n++,(null==window?void 0:window.QwenChat)?(i&&(clearInterval(i),i=null),this.nativeBridge=null==window?void 0:window.QwenChat,this.ready=!0,e()):n>=1200&&(i&&(clearInterval(i),i=null),t("window?.QwenChat is not defined after polling 1200 times"))},50)}invokeHandler(e){return new Promise((t,n)=>{const i=setTimeout(()=>{n(`: ${e.method}`)},e.timeout||1e4);try{if(this.nativeBridge&&this.nativeBridge[e.method]){const{params:n={}}=e,a=function(e,t=2){try{return JSON.stringify(e,(e,t)=>"function"==typeof t?"[Function]":"symbol"==typeof t?t.toString():void 0===t?null:t instanceof Error?t.toString():t instanceof Date?t.toISOString():t instanceof Set||t instanceof Map?[...t]:t,t)}catch(n){return null}}(n);t(this.nativeBridge[e.method](a)||!0),clearTimeout(i)}else clearTimeout(i),n(`: ${e.method}`)}catch(a){clearTimeout(i),n("")}})}openWindow(e,t="qwen://web?url="){const n=`${t}${encodeURIComponent(e)}`;this.invoke({method:"openWindow",params:{uri:n}})}routeTologin(){this.invoke({method:"showAlert",params:{type:"login"}})}}class FC extends OC{constructor(){super(...arguments),k(this,"platform",Wf.DESKTOP)}invoke(e){return P(this,null,function*(){var t,n;const{method:i,params:a}=e,o=i,s=a;return["get_app_version","get_platform_info","open_external_link","show_native_dialog","request_file_access","mcp_client_get_config","mcp_client_tool_list","mcp_client_tool_call","on_event","send_event","switch_theme","switch_ln"].includes(o)?{code:200,message:"success",data:null==(n=null==(t=window.electronAPI)?void 0:t[o])?void 0:n.call(t,s)}:{code:500,message:"method not found",data:null}})}openWindow(e){var t;null==(t=window.electronAPI)||t.open_external_link(e)}}class UC extends DC{constructor(){super(),k(this,"ready",!1),k(this,"platform",Wf.IOS),k(this,"nativeBridge",null),this.init()}getVersionMethodBlocklist(){const e={"1.3.0":new Set(["openHalfWindow"])};return this.mergeVersionMethodBlocklist(this.getDefaultVersionMethodBlocklist(),e)}init(){return this.setupBridge().then(()=>{this.ready=!0}).catch(e=>{})}doInvoke(e){return this.invokeHandler(e)}setupBridge(){return new Promise((e,t)=>{(null==window?void 0:window.QwenChat)?(this.nativeBridge=null==window?void 0:window.QwenChat,e()):t("Logger: window?.QwenChat is not defined")})}invokeHandler(e){return new Promise((t,n)=>{const i=setTimeout(()=>{n(`: ${e.method}`)},e.timeout||1e4);try{if(this.nativeBridge&&this.nativeBridge[e.method]){const{params:n={}}=e;t(this.nativeBridge[e.method](n)||!0),clearTimeout(i)}else clearTimeout(i),n(`: ${e.method}`)}catch(a){clearTimeout(i),n("")}})}openWindow(e,t="qwen://web?url="){const n=`${t}${encodeURIComponent(e)}`;this.invoke({method:"openWindow",params:{uri:n}})}routeTologin(){this.invoke({method:"showAlert",params:{type:"login"}})}}const zC=(()=>{if(wx())return Wf.DESKTOP;const e=navigator.userAgent.toLowerCase(),t=/iphone|ipad|ipod/.test(e),n=/android/.test(e),i=bx();return t&&i?Wf.IOS:n&&i?Wf.ANDROID:Wf.WEB})();let HC=OC;switch(zC){case Wf.IOS:HC=UC;break;case Wf.ANDROID:HC=LC;break;case Wf.DESKTOP:HC=FC}class $C extends HC{constructor(){super()}setTheme(e,t){const n=!["system_light","system_dark"].includes(e);NC("system_light"===e?"light":"system_dark"===e?"dark":e,{isPersistence:n}),t===Kf.SETAPP&&this.invoke({method:"setTheme",params:{theme:e}})}setLanguage(e,t){(e=>{Uf().changeLanguage(e)})(e),document.documentElement.setAttribute("lang",e),t===Kf.SETAPP?this.invoke({method:"setLanguage",params:{lang:e}}):t===Kf.DESKTOP&&this.invoke({method:"switch_ln",params:e})}saveCookie(e,t){localStorage.token=e}clearCookie(e){gT("token"),gT("settings"),Kf.SETAPP}downloadFile({chat:e,fileType:t}){var n;"txt"!==t?"json"===t&&(n=e,P(void 0,null,function*(){var e;const{saveAs:t}=ax;if(n.id){n=(n=yield pS({chat_id:n.id})).data;const t={};for(const i in n.chat.history.messages)Object.prototype.hasOwnProperty.call(n.chat.history.messages,i)&&(t[i]=kt(n.chat.history.messages[i],["webSearchInfo","extra.web_search_info"]),"assistant"===t[i].role&&(null==(e=t[i])?void 0:e.content)&&(t[i].content=t[i].content.replace(/\[\[\d+\]\]/g,"")));n.chat.history.messages=t,n.chat.messages&&n.chat.messages.length&&(n.chat.messages=n.chat.messages.map(e=>{const t=kt(e,["webSearchInfo","extra.web_search_info"]);return"assistant"===t.role&&(null==t?void 0:t.content)&&(t.content=t.content.replace(/\[\[\d+\]\]/g,"")),t}))}t(new Blob([JSON.stringify([n])],{type:"application/json;charset=utf-8"}),`chat-export-${Date.now()}.json`)})):((e,t)=>{P(void 0,null,function*(){const{saveAs:n}=ax,i=yield rC(e),a=new Blob([i],{type:"text/plain;charset=utf-8"}),o=`chat-${e.chat.title}.txt`;if(hx())try{yield M_(a,o)}catch(qY){"function"==typeof t&&t(qY)}else n(a,o)})})(e,e=>{AC.openOnce({type:"error",content:e})})}setNativeStopButton(e=!1){this.invoke({method:"showStopButton",params:{value:e}})}resetNativeState(){new URLSearchParams(window.location.search).get("shareId")||this.invoke({method:"setSendButtonEnabled",params:{value:!0}})}}var BC=(e=>(e.CHAT_INITIALIZED="chat.initialized",e.CHAT_HISTORY_LOADED="chat.historyLoaded",e.CHAT_INIT_NEWCHAT="chat.init.newChat",e.CHAT_BEGIN="chat.begin",e.CHAT_MESSAGE_SENT_REGENERATE="chat.message.sent.regenerate",e.CHAT_MESSAGE_EDIT_BEGIN="chat.message.sent.begin",e.CHAT_MESSAGE_EDIT_END="chat.message.sent.end",e.CHAT_MESSAGE_UPDATE="chat.message.update",e.CHAT_CREATE_NEW_CHAT="chat.create.new.chat",e.CHAT_SSE_ID_CHANGE="chat.sse.id.change",e.CHAT_SSE_BEGIN="chat.sse.begin",e.CHAT_SSE_ERROR="chat.sse.error",e.CHAT_SSE_PROCESS="chat.sse.process",e.CHAT_SSE_FIRST_RECEIVE_MESSAGE="chat.sse.first.receive.message",e.CHAT_SSE_END="chat.sse.end",e.CHAT_MESSAGE_FAILED="chat.message.failed",e.CHAT_MESSAGE_END="chat.message.end",e.CHAT_MESSAGE_END_PROCESS="chat.message.end.process",e.CHAT_END="chat.end",e.CHAT_MERGE_BEGIN="chat.merge.begin",e.CHAT_MERGE_MESSAGE_PROCESS="chat.merge.message.process",e.CHAT_MERGE_END="chat.merge.end",e.CHAR_HANDLE_DELETE_SOURCE="chat.message.delete.source",e.CHAT_ERROR="chat.error",e.CHAT_MESSAGE_DELETED="chat.message.deleted",e.CHAT_CLOSE_ROTE_COMMENT_PANEL="chat.close.rote.comment.panel",e.CHAT_RESET_INPUT_TEXTAREA="chat_reset_input_textarea",e.CHAR_REGENERATE_RESPONSE="chat.regenerate.response",e.CHAT_PARSE_URL_BEGIN="chat.message.parse.url",e.CHAT_PARSE_URL_END="chat.message.parse.url.end",e.CHAT_PARSE_URL_ERROR="chat.message.parse.url.error",e.CHAT_SCROLL_TO_BOTTOM="chat.message.scroll.to.bottom",e.CHAT_SELECTED_MODEL_ONMOUNT="chat.selected.model.onmount",e.FILE_PASE_REMOVE="file.pase.remove",e))(BC||{}),qC=(e=>(e.MESSAGE_SENT_BEFORE="message.sent.before",e.MESSAGE_SENT="message.sent",e.MESSAGE_VALIDATE_ERROR="message.validate.error",e.MESSAGE_EDIT_SAVE="message.edit.save",e.MESSAGE_FEEDBACK_SUBMIT="message.feedback.submit",e.MESSAGE_STOP_RESPONSE="message.stop.Response",e.MESSAGE_OPEN_TEMPORARY="message.open.temporary",e.MESSAGE_CLEAR_ALL="chear.all.messages",e.MESSAGE_INPUT_PANEL_ACTIVE="message.input.panel.active",e.MESSAGE_LEAVE_CONFIRM="message.leave.confirm",e.MESSAGE_ARTIFACT_SHOW="message.artifact.show",e.MESSAGE_ARTIFACT_DEPLOY_CHANGE="message.artifact.deploy.change",e.MESSAGE_PODCAST_AUDIO_PLAY_START="message.podcast.audio.play.start",e.MESSAGE_STOP_SCROLL_TO_BOTTOM="message.stop.scroll.to.bottom",e.MESSAGE_DEEP_RESEARCH_CLOSE_DETAIL="message.close.deepResearch.detail",e.MESSAGE_EDIT_ARTIFACTS="message.edit.artifacts",e.MESSAGE_STOP_ARTIFACTS_LOOP="message.stop.artifacts.loop",e))(qC||{}),GC=(e=>(e.SOURCE_CILCK="dp.source.messsage",e))(GC||{}),VC=(e=>(e.QWEN_SEND_MESSAGE="QwenEvent.onSendMessage",e.QWEN_REMOVE_SOURCE="QwenEvent.onRemoveSearchReference",e.QWEN_WEBLOAD="QwenEvent.onWebLoaded",e.QWEN_EVENT_ON_EDIT_MESSAGE="QwenEvent.onEditMessage",e.QWEN_EVENT_ON_CLICK_STOP_BUTTON="QwenEvent.onClickStopButton",e.QWEN_EVENT_ON_OPEN_CHAT="QwenEvent.onOpenChat",e.QWEN_EVENT_ON_DISLIKE_FEEDBACK="QwenEvent.onDislikeFeedback",e.QWEN_EVENT_ON_THEME_CHANGED="QwenEvent.onThemeChanged",e.QWEN_EVENT_ON_LANG_CHANGED="QwenEvent.onLangChanged",e.QWEN_EVENT_ON_CLEAR_ALL_CHATS="QwenEvent.onClearAllChats",e.QWEN_EVENT_ON_LOGOUT="QwenEvent.onLogout",e.QWEN_EVENT_ON_INPUT_PANEL_ACTIVE="QwenEvent.onInputPanelActive",e.QWEN_EVENT_ON_SELECT_MODEL="QwenEvent.onSelectModel",e.QWEN_EVENT_ON_ALERTPOSITIVE_BUTTON_CLICK="QwenEvent.onAlertPositiveButtonClick",e.QWEN_EVENT_ON_CHATCONFIG_CHANGE="QwenEvent.onChatConfigChange",e.QWEN_EVENT_ON_DEPLOY_STATUS_CHANGE="QwenEvent.onDeployStatusChange",e.QWEN_EVENT_ON_USER_PROFILE_UPDATE="QwenEvent.onUserProfileUpdate",e.QWEN_EVENT_ON_USER_PASSWORD_CHANGE="QwenEvent.onUserPasswordChange",e.QWEN_EVENT_ON_PAGE_PAUSE="QwenEvent.onPagePause",e.QWEN_EVENT_ON_PAGE_RESUME="QwenEvent.onPageResume",e.QWEN_EVENT_ON_TSS_SPEAKER_CHANGE="QwenEvent.onTTSSpeakerChange",e.QWEN_EVENT_ON_CALL_ENDED="QwenEvent.onCallEnded",e.QWEN_EVENT_ON_CALL_CONNECTED="QwenEvent.onCallConnected",e.QWEN_EVENT_ON_CALL_COMING="QwenEvent.onCallComing",e.QWEN_EVENT_ON_AUDIO_FOCUS_CHANGE="QwenEvent.onAudioFocusChange",e.QWEN_EVENT_ON_PLAYBACK_STATE_CHANGED="QwenEvent.onPlaybackStateChanged",e.QWEN_EVENT_ON_MEDIA_RATE_CHANGED="QwenEvent.onMediaRateChanged",e.QWEN_EVENT_ON_POST_CONTENT_TO_MAIN_CHAT="QwenEvent.onPostContentToMainChat",e.QWEN_EVENT_ON_SEND_PODCAST="QwenEvent.onSendPodcast",e.QWEN_EVENT_ON_PROMPT_SETTINGS_UPDATE="QwenEvent.onPromptSettingsUpdate",e))(VC||{}),WC=(e=>(e.QWEN_CHAT_ONDOWNLOADSTART="QwenChat.onDownloadStart",e.QWEN_CHAT_ONDOWNLOADCOMPLETE="QwenChat.onDownloadComplete",e))(WC||{}),QC=(e=>(e.COPY_MESSAGE="navbar.copy.messsage",e.NAVBAR_MODEL_SELECT_CHANGE="navbar.model.select.change",e.MESSAGE_AUDIO_PLAYBACK_CHANGED="message.audio.playback.changed",e.MESSAGE_AUDIO_PLAYBACK_RATE_CHANGED="message.audio.playback.rate.changed",e))(QC||{}),KC=(e=>(e.VIEWPORT_RESIZE="viewport.resize",e))(KC||{}),YC=(e=>(e.MESSAGE_INPUT_ON_BLUR="message.input.on.blur",e.MESSAGE_INPUT_TRIGGER_FOCUS="message.input.trigger.focus",e.MESSAGE_INPUT_RECOMMEND_WORDS_CLICK="message.input.recommend.words.click",e.MESSAGE_INPUT_RECOMMEND_WORDS_INIT="message.input.recommend.words.init",e))(YC||{});const XC=new ct({wildcard:!0,delimiter:".",newListener:!1,removeListener:!1,maxListeners:30,verboseMemoryLeak:!1,ignoreErrors:!1}),JC=class t{constructor(){return k(this,"chats",new Map),k(this,"currentId",null),k(this,"currentChatId",null),k(this,"clearChatsStatus",()=>{this.chats.forEach(e=>{e.id!==this.currentId&&(e.setStatus({isLeave:!0}),e.destroy())})}),k(this,"forceClearAllChat",()=>{this.chats.forEach(e=>{e.forceClear()})}),T(t,e)?T(t,e):(N(t,e,this),this)}static getInstance(){return T(t,e)||N(t,e,new t),T(t,e)}getChats(){return this.chats}hasChat(e){return this.chats.has(e)}addChat(e,t){return this.chats.has(e)?(this.currentChatId=e,!1):(this.currentChatId=e,this.chats.set(e,t),!0)}getChat(e){return this.chats.get(e)}getChatByChatId(e){let t;return this.chats.forEach(n=>{n.chatId===e&&(t=n)}),t}removeChat(e){return!(!e||!this.chats.has(e))&&this.chats.delete(e)}size(){return this.chats.size}};e=new WeakMap,j(JC,e,null);const ZC=JC.getInstance();const eE=new class{constructor(){k(this,"listeners"),this.listeners=new Map}add(e,t,n){let i=this.listeners.get(e);i||(i=new Set,this.listeners.set(e,i)),i.add(t),document.addEventListener(e,t,n||{})}remove(e,t){const n=this.listeners.get(e);n&&n.has(t)&&(document.removeEventListener(e,t),n.delete(t))}removeAll(e){const t=this.listeners.get(e);t&&(t.forEach(t=>{document.removeEventListener(e,t)}),t.clear())}clear(){this.listeners.forEach((e,t)=>{e.forEach(e=>{document.removeEventListener(t,e)})}),this.listeners.clear()}};class tE extends Error{constructor(e,t){super(e),this.name="ParseError",this.type=t.type,this.field=t.field,this.value=t.value,this.line=t.line}}function nE(e){}function iE(e){if("function"==typeof e)throw new TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");const{onEvent:t=nE,onError:n=nE,onRetry:i=nE,onComment:a}=e;let o,s="",r=!0,l="",c="";function u(e){if(""===e)return l.length>0&&t({id:o,event:c||void 0,data:l.endsWith("\n")?l.slice(0,-1):l}),o=void 0,l="",void(c="");if(e.startsWith(":"))return void(a&&a(e.slice(e.startsWith(": ")?2:1)));const n=e.indexOf(":");if(-1!==n){const t=e.slice(0,n),i=" "===e[n+1]?2:1;return void d(t,e.slice(n+i),e)}d(e,"",e)}function d(e,t,a){switch(e){case"event":c=t;break;case"data":l=`${l}${t}\n`;break;case"id":o=t.includes("\0")?void 0:t;break;case"retry":/^\d+$/.test(t)?i(parseInt(t,10)):n(new tE(`Invalid \`retry\` value: "${t}"`,{type:"invalid-retry",value:t,line:a}));break;default:n(new tE(`Unknown field "${e.length>20?`${e.slice(0,20)}`:e}"`,{type:"unknown-field",field:e,value:t,line:a}))}}return{feed:function(e){const t=r?e.replace(/^\xEF\xBB\xBF/,""):e,[n,i]=function(e){const t=[];let n="",i=0;for(;i<e.length;){const a=e.indexOf("\r",i),o=e.indexOf("\n",i);let s=-1;if(-1!==a&&-1!==o?s=Math.min(a,o):-1!==a?s=a===e.length-1?-1:a:-1!==o&&(s=o),-1===s){n=e.slice(i);break}{const n=e.slice(i,s);t.push(n),i=s+1,"\r"===e[i-1]&&"\n"===e[i]&&i++}}return[t,n]}(`${s}${t}`);for(const a of n)u(a);s=i,r=!1},reset:function(e={}){s&&e.consume&&u(s),r=!0,o=void 0,l="",c="",s=""}}}class aE extends TransformStream{constructor({onError:e,onRetry:t,onComment:n}={}){let i;super({start(a){i=iE({onEvent:e=>{a.enqueue(e)},onError(t){"terminate"===e?a.error(t):"function"==typeof e&&e(t)},onRetry:t,onComment:n})},transform(e){i.feed(e)}})}}const oE=e=>new Promise(t=>setTimeout(t,e));function sE(e,t,n=!0){return P(this,null,function*(){let i=function(e){return A(this,null,function*(){for(var t,n,i,a,o,s,r,l,c,u,d,h,p,m,f,g,v,y,b,x,w,S,E,k,I,T,j,N,P,A,R,O,D,L,F,U,z,H,$,B,q,G,V,W,Q,K,Y,X,J,Z,ee,te,ne,ie,ae,oe,se,re,le,ce,ue,de,he,pe,me,fe,ge,ve,ye,be,xe,we,Se,_e,Ce,Ee,ke,Ie;;){const{value:Te,done:je}=yield new M(e.read());if(je){yield{done:!0,value:""};break}if(!Te)continue;const Ne=Te.data;if(Ne.startsWith("[DONE]")){yield{done:!0,value:""};break}try{let e={};try{e=JSON.parse(Ne)}catch(qY){}const M=(null==e?void 0:e["response.created"])||void 0;if(M){yield{done:!1,value:"",chatId:M.chat_id,parentId:M.parent_id,responseId:M.response_id};continue}if(null==e?void 0:e["response.stopped"]){yield{done:!0,value:"",isStop:!0};continue}if(null==(i=null==(n=null==(t=null==e?void 0:e.choices)?void 0:t[0])?void 0:n.delta)?void 0:i.tts){const{tts:t=""}=null==(o=null==(a=null==e?void 0:e.choices)?void 0:a[0])?void 0:o.delta;yield{done:!1,value:t,tts:t,responseId:e.response_id}}if(e.error){yield{done:!0,value:"",error:e.error,responseId:e.response_id};continue}if(e.sources){yield{done:!1,value:"",sources:e.sources,role:null!=(c=null==(l=null==(r=null==(s=e.choices)?void 0:s[0])?void 0:r.delta)?void 0:l.role)?c:"",responseId:e.response_id};continue}if(e.selected_model_id){yield{done:!1,value:"",selectedModelId:e.selected_model_id,role:null!=(p=null==(h=null==(d=null==(u=e.choices)?void 0:u[0])?void 0:d.delta)?void 0:h.role)?p:"",responseId:e.response_id};continue}if("function"===(null==(g=null==(f=null==(m=e.choices)?void 0:m[0])?void 0:f.delta)?void 0:g.role)){if(null==(x=null==(b=null==(y=null==(v=e.choices)?void 0:v[0])?void 0:y.delta)?void 0:b.extra)?void 0:x.web_search_info){yield{done:!1,value:"",web_search_info:null!=(I=null==(k=null==(E=null==(S=null==(w=e.choices)?void 0:w[0])?void 0:S.delta)?void 0:E.extra)?void 0:k.web_search_info)?I:[],role:null!=(P=null==(N=null==(j=null==(T=e.choices)?void 0:T[0])?void 0:j.delta)?void 0:N.role)?P:"",responseId:e.response_id};continue}if(null==(D=null==(O=null==(R=null==(A=e.choices)?void 0:A[0])?void 0:R.delta)?void 0:O.extra)?void 0:D.code_interpreter_info){yield{done:!1,value:"",code_interpreter_info:null!=(H=null==(z=null==(U=null==(F=null==(L=e.choices)?void 0:L[0])?void 0:F.delta)?void 0:U.extra)?void 0:z.code_interpreter_info)?H:"",role:null!=(G=null==(q=null==(B=null==($=e.choices)?void 0:$[0])?void 0:B.delta)?void 0:q.role)?G:"",responseId:e.response_id};continue}}yield C(_({done:!1,value:null!=(K=null==(Q=null==(W=null==(V=e.choices)?void 0:V[0])?void 0:W.delta)?void 0:Q.content)?K:"",role:null!=(Z=null==(J=null==(X=null==(Y=e.choices)?void 0:Y[0])?void 0:X.delta)?void 0:J.role)?Z:"",phase:null==(ne=null==(te=null==(ee=e.choices)?void 0:ee[0])?void 0:te.delta)?void 0:ne.phase,status:null==(oe=null==(ae=null==(ie=e.choices)?void 0:ie[0])?void 0:ae.delta)?void 0:oe.status,usage:e.usage,extra:null==(le=null==(re=null==(se=e.choices)?void 0:se[0])?void 0:re.delta)?void 0:le.extra,lang_code:null==(de=null==(ue=null==(ce=e.choices)?void 0:ce[0])?void 0:ue.delta)?void 0:de.lang_code,function_call:null==(me=null==(pe=null==(he=e.choices)?void 0:he[0])?void 0:pe.delta)?void 0:me.function_call},(null==(ve=null==(ge=null==(fe=e.choices)?void 0:fe[0])?void 0:ge.delta)?void 0:ve.function_call)?{functionCallType:null==(we=null==(xe=null==(be=null==(ye=e.choices)?void 0:ye[0])?void 0:be.delta)?void 0:xe.function_call)?void 0:we.name}:{}),{mcp_name:null==(Ce=null==(_e=null==(Se=e.choices)?void 0:Se[0])?void 0:_e.delta)?void 0:Ce.mcp_name,tool_name:null==(Ie=null==(ke=null==(Ee=e.choices)?void 0:Ee[0])?void 0:ke.delta)?void 0:Ie.tool_name,responseId:e.response_id})}catch(qY){}}})}(e.pipeThrough(new TextDecoderStream).pipeThrough(new aE).getReader());return i=t?function(e,t=!0){return A(this,null,function*(){var n,i,a;let o="";try{for(var s,r,l,c=R(e);s=!(r=yield new M(c.next())).done;s=!1){const e=r.value;if(e.done||e.error)return void(yield e);if(e.sources||e.web_search_info||e.code_interpreter_info||e.function_call||e.functionCallType||e.parentId&&e.responseId||[ng.IMAGE_GEN,ng.TOOL,ng.LOCAL_TOOL].includes(e.phase)||(null==(n=null==e?void 0:e.extra)?void 0:n.deep_research)||(null==(i=null==e?void 0:e.extra)?void 0:i.image_zoom_in_tool_info)||(null==(a=null==e?void 0:e.extra)?void 0:a.travel_research)){yield e;continue}let s=e.value;if(t){let t=s.substring((null==o?void 0:o.length)||0);if(t.length){const e={chunk_size:t.length,chunk_time:Date.now()};yield{chunk_data:e,done:!1,value:""}}if(t.length<5){yield{done:!1,value:t,functionCallType:null==e?void 0:e.functionCallType},o=s;continue}for(;""!=t;){const n=Math.min(Math.floor(3*Math.random())+1,t.length),i=t.slice(0,n);yield{done:!1,value:i,functionCallType:null==e?void 0:e.functionCallType},"hidden"!==(null==document?void 0:document.visibilityState)&&(yield new M(oE(5))),t=t.slice(n)}o=s}else{if(s.length){const e={chunk_size:s.length,chunk_time:Date.now()};yield{chunk_data:e,done:!1,value:""}}if(s.length<5){yield{done:!1,value:s,functionCallType:null==e?void 0:e.functionCallType,role:null==e?void 0:e.role,phase:null==e?void 0:e.phase,status:null==e?void 0:e.status};continue}for(;""!=s;){const t=Math.min(Math.floor(3*Math.random())+1,s.length),n=s.slice(0,t);yield{done:!1,value:n,functionCallType:null==e?void 0:e.functionCallType,role:null==e?void 0:e.role,phase:null==e?void 0:e.phase,status:null==e?void 0:e.status},"hidden"!==(null==document?void 0:document.visibilityState)&&(yield new M(oE(5))),s=s.slice(t)}}}}catch(r){l=[r]}finally{try{s&&(r=c.return)&&(yield new M(r.call(c)))}finally{if(l)throw l[0]}}})}(i,n):function(e){return A(this,null,function*(){let t="";try{for(var n,i,a,o=R(e);n=!(i=yield new M(o.next())).done;n=!1){const e=i.value,n=e.value,a="string"==typeof n?n.substring((null==t?void 0:t.length)||0):"";if(a.length){const e={chunk_size:a.length,chunk_time:Date.now()};yield{chunk_data:e,done:!1,value:""}}yield e,t=n}}catch(i){a=[i]}finally{try{n&&(i=o.return)&&(yield new M(i.call(o)))}finally{if(a)throw a[0]}}})}(i),i})}const rE=(e,t)=>{const{theme:n}=yE.getState();return"dark"===n?t:e},lE=(e,t)=>new Promise(n=>{const i=new Image;i.onload=()=>{t||setTimeout(()=>{lE(e,320)},100),n(!0)},i.onerror=i.onabort=()=>n(!1);const a=t||100,o=`x-oss-process=image/resize,m_mfit,w_${a},h_${a}`;e.includes("qwen-webui")?i.src=e:e.includes("?")?i.src=e+`&${o}`:i.src=e+`?${o}`}),cE={mp4:"video/mp4",avi:"video/avi",wmv:"video/x-ms-wmv",flv:"video/x-flv",mkv:"video/x-matroska",mov:"video/quicktime",md:"text/markdown"},uE=2097152;const dE=new class{constructor(){k(this,"uploadTask",{}),k(this,"execUpload",e=>P(this,null,function*(){var t,n;const i=this.uploadTask[e];if(i)try{this.uploadTask[e].status="uploading";const{file:n,client:a,checkPoint:o,parallel:s,partSize:r,ossToken:l}=i,{filePath:c}=l,u=_({},o?{checkPoint:o}:{parallel:s,partSize:r});n.size<uE?yield a.put(c,n):yield a.multipartUpload(c,n,C(_({},u),{progress:(t,n)=>{var a;if(this.uploadTask[e]){const o=Math.round(100*t);this.uploadTask[e].progress=o,null==(a=i.onUploadProgress)||a.call(i,o),this.uploadTask[e].checkPoint=n}}})).catch(e=>{if(!(null==e?void 0:e.name)||"cancel"!==e.name)throw e});const d=i.resumeTime||i.startTime,h=i.resumeTime?"resume":"start",p=S_();if(i.successTime=p,this.sendTrackEvent("finishUpload",{c4:d,c5:p,c6:p-d,c7:h,taskId:e}),yield null==(t=i.onUploadSuccess)?void 0:t.call(i,l.fileId,l.fileCDNUrl),!i.onGreenNetFinish)return void delete this.uploadTask[e];this.uploadTask[e].status="uploadSuccess",this.execGreenNetCheck(e)}catch(a){null==(n=i.onUploadFailed)||n.call(i,a),BS("uploadFileError",{params:{et:"OTHER",c5:e,c6:a instanceof Error?a.message:String(a),c7:String(a)}}),this.uploadTask[e].status="uploadError"}})),k(this,"execGreenNetCheck",e=>P(this,null,function*(){})),k(this,"getParallelParams",e=>e<5242880?{parallel:2,partSize:uE}:e<10485760?{parallel:4,partSize:uE}:e<52428800?{parallel:6,partSize:6291456}:e<104857600?{parallel:8,partSize:8388608}:{parallel:10,partSize:10485760}),k(this,"getFileType",e=>{const{type:t}=e;let n="file";return t.startsWith("video")&&(n="video"),t.startsWith("image")&&(n="image"),t.startsWith("audio")&&(n="audio"),n}),k(this,"sendTrackEvent",(e,t={})=>{try{const n=t,{taskId:i=""}=n,a=E(n,["taskId"]);let o;if(i&&this.uploadTask[i]){const{file:e}=this.uploadTask[i],{name:t,size:n,type:a}=e;o={filename:t,filesize:n,filetype:a}}HS(`FileUpload-${e}`,{params:_(_({et:"OTHER"},a),o?{c8:o}:{})})}catch(n){}}),k(this,"getTaskItem",e=>this.uploadTask[e])}uploadFileToOss(e,t){const n=ot(),{name:i,size:a,type:o}=e,s=this.getFileType(e);return(e=>P(void 0,null,function*(){try{const t=q();yield zx();const n=yield Ox("/files/getstsToken",{method:"POST",headers:_({"Content-Type":"application/json","Accept-Language":`${t.language},${t.language.split("-")[0]};q=0.9`},localStorage.token&&{Authorization:`Bearer ${localStorage.token}`}),data:e||{}});if(!n.success||!n.data)return{errorCode:n.data.code||"",info:n.data.message||""};const i=n.data;return{accessKeyId:i.access_key_id,accessKeySecret:i.access_key_secret,stsToken:i.security_token,bucket:i.bucketname,region:i.region,endpoint:i.endpoint,fileId:i.file_id,filePath:i.file_path,fileCDNUrl:i.file_url}}catch(GY){return{errorCode:"",info:""}}}))({filename:i,filesize:a,filetype:s}).then(s=>{var r;if(void 0!==(null==s?void 0:s.errorCode)&&null!==(null==s?void 0:s.errorCode)||!s)return this.sendTrackEvent("ossTokenNetworkError",{c8:{filename:i,filesize:a,filetype:o}}),null==(r=null==t?void 0:t.onUploadFailed)||r.call(t,s),s;if((null==s?void 0:s.errorCode)||"error"===(null==s?void 0:s.type))return this.sendTrackEvent("ossTokenError",{c4:s,c8:{filename:i,filesize:a,filetype:o}}),null;const l=S_(),c=S_();this.sendTrackEvent("ossTokenTime",{c4:c,c5:l,c6:l-c,c8:{filename:i,filesize:a,filetype:o}});const u=new Ut({authorizationV4:!0,region:s.region,endpoint:s.endpoint,accessKeyId:s.accessKeyId,accessKeySecret:s.accessKeySecret,stsToken:s.stsToken,bucket:s.bucket}),d=this.getParallelParams(a),h=_(C(_({taskId:n,file:e,client:u,progress:0},d),{status:"uploading",startTime:c,ossToken:s}),t||{});return this.uploadTask[n]=h,h.startTime=S_(),this.sendTrackEvent("startUpload",{c4:h.startTime,taskId:n}),this.execUpload(n),n}).catch(e=>{var n;throw null==(n=null==t?void 0:t.onUploadFailed)||n.call(t,e),e})}resumeUpload(e){return P(this,null,function*(){var t;const n=this.uploadTask[e];if(n&&"uploadError"===n.status)try{n.resumeTime=S_(),this.sendTrackEvent("resumeUpload",{c4:n.resumeTime,taskId:e}),null==(t=n.onResumeUpload)||t.call(n),yield this.execUpload(e)}catch(i){}})}stopAndRemoveTask(e){return P(this,null,function*(){const t=this.uploadTask[e];if(t){this.sendTrackEvent("stopUpload",{c4:S_(),taskId:e});try{const{client:n,status:i,checkPoint:a}=t;"uploading"===i&&a&&n.abortMultipartUpload(a.name,a.uploadId).catch(e=>{!e.name||e.name}),delete this.uploadTask[e]}catch(n){}}})}getPromise(){let e=()=>{},t=()=>{};return{promise:new Promise((n,i)=>{e=n,t=i}),resolve:e,reject:t}}};let hE=q();const pE=e=>{if(!e||"{}"===JSON.stringify(e))return{};const{image_max_count:t,video_max_count:n,audio_max_count:i,doc_max_count:a,image_max_size:o,video_max_size:s,audio_max_size:r,doc_max_size:l,default_max_size:c,audio_max_duration:u,video_max_duration:d}=e;return{[Ag.DEFAULT]:{max_size:c},[Ag.DOC]:{max_count:a,max_size:l},[Ag.VIDEO]:{max_count:n,max_size:s,max_duration:d},[Ag.IMAGE]:{max_count:t,max_size:o},[Ag.AUDIO]:{max_count:i,max_size:r,max_duration:u}}};class mE{constructor({onAddProcess:e=()=>{},onAddSuccess:t=()=>{},onAddFail:n=()=>{},onPaseSuccess:i=()=>{},onPaseFail:a=()=>{},parsedFileTypes:o=[],userId:s}){k(this,"parseTaskIds",[]),k(this,"loopParse",null),k(this,"fileItems",[]),k(this,"limitTypes",Object.values(Ag)),k(this,"defaultLimitRules",Og),k(this,"limitRules",Og),k(this,"totalMaxCount",Mg),k(this,"onAddProcess",()=>{}),k(this,"onAddSuccess",()=>{}),k(this,"onAddFail",()=>{}),k(this,"onPaseSuccess",()=>{}),k(this,"onPaseFail",()=>{}),k(this,"userId"),k(this,"parsedFileTypes",[]),k(this,"beforeFileUpload",(e,t=!1,n)=>{const i=ot(),a=n===Ag.VIDEO,o=(e=>{switch(e){case"vision":return"image";case"document":case"audio":case"default":return"file";default:return e}})(n);return _({type:o,file:e,id:null,url:"",name:e.name,collection_name:"",progress:0,status:"uploading",greenNet:a?"greening":"success",size:e.size,error:"",itemId:i,file_type:e.type,showType:o,file_class:n},t||"default"===n?{context:"full"}:{})}),k(this,"startParse",(e,t)=>P(this,null,function*(){var n;e.id&&(n={file_id:e.id},P(void 0,null,function*(){const e=Uf();return yield Ox("/files/parse",{method:"POST",headers:{"Accept-Language":`${e.language},${e.language.split("-")[0]};q=0.9`},data:n})})).then(n=>{var i,a,o,s,r;if(n.success&&(null==(i=n.data)?void 0:i.file_id)&&(null==(a=n.data)?void 0:a.file_id)===e.id){if(e.file&&(e.file=C(_({},e.file),{meta:C(_({},null==(o=e.file)?void 0:o.meta),{parse_meta:{parse_status:"running"}})}),this.parseTaskIds.push(null==(s=n.data)?void 0:s.file_id)),t){const t=this.fileItems.find(t=>t.id===e.id);(null==t?void 0:t.file)&&(t.file=e.file)}this.loopParse||this.loopGetParseStatus(),this.onAddSuccess(this.fileItems,e)}else e.file&&(this.parseTaskIds=this.fileItems.filter(t=>t.id&&t.id!==e.id).map(e=>e.id||""),e.file=C(_({},e.file),{meta:C(_({},null==(r=e.file)?void 0:r.meta),{parse_meta:{parse_status:"failed",retry:!0}})}),this.onPaseFail(this.fileItems,e))})})),k(this,"loopGetParseStatus",()=>P(this,null,function*(){const e=()=>{this.parseTaskIds=[],this.loopParse=null,this.fileItems.length&&this.fileItems.map(e=>{var t,n,i,a;e.file&&"running"===(null==(i=null==(n=null==(t=e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)&&(e.file=C(_({},e.file),{meta:C(_({},null==(a=e.file)?void 0:a.meta),{parse_meta:{parse_status:"failed",retry:!0}})}),this.onPaseFail(this.fileItems,e))})};try{this.loopParse=setTimeout(()=>{const t=this.parseTaskIds.filter(e=>this.fileItems.find(t=>t.id===e));var n;t.length?(n={file_id_list:t},P(void 0,null,function*(){const e=Uf();return yield Ox("/files/parse/status",{method:"POST",headers:{"Accept-Language":`${e.language},${e.language.split("-")[0]};q=0.9`},data:n})})).then(t=>{var n;if(t.success){const e=[];null==(n=null==t?void 0:t.data)||n.map(t=>{var n,i,a,o,s,r,l,c;const u=this.fileItems.find(e=>e.id===t.file_id);"running"===t.status&&u?e.push(t.file_id):"success"===t.status&&u&&"running"===(null==(a=null==(i=null==(n=null==u?void 0:u.file)?void 0:n.meta)?void 0:i.parse_meta)?void 0:a.parse_status)?u.file&&(u.file=C(_({},u.file),{meta:C(_({},null==(o=u.file)?void 0:o.meta),{parse_meta:{parse_status:"success"}})}),this.onPaseSuccess(this.fileItems,u)):"failed"===t.status&&u&&"running"===(null==(l=null==(r=null==(s=null==u?void 0:u.file)?void 0:s.meta)?void 0:r.parse_meta)?void 0:l.parse_status)&&u.file&&(u.file=C(_({},u.file),{meta:C(_({},null==(c=u.file)?void 0:c.meta),{parse_meta:{parse_status:"failed",error_msg:t.error_msg,error_code:t.error_code,retry:t.retry}})}),AC.openOnce({type:"error",content:hE.t(t.error_msg)}),this.onPaseFail(this.fileItems,u))}),e.length?(this.parseTaskIds=e,this.loopGetParseStatus()):(clearTimeout(this.loopParse),this.loopParse=null,this.parseTaskIds=[])}else e()}):(clearTimeout(this.loopParse),this.loopParse=null,this.parseTaskIds=[])},2e3)}catch(t){clearTimeout(this.loopParse),this.loopParse=null,this.parseTaskIds=[]}})),k(this,"uploadFile",e=>P(this,null,function*(){const{file:t,fullContext:n=!1,uploadType:i,retryFile:a}=e;if(!this.validateFileCount(i))return!1;const o=a||this.beforeFileUpload(t,n,i);this.fileItems.push(o),a&&(o.status="uploading",this.onAddProcess(this.fileItems,o));const s=i===Ag.VIDEO,r=i===Ag.AUDIO,l=i===Ag.IMAGE;try{const e=S_(),n=yield dE.uploadFileToOss(t,{onUploadProgress:e=>{o.progress=e,this.updateFile(o),this.onAddProcess(this.fileItems,o)},onUploadFailed:e=>{let t="Upload failed. Please try again after your network connection is restored.";(null==e?void 0:e.errorCode)&&(t=e.info),AC.openOnce({type:"error",content:hE.t(t)}),o.status="upload_error","data_inspection_failed"===(null==e?void 0:e.errorCode)&&(o.greenNet="green_error"),this.updateFile(o),this.onAddFail(this.fileItems,o)},onResumeUpload:()=>{o.status="uploading",this.updateFile(o),this.onAddProcess(this.fileItems,o)},onUploadSuccess:(i,a)=>P(this,null,function*(){var c,u;const d=S_();let h=S_();var p;o.id=i,o.url=a,o.file=((e,t,n)=>{const{name:i,size:a,type:o}=e,s=(new Date).getTime();return{created_at:s,data:{},filename:i,hash:null,id:t,user_id:n,meta:{name:i,size:a,content_type:o},update_at:s}})(t,i,this.userId),s||l||r||(o.status="uploaded"),s&&(o.type="video",(yield(p=a,new Promise(e=>{const t=document.createElement("video");t.style.display="none",t.style.width="0%",t.style.height="0%",Object.assign(t,{controls:!1,autoplay:!1,muted:!0});let n=!1;t.onloadedmetadata=()=>{n||(n=!0,e(!0),document.body.removeChild(t))},t.onload=()=>{n||(n=!0,e(!0),document.body.removeChild(t))},t.onerror=()=>{n||(n=!0,e(!1),document.body.removeChild(t))},t.src=p,document.body.appendChild(t)})))?(h=S_(),o.showType="video"):o.showType="file",o.status="uploaded"),r&&(o.type="audio",(yield(e=>new Promise(t=>{const n=document.createElement("audio");n.style.display="none",n.style.width="0%",n.style.height="0%",Object.assign(n,{controls:!1,autoplay:!1,muted:!0});let i=!1;n.onloadedmetadata=()=>{i||(i=!0,t(!0),document.body.removeChild(n))},n.onload=()=>{i||(i=!0,t(!0),document.body.removeChild(n))},n.onerror=()=>{i||(i=!0,t(!1),document.body.removeChild(n))},n.src=e,document.body.appendChild(n)}))(a))?(h=S_(),o.showType="audio"):o.showType="file",o.status="uploaded"),l&&(o.type="image",(yield lE(a))?(h=S_(),o.showType="image"):o.showType="file",o.status="uploaded");let m=0;try{m=function(e,t,n=2){if("number"!=typeof e||"number"!=typeof t)throw new Error("");if(e<=0)throw new Error("0");if(t<=0)throw new Error("0");return Number((e/1048576/(t/1e3)).toFixed(n))}(t.size,Math.round(d-e),3)}catch(f){}BS("FileUpload-AllTime",{params:{et:"OTHER",c1:null==(c=null==o?void 0:o.file)?void 0:c.user_id,c4:o.type,c5:t.size,c6:Math.round(h-e),c7:Math.round(h-d),c8:Math.round(d-e),c9:m}}),n&&!dE.getTaskItem(n)||((null==(u=this.parsedFileTypes)?void 0:u.length)&&this.parsedFileTypes.includes(o.type)?this.startParse(o):this.onAddSuccess(this.fileItems,o))})});n?n.errorCode||(o.uploadTaskId=n,this.onAddProcess(this.fileItems,o)):(this.fileItems=this.fileItems.filter(e=>(null==e?void 0:e.itemId)!==o.itemId),this.onAddFail(this.fileItems,o))}catch(qY){"ossTokenError"!==qY.code&&AC.openOnce({type:"error",content:hE.t("Failed to upload file.")}),this.fileItems=this.fileItems.filter(e=>(null==e?void 0:e.itemId)!==o.itemId),this.onAddFail(this.fileItems,o)}})),k(this,"updateFile",e=>{const t=this.fileItems.findIndex(t=>t.itemId===e.itemId);t>-1&&this.fileItems.splice(t,1,e)}),k(this,"pushFile",e=>{Array.isArray(e)?this.fileItems=[...this.fileItems,...e]:this.fileItems.push(e)}),k(this,"setFiles",e=>{this.fileItems=e}),this.onAddProcess=e,this.onAddSuccess=t,this.onAddFail=n,this.onPaseSuccess=i,this.onPaseFail=a,this.userId=s,this.parsedFileTypes=o,hE=q()}updateLimitTypes(e){e&&(this.limitTypes=e)}getLimitTypes(){return this.limitTypes}updateLimitRules(e,t="custom"){"default"===t?(this.defaultLimitRules=Pt(It(Og),e),this.limitRules=this.defaultLimitRules):this.limitRules=Pt(It(this.defaultLimitRules),e);const n=["image/tiff"],i=[".tif",".tiff",".dib"],a=[".dib"],o=this.limitRules[Ag.IMAGE].accept_type,s=this.limitRules[Ag.IMAGE].accept_extension;rx()&&(this.limitRules[Ag.IMAGE].accept_extension=s.filter(e=>!a.includes(e))),cx()&&(this.limitRules[Ag.IMAGE].accept_type=o.filter(e=>!n.includes(e)),this.limitRules[Ag.IMAGE].accept_extension=s.filter(e=>!i.includes(e)))}getLimitRules(){return this.limitRules}validateFile(e,t){return P(this,null,function*(){const n=this.validateFileType(e,t);if(!n||!this.isValidFileType(n))return!1;if(!this.validateFileCount(n))return!1;if(!this.validateFileSize(e,n))return!1;return!!(yield this.validateFileDuration(e,n))&&n})}addFile(e,t){return P(this,null,function*(){const n=(e=>{var t,n,i;if(e.type)return e;const a=null==(i=null==(n=null==(t=null==e?void 0:e.name)?void 0:t.split("."))?void 0:n.at(-1))?void 0:i.toLowerCase();return a&&!(a in cE)||!a?e:new File([e],e.name,{type:cE[a]})})(e),i=yield this.validateFile(n,t);return!!i&&(yield this.uploadFile({file:n,fullContext:!1,uploadType:i}),!0)})}retryFile(e){return P(this,null,function*(){e.file&&(yield this.uploadFile({file:e.file,fullContext:!1,uploadType:e.file_class,retryFile:e}))})}addFiles(e,t){return P(this,null,function*(){var n;if(0===(null==(n=e.filter(e=>!!e))?void 0:n.length))return AC.openOnce({type:"error",content:hE.t("File not found.")}),!1;const i=(yield Promise.allSettled(e.map(e=>this.addFile(e,t)))).filter(e=>"rejected"===e.status).map(e=>e.reason.message);return!(i.length>0&&i.length===e.length)&&this.fileItems})}removeFile(e){this.fileItems=this.fileItems.filter(t=>t.itemId!==e.itemId)}clearFiles(){this.fileItems=[]}getFiles(){return this.fileItems}getFileExtensions(e){var t,n,i;return`${null==(i=null==(n=null==(t=null==e?void 0:e.name)?void 0:t.split("."))?void 0:n.at(-1))?void 0:i.toLowerCase()}`||""}isValidFileType(e){return e&&Object.values(Ag).includes(e)}validateFileType(e,t){const n=e.type,i=this.getFileExtensions(e);if(t){if(Array.isArray(t)){for(let e of t){e===Ag.CAMERA&&(e=Ag.IMAGE);const t=this.limitRules[e];if(this.limitTypes.includes(e)&&(t.accept_type.includes(n)||t.accept_extension.includes(i)))return e}return void AC.openOnce({type:"error",content:hE.t("The selected model or feature does not support the file type you uploaded.")})}const e=this.limitRules[t];return this.limitTypes.includes(t)&&(e.accept_type.includes(n)||e.accept_extension.includes(i))?t:void AC.openOnce({type:"error",content:hE.t("The selected model or feature does not support the file type you uploaded.")})}let a;if(Object.entries(this.limitRules).forEach(([e,t])=>{(t.accept_type.includes(n)||t.accept_extension.includes(i))&&(a=e)}),a&&this.limitTypes.includes(a))return a;AC.openOnce({type:"error",content:hE.t("The selected model or feature does not support the file type you uploaded.")})}validateFileSize(e,t){const n=this.limitRules[t];if(0==e.size)return hE.t("You cannot upload an empty file."),!1;if(e.size>1024*n.max_size*1024){const e={[Ag.IMAGE]:"Images",[Ag.AUDIO]:"Audio",[Ag.VIDEO]:"Video",[Ag.DOC]:"Document",[Ag.DEFAULT]:"TXT"};return AC.openOnce({type:"error",content:hE.t("{{type}} files are not allowed to exceed {{size}}",{type:hE.t(e[t]),size:n.max_size>=1024?`${Number((n.max_size/1024).toFixed(1))}G`:`${n.max_size}M`})}),!1}return!0}validateFileDuration(e,t){return P(this,null,function*(){if(t!==Ag.VIDEO&&t!==Ag.AUDIO)return!0;const n=this.limitRules[t];if(t===Ag.VIDEO){const t=yield(e=>new Promise(t=>{const n=document.createElement("video");n.style.display="none",n.style.width="0%",n.style.height="0%",Object.assign(n,{controls:!1,autoplay:!1,muted:!0});const i=URL.createObjectURL(e);let a=!1;n.onloadedmetadata=()=>{if(!a){a=!0;const e=Math.round(1e3*n.duration);t(e),URL.revokeObjectURL(i),document.body.removeChild(n)}},n.onload=()=>{if(!a){a=!0;const e=Math.round(1e3*n.duration);t(e),URL.revokeObjectURL(i),document.body.removeChild(n)}},n.onerror=()=>{a||(a=!0,t(0),URL.revokeObjectURL(i),document.body.removeChild(n))},n.src=i,document.body.appendChild(n)}))(e);if(t>1e3*n.max_duration)return n.max_duration<60?AC.openOnce({type:"error",content:hE.t("Video duration should not exceed {{maxSeconds}} seconds",{maxSeconds:n.max_duration})}):AC.openOnce({type:"error",content:hE.t("Video duration should not exceed {{maxMins}} mins.",{maxMins:(n.max_duration/60).toFixed(0)})}),!1}if(t===Ag.AUDIO){const t=yield(e=>new Promise(t=>{const n=document.createElement("audio");n.style.display="none",n.style.width="0%",n.style.height="0%",Object.assign(n,{controls:!1,autoplay:!1,muted:!0});const i=URL.createObjectURL(e);let a=!1;n.onloadedmetadata=()=>{if(!a){a=!0;const e=Math.round(1e3*n.duration);t(e),URL.revokeObjectURL(i),document.body.removeChild(n)}},n.onload=()=>{if(!a){a=!0;const e=Math.round(1e3*n.duration);t(e),URL.revokeObjectURL(i),document.body.removeChild(n)}},n.onerror=()=>{a||(a=!0,t(0),URL.revokeObjectURL(i),document.body.removeChild(n))},n.src=i,document.body.appendChild(n)}))(e);if(t>1e3*n.max_duration)return AC.openOnce({type:"error",content:hE.t("Audio duration should not exceed {{maxMins}} minutes.",{maxMins:n.max_duration/60})}),!1}return!0})}validateFileCount(e){var t;const n={[Ag.IMAGE]:"In a single-turn conversation, up to {{number}} images can be uploaded.",[Ag.AUDIO]:"In a single-turn conversation, up to {{number}} audio files can be uploaded.",[Ag.VIDEO]:"In a single-turn conversation, up to {{number}} video can be uploaded.",[Ag.DOC]:"In a single-turn conversation, up to {{number}} documents can be uploaded.",[Ag.DEFAULT]:"In a single-turn conversation, up to {{number}} documents can be uploaded."},i=this.limitRules[e],a=((null==(t=this.fileItems.filter(t=>t.file_class===e))?void 0:t.length)||0)+1,o=i.max_count;if(a>o)return AC.openOnce({type:"error",content:hE.t(n[e],{number:o})}),!1;return this.fileItems.length>this.totalMaxCount?(AC.openOnce({type:"error",content:hE.t("You can only chat with a maximum of {{maxCount}} file(s) at a time.",{maxCount:this.totalMaxCount})}),!1):e}}const fE=(e,t="day",n)=>null===e?n.t("Only available for Plus members"):"month"===t?n.t("{{ number }} uses available within this month.",{number:e}):"day"===t?n.t("{{ number }} uses available within this day.",{number:e}):"hour"===t?n.t("{{ number }} uses available within this hour.",{number:e}):"",gE=({remains:e,unit:t="day",capability:n="",allowHtml:i=!1,currentI18n:a})=>i?((e,t,n="day",i)=>`<div class='chat-common-btn-tooltip-text'>\n          <div class='chat-common-btn-tooltip-main-title'>${i.t("{{ capability }}",{capability:i.t(e)})}\n          </div>\n          <div class='chat-common-btn-tooltip-sub-title'>${fE(t,n,i)}</div>\n        <div>`)(n,e,t,a):fE(e,t,a),vE={theme:"light",realTheme:"light",language:"en-US",showSidebar:!1,showSettingSidebar:!1,isSmallScreen:!1,isMiddleScreen:!1,showSettings:!1,showSettingsGeneralAudioList:!1,showControls:!1,showArtifacts:!1,showWebDev:!1,showDeepResearch:!1,showCallOverlay:!1,isSharePage:!1,initInnerHeight:window.innerHeight,stepCurrent:0,showSlogan:!0,nativeInputFocused:!1,userActiveSidebar:!1,sideBarSearchText:"",showMemorySavedModal:!1,showMemoryUpdatedModal:!1,settingActionMenuItemId:"",closeSubscriptionPopupToSetting:!0,showH5PodcastDetail:!1,showTravel:!1,deepDetailTitle:"",sidebarListScrollTop:0,userMenuDropdownOpen:!1,activeChatMenuId:null,showSharePanel:!1,searchInputFocused:!1,omniButtonBackgroundImg:"https://img.alicdn.com/imgextra/i2/O1CN01sdDcX31h2oVI9jUiL_!!6000000004220-2-tps-96-96.png",sidebarFloatingPlaceholder:!1,showHeaderBorder:!1},yE=Wy()(Bb(e=>_(_({},vE),(e=>({setTheme:t=>{if(e({theme:t}),"system"===t){const t=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";e({realTheme:t})}else e({realTheme:t})},setRealTheme:t=>e({realTheme:t}),setLanguage:t=>e({language:t}),setSettingSidebar:t=>e({showSettingSidebar:t}),setIsSmallScreen:t=>e({isSmallScreen:t}),setSettingActionMenuItemId:t=>e({settingActionMenuItemId:t}),setCloseSubscriptionPopupToSetting:t=>e({closeSubscriptionPopupToSetting:t}),setIsMiddleScreen:t=>e({isMiddleScreen:t}),setShowSidebar:t=>e({showSidebar:t}),setSidebarFloatingPlaceholder:t=>e({sidebarFloatingPlaceholder:t}),setShowSettings:t=>e({showSettings:t}),setShowSettingsGeneralAudioList:t=>e({showSettingsGeneralAudioList:t}),setShowControls:t=>e({showControls:t}),setDeepDetailTitle:t=>e({deepDetailTitle:t}),setShowArtifacts:t=>e({showArtifacts:t}),setShowWebDev:t=>e({showWebDev:t}),setShowDeepResearch:t=>e({showDeepResearch:t}),setShowCallOverlay:t=>e({showCallOverlay:t}),setIsSharePage:t=>e({isSharePage:t}),setShowTravel:t=>e({showTravel:t}),setInitInnerHeight:t=>e({initInnerHeight:t}),setStepCurrent:t=>e({stepCurrent:t}),setShowSlogan:t=>e({showSlogan:t}),setNativeInputFocused:t=>e({nativeInputFocused:t}),setUserActiveSidebar:t=>e({userActiveSidebar:t}),setSideBarSearchText:t=>e({sideBarSearchText:t}),setShowMemorySavedModal:t=>e({showMemorySavedModal:t}),setShowMemoryUpdatedModal:t=>e({showMemoryUpdatedModal:t}),setShowH5PodcastDetail:t=>e({showH5PodcastDetail:t}),setSidebarListScrollTop:t=>e({sidebarListScrollTop:t}),setUserMenuDropdownOpen:t=>e({userMenuDropdownOpen:t}),setActiveChatMenuId:t=>e({activeChatMenuId:t}),setShowSharePanel:t=>e({showSharePanel:t}),setOmniButtonBackgroundImg:t=>e({omniButtonBackgroundImg:t}),setSearchInputFocused:t=>e({searchInputFocused:t}),setShowHeaderBorder:t=>e({showHeaderBorder:t})}))(e)),{name:"uiStore",store:"uiStore",enabled:!1})),bE={user:void 0},xE=Wy()(Bb(e=>_(_({},bE),(e=>({setUser:t=>e({user:t}),fetchUser:(t=!0)=>P(void 0,null,function*(){const n=Uf();try{const{success:i,data:a}=yield Zw(t);if(i&&a)return e({user:a}),a.token&&localStorage.setItem("token",a.token),a;t&&AC.openOnce({type:"error",content:n.t(null==a?void 0:a.message)})}catch(i){}})}))(e)),{name:"userStore",store:"userStore",enabled:!1}));let wE=!1;const SE={subscriptionPlus:!1,paymentRequestId:"",showSubscriptionDetail:!1,showSubscriptionCheckLoading:!1,paymentSubscriptionStatus:null,paymentSubscriptionInfo:null,paymentUserNotifications:[],paymentIssueNotification:null,paymentExpiredNotification:null,paymentReminderNotification:null},_E=e=>({setSubscriptionPlus:t=>e({subscriptionPlus:t}),setPaymentRequestId:t=>e({paymentRequestId:t}),setShowSubscriptionDetail:t=>e({showSubscriptionDetail:t}),setShowSubscriptionCheckLoading:t=>e({showSubscriptionCheckLoading:t}),setPaymentSubscriptionStatus:t=>e({paymentSubscriptionStatus:t}),fetchPaymentSubscriptionStatus:()=>P(void 0,null,function*(){try{const{data:t}=yield P(void 0,null,function*(){return yield Ox("/payment/get_subscription_status")});return t&&!t.code?(e({paymentSubscriptionStatus:t}),t):(t&&t.code,null)}catch(t){return null}}),setPaymentSubscriptionInfo:t=>e({paymentSubscriptionInfo:t}),fetchPaymentSubscriptionInfo:()=>P(void 0,null,function*(){var t;if(!["user","admin"].includes((null==(t=xE.getState().user)?void 0:t.role)||""))return;const n=yE.getState().language;try{const t=yield((e="en")=>P(void 0,null,function*(){return yield Ox(`/configs/?code=page.${e}.payment.subscription-info`)}))((e=>{const t=e.split("-"),n=t[0].toLowerCase();return"zh"===n&&t.length>1?`${n}-${t[1].toLowerCase()}`:n})(n));if(!t)return;t.data.normal&&e({paymentSubscriptionInfo:t.data})}catch(i){}}),fetchPaymentUserNotifications:()=>P(void 0,null,function*(){var t;if(["user","admin"].includes((null==(t=xE.getState().user)?void 0:t.role)||"")&&!wE)try{wE=!0;const t=yield P(void 0,null,function*(){return yield Ox("/notifications/payment")});if(!t)return void(wE=!1);const{data:{notifications:n=[]}=[]}=t;n&&(e({paymentIssueNotification:n.find(e=>"subscription_renewal_issue"===e.type)||null}),e({paymentExpiredNotification:n.find(e=>"subscription_expired"===e.type)||null}),e({paymentReminderNotification:n.find(e=>"subscription_expired_reminder"===e.type)||null})),e({paymentUserNotifications:n})}catch(n){}finally{wE=!1}})}),CE=Wy()(Gb(Bb(e=>_(_({},SE),_E(e)),{name:"paymentStore",store:"paymentStore",enabled:!1})));let EE=null;const kE=()=>{const e=xE.subscribe(e=>{var t,n;e.user&&(localStorage.setItem("userRole",String(null==(t=e.user)?void 0:t.role)),["admin","user"].includes(null==(n=e.user)?void 0:n.role)&&TE.getState().updateEquity())});EE=tx.subscribe(e=>{var t,n;!bT()&&(null==(n=null==(t=null==e?void 0:e.config)?void 0:t.features)?void 0:n.enable_payment_and_quota)&&(EE&&EE(),CE.getState().fetchPaymentSubscriptionInfo(),CE.getState().fetchPaymentUserNotifications())});const t=CE.subscribe(e=>e.subscriptionPlus,(e,t)=>P(void 0,null,function*(){e!==t&&(yield CE.getState().fetchPaymentUserNotifications())}));return()=>{e(),EE&&EE(),t()}},IE={remains:-1,unit:"hour",amount:1},TE=qy()(Lb((e,t)=>({modelsEquities:{},featuresEquities:{},isUpdating:!1,startAutoUpdate:!1,updateEquity:()=>P(void 0,null,function*(){yield t().resolveAllEquity()}),resetAllEquity:()=>P(void 0,null,function*(){e(e=>{Object.keys(e.modelsEquities).forEach(t=>{e.modelsEquities[t]=IE}),Object.keys(e.featuresEquities).forEach(t=>{e.featuresEquities[t]=IE})})}),getModelEquity:e=>{const n=t();return n.modelsEquities[e]?n.modelsEquities[e]:(n.updateEquityAndCache(e,IE,"model"),IE)},getFeatureEquity:e=>{const n=t();return n.featuresEquities[e]?n.featuresEquities[e]:(n.updateEquityAndCache(e,IE,"feature"),IE)},updateEquityAndCache:(t,n,i)=>{e(e=>{"model"===i?e.modelsEquities[t]&&Mt(e.modelsEquities[t],n)||(e.modelsEquities[t]=n):e.featuresEquities[t]&&Mt(e.featuresEquities[t],n)||(e.featuresEquities[t]=n)})},resolveAllEquity:()=>P(void 0,null,function*(){var n,i,a;if(!(null==(i=null==(n=tx.getState().config)?void 0:n.features)?void 0:i.enable_payment_and_quota))return;if(!["user","admin"].includes((null==(a=xE.getState().user)?void 0:a.role)||""))return;const o=t();if(!o.isUpdating){e(e=>{e.isUpdating=!0});try{const e=yield(s=[...Wg],P(void 0,null,function*(){return yield Ox("/users/user/entitlement_quota",{method:"POST",data:JSON.stringify({features:s})})})),t=null==e?void 0:e.data;if(t&&t.model){const e=t.model;e&&Object.keys(e).length&&Object.keys(e).forEach(t=>{const n=e[t];if(n){const e=o.formatEquity(n);o.updateEquityAndCache(t,e,"model")}}),Object.keys(t).forEach(e=>{if("model"!==e){const n=t[e];if(n){const t=o.formatEquity(n);o.updateEquityAndCache(e,t,"feature")}}}),CE.getState().setSubscriptionPlus("subscription-plus"===t.user_tier)}}finally{e(e=>{e.isUpdating=!1})}var s}}),formatEquity:e=>({remains:e.times_left,unit:e.time_unit,amount:e.time_amount})}))),jE=()=>P(void 0,null,function*(){TE.getState().resolveAllEquity(),CE.getState().fetchPaymentUserNotifications()}),NE=()=>P(void 0,null,function*(){var e,t;(null==(t=null==(e=tx.getState().config)?void 0:e.features)?void 0:t.enable_payment_and_quota)&&(TE.getState().startAutoUpdate=!0,document.addEventListener("visibilitychange",()=>P(void 0,null,function*(){"visible"===document.visibilityState&&jE()})),window.addEventListener("pageshow",jE),window.addEventListener("focus",jE))});tx.subscribe(e=>{var t,n;!TE.getState().startAutoUpdate&&(null==(n=null==(t=e.config)?void 0:t.features)?void 0:n.enable_payment_and_quota)&&(TE.getState().resolveAllEquity(),NE())}),NE(),TE.getState().resolveAllEquity();const PE=(e,t)=>{if(t)return t;switch(e){case og.PARSING:return sv("Please wait, Qwen is still viewing the webpage content");case og.SUCCESS:return sv("Qwen successfully viewed the content of this webpage");case og.FAIL:return sv("Qwen was unable to view the content of this webpage");case og.OUT_OF_LIMIT:return sv("Qwen can only view up to 10 webpages per round");default:return sv("Qwen was unable to view the content of this webpage")}},ME=(e,t)=>{if(fx()&&kx("1.0.0",!0))return[];const n=[];let i=0,a=e;"string"!=typeof a&&(a=String(a));return[...a.matchAll(/(https):\/\/([a-zA-Z0-9\-.]+\.[a-zA-Z]{2,})(:[0-9]+)?(\/[a-zA-Z0-9/+=%&_.~?@-]*)?(#[a-zA-Z0-9/+=%&_.~?-]*)?(?=\s|$|[^\u0080-\uFFFF])/g)].forEach((e,o)=>{var s,r;const l=e[0],c=e.index,u=c+l.length;i<c&&n.push({content:a.slice(i,c),type:ag.text});const d=void 0===t?og.PARSING:(null==(s=t.find(e=>e.url===l))?void 0:s.status)||og.FAIL;n.push({content:l,type:ag.url,title:PE(d,null==(r=null==t?void 0:t.find(e=>e.url===l))?void 0:r.title),status:d}),i=u}),i<(null==a?void 0:a.length)&&n.push({content:a.slice(i),type:ag.text}),n},AE=e=>{let t="";return e.forEach(e=>{t+=e.content,e.type===ag.url&&(t+=" ")}),t},RE=e=>ME(e).filter(e=>e.type===ag.url).map(e=>e.content),OE=(e,t,n)=>{if(!t)return e;if("zh-CN"===n){let n=t.split(" ").filter(Boolean).map(e=>{return`\\b${t=e,t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}\\b`;var t}).join("|");const i=[...t].filter(e=>/[\u4e00-\u9fff]/.test(e));if(i.length>0){n+=(n?"|":"")+i.map(e=>`(${e})`).join("|")}const a=new RegExp(n,"gi");return e.replace(a,e=>`<span style="color: ${rE("#8F91A8","#AFB1C4")}; display: inline;">${e}</span>`)}if(e.includes(t)){const n=new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g");return e.replace(n,e=>`<span style="color: ${rE("#8F91A8","#AFB1C4")}; display: inline;">${e}</span>`)}return e},DE=(e,t=null)=>{const n=[...e],i=n.length,a=null==t||t<0?i:Math.min(t,i);for(let o=i-1;o>0;o--){const e=Math.floor(Math.random()*(o+1));[n[o],n[e]]=[n[e],n[o]]}return n.slice(0,a)},LE=e=>e===Zf.ImageGeneration?"image_edit":e===Zf.WebSearch?"web_search":e===Zf.VideoGeneration?"video_generation":e,FE={[Zf.VideoGeneration]:{fileType:["JPG","JPEG","PNG","BMP","WEBP"],mineType:["image/png","image/jpeg","image/bmp","image/webp"],extensions:[".png",".jpg",".jpeg",".bmp",".webp"]}},UE=e=>{const{type:t="",file_type:n="",name:i=""}=e||{};return["image/png","image/jpeg","image/bmp","image/tiff","image/webp"].includes(n||t)&&(i.toLowerCase().endsWith(".png")||i.toLowerCase().endsWith(".jpg")||i.toLowerCase().endsWith(".jpeg")||i.toLowerCase().endsWith(".bmp")||i.toLowerCase().endsWith(".tif")||i.toLowerCase().endsWith(".tiff")||i.toLowerCase().endsWith(".webp"))},zE=(e,t,n=[],i,a,o)=>{var s;const r=null==(s=null==i?void 0:i.features)?void 0:s.feature_file,l=null==r?void 0:r[LE(t)];if(l&&!(null==l?void 0:l.includes(e)))return!0;if(n.some(t=>{const n=null==r?void 0:r[LE(t)];return n&&!(null==n?void 0:n.includes(e))}))return!0;const c=(e=>{const t=["default"];return Object.keys(Ag).forEach(n=>{const i=Ag[n];e.every(e=>{var t,n,a;return 1===(null==(a=null==(n=null==(t=null==e?void 0:e.info)?void 0:t.meta)?void 0:n.abilities)?void 0:a[i])})&&t.push(i)}),t})(a||[]).map(e=>"document"===e||"default"===e?Rg.FILE:"vision"===e?Rg.IMAGE:e);return!c.includes(e)||!(e!==Rg.IMAGE||t!==Zf.VideoGeneration||!(null==o?void 0:o.some(e=>"image"===e.type)))},HE=(e,t,n,i,a=[],o)=>{var s,r,l,c,u,d,h,p,m,f,g,v;if(o&&(null==o?void 0:o.length)>1||(null==i?void 0:i.length)>1)return{disabled:!0,msg:sv("The function {{capability}} is not supported in battle mode.",{capability:t})};if(!i||1===(null==i?void 0:i.length)&&!i[0])return{disabled:!1,msg:""};if(0===(null==(r=null==(s=null==n?void 0:n.permissions)?void 0:s.chat)?void 0:r[e]))return{disabled:!0,msg:sv("Coming soon")};if(5===(null==(c=null==(l=null==n?void 0:n.permissions)?void 0:l.chat)?void 0:c[e])&&bT())return{disabled:!0,msg:sv("{{capability}} is not supported in guest mode.",{capability:t})};if(2===(null==(d=null==(u=null==n?void 0:n.permissions)?void 0:u.chat)?void 0:d[e]))return{disabled:!0};const y=i[0],b=(null==(p=null==(h=null==y?void 0:y.info)?void 0:h.meta)?void 0:p.chat_type)||[],x=(null==(f=null==(m=null==y?void 0:y.info)?void 0:m.meta)?void 0:f.abilities)||{};let w=!1;if(w=e===Zf.Thinking||e===Zf.Mcp?!(null==x?void 0:x[e])||0===(null==x?void 0:x[e])||2===(null==x?void 0:x[e])||5===(null==x?void 0:x[e]):!b.includes(e),w)return{disabled:!0,msg:sv("{{model}} does not support {{capability}}",{model:null==y?void 0:y.name,capability:t})};const S=(null==(v=null==(g=null==n?void 0:n.features)?void 0:g.feature_file)?void 0:v[LE(e)])||Object.values(Rg);return Object.values(Rg).some(e=>!(S.includes(e)||!a.some(t=>{return((n=t.file_class)===Ag.DOC||n===Ag.DEFAULT?Rg.FILE:n===Ag.IMAGE?Rg.IMAGE:n)===e;var n})))?{disabled:!0,msg:""}:{disabled:!1,msg:""}};const $E=[Zf.ImageGeneration,Zf.VideoGeneration,Zf.ImageEdit],BE=(e,t,n,i,a,o)=>{var s,r,l,c,u;const{disabled:d}=HE(e,t,n,i,a);return!d&&(1===(null==i?void 0:i.length)&&((null==(r=null==(s=null==n?void 0:n.permissions)?void 0:s.chat)?void 0:r[e])===o||(null==(u=null==(c=null==(l=i[0])?void 0:l.info)?void 0:c.meta)?void 0:u.abilities[e])===o))},qE=(e,t,n)=>{BS("chatGeneration",{params:{et:"CLK"},aesParams:{c4:t,c5:n,c6:e},paramsExtend:{chat_id:t,msg_type:n,send_type:e}})},GE=(e,t,n,i)=>{var a;if(t||n)for(const o of e)if(o.key||(null==(a=o.childrens)?void 0:a.length)){if(o.key===n||o.key===t||"mcp"===o.key&&i)return o;if(o.childrens){const e=GE(o.childrens,t,n);if(e)return e}}},VE=(e,t)=>{const n=null==e?void 0:e[t||""];return n?(null==n?void 0:n.chat_type)===Zf.DeepResearch&&(null==n?void 0:n.sub_chat_type)===Zf.DeepResearch?n:(null==n?void 0:n.parentId)?VE(e,null==n?void 0:n.parentId):null:null},WE=(e,t="assistant")=>e.findLastIndex(e=>e.chat_type===Zf.DeepResearch&&e.sub_chat_type===Zf.DeepResearch&&e.role===t);class QE{constructor(){k(this,"paramsMap",{}),k(this,"addItem",(e,t)=>{if(!e)return{};this.paramsMap=C(_({},this.paramsMap),{[e]:t})}),k(this,"removeItem",e=>{if(!e)return{};delete this.paramsMap[e]}),k(this,"getParamsMap",()=>this.paramsMap),k(this,"getParams",e=>e?this.paramsMap[e]:{}),k(this,"setParams",(e,t)=>{if(!e)return{};this.paramsMap=C(_({},this.paramsMap),{[e]:_(_({},this.paramsMap[e]),t)})}),k(this,"setParamsForAll",e=>{this.paramsMap&&"{}"!==JSON.stringify(this.paramsMap)&&Object.keys(this.paramsMap).forEach(t=>{this.paramsMap[t]=_(_({},this.paramsMap[t]),e)})}),k(this,"clearParams",()=>{this.paramsMap={}})}}const KE=new class extends QE{constructor(){super(),k(this,"type","ModelStreamingInterfaceStatisticsEvent"),k(this,"sendEvent",e=>{var t;if(!e)return;const n=this.getParams(e);if(!n||"{}"===JSON.stringify(n))return;const{first_chunk_time:i=0,api_start_time:a=0,chunk_info_list:o=[],model_id:s,is_error:r=!1,is_leave:l=!1,is_stop:c=!1,error_info:u=null,x_request_id:d,chat_id:h="",chat_type:p=""}=n,m=i-a;let f=0,g=0,v=0,y=0,b=0,x=0;(null==o?void 0:o.length)>0&&(f=null==(t=o[o.length-1])?void 0:t.chunk_time,g=Math.max(...(o||[]).map(e=>e.interval_time)),v=o.reduce((e,t)=>e+t.chunk_size,0),y=o.reduce((e,t)=>e+t.interval_time,0),b=y/o.length,x=v/(f-i)*1e3);const w={et:"OTHER",c6:m,c7:g,c8:{avg_chunk_interval:Number(b.toFixed(2)),avg_char_rate:Number(x.toFixed(2)),model:s,api_start_time:a,total_chars:v,end_chunk_time:f,first_chunk_time:i,x_request_id:d,is_stop:c,is_error:r,is_leave:l,error_info:u,response_id:e,chat_id:h,chat_type:p}};HS("modelStreamingInterfaceStatistics",{params:w}),this.removeItem(e)}),k(this,"sendAllEvent",()=>{this.paramsMap&&"{}"!==JSON.stringify(this.paramsMap)&&(Object.keys(this.getParamsMap()).forEach(e=>{this.sendEvent(e)}),this.clearParams())}),k(this,"dealEventStreamChunkData",(e,t)=>{const n=this.getParams(e);let i=null==n?void 0:n.first_chunk_time;const a=null==n?void 0:n.api_start_time;let o=null==n?void 0:n.first_packet_time;!i&&a&&(i=null==t?void 0:t.chunk_time,o=i-a,this.setParams(e,{first_chunk_time:i,first_packet_time:o}));let s=null==n?void 0:n.chunk_info_list,r=(null==n?void 0:n.max_chunk_interval)||0;if(s&&0!==(null==s?void 0:s.length)){const e=(null==t?void 0:t.chunk_time)-s[s.length-1].chunk_time;s.push(C(_({},t),{interval_time:e})),r=Math.max(r,e)}else s=[C(_({},t),{interval_time:0})];this.setParams(e,{chunk_info_list:s,max_chunk_interval:r})})}};class YE{constructor(e){k(this,"instanceId"),this.instanceId=e}isCurrentRunningInstance(){return this.instanceId===ZC.currentId}get(e){const t=Wb.getState();if(e in t)return t[e]}set(e,t){if(!this.isCurrentRunningInstance())return;const n=Wb.getState(),i=String(e),a=`set${i.charAt(0).toUpperCase()+i.slice(1)}`;"function"==typeof n[a]&&n[a](t)}changeHistory(e){Wb.getState().updateHistoryByImmer(e)}forceSet(e,t){const n=Wb.getState(),i=String(e),a=`set${i.charAt(0).toUpperCase()+i.slice(1)}`;"function"==typeof n[a]&&n[a](t)}getAvailableKeys(){const e=Wb.getState();return Object.keys(e).filter(t=>!t.startsWith("set")&&"function"!=typeof e[t])}getAvailableSetters(){const e=Wb.getState();return Object.keys(e).filter(t=>t.startsWith("set")&&"function"==typeof e[t])}hasKey(e){const t=Wb.getState();return e in t&&!e.startsWith("set")&&"function"!=typeof t[e]}hasSetter(e){return"function"==typeof Wb.getState()[`set${e.charAt(0).toUpperCase()+e.slice(1)}`]}subscribe(e){return Wb.subscribe(e)}getState(){return Wb.getState()}resetChatState(){const e=Wb.getState();"function"==typeof e.resetChatState&&e.resetChatState()}getInstanceId(){return this.instanceId}}class XE extends YE{constructor(e){super(e),k(this,"localState",Vb())}get(e){return this.localState[e]}set(e,t){this.localState[e]=t,this.isCurrentRunningInstance()&&super.set(e,t)}forceSet(e,t){super.forceSet(e,t)}forceSetAllState(){Object.keys(this.localState).forEach(e=>{this.forceSet(e,this.localState[e])})}getLocalState(){return _({},this.localState)}setLocalState(e){this.localState=_(_({},this.localState),e)}clearLocalState(){this.localState={}}resetChatState(){this.localState=Vb(),this.isCurrentRunningInstance()&&super.resetChatState()}get isStopDisabled(){return this.get("isStopDisabled")}set isStopDisabled(e){this.set("isStopDisabled",e)}get currentChatPage(){return this.get("currentChatPage")}set currentChatPage(e){this.set("currentChatPage",e)}get chatLoaded(){return this.get("chatLoaded")}set chatLoaded(e){this.set("chatLoaded",e)}get isChat(){return this.get("isChat")}set isChat(e){var t;if(!1===e){if(null==(t=sC(this.history.currentId,this.history))?void 0:t.find(e=>"assistant"===e.role&&!e.done))return}this.set("isChat",e)}get chatPermission(){return this.get("chatPermission")}set chatPermission(e){this.set("chatPermission",e)}get chatId(){return this.get("chatId")}set chatId(e){this.set("chatId",e)}get chatTitle(){return this.get("chatTitle")}set chatTitle(e){this.set("chatTitle",e)}get projectId(){return this.get("projectId")}set projectId(e){this.set("projectId",e)}get emitSendPromptType(){return this.get("emitSendPromptType")}set emitSendPromptType(e){this.set("emitSendPromptType",e)}get history(){return this.get("history")}set history(e){this.set("history",e)}changeHistory(e){if(e&&"function"==typeof e){const t=JSON.parse(JSON.stringify(this.localState.history));e(t),this.localState.history=t,this.isCurrentRunningInstance()&&super.changeHistory(e)}else this.set("history",e)}get historyCurrentId(){return this.get("historyCurrentId")}set historyCurrentId(e){this.set("historyCurrentId",e)}get pinnedChats(){return this.get("pinnedChats")}set pinnedChats(e){this.set("pinnedChats",e)}get allSearchAndThinkLists(){return this.get("allSearchAndThinkLists")}set allSearchAndThinkLists(e){this.set("allSearchAndThinkLists",e)}get currentInputFeature(){return this.get("currentInputFeature")}set currentInputFeature(e){this.set("currentInputFeature",e)}get currentInputSubType(){return this.get("currentInputSubType")}set currentInputSubType(e){this.set("currentInputSubType",e)}get currentCitationInfo(){return this.get("currentCitationInfo")}set currentCitationInfo(e){this.set("currentCitationInfo",e)}get currentSearchSource(){return this.get("currentSearchSource")}set currentSearchSource(e){this.set("currentSearchSource",e)}get temporarySource(){return this.get("temporarySource")}set temporarySource(e){this.set("temporarySource",e)}get currentSearchLists(){return this.get("currentSearchLists")}set currentSearchLists(e){this.set("currentSearchLists",e)}get currentArtifactsMessage(){return this.get("currentArtifactsMessage")}set currentArtifactsMessage(e){this.set("currentArtifactsMessage",e)}get shareChatError(){return this.get("shareChatError")}set shareChatError(e){this.set("shareChatError",e)}get chatMode(){return this.get("chatMode")}set chatMode(e){this.set("chatMode",e)}get imageReasonData(){return this.get("imageReasonData")}set imageReasonData(e){this.set("imageReasonData",e)}get branchInfo(){return this.get("branchInfo")}set branchInfo(e){this.set("branchInfo",e)}}const JE=(e,t)=>{var n,i,a;const{phaseContentMode:o="single_answer"}={};if(!e)return"";if(null==e?void 0:e.content)return e.content;if(!Array.isArray(null==e?void 0:e.content_list))return"";if(!(null==e?void 0:e.content_list.length))return"";if("single_answer"===o){const t=null==(n=null==e?void 0:e.content_list)?void 0:n.findLast(e=>e.phase===ng.IMAGE_GEN&&e.content);return t?(null==t?void 0:t.content)||"":(null==(a=null==(i=null==e?void 0:e.content_list)?void 0:i.find(e=>[ng.ANSWER].includes(e.phase)))?void 0:a.content)||""}return null==e?void 0:e.content_list.filter(e=>e.phase===ng.ANSWER).map(e=>(null==e?void 0:e.content)||"").join("")},ZE=e=>({meta:{subChatType:"translate",translateLanguage:e}}),ek=(e,t,n)=>`${e}\n${t}\n\n${n.title}:`,tk=(e,t)=>{var n,i,a,o,s,r,l,c,u,d,h,p,m,f,g,v,y,b,x,w,S;let _=null;if(_=t?null==(n=null==e?void 0:e.messages)?void 0:n[t]:(e?Object.values((null==e?void 0:e.messages)||{}):[]).find(e=>{var t;return"assistant"===e.role&&e.sub_chat_type===Zf.INTERRUPT&&!!(null==(t=null==e?void 0:e.content_list)?void 0:t.find(e=>e.phase===ng.PdfMdGen))}),_){const e=null==(i=null==_?void 0:_.content_list)?void 0:i.find(e=>e.phase===ng.PdfMdGen),n=(null==(o=null==(a=null==e?void 0:e.extra)?void 0:a.deep_research)?void 0:o.version)||"";if(n)return n;if(t)return""}const C=e=>{var t,n;return(null==e?void 0:e.sub_chat_type)===Zf.DeepResearch||(null==(n=null==(t=null==e?void 0:e.extra)?void 0:t.meta)?void 0:n.subChatType)===Zf.DeepResearch},E=(e?Object.values((null==e?void 0:e.messages)||{}):[]).filter(e=>"assistant"===e.role&&C(e)&&!(null==e?void 0:e.error)),k=null==e?void 0:e.currentId;if(k){const t=sC(k,e).find(e=>"assistant"===(null==e?void 0:e.role)&&C(e)&&!(null==e?void 0:e.error));if(t)return(null==(c=null==(l=null==(r=null==(s=null==t?void 0:t.content_list)?void 0:s[0])?void 0:r.extra)?void 0:l.deep_research)?void 0:c.version)||""}return k&&(null==(d=null==(u=null==e?void 0:e.messages)?void 0:u[k])?void 0:d.sub_chat_type)===Zf.DeepResearch?(null==(v=null==(g=null==(f=null==(m=null==(p=null==(h=null==e?void 0:e.messages)?void 0:h[k])?void 0:p.content_list)?void 0:m[0])?void 0:f.extra)?void 0:g.deep_research)?void 0:v.version)||"":(null==(y=null==E?void 0:E[0])?void 0:y.content_list)&&(null==(S=null==(w=null==(x=null==(b=E[0])?void 0:b.content_list[0])?void 0:x.extra)?void 0:w.deep_research)?void 0:S.version)||""},nk=(e,t,n)=>{var i,a,o,s,r,l;const{chatType:c,subChatType:u,extra:d={},userAction:h}=n;switch(c){case Zf.Artifacts:case Zf.ImageGeneration:case Zf.VideoGeneration:case Zf.Image2Video:case Zf.WebSearch:case Zf.Slides:case Zf.Txt2Txt:{if((null==(i=null==d?void 0:d.meta)?void 0:i.user_action)&&delete d.meta.user_action,[eg.OmniAudio,eg.OmniVideo].includes(u))return C(_({},n),{subChatType:Zf.Txt2Txt});let e=u||c;return t&&"translate"===t||"translate"!==u||(e=n.chatType),C(_({},n),{subChatType:e})}case Zf.DeepResearch:case Zf.Travel:{const i=It(d);let p="";return(null==(a=null==d?void 0:d.meta)?void 0:a.subChatType)&&"retry"===(null==(o=null==d?void 0:d.meta)?void 0:o.user_action)&&(p=null==(s=null==d?void 0:d.meta)?void 0:s.subChatType),(null==(r=null==i?void 0:i.meta)?void 0:r.user_action)&&(delete d.meta.user_action,delete i.meta.user_action),p=p||((e,t,n)=>{var i,a;if(!n)return e;const o=null==n?void 0:n.at(-1);if(e===Zf.DeepResearch){if(t===Zf.DeepResearchWebDev||t===Zf.Podcast)return t;const e=null==n?void 0:n.findLast(e=>{var t,n;return((null==(n=null==(t=null==e?void 0:e.extra)?void 0:t.meta)?void 0:n.subChatType)===Zf.DeepResearch||(null==e?void 0:e.sub_chat_type)===Zf.DeepResearch)&&"assistant"===e.role}),s=n.findLastIndex(e=>{var t;return(null==e?void 0:e.chat_type)===Zf.DeepResearch&&[Zf.DeepResearch,Zf.INTERRUPT].includes(e.sub_chat_type)&&(null==e?void 0:e.done)&&(null==(t=null==e?void 0:e.content_list)?void 0:t.some(e=>e.phase===ng.PdfMdGen))});let r=It(n);-1!==s&&(r=r.slice(s+1));const l=null==r?void 0:r.find(e=>{var t;return(null==e?void 0:e.sub_chat_type)===Zf.INTERRUPT&&"assistant"===e.role&&(null==(t=null==e?void 0:e.content_list)?void 0:t.find(e=>e.phase===ng.ANSWER))}),c=e&&!0!==(null==e?void 0:e.done)&&!(null==e?void 0:e.error)&&!l,u=(null==o?void 0:o.sub_chat_type)||(null==(a=null==(i=null==o?void 0:o.extra)?void 0:i.meta)?void 0:a.subChatType)||"";return[Zf.DeepResearch,Zf.INTERRUPT].includes(u)&&c?Zf.INTERRUPT:(null==o?void 0:o.sub_chat_type)===Zf.DeepThinking?Zf.DeepResearch:Zf.DeepThinking}return e===Zf.Podcast?Zf.Podcast:e===Zf.Travel?(null==o?void 0:o.sub_chat_type)===Zf.TRAVEL_FEEDBACK?Zf.TRAVEL_RESEARCH:Zf.TRAVEL_FEEDBACK:t})(c,t||"",e),c===Zf.DeepResearch&&p===Zf.INTERRUPT&&(i.deep_research_id=null==(l=e.findLast(e=>e.sub_chat_type===Zf.DeepResearch&&"assistant"===e.role))?void 0:l.id),([Zf.DeepResearchWebDev,Zf.Podcast].includes(u)||h===Qf.EDIT)&&(p=u),C(_({},n),{subChatType:p,extra:i})}}return n},ik=(e,t)=>{var n,i,a;let o="";switch(e){case Ce.md:o=(null==(n=null==t?void 0:t.md)?void 0:n.link)||"";break;case Ce.pdf:o=(null==(i=null==t?void 0:t.pdf)?void 0:i.link)||"";break;case Ce.image:o=(null==(a=null==t?void 0:t.image)?void 0:a.link)||""}if(!o){const e=q();return void ut.openOnce({type:"error",content:e.t("Download failed: url error")})}try{K_({url:o,errorTexts:!0})}catch(s){const e=q();ut.openOnce({type:"error",content:e.t("Download failed")})}},ak=e=>{const t=e.match(/```[\s\S]*?```/g),n=[];t&&t.forEach(e=>{const t=e.split("\n")[0].replace("```","").trim().toLowerCase(),i=e.replace(/```[\s\S]*?\n/,"").replace(/```$/,"");n.push({lang:t,code:i})});let i="",a="",o="";const s=n.find(e=>"jsx"===e.lang),r=n.find(e=>"tsx"===e.lang);if(s){const{code:e}=s}else if(r){const{code:e}=r}else n.forEach(e=>{const{lang:t,code:n}=e;"html"===t?i+=n+"\n":"css"===t?a+=n+"\n":"javascript"!==t&&"js"!==t||(o+=n+"\n")});let l={type:"",iframeType:"",content:""};if(""!==i||""!==a||""!==o){let e="";e=""!==a||""!==o?`\n                        <!DOCTYPE html>\n                        <html lang="en">\n                        <head>\n                            <meta charset="UTF-8">\n                            <meta name="viewport" content="width=device-width, initial-scale=1.0">\n              <style>\n                body {\n                  background-color: white; /* Ensure the iframe has a white background */\n                }\n\n                ${a}\n              </style>\n                        </head>\n                        <body>\n                            ${i}\n\n              <script>\n                              ${o}\n              <\/script>\n                        </body>\n                        </html>\n                    `:i,l={type:"iframe",iframeType:"html",content:e}}else for(const c of n)"svg"===c.lang||"xml"===c.lang&&c.code.includes("<svg")?l={type:"svg",iframeType:"html",content:c.code}:"jsx"===c.lang?l={type:"iframe",iframeType:"jsx",content:c.code}:"tsx"===c.lang&&(l={type:"iframe",iframeType:"tsx",content:c.code});return""===l.content&&(e.toLowerCase().startsWith("<!doctype html>")?l={type:"iframe",iframeType:"html",content:e}:e.toLowerCase().startsWith("import")&&(l={type:"iframe",iframeType:"jsx",content:e})),l};function ok(e){return[ng.IMAGE_GEN_THINK,ng.IMAGE_GEN_WEB_SEARCH,ng.IMAGE_GEN,ng.IMAGE_EDIT].includes(e)}function sk(e){return[ng.LOCAL_TOOL,ng.TOOL,ng.IMAGE_ZOOM_IN_TOOL,ng.CODE_INTERPRETER,ng.WEB_EXTRACTOR,ng.IMAGE_GEN_TOOL,ng.IMAGE_EDIT_TOOL,ng.WEB_SEARCH_IMAGE,ng.IMAGE_SEARCH].includes(e)}function rk(e,t){e.push(t)}function lk(e,t){const{extra:n,phase:i,subChatType:a}=t;if(a===Zf.DeepResearch)e.extra=((e,t)=>{var n;const{extra:i={}}=e,{phase:a}=t,o={[Zf.DeepResearch]:{}};let s=(null==i?void 0:i[Zf.DeepResearch])||{};Array.isArray(s)||(s=[_(_({},s),(null==s?void 0:s.query)||{})]);const r=(null==(n=t.extra)?void 0:n[Zf.DeepResearch])||{};switch(a){case ug.PdfMdGen:o[Zf.DeepResearch]=t.extra;break;case ug.ResearchPlanning:case ug.ReportGeneration:case ng.ANSWER:const e=Array.isArray(s)?s[0]:s;o[Zf.DeepResearch]=C(_(_({},e),r),{id:a});break;default:Array.isArray(s)||(s=[]),Array.isArray(r)?o[Zf.DeepResearch]=yC(s,r):o[Zf.DeepResearch]=vC(s,C(_({},r),{phase:a}))}return{extra:o}})(e,{extra:n,phase:i}).extra;else if(a===Zf.TRAVEL_RESEARCH){const t=((e,t)=>{var n;const{extra:i={}}=e,{phase:a}=t,o={[Zf.TRAVEL_RESEARCH]:{}};let s=(null==i?void 0:i[Zf.TRAVEL_RESEARCH])||{};Array.isArray(s)||(s=[_(_({},s),(null==s?void 0:s.query)||{})]);const r=(null==(n=t.extra)?void 0:n[Zf.TRAVEL_RESEARCH])||{};switch(a){case ug.PdfMdGen:o[Zf.TRAVEL_RESEARCH]=t.extra;break;case ug.ResearchPlanning:case ug.ReportGeneration:case ng.ANSWER:const e=Array.isArray(s)?s[0]:s;o[Zf.TRAVEL_RESEARCH]=C(_(_({},e),r),{id:a});break;default:Array.isArray(s)||(s=[]),Array.isArray(r)?o[Zf.TRAVEL_RESEARCH]=yC(s,r):o[Zf.TRAVEL_RESEARCH]=vC(s,C(_({},r),{phase:a}))}return{extra:o}})(e,{extra:n,phase:i}).extra;e.extra=t}else[ng.THINKING_SUMMARY,ng.BIO,ng.WEB_SEARCH,ng.SLIDES,ng.IMAGE_SEARCH].includes(i)&&!jt(n)&&(e.extra=It(n))}function ck(e){const{content_list:t,phase:n,value:i,role:a,status:o,extra:s,lang_code:r,mcp_name:l,tool_name:c,function_call:u,subChatType:d,splitLargeChunks:h,function_id:p,timestamp:m}=e;if(0===t.length||ok(n))return void rk(t,{content:i,role:a,phase:n,status:o,extra:s,lang_code:r,mcp_name:l,tool_name:c,function_call:u,function_id:p,timestamp:m});const f=t.find(e=>e.function_id&&e.function_id===p);sk(n)?function(e,t,n){const{value:i,phase:a,status:o,extra:s,function_id:r,timestamp:l,function_call:c,mcp_name:u,tool_name:d,role:h}=t,p=n||e.at(-1);let m;if(r){for(let f=e.length-1;f>=0;f-=1)if(e[f].function_id===r){m=e[f];break}}else a===ng.LOCAL_TOOL&&(m=e.findLast(e=>e.phase===ng.LOCAL_TOOL&&!!e.mcp_name&&!!e.tool_name&&e.status!==ig.FINISHED),m||o!==ig.FINISHED||(null==s?void 0:s.local_mcp)||(m=e.findLast(e=>e.phase===ng.LOCAL_TOOL&&!!e.mcp_name&&!!e.tool_name)));!m||m.mcp_results||m===p&&m.phase!==a||!m?rk(e,{content:i,phase:a,status:o,extra:s,function_id:r,timestamp:l,function_call:c,mcp_name:u,tool_name:d}):(m.extra=_(_({},m.extra||{}),s||{}),c&&(m.function_call=c),m.status=o,h&&(m.role=h))}(t,{value:i,phase:n,status:o,extra:s,function_call:u,function_id:p,mcp_name:l,tool_name:c,timestamp:m,role:a},f):function(e,t,n){const{value:i,role:a,phase:o,status:s,timestamp:r,extra:l,function_id:c,subChatType:u,splitLargeChunks:d}=t,h=n||e.at(-1),p=(null==h?void 0:h.function_id)&&c&&h.function_id!==c;(null==h?void 0:h.phase)!==o||p?rk(e,{content:i,role:a,phase:o,timestamp:r,status:s,function_id:c,extra:It(l)}):("string"==typeof i&&"string"==typeof h.content?function(e,t){e.content+=t}(h,i):i&&(h.content=i),h.role!==a&&(h.role=a),lk(h,{extra:l,phase:o,subChatType:u}),h.status=s)}(t,{value:i,role:a,phase:n,status:o,extra:s,subChatType:d,splitLargeChunks:h,function_id:p,timestamp:m},f)}class uk{constructor(e,t,n){k(this,"queue",[]),k(this,"batchTimer",null),k(this,"isProcessing",!1),k(this,"config"),k(this,"onBatchProcess"),k(this,"onError"),k(this,"itemIndex",0),this.config=e,this.onBatchProcess=t,this.onError=n||this.defaultErrorHandler}addToQueue(e){if(!this.config.enabled){const t=this.onBatchProcess([e]);return void(t instanceof Promise&&t.catch(e=>this.onError(e)))}const t={data:e,timestamp:Date.now(),index:this.itemIndex++};this.queue.push(t),this.config.debug,this.batchTimer||this.startBatchTimer()}startBatchTimer(){this.batchTimer&&clearTimeout(this.batchTimer),this.batchTimer=setTimeout(()=>{this.processBatch()},this.config.batchInterval)}processBatch(){if(!this.isProcessing&&0!==this.queue.length){this.isProcessing=!0;try{this.batchTimer&&(clearTimeout(this.batchTimer),this.batchTimer=null);const e=Math.min(this.queue.length,this.config.maxBatchSize),t=this.queue.splice(0,e);t.sort((e,t)=>e.index-t.index);const n=t.map(e=>e.data);this.config.debug;const i=this.onBatchProcess(n);i instanceof Promise&&i.catch(e=>this.onError(e))}catch(e){this.onError(e)}finally{this.isProcessing=!1,this.queue.length>0&&this.startBatchTimer()}}}flush(){if(this.queue.length>0)for(;this.queue.length>0;)if(this.processBatch(),this.queue.length>0){setTimeout(()=>{this.flush()},0);break}}flushSync(){return P(this,null,function*(){for(;this.queue.length>0;)this.isProcessing?yield new Promise(e=>setTimeout(e,1)):(this.processBatch(),this.queue.length>0&&(yield new Promise(e=>setTimeout(e,0))))})}clear(){this.queue=[],this.itemIndex=0,this.batchTimer&&(clearTimeout(this.batchTimer),this.batchTimer=null),this.isProcessing=!1}getStatus(){return{queueLength:this.queue.length,isProcessing:this.isProcessing,hasTimer:!!this.batchTimer}}updateConfig(e){this.config=_(_({},this.config),e),this.config.enabled||(this.flush(),this.clear())}destroy(){this.clear()}defaultErrorHandler(e){}}const dk={batchInterval:20,maxBatchSize:50,enabled:!0,debug:!0};class hk{constructor(e={},t,n){k(this,"config"),k(this,"performanceMetrics"),k(this,"startTime"),k(this,"lastProcessTime"),k(this,"onBatchProcess"),k(this,"onError"),this.config=_(C(_({},dk),{enableSmartBatching:!0,enableDynamicInterval:!0,minBatchInterval:50,maxBatchInterval:200,enablePerformanceMonitoring:!0}),e),this.performanceMetrics={totalProcessed:0,averageBatchSize:0,averageProcessingTime:0,queueUtilization:0,throughput:0},this.startTime=Date.now(),this.lastProcessTime=Date.now(),this.onBatchProcess=t,this.onError=n}processSSEStream(e,t=!1,n=!0,i=!0){return A(this,null,function*(){try{const c=e.pipeThrough(new TextDecoderStream).pipeThrough(new aE).getReader(),u=this.createEnhancedIterator(c,t,n);if(!i){try{for(var a,o,s,r=R(u);a=!(o=yield new M(r.next())).done;a=!1){const e=o.value;yield e}}catch(o){s=[o]}finally{try{a&&(o=r.return)&&(yield new M(o.call(r)))}finally{if(s)throw s[0]}}return}const d=[];let h=!1,p=null,m=null,f=null;const g=()=>{f=new Promise(e=>{m=e})};g();const v=this.onBatchProcess,y=new uk(this.config,e=>P(this,null,function*(){const t=performance.now();v&&(yield v(e));const n=this.mergeTextStreams(e);d.push(...n),m&&(m(),g());const i=performance.now(),a=y.getStatus();this.updatePerformanceMetrics(e.length,i-t,a.queueLength),this.config.enableDynamicInterval&&this.adjustBatchInterval(y)}),e=>{p=e,h=!0,m&&m(),this.onError&&this.onError(e)}),b=(()=>P(this,null,function*(){try{try{for(var e,t,n,i=R(u);e=!(t=yield i.next()).done;e=!1){const e=t.value;y.addToQueue(e)}}catch(t){n=[t]}finally{try{e&&(t=i.return)&&(yield t.call(i))}finally{if(n)throw n[0]}}yield y.flushSync(),h=!0,m&&m()}catch(a){p=a,h=!0,m&&m()}finally{y.destroy()}}))();for(;!h||d.length>0;)if(d.length>0)for(;d.length>0;){const e=d.shift();e&&(yield e)}else{if(h||!f)break;try{yield new M(Promise.race([f,new Promise(e=>setTimeout(e,10))]))}catch(l){}}if(yield new M(b),p)throw p}catch(l){throw l}})}createEnhancedIterator(e,t,n){return A(this,null,function*(){let t="";for(;;){const{value:i,done:a}=yield new M(e.read());if(a){yield{done:!0,value:""};break}if(!i)continue;const o=i.data;if(o.startsWith("[DONE]")){yield{done:!0,value:""};break}try{const e=this.parseSSEData(o);if(!e)continue;const n=this.createTextStreamUpdate(e);n&&(n.value&&(t=n.value),yield n)}catch(n){}}})}parseSSEData(e){try{return JSON.parse(e)}catch(qY){return null}}createTextStreamUpdate(e){var t,n,i,a,o,s,r,l,c,u,d,h,p,m,f;if(null==e?void 0:e["response.created"])return{done:!1,value:"",chatId:e["response.created"].chat_id,parentId:e["response.created"].parent_id,responseId:e["response.created"].response_id};if(null==e?void 0:e["response.stopped"])return{done:!0,value:"",isStop:!0};if("skip_think"===(null==(t=null==e?void 0:e["response.info"])?void 0:t.action))return{done:!1,value:"",isStopInThinking:!0};if(e.error)return"string"==typeof e.error?{done:!0,value:"",error:{code:"Internal_Server_Error",details:e.error},responseId:e.response_id}:{done:!0,value:"",error:e.error,responseId:e.response_id};if(e.sources)return{done:!1,value:"",sources:e.sources,responseId:e.response_id};if(e.selected_model_id)return{done:!1,value:"",selectedModelId:e.selected_model_id,responseId:e.response_id};if("KeepAlive"===(null==(a=null==(i=null==(n=e.choices)?void 0:n[0])?void 0:i.delta)?void 0:a.phase))return null;const g=null!=(l=null==(r=null==(s=null==(o=e.choices)?void 0:o[0])?void 0:s.delta)?void 0:r.content)?l:"",v=null==(u=null==(c=e.choices)?void 0:c[0])?void 0:u.delta;return"function"===(null==v?void 0:v.role)?(null==(d=null==v?void 0:v.extra)?void 0:d.web_search_info)?{done:!1,value:"",web_search_info:null!=(p=null==(h=null==v?void 0:v.extra)?void 0:h.web_search_info)?p:[],responseId:e.response_id,phase:null==v?void 0:v.phase,extra:null==v?void 0:v.extra,status:null==v?void 0:v.status,function_id:null==v?void 0:v.function_id,timestamp:Date.now()/1e3||e.timestamp}:{done:!1,value:null!=(m=null==v?void 0:v.content)?m:"",role:null==v?void 0:v.role,phase:null==v?void 0:v.phase,status:null==v?void 0:v.status,extra:null==v?void 0:v.extra,function_id:null==v?void 0:v.function_id,responseId:e.response_id,timestamp:Date.now()/1e3||e.timestamp}:{done:!1,value:g,role:null==v?void 0:v.role,phase:null==v?void 0:v.phase,status:null==v?void 0:v.status,usage:e.usage,extra:null==v?void 0:v.extra,lang_code:null==v?void 0:v.lang_code,functionCallType:null==(f=null==v?void 0:v.function_call)?void 0:f.name,function_id:null==v?void 0:v.function_id,function_call:null==v?void 0:v.function_call,mcp_name:null==v?void 0:v.mcp_name,tool_name:null==v?void 0:v.tool_name,responseId:e.response_id,timestamp:e.timestamp}}mergeFunctionCall(e,t){if(!t)return e;if(!e)return t;let n;return n="string"==typeof t.arguments?(e.arguments,t.arguments):"object"==typeof t.arguments&&null!==t.arguments?"object"==typeof e.arguments&&null!==e.arguments?Pt({},e.arguments,t.arguments):t.arguments:e.arguments||t.arguments,C(_(_({},e),t),{arguments:n})}mergeTextStreams(e){const t=[];return e.forEach(e=>{var n,i,a,o,s,r,l,c,u,d;if(e.phase===ng.KEEPALIVE)return;if(0===t.length)return void t.push(It(e));const h=(e=>{const n=e.responseId;for(let i=t.length-1;i>=0;i--){const e=t[i],a=e.responseId;if(!n&&!a)return e;if(n&&a&&n===a)return e}return null})(e);if(!h)return void t.push(e);const p=e.phase,m=h.phase;if(p&&ok(p))t.push(e);else{if(p&&sk(p)){if(m===p&&h.status!==ig.FINISHED&&e.status!==ig.FINISHED){h.extra=Pt({},h.extra,e.extra);const t=e.function_call||(null==(n=e.extra)?void 0:n.function_call),a=h.function_call||(null==(i=h.extra)?void 0:i.function_call);if(t){const e=this.mergeFunctionCall(a,t);h.function_call=e,h.extra&&(h.extra.function_call=e)}else a&&(h.function_call=a);e.mcp_name&&(h.mcp_name=e.mcp_name),e.tool_name&&(h.tool_name=e.tool_name),e.status&&(h.status=e.status),e.value&&(h.value+=e.value)}else t.push(It(e));return}if(p&&m===p){"string"==typeof e.value&&"string"==typeof h.value?h.value+=e.value:e.value&&(h.value=e.value),e.role&&h.role!==e.role&&(h.role=e.role);const t=(null==(a=h.extra)?void 0:a[Zf.DeepResearch])&&(null==(o=e.extra)?void 0:o[Zf.DeepResearch]),n=(null==(s=h.extra)?void 0:s[Zf.TRAVEL_RESEARCH])||(null==(r=e.extra)?void 0:r[Zf.TRAVEL_RESEARCH]),i=t?Zf.DeepResearch:n?Zf.TRAVEL_RESEARCH:void 0;if(i&&p){const t={extra:h.extra||{},content:h.value,role:h.role,status:h.status};lk(t,{extra:e.extra,phase:p,subChatType:i}),h.extra=t.extra}else h.extra=Pt({},h.extra,e.extra);e.lang_code&&(h.lang_code=e.lang_code),e.status&&(h.status=e.status);const u=e.function_call||(null==(l=e.extra)?void 0:l.function_call),d=h.function_call||(null==(c=h.extra)?void 0:c.function_call);if(u){const e=this.mergeFunctionCall(d,u);h.function_call=e,h.extra&&(h.extra.function_call=e)}else d&&(h.function_call=d);e.mcp_name&&(h.mcp_name=e.mcp_name),e.tool_name&&(h.tool_name=e.tool_name)}else if(p||m)t.push(It(e));else if(e.role&&h.role===e.role){"string"==typeof e.value&&"string"==typeof h.value?h.value+=e.value:e.value&&(h.value=e.value),h.extra=Pt({},h.extra,e.extra);const t=e.function_call||(null==(u=e.extra)?void 0:u.function_call),n=h.function_call||(null==(d=h.extra)?void 0:d.function_call);if(t){const e=this.mergeFunctionCall(n,t);h.function_call=e,h.extra&&(h.extra.function_call=e)}else n&&(h.function_call=n);e.status&&(h.status=e.status),e.lang_code&&(h.lang_code=e.lang_code)}else t.push(It(e))}}),t}updatePerformanceMetrics(e,t,n){if(!this.config.enablePerformanceMonitoring)return;this.performanceMetrics.totalProcessed+=e,this.performanceMetrics.averageBatchSize=(this.performanceMetrics.averageBatchSize+e)/2,this.performanceMetrics.averageProcessingTime=(this.performanceMetrics.averageProcessingTime+t)/2;const i=Date.now(),a=(i-this.lastProcessTime)/1e3;a>0&&(this.performanceMetrics.throughput=e/a),this.lastProcessTime=i,void 0!==n&&(this.performanceMetrics.queueUtilization=n/this.config.maxBatchSize)}adjustBatchInterval(e){const t=this.config.batchInterval,n=this.performanceMetrics.queueUtilization,i=this.performanceMetrics.throughput;let a=t;n>.8?a=Math.max(this.config.minBatchInterval,.8*t):n<.2&&i>100&&(a=Math.min(this.config.maxBatchInterval,1.2*t)),a!==t&&(this.config.batchInterval=a,e.updateConfig({batchInterval:a}),this.config.debug)}getPerformanceMetrics(){return _({},this.performanceMetrics)}getQueueStatus(){return{queueLength:Math.round(this.performanceMetrics.queueUtilization*this.config.maxBatchSize),isProcessing:!1,hasTimer:!1,utilization:this.performanceMetrics.queueUtilization}}updateConfig(e){this.config=_(_({},this.config),e)}destroy(){this.performanceMetrics={totalProcessed:0,averageBatchSize:0,averageProcessingTime:0,queueUtilization:0,throughput:0},this.startTime=Date.now(),this.lastProcessTime=Date.now()}}const pk={batchInterval:100,maxBatchSize:30,enabled:!0,debug:!0,enableSmartBatching:!0,enableDynamicInterval:!0,minBatchInterval:5,maxBatchInterval:200,enablePerformanceMonitoring:!0},mk={batchInterval:50,maxBatchSize:100,enabled:!0,debug:!1,enableSmartBatching:!0,enableDynamicInterval:!0,minBatchInterval:20,maxBatchInterval:100,enablePerformanceMonitoring:!0},fk={batchInterval:30,maxBatchSize:20,enabled:!0,debug:!1,enableSmartBatching:!0,enableDynamicInterval:!0,minBatchInterval:10,maxBatchInterval:80,enablePerformanceMonitoring:!0},gk={batchInterval:200,maxBatchSize:10,enabled:!0,debug:!0,enableSmartBatching:!0,enableDynamicInterval:!0,minBatchInterval:100,maxBatchInterval:500,enablePerformanceMonitoring:!0},vk={batchInterval:0,maxBatchSize:1,enabled:!1,debug:!1,enableSmartBatching:!1,enableDynamicInterval:!1,minBatchInterval:0,maxBatchInterval:0,enablePerformanceMonitoring:!1},yk="high_performance",bk="low_latency",xk="debug",wk="disabled";function Sk(e){switch(e){case yk:return mk;case bk:return fk;case xk:return gk;case wk:return vk;default:return pk}}class _k{constructor(){k(this,"streamingProcessor",null),k(this,"streamingMode","default"),this.initializeStreamingProcessor()}initializeStreamingProcessor(){const e=Sk(this.streamingMode);this.streamingProcessor=new hk(e,e=>P(this,null,function*(){}),e=>{})}updateStreamingMode(e){if(this.streamingMode=e,this.streamingProcessor){const t=Sk(e);this.streamingProcessor.updateConfig(t)}}getStreamingStatus(){return this.streamingProcessor?{queueStatus:this.streamingProcessor.getQueueStatus(),performanceMetrics:this.streamingProcessor.getPerformanceMetrics()}:null}}const Ck="fev",Ek="0.2.8",kk=()=>Ek,Ik=(e=((e=Ck)=>{const t=new URL(window.location.href);return new URLSearchParams(t.search).get(e)||"0.0.0"})(),t=Ek)=>{var n,i;const a=e.split(".").map(Number),o=t.split(".").map(Number),s=Math.max(a.length,o.length);for(let r=0;r<s;r++){const e=null!=(n=a[r])?n:0,t=null!=(i=o[r])?i:0;if(e>t)return"greater";if(e<t)return"less"}return"equal"},Tk=({loaded:e=!1,fixed:t=!0,absolute:n=!1,center:i=!1})=>{const a=G();return tn.jsx("div",{className:J("page-loading",{"page-loading-fixed":t&&!n,"page-loading-absolute":n&&!t,"page-loading-center":i&&!t&&!n}),style:{display:"flex",opacity:e?0:1,transition:"opacity 0.2s ease-in-out",pointerEvents:e?"none":"auto"},"aria-hidden":e,children:tn.jsx("img",{width:40,src:"https://img.alicdn.com/imgextra/i3/O1CN01zaxxvj1p4f0VrY17j_!!6000000005307-54-tps-180-180.apng",alt:a.t("Loading...")})})},jk=class e{constructor(){if(j(this,n,!1),j(this,i,null),j(this,a,0),j(this,o,12),j(this,s,()=>{T(this,n)||(N(this,n,!0),document.addEventListener("visibilitychange",T(this,r)))}),k(this,"destroy",()=>{T(this,c).call(this),document.removeEventListener("visibilitychange",T(this,r))}),j(this,r,()=>{document.hidden?T(this,c).call(this):this.subscribePolling()}),j(this,l,()=>{T(this,c).call(this),N(this,a,0),T(this,i)||N(this,i,window.setInterval(()=>P(this,null,function*(){var e,t;if(T(this,a)>=T(this,o))return void T(this,c).call(this);const n=yield((e="memory")=>P(void 0,null,function*(){return yield Ox(`notifications/latest?type=${e}`,{method:"GET"})}))("memory");if((null==n?void 0:n.success)&&(null==(t=null==(e=n.data)?void 0:e.notifications)?void 0:t.length)>0){const e=n.data.notifications[0];Pk(e)}var i,s,r,l;(i=this,s=a,{set _(e){N(i,s,e,r)},get _(){return T(i,s,l)}})._++,T(this,a)>=T(this,o)&&T(this,c).call(this)}),1e4))}),j(this,c,()=>{T(this,i)&&(window.clearInterval(T(this,i)),N(this,i,null)),N(this,a,0)}),j(this,u,e=>{e?T(this,l).call(this):T(this,c).call(this)}),k(this,"subscribePolling",()=>{var e,t,n;const i=null==(e=tx.getState().config)?void 0:e.memory_version,a=i&&"disable"!==i;bT()||fx()&&kx("1.7.0")||!a||((null==(n=null==(t=cT.getState().settings)?void 0:t.memory)?void 0:n.enable_memory)&&!Zb.getState().temporaryChatEnabled&&T(this,u).call(this,!0),Zb.subscribe(e=>e.temporaryChatEnabled,e=>{var t,n;const i=null==(n=null==(t=cT.getState().settings)?void 0:t.memory)?void 0:n.enable_memory;T(this,u).call(this,i&&!e)}),cT.subscribe(e=>{var t,n;return null==(n=null==(t=e.settings)?void 0:t.memory)?void 0:n.enable_memory},e=>{const t=Zb.getState().temporaryChatEnabled;T(this,u).call(this,e&&!t)}))}),T(e,t))return T(e,t);N(e,t,this),T(this,s).call(this)}static getInstance(){return T(this,t)||N(this,t,new e),T(this,t)}};t=new WeakMap,n=new WeakMap,i=new WeakMap,a=new WeakMap,o=new WeakMap,s=new WeakMap,r=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,j(jk,t,null);const Nk=jk.getInstance(),Pk=e=>{var t,n;const{clearAllNotification:i,setNotification:a,clearNotificationById:o}=pT.getState();i(),a({type:"memory",message:sv("Update Saved Memory"),description:sv("Added {{latest}} new memories. Updated {{existing}} existing memories with new details.",{latest:null==(t=e.detail.new_memories)?void 0:t.length,existing:null==(n=e.detail.updated_memories)?void 0:n.length}),duration:1e4,onClickButton:e=>{o(e),yE.getState().setShowMemoryUpdatedModal(!0)},props:e}),tx.getState().mobile&&ut.openOnce({type:"message",closable:!1,className:"memory-updated-saved-toast",duration:1e4,content:tn.jsxs(tn.Fragment,{children:[tn.jsxs("div",{className:"memory-updated-saved-toast-content",children:[tn.jsx("div",{className:"memory-updated-saved-toast-icon",children:tn.jsx(dt,{type:"icon-line-information-circle"})}),tn.jsx("div",{className:"memory-updated-saved-toast-text",children:Uf().t("Update Saved Memory")})]}),tn.jsx("div",{className:"memory-updated-saved-toast-btn",onClick:()=>{const e=pT.getState().memoryNotification,t=yE.getState().setShowMemoryUpdatedModal,n={items:[...At(e,"detail.new_memories",[]).map(e=>({type:"new",markdown:e.content})),...At(e,"detail.updated_memories",[]).map(e=>({type:"updated",markdown:e.content})),...At(e,"detail.cleared_memories",[]).map(e=>({type:"cleared",markdown:e.content}))]};bx()?oT.adapter.invoke({method:"openMemoryWindow",params:rx()?n:JSON.stringify(n)}):t(!0),X.destroy()},children:Uf().t("View")})]})})};class Mk{static createUserMessage(e,t){const n=ot(),i=pC(t.currentInputFeature),a=t.featureConfig||{thinking_enabled:!1,output_schema:"phase",research_mode:"normal"};return{userMessage:{fid:n,parentId:e.parentId,childrenIds:[],role:"user",content:e.content,user_action:e.userAction,files:e.files&&e.files.length>0?e.files:void 0,timestamp:Math.floor(Date.now()/1e3),models:t.models||[],chat_type:i,feature_config:a,extra:e.extra,sub_chat_type:t.subChatType||t.currentInputFeature},messageId:n}}static createResponseMessage(e,t){const n=ot(),i=pC(t.currentInputFeature),a=t.featureConfig||{thinking_enabled:!1,output_schema:"phase",research_mode:"normal"};return{responseMessage:{parentId:e.parentId,fid:n,childrenIds:[],role:"assistant",content:"",model:e.model.id,modelName:e.model.name,modelIdx:e.modelIdx,userContext:null,chat_type:i,user_action:e.userAction,info:[Zf.ImageGeneration,Zf.VideoGeneration].includes(t.currentInputFeature)?{size:rT.getState().visionSize}:void 0,merged:void 0,feature_config:a,extra:e.extra,timestamp:Math.floor(Date.now()/1e3),sub_chat_type:t.subChatType||t.currentInputFeature},messageId:n}}static createResponseMessages(e,t){return e.selectedModels.map((n,i)=>{const{responseMessage:a,messageId:o}=Mk.createResponseMessage({parentId:e.parentId,model:n,modelIdx:i,userAction:e.userAction,extra:e.extra},t);return{message:a,messageId:o}})}static updateHistoryMessages(e,t){const{userMessage:n,responseMessages:i}=t,a=i.map(e=>e.messageId);if(n&&(n.message.childrenIds=a,e.messages[n.messageId]=n.message,n.message.parentId)){const t=e.messages[n.message.parentId];t&&(t.childrenIds=[...t.childrenIds||[],n.messageId])}i.forEach(({message:t,messageId:n})=>{e.messages[n]=t}),a.length>0?(e.currentId=a[0],e.currentResponseIds=a):n&&(e.currentId=n.messageId)}static updateUserMessageChildrenIds(e,t,n,i){const a=e.messages[t];a&&(a.childrenIds=[...a.childrenIds||[],n],i&&(i.models&&(a.models=i.models),i.feature_config&&(a.feature_config=_(_({},a.feature_config||{}),i.feature_config)),i.sub_chat_type&&(a.sub_chat_type=i.sub_chat_type),void 0!==i.extra&&(a.extra=i.extra)))}static updateParentMessageChildrenIds(e,t,n){const i=e.messages[t];i&&(i.childrenIds=[...i.childrenIds||[],n])}static getLastMessage(e){var t;if(!e||!e.currentId)return null;const n=sC(e.currentId,e);if(0===n.length)return null;let i=null==(t=n[n.length-1])?void 0:t.id,a=n[n.length-1];if(!i&&n.length>0){const e=[...n];for(;!i&&e.length>0;){const t=e.pop();if("assistant"===(null==t?void 0:t.role)&&(null==t?void 0:t.id)){i=t.id,a=t;break}}}return a&&"assistant"===a.role&&a.id?a:null}static deleteMessage(e,t){var n;const i=e.messages[t];if(!i)return{currentId:e.currentId,currentResponseIds:e.currentResponseIds};const a=i.parentId,o=null!=(n=i.childrenIds)?n:[],s=o.flatMap(t=>{var n,i;return t&&null!=(i=null==(n=e.messages[t])?void 0:n.childrenIds)?i:[]});a&&e.messages[a]&&(e.messages[a].childrenIds=[...e.messages[a].childrenIds.filter(e=>e!==t),...s]),s.forEach(t=>{t&&e.messages[t]&&(e.messages[t].parentId=a)}),[t,...o].forEach(t=>{t&&delete e.messages[t]});let r=a;if(a&&e.messages[a]){let t=e.messages[a].childrenIds||[];for(;t.length>0;){const n=t[t.length-1];if(!n||!e.messages[n])break;r=n,t=e.messages[n].childrenIds||[]}}return{currentId:r,currentResponseIds:r?[r]:[]}}static cloneResponseMessage(e,t,n){if(!n)return null;const i=C(_({},n),{fid:t,id:null,content:"",content_list:[]});e.messages[t]=i;const a=n.parentId;if(a&&e.messages[a]){const n=e.messages[a];n.childrenIds||(n.childrenIds=[]),n.childrenIds.includes(t)||n.childrenIds.push(t)}return i}}const Ak=e=>{var t,n;const i=null==(t=null==e?void 0:e.content_list)?void 0:t.findLast(e=>e.phase===ng.SLIDES);return null==(n=null==i?void 0:i.extra)?void 0:n.slides};class Rk extends XE{constructor({config:e,settings:t,user:n,chatMode:i="normal"}){const a=ot();super(a),k(this,"id"),k(this,"chatFiles",[]),k(this,"tags"),k(this,"models"),k(this,"isChatIntercept"),k(this,"subChatType",""),k(this,"userAction",Qf.CHAT),k(this,"stopResponseFlag",!1),k(this,"eventTarget",new EventTarget),k(this,"sessionId",ot()),k(this,"changeResponseIdMap",{}),k(this,"reconnectTimesMap",{}),k(this,"mcpLoopParams",{}),k(this,"mcpErrorServers",[]),k(this,"isLeave",!1),k(this,"isForceClear",!1),k(this,"share_id"),k(this,"config"),k(this,"settings"),k(this,"user"),k(this,"loadChat",e=>P(this,null,function*(){var t,n,i,a,o,s,r,l,c,u;if(!e)return;const d=aI.getState().models;if(this.isChat){this.isLeave=!1,this.chatLoaded=!0;const e=this.history.messages[this.history.currentId||""],t=TC(this.models||[],!1,d,e.modelName);return aI.getState().setSelectedModels(t||[]),this._emit(BC.CHAT_HISTORY_LOADED,{id:this.id,chatId:this.chatId,chatOptions:this.getChatOptions()}),this.forceSetAllState(),!0}this.chatLoaded=!1,this.share_id||this.resetChatState(),this.setChatId(e);const h=yE.getState().isSharePage,p=Wb.getState().isCompareVersion,m=h?e.startsWith("t_")?yield(f={id:e},P(void 0,null,function*(){return yield Ox(`/share/message/${f.id}`,{method:"GET"})})):yield(e=>P(void 0,null,function*(){return yield zx(),yield Ox(`/chats/share/${e.share_id}`)}))({share_id:e}):yield pS({chat_id:e});var f;const{success:g,data:v}=m||{};let y="";if(h&&p&&"greater"===Ik())return y="invalid_gray_link",Wb.setState({shareChatError:y}),void this.setStatus({isLeave:!0,isChat:!1});if(!g)return h&&!y&&Wb.setState({shareChatError:"invalid"}),fT.getState().setChatProjectId(""),this.setStatus({isLeave:!0,isChat:!1}),void this.destroy();if(v.project_id&&fT.getState().setActiveChatDetails(v),!(null==(n=null==(t=null==v?void 0:v.chat)?void 0:t.history)?void 0:n.messages)||jt(v.chat.history.messages))return fT.getState().setChatProjectId(""),this.history={currentId:null,currentResponseIds:[],messages:{}},void this.setStatus({isLeave:!0,isChat:!1});if("normal"===this.chatMode&&!h){const t=yield(e=>P(void 0,null,function*(){return yield Ox(`chats/${e.chat_id}/tags`)}))({chat_id:e}).catch(()=>P(this,null,function*(){return{data:[]}}));this.tags=t.data}fT.getState().setChatProjectId((null==v?void 0:v.project_id)||""),this.reconnectTimesMap={},this.chatTitle=v.title||v.chat.title,this.projectId=(null==v?void 0:v.project_id)||"",this.models=v.chat.models,v.permissions&&(this.chatPermission=v.permissions),this.branchInfo=(null==(i=null==v?void 0:v.meta)?void 0:i.branch_info)||null;const b=cC(v.chat.history);Object.values(b.messages||{}).forEach(e=>{b.messages[e.id||""]=this.formatServerMessage(e)});const x=b.currentId||v.currentId||v.chat.currentId;let w=b.currentResponseIds||v.currentResponseIds||v.chat.currentResponseIds||[];const S=b.messages[b.currentId||""];let _=S.chat_type||(null==(a=null==v?void 0:v.chat)?void 0:a.chat_type)||Zf.Txt2Txt,C=(null==S?void 0:S.sub_chat_type)||(null==(s=null==(o=null==S?void 0:S.extra)?void 0:o.meta)?void 0:s.subChatType)||_;_===Zf.ImageEdit&&(_=Zf.ImageGeneration,C=Zf.ImageGeneration),Y_(b)&&(this.isStopDisabled=!0),this.history={currentId:x,currentResponseIds:w,messages:b.messages},Object.values(this.history.messages||{}).forEach(e=>{"assistant"===e.role&&e.error&&"data_inspection_failed"===e.error.errorCode&&this.handleGreenNetErrorParentMsg(e._error,e.parentId||"")}),_!==Zf.Artifacts||tx.getState().mobile||h?_!==Zf.Slides||tx.getState().mobile||h||!S.done||!(null==(r=S.content_list)?void 0:r.some(e=>e.phase===ng.SLIDES))||S.error?Zb.setState({currentShowControl:tg.None}):Zb.setState({currentShowControl:tg.Slides,currentControlsId:S.id||"",currentSlidesInfo:Ak(S)}):(Zb.setState({currentShowControl:tg.Artifacts}),Wb.setState({currentArtifactsMessage:S})),this.currentInputFeature=_,this.subChatType=C,this.currentInputSubType=C,this.chatFiles=(e=>{const t=Object.values((null==e?void 0:e.messages)||{}).filter(e=>"user"===e.role),n=[];return t.length&&t.forEach(e=>{e.files&&n.push(...e.files)}),n})(b),this.isChatIntercept=!1;const E=TC(v.chat.models,h,d,S.modelName);if(aI.getState().setSelectedModels(E||[]),[Zf.ImageGeneration,Zf.VideoGeneration].includes(_)){let e=null==(l=null==S?void 0:S.info)?void 0:l.size;const t=Array.isArray(S.content_list)&&S.content_list.find(e=>{var t;return e.phase===ng.IMAGE_GEN&&(null==(t=null==e?void 0:e.extra)?void 0:t.output_image_hw)});if(!e&&t){const[n,i]=null==(u=null==(c=null==t?void 0:t.extra)?void 0:c.output_image_hw)?void 0:u[0];e=rg["1:1"],Object.values(rg).forEach(t=>{const[a,o]=t.split(":");Math.abs(Number(i)/Number(n)-Number(a)/Number(o))<.1&&(e=t)})}e&&rT.getState().setVisionSize(e)}const k=sC(x,this.history).find(e=>e.sub_chat_type===Zf.DeepResearch&&!e.done&&"assistant"===e.role);w=[...new Set([...w,null==k?void 0:k.id])];const I=w.filter(e=>{const t=this.history.messages[e];return!!t&&((!(null==t?void 0:t.sub_chat_type)||![Zf.Podcast].includes(t.sub_chat_type))&&(!t.done||!1))});return this._emit(BC.CHAT_HISTORY_LOADED,{id:this.id,chatId:this.chatId,chatOptions:this.getChatOptions()}),this.chatLoaded=!0,this.setStatus({isChat:!!I.length}),Y_(b)&&(this.isStopDisabled=!0,I.length=0),I.length>0&&![Zf.VideoGeneration].includes(_)&&(this._emit(BC.CHAT_BEGIN,{id:this.id}),I.map(e=>P(this,null,function*(){return setTimeout(()=>{BS("AsyncChat-Response",{params:{et:"OTHER",c6:!0},paramsExtend:{chat_id:this.chatId,msg_type:this.currentInputFeature},aesParams:{c4:this.chatId,c5:this.currentInputFeature,c7:C,c8:e}})}),yield this.retrievableFetchSSEResponse(e)}))),BS("AsyncChat-Load",{params:{et:"OTHER",c6:!0},paramsExtend:{chat_id:this.chatId,msg_type:this.currentInputFeature},aesParams:{c4:this.chatId,c5:this.currentInputFeature,c7:C}}),!0})),k(this,"saveChat",(e,t,n)=>{}),k(this,"handleMergeError",(e,t,n,i)=>P(this,null,function*(){const a=_({},i),{errorCode:o,errorMessage:s,errorMessageLocale:r}=yield this.handleGeneralError(e,t);a.error={content:sv("Oops! There was an issue connecting to {{provider}}.",{provider:n})+" "+r,errorMessage:s,errorCode:"data_inspection_failed"===s?"data_inspection_failed":""},a.done=!0,a.statusHistory&&(a.statusHistory=a.statusHistory.filter(e=>"knowledge_search"!==e.action)),"data_inspection_failed"===o&&(a.content=""),this.changeHistory(e=>{e.messages[a.id]=a})})),k(this,"stopResponse",()=>P(this,null,function*(){var e,t;this.stopResponseFlag=!0,this.isStopDisabled=!0;const{currentResponseIds:n,messages:i}=this.history,a=n.filter(e=>i[e]&&!i[e].done||!1),o=null!=(t=null==(e=sC(this.history.currentId,this.history))?void 0:e.filter(e=>"assistant"===e.role&&!e.done).map(e=>e.id))?t:[],s=[...new Set([...a,...o])];this.chatId&&s.length&&s.forEach(e=>P(this,null,function*(){yield GS({chat_id:this.chatId,response_id:e})})),KE.setParamsForAll({is_stop:!0}),KE.sendAllEvent()})),k(this,"stopThinkingPhase",e=>P(this,null,function*(){const{messages:t}=this.history;if(!this.chatId||!e||!t[e]||"assistant"!==t[e].role)return;const n=t[e];if(!(null==n?void 0:n.content_list)||!n.content_list.length)return;const{error:i,is_stop:a,content_list:o,done:s}=n,r=null==o?void 0:o.at(-1),l=r&&[ng.ANSWER,ng.SLIDES].includes(null==r?void 0:r.phase);i||a||s||l||(this.updateResponseMessage(e,{is_stop_in_thinking_flag:!0}),yield GS({chat_id:this.chatId,response_id:e,phase:"think"}))})),k(this,"handleGeneralError",(e,t)=>P(this,null,function*(){var n;let i,a="",o="",s="";if("quotaLimited"===(null==t?void 0:t.code)?i={code:null==t?void 0:t.code,detail:t.details,error:t.details}:(null==t?void 0:t.data)&&"Too_Many_Requests"===(null==(n=t.data)?void 0:n.code)||e&&"Too_Many_Requests"===(null==e?void 0:e.code)||null===t&&!e?i={code:"Too_Many_Requests",detail:sv("Currently, there are too many requests in the queue. Please try again later."),error:sv("Currently, there are too many requests in the queue. Please try again later.")}:e?i=e:t&&"error"===t.type?i={detail:t.info,error:t.content}:null!==t&&(i=(null==t?void 0:t.data)||t),i||(i=new Error("unknown error")),a=i.code||i.errorCode,"data_inspection_failed"===i.code){o=i.details,s=sv(o);const e=this.formatGreenErrorMessage(i);e.errorMessage&&(o=e.errorMessage),e.errorMessageLocale&&(s=e.errorMessageLocale)}else i.code&&i.details?i.template?(o=i.template,s=sv(i.template,{num:i.num})):(o=i.details,s=sv(i.details)):"error"in i?i.error&&Object.hasOwnProperty.call(i.error,"message")?(o=i.error.message,s=sv(o)):(o=i.error,s=sv(o)):"message"in i?(o=i.message,s=sv(o)):"quotaLimited"===i.code&&(o=i.details,s=sv(o));return AC.openOnce({type:"error",content:s}),{errorCode:a,errorMessage:o,errorMessageLocale:s}})),k(this,"formatGreenErrorMessage",e=>{const{code:t,stage:n,modality:i=[],details:a}=e;let o="",s="";if("data_inspection_failed"===t)if(n&&i.length>0){const e=i.join(", "),t=null==i?void 0:i.map(e=>sv(e)).join(", ");o=`Content security warning: ${n} ${e} data may contain inappropriate content!`,s=sv(`Content security warning: ${n} {{fileType}} data may contain inappropriate content!`,{fileType:t})}else o=a,s=sv(o);return{errorMessage:o,errorMessageLocale:s}}),k(this,"handleGreenNetErrorParentMsg",(e,t)=>{if("data_inspection_failed"!==(null==e?void 0:e.code)||!t)return;const{image_idx:n=[],video_idx:i=[],file_idx:a=[]}=e,o=this.history.messages[t];if((n.length||i.length||a.length)&&(null==o?void 0:o.files)){const e=[],t=[],s=[],r=[];o.files.map((n,i)=>{switch(n.type){case"image":e.push(i);break;case"video":t.push(i);break;case"file":s.push(i)}}),n.map(t=>r.push(e[t])),i.map(e=>r.push(t[e])),a.map(e=>r.push(s[e])),r.sort((e,t)=>e-t).map(e=>{var t;(null==(t=o.files)?void 0:t[e])&&(o.files[e].greenNet="green_error",o.files[e].url="")}),null!==(null==o?void 0:o.id)&&this.changeHistory(e=>{e.messages[o.id]=o})}}),k(this,"handleOpenAIError",(e,t,n)=>P(this,null,function*(){var i;const a=_({},n),{errorCode:o,errorMessage:s,errorMessageLocale:r}=yield this.handleGeneralError(e,t),l=a.id||a.fid;if(!l)return;const c=this.getModelForId(a.model);this.setStatus({isChat:!1}),this.isStopDisabled=!1,a.error={errorCode:o,errorMessage:s,content:sv("Oops! There was an issue connecting to {{provider}}.",{provider:null!=(i=null==c?void 0:c.name)?i:null==c?void 0:c.id})+"\n"+(r||((null==t?void 0:t.info)?sv(null==t?void 0:t.info):""))},a.done=!0,KE.setParams(l,{error_info:a.error,is_error:!0}),KE.sendEvent(l),a.statusHistory&&(a.statusHistory=a.statusHistory.filter(e=>"knowledge_search"!==e.action)),"data_inspection_failed"===o&&(a.content="",a.content_list=[],this.handleGreenNetErrorParentMsg(e,a.parentId)),!o&&[Zf.ImageGeneration,Zf.ImageEdit].includes(this.currentInputFeature)&&(a.error=void 0),this.changeHistory(e=>{e.messages[l]=a}),this._emit(BC.CHAT_SSE_ERROR,{id:this.id,chatId:this.chatId,history:It(this.history),errorType:o}),this.isChat=!1})),k(this,"urlParsingBeforeSubmit",e=>P(this,null,function*(){var t;this._emit(BC.CHAT_PARSE_URL_BEGIN,{id:this.id,chatId:this.chatId});const n=RE(e);let i=[],a={};if(n.length>0){let e;try{e=yield(e=>P(void 0,null,function*(){return yield Ox("/parse_url",{baseURL:"/api",method:"POST",data:{url_list:e}})}))(n);const o=(null==(t=null==e?void 0:e.data)?void 0:t.parse_data)||[],s=o.filter(e=>e.status===og.SUCCESS);a={file_name_map:s.reduce((e,t)=>(e[t.oss_url]=t.url,e),{}),url_parse_result:o},i=s.map(e=>({type:"file",url:e.oss_url,file_class:"url"}))}catch(qY){this._emit(BC.CHAT_PARSE_URL_ERROR,{id:this.id})}}return this._emit(BC.CHAT_PARSE_URL_END,{id:this.id,chatId:this.chatId}),{hasUrl:!0,extra:a,urlFiles:i}})),k(this,"createNewChat",e=>P(this,null,function*(){var t;if(null==(t=this.history)?void 0:t.currentId){this.projectId=e||"";try{const{success:t,data:i}=yield(n={title:sv("New Chat"),models:this.models,chat_mode:this.chatMode,chat_type:pC(this.currentInputFeature),timestamp:Date.now(),project_id:e||""},P(void 0,null,function*(){return yield zx(),yield Ox("/chats/new",{method:"POST",data:n})})),a=i.id;if(t&&a){this.setChatId(a);const e="normal"===this.chatMode?this.chatId:this.chatMode;return KT.navigate(`/c/${e}`),i}const o=sv((null==i?void 0:i.message)||"Error");throw AC.open({type:"error",content:o}),new Error(o)}catch(i){this._emit(BC.CHAT_ERROR,{id:this.id,chatId:this.chatId,error:i})}var n}})),k(this,"updateSubChatType",(e,t)=>{var n,i,a;this.subChatType=e;return C(_({},t),{extra:C(_({},null!=(n=t.extra)?n:{}),{meta:C(_({},null!=(a=null==(i=t.extra)?void 0:i.meta)?a:{}),{subChatType:e})})})}),this.id=a,ZC.currentId=this.id,ZC.addChat(this.id,this),ZC.clearChatsStatus(),this.config=e,this.settings=t,this.user=n,this.chatMode=i}get token(){return yT()}_emit(e,...t){this.id===ZC.currentId&&XC.emit(e,...t)}setChatId(e){this.chatId=e,this.setStatus({isLeave:!1})}setStatus({isChat:e,isLeave:t}){void 0!==e&&(this.isChat=e),void 0!==t&&(this.isLeave=t)}updateHistory(e){this.history=_(_({},this.history),e)}setChatOptions(e){Object.keys(e).forEach(t=>{t in this&&(this[t]=e[t])})}getChatOptions(){return{chatTitle:this.chatTitle,projectId:this.projectId,history:this.history,chatFiles:It(this.chatFiles),tags:It(this.tags),models:It(this.models),isChatIntercept:this.isChatIntercept,currentInputFeature:this.currentInputFeature,isChat:this.isChat,subChatType:this.subChatType||this.currentInputSubType||this.currentInputFeature,permissions:It(this.chatPermission)}}getChatOption(e){if(e in this){const t=this[e];return"object"==typeof t?It(t):t}}submitPrompt(e){return P(this,arguments,function*({parentId:e,files:t=[],type:n,selectedModels:i,inputText:a,feature_config:o,sub_chat_type:s,extra:r,projectId:l}){var c,u,d,h,p,m,f,g,v,y;this.share_id=new URLSearchParams(window.location.search).get("shareId")||this.share_id||void 0;let b=a;const x=ME(b);(x.length>1||(null==(c=null==x?void 0:x[0])?void 0:c.type)===ag.url)&&(b=AE(x));const w=[...t||[]],S=[...this.chatFiles||[]];if(S.push(...w.filter(e=>["doc","file","collection"].includes(e.type))),this.chatFiles=S.filter((e,t,n)=>n.findIndex(t=>JSON.stringify(t)===JSON.stringify(e))===t),null!==(null!=(h=null==(d=null==(u=this.config)?void 0:u.file)?void 0:d.max_count)?h:null)&&t.length+(null!=(m=null==(p=null==this?void 0:this.chatFiles)?void 0:p.length)?m:0)>Number(null==(g=null==(f=this.config)?void 0:f.file)?void 0:g.max_count))return void AC.open({type:"error",content:sv("You can only chat with a maximum of {{maxCount}} file(s) at a time.",{maxCount:null==(y=null==(v=this.config)?void 0:v.file)?void 0:y.max_count})});this.models=i.map(({id:e})=>e),this.currentInputFeature=n,this.currentInputSubType=s||n,this.setStatus({isChat:!0});let _=e;if(!_&&this.history){const e=Mk.getLastMessage(this.history);_=(null==e?void 0:e.id)||null}const C=o||this.getDefaultFeatureConfig(),{userMessage:E,messageId:k}=Mk.createUserMessage({content:b,parentId:_,userAction:Qf.CHAT,files:(null==t?void 0:t.length)>0?t:void 0,extra:r},{currentInputFeature:this.currentInputFeature,subChatType:s||this.currentInputFeature,models:this.models||[],featureConfig:C});if(this.history){const e=this.updateSubChatType(this.subChatType,E);if(this.changeHistory(t=>{if(t.messages[k]=e,t.currentId=k,this.share_id&&_){const e=t.messages[_];e&&(e.childrenIds=[k])}else if(_){const e=t.messages[_];e&&-1===(e.childrenIds||[]).indexOf(k)&&(e.childrenIds=[...e.childrenIds||[],k])}}),this.checkForceClear())return;this.sendPrompt(e,{selectedModels:i,user_action:this.userAction,projectId:l})}})}sendPrompt(e,t){return P(this,arguments,function*(e,{selectedModels:t,user_action:n,userModelIds:i,projectId:a}){var o;if(!e.fid&&!e.id)return;const s=e.id||e.fid,r=i||e.models;if(this.checkForceClear())return;const l=this.history.messages[e.parentId||""],c=!!this.share_id&&(null==e?void 0:e.sub_chat_type)!==Zf.INTERRUPT,u=!e.parentId&&"user"===e.role&&0===Object.values(this.history.messages).filter(e=>"user"!==e.role).length||l&&1===(null==(o=null==l?void 0:l.childrenIds)?void 0:o.length)&&this.branchInfo&&"/c/new-branch"===location.pathname||c||"/c/new-chat"===location.pathname,d=1===r.length&&e.childrenIds.length>1?e.childrenIds.filter(e=>!!e).findIndex(e=>this.history.messages[e].model===r[0]):void 0,h=[],p=[];for(const[f,g]of r.entries()){const e=t.find(({id:e})=>e===g);e?h.push(e):AC.open({type:"error",content:sv("Model {{modelId}} not found",{modelId:g})})}const m=Mk.createResponseMessages({parentId:s,selectedModels:h,userAction:n,extra:e.extra},{models:this.models||[],featureConfig:e.feature_config||this.getDefaultFeatureConfig(),subChatType:pC(null==e?void 0:e.sub_chat_type)||"",currentInputFeature:pC(e.chat_type)||"chat_type_undefined"});if(m.forEach((e,t)=>{const n=void 0!==d?d:t;n!==t&&(e.message.modelIdx=n),p.push({model:h[t],responseMessageId:e.messageId})}),this.changeHistory(t=>{var n,i;if(t.messages[s||""]=C(_({},e),{childrenIds:[...(null==(i=null==(n=t.messages[s||""])?void 0:n.childrenIds)?void 0:i.filter(e=>null!==e))||[],...m.map(e=>e.messageId)]}),this.changeResponseIdMap={},m.forEach(({message:e,messageId:n})=>{t.messages[n]=e}),m.length>0&&(t.currentId=m[0].messageId,t.currentResponseIds=m.map(e=>e.messageId)),null!==(null==e?void 0:e.parentId)&&!c){const n=t.messages[e.parentId];n&&-1===(n.childrenIds||[]).indexOf(s)&&(n.childrenIds=[...n.childrenIds||[],s])}}),this.isStopDisabled=!0,this._emit(BC.CHAT_BEGIN,{id:this.id}),aT.reset(["inputValue","files"]),u){if(!(yield this.createNewChat(a)))return this.changeHistory(e=>{e.currentId=null,e.currentResponseIds=[],e.messages={}}),void(this.isChat=!1);this._emit(BC.CHAT_CREATE_NEW_CHAT,{id:this.id,chatId:this.chatId}),this.setStatus({isChat:!0}),"normal"===this.chatMode&&(dC(),hC())}this.clearMcpParams(),this.checkForceClear()||(yield Promise.all(p.map(e=>this.sendPromptOpenAI(e.model,e.responseMessageId))))})}getDefaultFeatureConfig(){const{thinkingEnabled:e,researchMode:t}=Zb.getState();return{thinking_enabled:e,output_schema:"phase",research_mode:t?"advance":"normal"}}getMessageCreateConfig(e){return{currentInputFeature:this.currentInputFeature,subChatType:this.subChatType,models:this.models||[],featureConfig:e||this.getDefaultFeatureConfig()}}editSubmitPrompt(e){return P(this,arguments,function*({type:e,selectedModels:t,inputText:n,feature_config:i,subChatType:a,extra:o,messageId:s}){const r=this.history.messages[s],l=r.id||r.fid;this.setStatus({isChat:!0}),this.models=t.map(({id:e})=>e);const c=this.currentInputFeature;this.currentInputFeature=e,this.subChatType=a||(null==r?void 0:r.sub_chat_type);const u=i||{thinking_enabled:!1,output_schema:"phase"},d=_(_({},r.feature_config||{}),u),{userMessage:h,messageId:p}=Mk.createUserMessage({files:(null==r?void 0:r.files)||void 0,content:n,parentId:r.parentId,userAction:Qf.EDIT,extra:_(_({},r.extra||{}),o||{})},this.getMessageCreateConfig(d)),m=Mk.createResponseMessages({parentId:p,selectedModels:t,userAction:Qf.EDIT,extra:h.extra},this.getMessageCreateConfig(d));this.changeHistory(e=>{Mk.updateHistoryMessages(e,{userMessage:{message:h,messageId:p},responseMessages:m})}),this.checkForceClear()||(BS("AsyncChat-ReSend",{params:{et:"OTHER",c6:!0},paramsExtend:{chat_id:this.chatId,msg_type:this.currentInputFeature},aesParams:{c4:this.chatId,c5:c,c6:this.currentInputFeature,c7:l}}),this.clearMcpParams(),yield Promise.all(m.map(({messageId:e,message:t})=>{const n=this.getModelForId(t.model);return this.sendPromptOpenAI(n,e)})))})}regenerateSubmitPrompt(e){return P(this,arguments,function*({type:e,selectedModels:t,feature_config:n,extra:i,userMessageId:a,modelIdx:o=0,sub_chat_type:s}){this.setStatus({isChat:!0}),this.models=t.map(({id:e})=>e);const r=this.currentInputFeature;this.currentInputFeature=e,this.subChatType=s;const l=this.history.messages[a],c=t[o],u=n||{thinking_enabled:!1,output_schema:"phase"},d=_(_({},l.feature_config||{}),u),h=C(_({},i||{}),{meta:C(_({},(null==i?void 0:i.meta)||{}),{subChatType:s})}),{responseMessage:p,messageId:m}=Mk.createResponseMessage({parentId:a,model:c,modelIdx:o,userAction:Qf.RETRY,extra:h},this.getMessageCreateConfig(d));this.changeHistory(e=>{Mk.updateUserMessageChildrenIds(e,a,m,{models:this.models,sub_chat_type:s,feature_config:d,extra:h||l.extra}),Mk.updateHistoryMessages(e,{responseMessages:[{message:p,messageId:m}]})}),this.checkForceClear()||(BS("AsyncChat-ReGenerate",{params:{et:"OTHER",c6:!0},paramsExtend:{chat_id:this.chatId,msg_type:this.currentInputFeature},aesParams:{c4:this.chatId,c5:r,c6:this.currentInputFeature,c7:a}}),this.clearMcpParams(),yield this.sendPromptOpenAI(c,m))})}sendPromptOpenAI(e,t){return P(this,null,function*(){var n,i,a,o,s,r,l,c,u,d,h,p,m,f,g,v,y,b,x,w,S,E,k,I,T,j,N,M,A,R,O,D,L;const{emitSendPromptType:F}=Wb.getState();if(!this.history||!t)return"";const U=_({},this.history.messages[t]),z=null==U?void 0:U.parentId;if(!z)return"";const H=_({},this.history.messages[z]);if(!H)return"";rT.getState().resetMessageInput(["inputValue","files"]),this.isStopDisabled=!0;let $={};2===(null==(a=null==(i=null==(n=e.info)?void 0:n.meta)?void 0:i.abilities)?void 0:a.parse_url)||3===(null==(r=null==(s=null==(o=e.info)?void 0:o.meta)?void 0:s.abilities)?void 0:r.parse_url)&&(null==(l=H.feature_config)?void 0:l.thinking_enabled)||($=yield this.urlParsingBeforeSubmit(H.content),$.hasUrl&&(H.extra=_(_({},H.extra||{}),$.extra)));let B=(null==H?void 0:H.sub_chat_type)||(null==(u=null==(c=H.extra)?void 0:c.meta)?void 0:u.subChatType);this.changeHistory(e=>{var n;U.extra=C(_({},(null==U?void 0:U.extra)||{}),{meta:{subChatType:B}}),e.messages[t]=U,H.extra=C(_({},(null==H?void 0:H.extra)||{}),{meta:C(_({},null==(n=null==H?void 0:H.extra)?void 0:n.meta),{subChatType:B})}),e.messages[U.parentId||""]=H}),this.subChatType=B;let q=this.currentInputFeature;q===Zf.VideoGeneration&&(null==(d=null==H?void 0:H.files)?void 0:d.find(e=>"image"===e.type))&&(q=Zf.Image2Video,B=Zf.Image2Video);const G=(V=this.currentInputFeature,[Zf.ImageGeneration,Zf.VideoGeneration].includes(V));var V;let W=null==(v=null!=(g=null==(p=null==(h=null==e?void 0:e.info)?void 0:h.params)?void 0:p.stream_response)?g:null==(f=null==(m=this.settings)?void 0:m.params)?void 0:f.stream_response)||v;(this.subChatType===Zf.Podcast||[Zf.VideoGeneration,Zf.Image2Video].includes(this.currentInputFeature))&&(W=!1);const Q=!!(null==(y=this.mcpLoopParams)?void 0:y.messages),K=!!this.share_id&&(null==H?void 0:H.sub_chat_type)!==Zf.INTERRUPT,Y=U.user_action===Qf.RETRY,X=[...(null==$?void 0:$.urlFiles)||[],...(null==H?void 0:H.files)||[]],J=C(_(_(C(_({},H),{files:X,chat_type:q,sub_chat_type:I_((null==H?void 0:H.extra)||{})?"translate":B,parent_id:H.parentId}),Y?{id:z,parent_id:null,parentId:null}:{}),K?{id:void 0,parent_id:null,parentId:null}:{}),{user_action:F,extra:C(_({},(null==H?void 0:H.extra)||{}),{meta:C(_({},(null==(b=null==H?void 0:H.extra)?void 0:b.meta)||{}),{subChatType:B})})});(null==(w=null==(x=null==e?void 0:e.info)?void 0:x.meta)?void 0:w.thinking_format)&&((null==(S=J.feature_config)?void 0:S.thinking_enabled)||(null==(E=J.feature_config)?void 0:E.auto_thinking))&&(J.feature_config=C(_({},J.feature_config||{}),{thinking_format:e.info.meta.thinking_format}));const Z=!((null==(k=null==J?void 0:J.models)?void 0:k.length)>1)&&(null==(T=null==(I=null==e?void 0:e.info)?void 0:I.meta)?void 0:T.auto_search);J.feature_config=C(_({},J.feature_config||{}),{auto_search:Z});const ee=(null==(j=this.mcpLoopParams)?void 0:j.messages)||[It(J)],te=Date.now(),ne=e.id,ie=ot();let ae;G||KE.setParams(t,{model_id:ne,x_request_id:ie,api_start_time:te,chat_id:this.chatId,chat_type:null==U?void 0:U.chat_type,sub_chat_type:B}),0===Object.keys(this.mcpLoopParams).length&&(this._emit(BC.CHAT_SSE_BEGIN,{id:this.id,chatId:this.chatId,subChatType:this.subChatType,responseMessageId:t}),ee[0]=yield this.connectMcp(J,H));try{const t={};(null==(N=null==J?void 0:J.models)?void 0:N.length)>1&&(t.turn_id=U.parentId,t.modelIdx=U.modelIdx||0);const n=this.history.messages[H.parentId||""],i=(null==n?void 0:n.childrenIds)||[],a=0===i.filter(e=>{var t,n;return(null==(n=null==(t=this.history.messages)?void 0:t[e])?void 0:n.id)===e}).length,o=n&&!!this.branchInfo&&a&&H.parentId===(null==(M=this.branchInfo)?void 0:M.branch_message_id);o&&ee[0]&&(ee[0].parent_id=null,ee[0].parentId=null);let s=Q?U.id:J.parentId;Y&&!Q&&(s=null),ae=yield((e,...t)=>P(void 0,[e,...t],function*(e,t={}){return BS("sendCompletionsRequestId",{params:{et:"OTHER"},paramsExtend:{request_id:null==t?void 0:t["X-Request-Id"]},aesParams:{c5:null==t?void 0:t["X-Request-Id"]}}),yield Ox("/chat/completions",{method:"post",responseType:"stream",headers:_({"X-Accel-Buffering":"no"},t),params:{chat_id:e.chat_id},data:e})}))(_(_(_({stream:W,version:"2.1",incremental_output:lg,chat_id:this.chatId,origin_branch_message_id:o?H.parentId:void 0,chat_mode:this.chatMode,model:e.id,parent_id:o||K?null:s,messages:ee,timestamp:Math.floor(Date.now()/1e3),share_id:K?this.share_id:void 0},t),G?{size:rT.getState().visionSize}:{}),W&&null!=(D=null==(O=null==(R=null==(A=e.info)?void 0:A.meta)?void 0:R.capabilities)?void 0:O.usage)&&D?{stream_options:{include_usage:!0}}:{}),{"X-Request-Id":ie}),yield TE.getState().updateEquity(),BS("generationCreateReturn",{params:{et:"OTHER",c6:!0},paramsExtend:{chat_id:this.chatId,msg_type:U.chat_type||this.currentInputFeature},aesParams:{c4:this.chatId,c5:U.chat_type||this.currentInputFeature,c7:B}})}catch(se){yield this.handleCompletionsSendError(se,t)}if(ae&&ae.data)if(ae.success&&ae.data){const e=yield this.handleCompletionsResponseSuccess(ae,t);if((null==(L=null==e?void 0:e.changedResponseIds)?void 0:L.length)>0)return void e.changedResponseIds.forEach(e=>{const t=this.getResponseMessage(e);t&&this.finishChatUpdate(t,t.id||t.fid,ne)})}else yield this.handleCompletionsResponseError(ae,t);else yield this.handleCompletionsResponseNull(t);const oe=this.getResponseMessage(U.fid);oe&&this.finishChatUpdate(oe,U.id||U.fid||"",ne)})}sendPromptOpenAIAndCallMcpTools(e,t,n){return P(this,null,function*(){const i=Object.keys(n),a={};for(const e of i){const t=n[e];a[e]=[];for(const n of t){const t=n.tool_name,i=n.params;if(["grantedOnce","granted"].includes(this.chatPermission.local_mcp)){const n=yield aC.callTool({serverName:e,toolName:t,toolArguments:i});n&&a[e].push({[t]:JSON.stringify(n.content)})}else"denied"===this.chatPermission.local_mcp&&a[e].push({[t]:"Tool call failed: User not authorized"})}}const o=_({},this.history.messages[t]);this.changeHistory(e=>{e.messages[t].content_list=[...(null==o?void 0:o.content_list)||[],{content:"",extra:{},mcp_results:a,phase:ng.LOCAL_TOOL,status:ig.FINISHED}]});const s=C(_({},It(o)),{role:"function",content:a});delete s.parentId,delete s.id,delete s.content_list,delete s.feature_config.mcp,delete s.feature_config.local_mcp,delete s.user_action,this.mcpLoopParams={messages:[s]},this.sendPromptOpenAI(e,t)})}clearMcpParams(){return P(this,null,function*(){this.mcpLoopParams={},this.mcpErrorServers=[]})}connectMcp(e,t){return P(this,null,function*(){const n=e,i=_({},t),a=i.id||i.fid||"";if(t.feature_config.mcp){if(t.feature_config.mcp.includes("amap")){const e=(yield xT())||void 0;n.extra=C(_({},n.extra),{location:e})}this.mcpErrorServers=yield aC.connect();const e=aC.getFormatAvailableServerMap();e&&Object.keys(e).length&&(n.feature_config=C(_({},n.feature_config),{local_mcp:e}),i.feature_config=C(_({},i.feature_config),{local_mcp:e})),this.changeHistory(e=>{e.messages[a]=i})}return n})}setLocalMcpPermission(e,t){return P(this,null,function*(){var n,i,a;if(this.chatPermission=C(_({},this.chatPermission),{local_mcp:e}),t){const{model:o,responseMessageId:s}=t;switch(e){case"grantedOnce":case"granted":case"denied":{const e=null==(i=null==(n=this.history.messages[s])?void 0:n.content_list)?void 0:i.findLast(e=>{var t;return e.phase===ng.LOCAL_TOOL&&!!(null==(t=e.extra)?void 0:t.local_mcp)}),t=(null==(a=null==e?void 0:e.extra)?void 0:a.local_mcp)||{};if(!this.isChat){const e=Object.keys(t);this.mcpErrorServers=yield aC.connect(e)}this.sendPromptOpenAIAndCallMcpTools(o,s,t);break}}}})}finishChatUpdate(e,t,n){return P(this,null,function*(){var i,a,o,s,r,l,c,u,d,h,p,m,f,g,v,y,b;if(this.stopResponseFlag=!1,this.updateMessage(t,{chat_type:pC(e.chat_type)}),this.checkForceClear())return;const x=this.currentInputFeature===cg.WebSearch&&!(null==(i=e.content_list)?void 0:i.find(e=>[ng.IMAGE_GEN_THINK,ng.IMAGE_GEN_WEB_SEARCH,ng.IMAGE_GEN].includes(e.phase))),w=sC(t,this.history);if(x&&(null==(a=this.history.messages[t])?void 0:a.done)&&!(null==(o=this.history.messages[t])?void 0:o.error)){const e=((null==w?void 0:w.length)?w:[{role:"user",content:"",extra:{meta:{}}}]).at(-1);try{const i=yield mC({stream:!1,modelIdx:0,model:n,chat_id:this.chatId,parent_id:null==e?void 0:e.id,timestamp:Math.floor(Date.now()/1e3)});let a=[];if((null==i?void 0:i.success)&&(null==i?void 0:i.data)){const e=k_(null==(c=null==(l=null==(r=null==(s=i.data)?void 0:s.choices)?void 0:r[0])?void 0:l.message)?void 0:c.content,[]);a=Array.isArray(e)?e:[]}(null==a?void 0:a.length)>0&&this.changeHistory(e=>{e.messages[t].info=C(_({},e.messages[t].info),{suggest:a})})}catch(M){}}const S=null==w?void 0:w.at(-1);if(mg(null==(d=null==(u=null==S?void 0:S.extra)?void 0:u.meta)?void 0:d.subChatType)&&(S.extra.endTime=window._currentTime_),this.checkForceClear())return;this.stopResponseFlag=!1;const E=w.filter(e=>"user"===e.role);let k=!1;2==Object.keys(this.history.messages).length&&(null==(h=this.models)?void 0:h[0])===n&&"data_inspection_failed"!==(null==(p=null==e?void 0:e.error)?void 0:p.errorCode)&&"normal"===this.chatMode&&(k=!0);const I=["RateLimited","ParallelLimited"].includes((null==(m=null==e?void 0:e.error)?void 0:m.errorCode)||""),T=(null==(f=this.branchInfo)?void 0:f.isTemp)&&!I,j=this.share_id&&this.chatId===Wb.getState().chatId&&!I,N=k||T||j;if(N&&0!==(null==(g=this.models)?void 0:g.length)){const e=yield pS({chat_id:this.chatId||""}).catch(()=>P(this,null,function*(){return null}));if(k){const t=null==(v=null==e?void 0:e.data)?void 0:v.title;this.updateChatTitleAndTags(t)}if((T||j)&&e){let t=e.data.chat.history;const n=Object.values(t.messages||{}),i=sC(t.currentId,t),a=sC(this.history.currentId,this.history);i.forEach((e,t)=>{const n=a[t];e.fid=n.fid}),t=cC(e.data.chat.history),n.forEach(e=>{t.messages[e.id||""]=this.formatServerMessage(e)}),this.updateHistory(t),this.share_id=I?this.share_id:"",this.branchInfo=(null==(b=null==(y=e.data)?void 0:y.meta)?void 0:b.branch_info)||null}}this._emit(BC.CHAT_MESSAGE_END,{id:this.id,chatMode:this.chatMode,chatId:this.chatId,userMessageLength:E.length,responseMessage:It(e),history:It(this.history),isFirstConversation:N}),this.isLeave&&this.destroy(),this.setStatus({isChat:!1}),this.isStopDisabled=!1})}updateChatTitleAndTags(e){return P(this,null,function*(){if(this.checkForceClear())return;let t=sv("New Chat");e&&(t=e),this.chatTitle=t,this._emit(BC.CHAT_MESSAGE_END_PROCESS,{id:this.id,chatId:this.chatId,process_type:"UPDATE_TITLE_AND_TAGS",title:t}),hC()})}updateToSaveMessage(e,t){return P(this,null,function*(){var n,i,a,o,s,r,l,c,u,d,h,p,m,f,g,v,y,b,x,w,S,C;if(this._emit(BC.CHAT_MESSAGE_EDIT_BEGIN,{chatId:this.chatId,history:this.history}),"user"===this.history.messages[e].role)this.changeHistory(n=>{n.messages[e].content=t}),yield gS({chat_id:this.chatId,message_id:e,content:t,content_list:[]}),this._emit(BC.CHAT_MESSAGE_EDIT_END,{instanceId:this.id,history:history});else{let E="",k=[];if((null==(i=null==(n=this.history)?void 0:n.messages[e])?void 0:i.content_list)&&(null==(o=null==(a=this.history)?void 0:a.messages[e])?void 0:o.content_list.length)){let n=-1;const i=[null==(s=this.history)?void 0:s.messages[e].chat_type,null==(r=this.history)?void 0:r.messages[e].sub_chat_type,null==(d=null==(u=null==(c=null==(l=this.history)?void 0:l.messages[e])?void 0:c.extra)?void 0:u.meta)?void 0:d.subChatType].includes(Zf.WebSearch),a=null==(m=null==(p=null==(h=this.history)?void 0:h.messages[e])?void 0:p.content_list)?void 0:m.some(e=>e.phase===ng.IMAGE_ZOOM_IN_TOOL);n=i||a?null!=(y=null==(v=null==(g=null==(f=this.history)?void 0:f.messages[e])?void 0:g.content_list)?void 0:v.findLastIndex(e=>e.phase===ng.ANSWER||e.phase===ng.DEEPTHINKING))?y:-1:null!=(w=null==(x=null==(b=this.history.messages[e])?void 0:b.content_list)?void 0:x.findIndex(e=>e.phase===ng.ANSWER||e.phase===ng.DEEPTHINKING))?w:-1,-1!==n&&this.changeHistory(i=>{var a,o;i.messages[e].content_list[Number(n)].content=t,i.messages[e].originalContent=null==(o=(null==(a=i.messages[e])?void 0:a.content_list)[Number(n)])?void 0:o.content}),k=this.history.messages[e].content_list}else this.changeHistory(n=>{n.messages[e].content=t,n.messages[e].originalContent=n.messages[e].content}),E=this.history.messages[e].content;this.changeHistory(t=>{t.messages[e].edited=!0}),this.history.messages[e].chat_type!==Zf.Artifacts&&(null==(C=null==(S=this.history.messages[e].extra)?void 0:S.meta)?void 0:C.subChatType)!==Zf.DeepResearchWebDev||XC.emit(qC.MESSAGE_EDIT_ARTIFACTS,{message:this.history.messages[e]}),yield gS(_(_({chat_id:this.chatId,message_id:e},E?{content:E}:{}),k.length?{content_list:k}:{})),this._emit(BC.CHAT_MESSAGE_EDIT_END,{instanceId:this.id,history:this.history})}})}saveAsCopyMessage(e,t){return P(this,null,function*(){var n,i,a,o,s,r,l,c,u,d,h,p,m,f;const g=this.history,v=(null==(n=null==g?void 0:g.messages[e])?void 0:n.content_list)&&(null==(i=null==g?void 0:g.messages[e])?void 0:i.content_list.length),y=It(g.messages[e]),b=null==(a=null==y?void 0:y.error)?void 0:a.content;if(b){const e="data_inspection_failed"===b?sv("Input or output data may contain inappropriate content."):b;y.error={content:e,errorMessage:b,errorCode:"data_inspection_failed"===b?"data_inspection_failed":""},AC.open({type:"error",content:sv(e)})}(null==(s=null==(o=y.extra)?void 0:o.meta)?void 0:s.deploy)&&(y.extra.meta.deploy=void 0);const x=y.parentId,w=C(_({},y),{childrenIds:[],edited:!0,timestamp:Math.floor(Date.now()/1e3)});if(v){const e=[y.chat_type,y.sub_chat_type,null==(l=null==(r=null==y?void 0:y.extra)?void 0:r.meta)?void 0:l.subChatType].includes(Zf.WebSearch),n=null==(c=null==y?void 0:y.content_list)?void 0:c.some(e=>e.phase===ng.IMAGE_ZOOM_IN_TOOL);let i=-1;i=e||n?null!=(d=null==(u=null==w?void 0:w.content_list)?void 0:u.findLastIndex(e=>e.phase===ng.ANSWER||e.phase===ng.DEEPTHINKING))?d:-1:null!=(p=null==(h=null==w?void 0:w.content_list)?void 0:h.findIndex(e=>e.phase===ng.ANSWER||e.phase===ng.DEEPTHINKING))?p:-1,-1!==i&&(w.content_list[i].content=t)}else w.content=t;"data_inspection_failed"===b&&(w.content="");const S=yield(E={chat_id:this.chatId,message_id:e,content:w.content,content_list:w.content_list},P(void 0,null,function*(){return yield Ox(`/chats/${E.chat_id}/messages/${E.message_id}/save_as_copy`,{method:"POST",data:{content:E.content,content_list:E.content_list,id:E.message_id}})}));var E;const{data:k}=S;return w.id=k.id,this.changeHistory(e=>{if(e.messages[k.id]=w,e.currentId=k.id,x){const t=[...e.messages[x].childrenIds,k.id];e.messages[x]=C(_({},e.messages[x]),{childrenIds:t})}}),this.history.messages[k.id].chat_type!==Zf.Artifacts&&(null==(f=null==(m=this.history.messages[k.id].extra)?void 0:m.meta)?void 0:f.subChatType)!==Zf.DeepResearchWebDev||XC.emit(qC.MESSAGE_EDIT_ARTIFACTS,{message:this.history.messages[k.id]}),this._emit(BC.CHAT_MESSAGE_EDIT_END,{instanceId:this.id,history:It(this.history)}),{responseMessageId:k.id}})}deleteMessageById(e){return P(this,null,function*(){this.changeHistory(t=>{const n=Mk.deleteMessage(t,e);t.currentId=n.currentId,t.currentResponseIds=n.currentResponseIds})})}destroy(){return P(this,null,function*(){(this.id!==ZC.currentId&&!this.isChat||this.isForceClear)&&ZC.removeChat(this.id)})}forceClear(){this.isForceClear=!0,this.stopResponseFlag=!0,this.isStopDisabled=!1,this.isLeave=!0,this.destroy()}checkForceClear(){return!!this.isForceClear&&(this.destroy(),!0)}handleCompletionsResponseNull(e){return P(this,null,function*(){this._emit(BC.CHAT_SSE_ERROR,{id:this.id,chatId:this.chatId,responseMessageId:e,errorType:"ResIsNULL"})})}handleCompletionsResponseError(e,t){return P(this,null,function*(){var n;const i=this.changeResponseIdMap[t]||t,a=this.getResponseMessage(i);this.handleOpenAIError(null,null==(n=null==e?void 0:e.json)?void 0:n.call(e),a)})}formatServerMessage(e){if("user"===e.role)return e;if(e.error&&e.error.code){const t=e.error;e._error=e.error;const n=this.getModelForId(e.model);let i="",a="",o="";if("data_inspection_failed"===t.code){const n=this.formatGreenErrorMessage(t);o="data_inspection_failed",i=n.errorMessage,a=n.errorMessageLocale,e.content="",e.content_list=[]}else{const e=t.details;void 0!==(null==e?void 0:e.errorCode)&&void 0!==(null==e?void 0:e.content)&&void 0!==(null==e?void 0:e.errorMessage)?(o=e.errorCode||t.code||"unknown_error",i=e.errorMessage,a=sv(i)):(o=t.status_code||"unknown_error",i=t.detail||t.details||"",a=sv(i))}const s=(null==e?void 0:e.modelName)||(null==n?void 0:n.name)||(null==n?void 0:n.id)||"Qwen";e.done=!0,e.error={errorCode:o,errorMessage:i,content:sv("Oops! There was an issue connecting to {{provider}}.",{provider:s})+`\n${a}`}}return e}handleCompletionsResponseSuccess(e,t){return P(this,null,function*(){let n={};if(!!e.isStream)try{n=yield this.handleCompletionsResponseSSE(e.data,t)}catch(i){const e=this.changeResponseIdMap[t]||t;yield this.handleRetrievableFetchSSEError(e,i)}else n=yield this.handleCompletionsResponseJSON(e.data,t);return n})}handleCompletionsResponseJSON(e,t){return P(this,null,function*(){var n,i,a,o;let s=this.getResponseMessage(t);const r=null==e?void 0:e.data;if((null==r?void 0:r.message_id)&&(null==r?void 0:r.parent_id)){const{message_id:e,parent_id:n}=r;this.updateChatMessageIds(t,{parentId:n,respId:e}),this.updateCurrentResponseIdAfterIdChange(t,e),s=this.getResponseMessage(e)}if(null!==e&&e.success&&r){const{message_id:e}=r,t=r.messages.at(-1),l={done:!0};l.content=t.content,t.chat_type&&(l.chat_type=t.chat_type,t.chat_type===Zf.Image2Video&&(l.chat_type=Zf.VideoGeneration)),l.info=C(_({},r.usage||{}),{openai:!0,chatId:this.chatId});return((null==(i=null==(n=null==t?void 0:t.extra)?void 0:n.wanx)?void 0:i.task_id)||(null==(o=null==(a=null==t?void 0:t.extra)?void 0:a.aipodcast)?void 0:o.task_id)||"")&&(l.done=!1,l.extra=_(_({},(null==s?void 0:s.extra)||{}),t.extra),this._emit(BC.CHAT_SSE_FIRST_RECEIVE_MESSAGE,{id:this.id,chatId:this.chatId})),this.updateResponseMessage(e,l),{changedResponseIds:[e]}}yield this.handleOpenAIError(null,r||e,s)})}handleCompletionsResponseSSE(e,t){return P(this,null,function*(){var n;const i=new _k;if(i.streamingProcessor){const a=i.streamingProcessor.processSSEStream(e,!!(null==(n=this.settings)?void 0:n.splitLargeChunks),!1,!0);return yield this.handleCompoletionsResponseStream(e,t,a)}return yield this.handleCompletionsResponseSSEFallback(e,t)})}handleCompletionsResponseSSEFallback(e,t){return P(this,null,function*(){var n;const i=yield sE(e,!!(null==(n=this.settings)?void 0:n.splitLargeChunks),!1);return yield this.handleCompoletionsResponseStream(e,t,i)})}handleCompoletionsResponseStream(e,t,n){return P(this,null,function*(){var e,i,a,o,s,r,l,c;const u=new Map;let d=0,h=t;const p=this.getResponseMessage(h);if(!p)return;const m=this.getModelForId(p.model),f=this.currentInputFeature,g=this.subChatType,v=new Map;let y=!1,b=!1;this.mcpErrorServers.length&&this.changeHistory(e=>{p&&(e.messages[t].extra=C(_({},p.extra||{}),{connectFailedMcp:this.mcpErrorServers.map(e=>e.name)}))});try{for(var x,w,S,E=R(n);x=!(w=yield E.next()).done;x=!1){const n=w.value,{value:m,role:x,phase:S,status:E,sources:I,selectedModelId:T,error:j,usage:N,functionCallType:P,web_search_info:M,code_interpreter_info:A,chunk_data:R,extra:O={},lang_code:D,function_call:L,chatId:F,parentId:U,done:z,isStop:H,isStopInThinking:$,mcp_name:B="",tool_name:q="",function_id:G="",timestamp:V}=n;let W,Q=n.responseId;if((null==(e=null==O?void 0:O.deep_research)?void 0:e.interrupt_id)&&"assistant"===x&&(Q=null==(i=null==O?void 0:O.deep_research)?void 0:i.interrupt_id),Q){if(W=u.get(Q),void 0===W){let e;W=d,d++,u.set(Q,W);if(this.history.messages[this.history.currentId||""].sub_chat_type===Zf.INTERRUPT&&p.sub_chat_type===Zf.DeepResearch&&(e=It((null==(a=this.history.messages[Q])?void 0:a.content_list)||[])),v.set(W,e||It((null==(o=this.mcpLoopParams)?void 0:o.messages)?[...p.content_list||[]]:[])),F&&U){if(this.history.messages[Q]){h=Q;continue}const e=0===W?t:t+"__MULTI__"+W;if(0!==W){const n=this.changeResponseIdMap[t]||t,i=this.getResponseMessage(n);i&&this.changeHistory(t=>{Mk.cloneResponseMessage(t,e,i)})}this.updateChatMessageIds(e,{parentId:U,respId:Q}),this.updateCurrentResponseIdAfterIdChange(e,Q),this.updateResponseMessage(Q,{responseIdx:W}),u.size>1&&([...u.keys()].forEach(e=>{this.updateResponseMessage(e,{isMultiResponse:!0})}),this.changeHistory(e=>{var t;e.currentId=(null==(t=e.currentResponseIds)?void 0:t[0])||Q})),h=Q,this.stopResponseFlag||(this.isStopDisabled=!1);continue}}h=Q}else{W=0;const e=Array.from(u.entries()).find(([e,t])=>0===t);h=(null==e?void 0:e[0])||t,u.set(h,0)}const K=v.get(W)||It((null==(s=this.mcpLoopParams)?void 0:s.messages)?[...p.content_list||[]]:[]),Y=this.getResponseMessage(h);this.stopResponseFlag||(this.isStopDisabled=!1);const{local_mcp:X}=O||{};if(b||(b=S===ng.LOCAL_TOOL&&E===ig.FINISHED&&!!Object.keys(X).length),!z&&(null==R?void 0:R.chunk_time)&&(null==R?void 0:R.chunk_size))KE.dealEventStreamChunkData(h,R);else{if(P){const e=!!(null==(r=null==Y?void 0:Y.feature_config)?void 0:r.thinking_enabled);"bio"!==P||e||Pk({notification_id:null==O?void 0:O.function_id,type:"functionCallType",detail:_({chat_id:this.chatId},(null==O?void 0:O.memory_operation_result)||{})}),this.updateResponseMessage(h,{functionCallType:P})}if(!P&&(null==Y?void 0:Y.functionCallType)&&this.updateResponseMessage(h,{functionCallType:null}),A&&this.updateResponseMessage(h,{codeInterpreterInfo:A,role:x}),j&&"The request is ended!"!==j.details&&"The request is finished!"!==j.details){yield this.handleOpenAIError(j,null,Y);if([...u.keys()].every(e=>{var t;return!0===(null==(t=this.getResponseMessage(e))?void 0:t.done)}))break;continue}if(z||j&&("The request is ended!"===j.details||"The request is finished!"===j.details)){if(b)break;if(j)try{yield this.handleReconnectIsFinished(h)}catch(k){yield this.handleOpenAIError(k,null,Y);break}[...u.keys()].forEach(e=>{var t;if(KE.sendEvent(e),this.currentInputFeature===cg.WebSearch){const n=K.length-1,i=K.findIndex(e=>e.function_id===G),a=-1===i?n:i;K[a].extra=C(_({},(null==(t=null==Y?void 0:Y.content_list)?void 0:t[a].extra)||{}),{web_search_info:[]}),this.updateResponseMessage(e,{content_list:It(K)})}H&&(this.updateResponseMessage(e,{is_stop:!0}),y=!0),this.updateResponseMessage(e,{done:!0}),this.setStatus({isChat:!0}),this._emit(BC.CHAT_SSE_PROCESS,{id:this.id,chatId:this.chatId,responseMessageId:e,history:this.history})});break}if($&&(v.set(W,[]),this.updateResponseMessage(h,{content_list:[],is_stop_in_thinking:!0})),N&&"{}"!==JSON.stringify(N)&&this.updateResponseMessage(h,{info:C(_({},N),{openai:!0,usage:N})}),T)this.updateResponseMessage(h,{selectedModelId:T,arena:!0});else if(I)this.updateResponseMessage(h,{sources:I});else if((!fg(f)||S)&&(""!=Y.content||S||"\n"!=m)&&(S&&S!==ng.KEEPALIVE&&(ck({content_list:K,phase:S,value:m,role:x,status:E,extra:O,lang_code:D,mcp_name:B,tool_name:q,function_call:L,timestamp:V,subChatType:g,function_id:G,splitLargeChunks:null==(l=this.settings)?void 0:l.splitLargeChunks}),v.set(W,K)),S!==ng.KEEPALIVE)){if(!S){let e=Y.content;null==(c=this.settings)||c.splitLargeChunks,e+=m,this.updateResponseMessage(h,{content:e})}this.updateResponseMessage(h,{content_list:It(K),extra:C(_({},(null==Y?void 0:Y.extra)||{}),{meta:{subChatType:g}})}),this.setStatus({isChat:!0}),this._emit(BC.CHAT_SSE_PROCESS,{id:this.id,chatId:this.chatId,responseMessageId:h,history:It(this.history),setWebSearchInfo:!!M})}}}}catch(w){S=[w]}finally{try{x&&(w=E.return)&&(yield w.call(E))}finally{if(S)throw S[0]}}return this.mcpErrorServers.length&&(yield gS({chat_id:this.chatId,message_id:h,extra:{connectFailedMcp:this.mcpErrorServers.map(e=>e.name)}})),b?("prompt"!==this.chatPermission.local_mcp&&m&&this.setLocalMcpPermission(this.chatPermission.local_mcp,{model:m,responseMessageId:h}),void(yield mS({chat_id:this.chatId,chat:{permission:this.chatPermission}}))):(["grantedOnce","denied"].includes(this.chatPermission.local_mcp)&&this.setLocalMcpPermission("prompt"),[...u.keys()].forEach(e=>{const t=this.getResponseMessage(e);this._emit(BC.CHAT_SSE_END,{id:this.id,chatId:this.chatId,responseMessage:t,responseMessageId:e,model:m,permissions:this.chatPermission,history:It(this.history)})}),{isMCPLoop:b,isStopResponse:y,changedResponseIds:[...u.keys()]})})}getResponseMessage(e){return this.history.messages[e]?_({},this.history.messages[e]):void 0}updateResponseMessage(e,t){this.changeHistory(n=>{var i;if(!n.messages[e])return;const a=n.messages[e];if(Object.keys(t).forEach(e=>{"[object Object]"===Object.prototype.toString.call(t[e])?a[e]=_(_({},a[e]||{}),t[e]):a[e]=t[e]}),t.codeInterpreterInfo&&(null==(i=a.content_list)?void 0:i.length)){const e=a.content_list.length-1;a.content_list[e].extra=C(_({},a.content_list[e].extra||{}),{code_interpreter_info:t.codeInterpreterInfo})}"assistant"===a.role&&lC(a)})}updateChatMessageIds(e,t){const{parentId:n,respId:i}=t;this.changeHistory(t=>{var a,o,s;const r=t.messages[e];if(!r)return;this.changeResponseIdMap[e]=i,r.id=i;const l=r.fid,c=(null==(a=t.messages)?void 0:a[r.parentId||""])||t.messages[n]||{},u=c.fid;c.id||(c.id=n);const d=null==(o=c.childrenIds)?void 0:o.findIndex(t=>t===e);if(d>-1){const e=[...c.childrenIds||[]];e[d]=i,c.childrenIds=e}if(c.parentId){const e=_({},t.messages[c.parentId]||{}),i=null==(s=e.childrenIds)?void 0:s.findIndex(e=>e===u);if(i>-1){const t=[...e.childrenIds||[]];t[i]=n,e.childrenIds=t}t.messages[c.parentId]=e}r.parentId=n,l&&t.messages[l]&&delete t.messages[l],t.messages[i]=r,t.messages[u]&&delete t.messages[u],t.messages[n]=c,t.currentId=i}),this._emit(BC.CHAT_SSE_ID_CHANGE,{id:this.id,chatId:this.chatId,responseMessageId:i,history:It(this.history)})}updateCurrentResponseIdAfterIdChange(e,t){this.changeHistory(n=>{n.currentId=t;const i=n.currentResponseIds.findIndex(t=>t===e),a=n.currentResponseIds.findIndex(e=>e===t);i>-1?n.currentResponseIds[i]=t:-1===a&&n.currentResponseIds.push(t)})}updateMessage(e,t){var n;this.history.messages[e]&&(t.chat_type===Zf.Image2Video&&(t.chat_type=Zf.VideoGeneration,t.extra=C(_({},t.extra||{}),{meta:C(_({},(null==(n=t.extra)?void 0:n.meta)||{}),{subChatType:Zf.VideoGeneration})})),this.changeHistory(n=>{n.messages[e]=_(_({},n.messages[e]),t)}),this._emit(BC.CHAT_MESSAGE_UPDATE,{instanceId:this.id,chatId:this.chatId,messageId:e,history:It(this.history)}))}handleCompletionsSendError(e,t){return P(this,null,function*(){const n=this.getResponseMessage(t);BS("generationCreateReturn",{params:{et:"OTHER",c6:!1},paramsExtend:{chat_id:this.chatId,msg_type:this.currentInputFeature},aesParams:{c4:this.chatId,c5:(null==n?void 0:n.chat_type)||this.currentInputFeature,c7:this.subChatType}});const i={content:"",content_list:[],done:!0};this.stopResponseFlag&&(i.is_stop=!0),this.updateResponseMessage(t,i),this.changeHistory(e=>{e.currentId&&(e.messages[e.currentId].done=!0)}),this._emit(BC.CHAT_SSE_ERROR,{id:this.id,chatId:this.chatId,responseMessageId:t,errorType:e.name,history:It(this.history)})})}handleCompletionsSSEError(e,t){return P(this,null,function*(){const n=this.changeResponseIdMap[t]||t,i=this.getResponseMessage(n);if("AbortError"===e.name||"User: Stop Response"===e){const t={done:!0,is_stop:!0};this.changeHistory(e=>{e.currentId&&(e.messages[e.currentId].done=!0)}),this.updateResponseMessage(n,t),this.setStatus({isChat:!1}),this.isStopDisabled=!1,this._emit(BC.CHAT_SSE_ERROR,{id:this.id,chatId:this.chatId,errorType:null==e?void 0:e.name,history:It(this.history)})}else yield this.handleOpenAIError(e,null,i)})}retrievableFetchSSEResponse(e){return P(this,null,function*(){var t;this._emit(BC.CHAT_SCROLL_TO_BOTTOM,{id:this.id});const n=yield((e,...t)=>P(void 0,[e,...t],function*(e,t={}){return yield Ox("/chat/completions",{method:"get",responseType:"stream",headers:_({"X-Accel-Buffering":"no"},t),toast:!1,params:e})}))({chat_id:this.chatId,response_id:e});if(!n.success||!n.data)return this.handleRetrievableFetchSSEError(e,new Error((null==(t=n.data)?void 0:t.message)||"Unknown error"));yield this.handleCompletionsResponseSuccess(n,e);const i=this.getResponseMessage(e);i&&this.finishChatUpdate(i,e,i.model)})}handleRetrievableFetchSSEError(e,t){return P(this,null,function*(){if("number"==typeof this.reconnectTimesMap[e]?this.reconnectTimesMap[e]+=1:this.reconnectTimesMap[e]=1,this.reconnectTimesMap[e]>10)return yield this.handleCompletionsSSEError(t,e);if(this.stopResponseFlag||"AbortError"===t.name)return this.handleCompletionsSSEError(t,e);if(this.isLeave)return;const n=this.changeResponseIdMap[e]||e;return AC.open({type:"warning",content:sv("Network error, reconnecting..."),duration:3500}),BS("AsyncChat-Reconnect",{params:{et:"OTHER",c6:!0},paramsExtend:{chat_id:this.chatId,msg_type:this.currentInputFeature},aesParams:{c4:this.chatId,c5:this.currentInputFeature,c7:this.subChatType,c8:n}}),yield new Promise(e=>setTimeout(e,3e3)),yield this.retrievableFetchSSEResponse(n)})}handleReconnectIsFinished(e){return P(this,null,function*(){var t,n,i;yield RC(200);const a=yield pS({chat_id:this.chatId||""}),o=null==(i=null==(n=null==(t=null==a?void 0:a.data)?void 0:t.chat)?void 0:n.history)?void 0:i.messages;if(o&&o[e]){const{content:t,content_list:n,error:i,modelName:a}=o[e];if((t||n)&&this.updateResponseMessage(e,{content:t,content_list:n}),i){const t={errorCode:i.code,errorMessage:i.message||i.details,content:sv("Oops! There was an issue connecting to {{provider}}.",{provider:a})+`\n${sv(i.message||i.details)}`};this.updateResponseMessage(e,{error:t})}}})}getModelForId(e){const{models:t}=aI.getState();return t.find(t=>t.id===e)}}k(Rk,"modelsList",[]);class Ok extends ct{constructor(){super({maxListeners:200}),k(this,"eventQueue"),k(this,"isPaused",!1),k(this,"eventListeners"),k(this,"maxListeners",20),k(this,"eventHistory"),k(this,"maxHistorySize",100),this.eventQueue=new Map,this.eventListeners=new Map,this.eventHistory=[],this.maxListeners=200}on(e,t){return this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e).add(t),super.on(e.toString(),t)}firstOn(e,t){if(!e)return;const n=super.listeners(e);return n.length>0?(super.off(e.toString(),n[0]),super.prependListener(e.toString(),t)):super.on(e.toString(),t)}once(e,t){const n=(...i)=>{t(...i),this.eventListeners.has(e)&&this.eventListeners.get(e).delete(n)};return this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e).add(n),super.once(e,n)}off(e,t){return t?(this.eventListeners.has(e)&&this.eventListeners.get(e).delete(t),super.off(e,t)):(this.eventListeners.has(e)&&this.eventListeners.delete(e),super.removeAllListeners(e)),this}emit(e,...t){return this.addToHistory(e,t[0]),this.isPaused?(this.eventQueue.has(e)||this.eventQueue.set(e,[]),this.eventQueue.get(e).push(t),!0):super.emit(e,...t)}pause(){this.isPaused=!0}resume(e=!0){this.isPaused=!1,e?this.processEventQueue():this.eventQueue.clear()}processEventQueue(){this.eventQueue.forEach((e,t)=>{e.forEach(e=>{super.emit(t,...e)})}),this.eventQueue.clear()}addToHistory(e,t){this.eventHistory.push({type:e,data:t,timestamp:Date.now()}),this.eventHistory.length>this.maxHistorySize&&this.eventHistory.shift()}getEventHistory(e,t){let n=this.eventHistory;return e&&(n=n.filter(t=>t.type===e)),t&&t>0&&(n=n.slice(-t)),n}clearEventHistory(){this.eventHistory=[]}getListenerCount(e){return this.listeners(e).length}getEventNames(){return Array.from(this.eventListeners.keys())}setMaxListeners(e){return this.maxListeners=e,this}getMaxListeners(){return this.maxListeners}createNamespace(e){return new Dk(this,e)}}class Dk{constructor(e,t){k(this,"controller"),k(this,"namespace"),this.controller=e,this.namespace=t}getNamespacedEvent(e){return`${this.namespace}:${e}`}on(e,t){return this.controller.on(this.getNamespacedEvent(e),t),this}once(e,t){return this.controller.once(this.getNamespacedEvent(e),t),this}off(e,t){return this.controller.off(this.getNamespacedEvent(e),t),this}emit(e,...t){return this.controller.emit(this.getNamespacedEvent(e),...t)}}class Lk extends Ok{destroy(){}handleError(e,t){this.emit("system:error",{code:"controller_error",message:e.message,timestamp:Date.now(),data:{context:t||this.constructor.name,stack:e.stack}})}}var Fk=(e=>(e.INITIALIZED="initialized",e.LOADING="loading",e.READY="ready",e.PLAYING="playing",e.PAUSED="paused",e.STOPPED="stopped",e.UNSUPPORTED_LANGUAGE="unsupportedLanguage",e))(Fk||{}),Uk=(e=>(e.AUDIO_CONTEXT="audioContext",e.HTML_AUDIO="htmlAudio",e.SIMPLE_HTML_AUDIO="simpleHtmlAudio",e.HTML_AUDIO_CXT="htmlAudioCxt",e))(Uk||{});class zk{constructor(e){k(this,"_state",Fk.STOPPED),k(this,"options"),k(this,"audioContext",null),k(this,"gainNode",null),k(this,"audioCtxInitialized",!1),k(this,"isProcessingQueue",!1),k(this,"startTime",0),k(this,"currentTime",0),k(this,"audioBuffer",null),k(this,"bufferSize",8192),k(this,"minBufferSize",1024),k(this,"processedSamples",0),k(this,"isStreamPlaying",!1),k(this,"currentSource",null),k(this,"isWaitingForNextChunk",!1),k(this,"nextSource",null),k(this,"preloadThreshold",.5),k(this,"isPreloading",!1),k(this,"maxChunkSize",4096),k(this,"isFirstChunk",!0),k(this,"hasReceivedData",!1),k(this,"isDataComplete",!1),k(this,"preloadTimers",new Set),k(this,"sampleRate",24e3),k(this,"channels",1),this.options={onStateChange:e.onStateChange||(()=>{}),onError:e.onError||(()=>{})},this.initAudioContext()}initAudioContext(){return P(this,null,function*(){var e,t;try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination),this.gainNode.gain.value=1,this.audioCtxInitialized=!0,this.setState(Fk.INITIALIZED)}catch(n){throw null==(t=(e=this.options).onError)||t.call(e,n),new Error("Web Audio API ")}})}appendPCMBuffer(e,t=!1){if(this.hasReceivedData||(this.setState(Fk.LOADING),this.hasReceivedData=!0),!this.audioCtxInitialized)throw new Error("Web Audio API ");this.audioBuffer||(this.audioBuffer=new Float32Array(this.bufferSize),this.processedSamples=0);const n=this.pcmBufferToFloat32(e),i=Math.floor(this.currentTime*this.sampleRate)-this.processedSamples,a=i+n.length;if(this.audioBuffer.length<this.processedSamples+a){const e=new Float32Array(Math.max(this.processedSamples+a,2*this.audioBuffer.length));e.set(this.audioBuffer),this.audioBuffer=e}this.audioBuffer.set(n,this.processedSamples+i),this.currentTime=(this.processedSamples+a)/this.sampleRate,(a>=this.minBufferSize||t)&&(this.isStreamPlaying||this._state===Fk.PLAYING||this._state===Fk.STOPPED||this.startStreamingPlayback(),this._state!==Fk.PLAYING||this.isProcessingQueue||this.processAudioBuffer(t)),t&&(this.isDataComplete=!0)}startStreamingPlayback(){var e;this.audioContext&&"suspended"===this.audioContext.state&&this.audioContext.resume(),this.isStreamPlaying=!0,this.startTime=(null==(e=this.audioContext)?void 0:e.currentTime)||0,this.isFirstChunk=!0,this.setState(Fk.PLAYING)}processAudioBuffer(e=!1){var t,n;if(this._state!==Fk.STOPPED&&this.isStreamPlaying&&this.audioBuffer&&!this.isProcessingQueue&&this.audioContext)if(this.currentSource&&this.currentSource.buffer)this.isWaitingForNextChunk=!0;else{this.isProcessingQueue=!0;try{const t=Math.floor(this.currentTime*this.sampleRate)-this.processedSamples;if(t<=0)return(e||this.isDataComplete)&&(this.isStreamPlaying=!1,this.setState(Fk.STOPPED)),void(this.isProcessingQueue=!1);let n=Math.min(t,this.audioBuffer.length-this.processedSamples);if(e)n=Math.min(t,this.audioBuffer.length-this.processedSamples);else{if(this.isFirstChunk){const e=Math.min(512,this.minBufferSize);if(!(n>=e))return void(this.isProcessingQueue=!1);this.isFirstChunk=!1}if(!this.isFirstChunk&&(n=Math.min(n,this.maxChunkSize),n<this.minBufferSize&&!e))return void(this.isProcessingQueue=!1)}if(n<=0)return void(this.isProcessingQueue=!1);const i=this.audioContext.createBuffer(this.channels,n,this.sampleRate);for(let e=0;e<this.channels;e++){i.getChannelData(e).set(this.audioBuffer.subarray(this.processedSamples,this.processedSamples+n))}const a=this.audioContext.createBufferSource();a.buffer=i,a.connect(this.gainNode),this.currentSource=a;const o=this.audioContext.currentTime;let s;0===this.processedSamples?s=o:(s=this.startTime+this.processedSamples/this.sampleRate,s<o-.1?(this.startTime=o-this.processedSamples/this.sampleRate,s=o):s=Math.max(s,o)),a.start(s),a.onended=()=>{this.processedSamples+=n,this.currentSource=null;const t=Math.floor(this.currentTime*this.sampleRate);!(this.processedSamples<t)||e&&this.isDataComplete?(this.isStreamPlaying=!1,this.setState(Fk.STOPPED)):this.isStreamPlaying&&!this.isProcessingQueue&&(this.isWaitingForNextChunk=!1,this.processAudioBuffer(e))},this.setupPreloadListener(a,n,e)}catch(i){this.currentSource=null,null==(n=(t=this.options).onError)||n.call(t,i)}this.isProcessingQueue=!1}}setupPreloadListener(e,t,n){const i=t/this.sampleRate*this.preloadThreshold,a=setTimeout(()=>{!this.isStreamPlaying||this.isPreloading||n||this._state!==Fk.PLAYING||this.preloadNextChunk(),this.preloadTimers.delete(a)},1e3*i);this.preloadTimers.add(a);const o=e.onended;e.onended=()=>{clearTimeout(a),this.preloadTimers.delete(a),o&&o.call(e)}}preloadNextChunk(){if(this._state!==Fk.STOPPED&&this.isStreamPlaying&&!this.isPreloading&&this.audioBuffer){this.isPreloading=!0;try{const e=Math.floor(this.currentTime*this.sampleRate)-this.processedSamples;if(e<=0)return void(this.isPreloading=!1);const t=Math.min(e,this.audioBuffer.length-this.processedSamples);if(t<=0)return void(this.isPreloading=!1);const n=this.audioContext.createBuffer(this.channels,t,this.sampleRate);for(let a=0;a<this.channels;a++){n.getChannelData(a).set(this.audioBuffer.subarray(this.processedSamples,this.processedSamples+t))}const i=this.audioContext.createBufferSource();i.buffer=n,i.connect(this.gainNode),this.nextSource=i}catch(e){}this.isPreloading=!1}}pcmBufferToFloat32(e){const t=new Float32Array(e.length/2);for(let n=0;n<e.length;n+=2){const i=e[n]|e[n+1]<<8;t[n/2]=32768&i?(i-65536)/32768:i/32768}return t}play(){return P(this,null,function*(){var e;if(!this.audioCtxInitialized)throw new Error("Web Audio API ");this._state!==Fk.PLAYING&&this.hasReceivedData&&(this.audioContext&&"suspended"===this.audioContext.state&&(yield this.audioContext.resume()),this.isStreamPlaying=!0,0===this.processedSamples&&(this.startTime=(null==(e=this.audioContext)?void 0:e.currentTime)||0),this.setState(Fk.PLAYING),this.audioBuffer&&!this.isProcessingQueue&&(this.isFirstChunk=!0,this.processAudioBuffer()))})}pause(){return P(this,null,function*(){if(!this.audioCtxInitialized)throw new Error("Web Audio API ");this.setState(Fk.PAUSED)})}stop(){return P(this,null,function*(){if(!this.audioCtxInitialized)throw new Error("Web Audio API ");if(this.currentSource){try{this.currentSource.stop()}catch(e){}this.currentSource=null}if(this.nextSource){try{this.nextSource.stop()}catch(e){}this.nextSource=null}this.preloadTimers.forEach(e=>clearTimeout(e)),this.preloadTimers.clear(),this.isStreamPlaying=!1,this.isWaitingForNextChunk=!1,this.isPreloading=!1,this.setState(Fk.STOPPED)})}reset(){return P(this,null,function*(){yield this.stop(),this.hasReceivedData=!1,this.isDataComplete=!1,this.audioBuffer=null,this.currentTime=0,this.startTime=0,this.processedSamples=0,this.isStreamPlaying=!1,this.isWaitingForNextChunk=!1,this.isPreloading=!1,this.isFirstChunk=!0,this.currentSource=null,this.nextSource=null,this.preloadTimers.forEach(e=>clearTimeout(e)),this.preloadTimers.clear(),this.setState(Fk.STOPPED)})}resetPlayback(){return P(this,null,function*(){yield this.stop(),this.currentTime=0,this.startTime=0,this.processedSamples=0,this.isStreamPlaying=!1,this.isWaitingForNextChunk=!1,this.isPreloading=!1,this.isFirstChunk=!0,this.currentSource=null,this.nextSource=null,this.preloadTimers.forEach(e=>clearTimeout(e)),this.preloadTimers.clear(),this.audioBuffer&&this.hasReceivedData&&(this.currentTime=this.audioBuffer.length/this.sampleRate),this.hasReceivedData?this.setState(Fk.READY):this.setState(Fk.STOPPED)})}destroy(){this.stop(),this.preloadTimers.forEach(e=>clearTimeout(e)),this.preloadTimers.clear(),this.audioCtxInitialized&&(this.audioContext&&"closed"!==this.audioContext.state&&this.audioContext.close(),this.gainNode=null,this.audioContext=null),this.setState(Fk.STOPPED)}setState(e){var t,n;this._state!==e&&(this._state=e,null==(n=(t=this.options).onStateChange)||n.call(t,e))}get volume(){var e;if(!this.audioCtxInitialized)throw new Error("Web Audio API ");return(null==(e=this.gainNode)?void 0:e.gain.value)||0}set volume(e){if(!this.audioCtxInitialized)throw new Error("Web Audio API ");this.gainNode.gain.value=e}get state(){return this._state}get isReady(){return this._state===Fk.READY}get isLoading(){return this._state===Fk.LOADING}get isPlaying(){return this._state===Fk.PLAYING}get isPaused(){return this._state===Fk.PAUSED}get isStopped(){return this._state===Fk.STOPPED}get hasData(){return this.hasReceivedData}get isComplete(){return this.isDataComplete}setAudioParams(e,t=1){this.sampleRate=e,this.channels=t}}class Hk{constructor(e){k(this,"_state",Fk.STOPPED),k(this,"options"),k(this,"audioElement",null),k(this,"audioCtxInitialized",!1),k(this,"bufferSize",8192),k(this,"minBufferSize",1024),k(this,"isStreamPlaying",!1),k(this,"isAudioCreated",!1),k(this,"audioChunks",[]),k(this,"hasReceivedData",!1),k(this,"isDataComplete",!1),k(this,"currentBlobURL",null),k(this,"playedChunksCount",0),k(this,"lastUpdateTime",0),k(this,"isUpdatingAudio",!1),k(this,"updateQueue",[]),k(this,"retryCount",0),k(this,"maxRetries",3),k(this,"isManuallyStopped",!1),k(this,"stopRequested",!1),k(this,"pendingTimeouts",new Set),k(this,"sampleRate",24e3),k(this,"channels",1),k(this,"bitsPerSample",16),k(this,"audioInitAbortHandler",()=>{}),k(this,"audioInitCanplayHandler",()=>{var e;this.setState(Fk.READY),!(null==(e=this.audioElement)?void 0:e.paused)||this.isManuallyStopped||this.stopRequested||this.audioElement.play().catch(e=>{})}),k(this,"audioInitPlayHandler",()=>{this.setState(Fk.PLAYING)}),k(this,"audioInitPauseHandler",()=>{this.setState(Fk.PAUSED)}),k(this,"audioInitEndedHandler",()=>{if(this.isManuallyStopped||this.stopRequested)this.setState(Fk.STOPPED);else if(this.setState(Fk.STOPPED),this.isStreamPlaying&&!this.isDataComplete&&this.audioChunks.length>this.playedChunksCount&&!this.isManuallyStopped&&!this.stopRequested){const e=setTimeout(()=>{var t;this.pendingTimeouts.delete(e),(null==(t=this.audioElement)?void 0:t.paused)&&this.isStreamPlaying&&this.audioChunks.length>this.playedChunksCount&&!this.isManuallyStopped&&!this.stopRequested&&this.queueUpdate(()=>this.updateStreamingAudio())},100);this.pendingTimeouts.add(e)}else this.isDataComplete&&(this.isStreamPlaying=!1)}),k(this,"audioInitErrorHandler",e=>{var t,n;null==(n=(t=this.options).onError)||n.call(t,new Error(""))}),k(this,"audioCanPlayHandler",()=>{this.removeAudioEventListeners(),this.playAudio()}),k(this,"audioErrorHandler",()=>{var e,t;this.removeAudioEventListeners(),null==(t=(e=this.options).onError)||t.call(e,new Error(""))}),this.options={onStateChange:e.onStateChange||(()=>{}),onError:e.onError||(()=>{})},this.initHTMLAudio()}initHTMLAudio(){return P(this,null,function*(){var e,t;try{this.audioElement=document.createElement("audio"),this.audioElement.style.display="none",this.audioElement.preload="auto",this.audioElement.controls=!1,this.audioElement.volume=1,document.body.appendChild(this.audioElement),this.audioElement.addEventListener("abort",this.audioInitAbortHandler),this.audioElement.addEventListener("canplay",this.audioInitCanplayHandler),this.audioElement.addEventListener("play",this.audioInitPlayHandler),this.audioElement.addEventListener("pause",this.audioInitPauseHandler),this.audioElement.addEventListener("ended",this.audioInitEndedHandler),this.audioElement.addEventListener("error",this.audioInitErrorHandler),this.audioCtxInitialized=!0,this.setState(Fk.INITIALIZED)}catch(n){throw null==(t=(e=this.options).onError)||t.call(e,n),new Error(" HTML Audio ")}})}appendPCMBuffer(e,t=!1){var n,i;if(this.isManuallyStopped||this.stopRequested)return;if(this.hasReceivedData||(this.setState(Fk.LOADING),this.hasReceivedData=!0),!this.audioCtxInitialized)throw new Error(" HTML Audio ");this.audioChunks.push(e);if(this.audioChunks.reduce((e,t)=>e+t.length,0)>=this.minBufferSize&&!this.isStreamPlaying&&!this.isAudioCreated&&this.startStreamingPlayback(),this.isStreamPlaying&&this.isAudioCreated&&(null==(n=this.audioElement)?void 0:n.paused)){const e=Date.now();e-this.lastUpdateTime>200&&this.audioChunks.length>this.playedChunksCount&&(this.lastUpdateTime=e,this.queueUpdate(()=>this.updateStreamingAudio()))}t&&(this.isDataComplete=!0,this.isStreamPlaying?this.isAudioCreated&&(null==(i=this.audioElement)?void 0:i.paused)&&this.queueUpdate(()=>this.updateStreamingAudio()):this.startStreamingPlayback())}float32ToPCM(e){const t=new Uint8Array(2*e.length);for(let n=0;n<e.length;n++){const i=Math.max(-1,Math.min(1,e[n])),a=i<0?32768*i:32767*i,o=Math.round(a);t[2*n]=255&o,t[2*n+1]=o>>8&255}return t}startStreamingPlayback(){this.isStreamPlaying||this.isManuallyStopped||this.stopRequested||(this.isStreamPlaying=!0,this.setState(Fk.PLAYING),this.queueUpdate(()=>this.updateStreamingAudio()))}waitForAudioLoadAndPlay(){this.audioElement&&(this.isManuallyStopped||this.stopRequested||(this.audioElement.readyState>=2?this.playAudio():(this.audioElement.addEventListener("canplay",this.audioCanPlayHandler),this.audioElement.addEventListener("error",this.audioErrorHandler))))}queueUpdate(e){this.isManuallyStopped||this.stopRequested||(this.isUpdatingAudio?this.updateQueue.push(e):this.executeUpdate(e))}executeUpdate(e){if(this.isManuallyStopped||this.stopRequested)this.processNextUpdate();else{this.isUpdatingAudio=!0;try{e()}catch(t){this.isUpdatingAudio=!1,this.processNextUpdate()}}}processNextUpdate(){if(this.isManuallyStopped||this.stopRequested)return this.updateQueue=[],void(this.isUpdatingAudio=!1);if(this.updateQueue.length>0){const e=this.updateQueue.shift();if(e){const t=setTimeout(()=>{this.pendingTimeouts.delete(t),this.executeUpdate(e)},50);this.pendingTimeouts.add(t)}}else this.isUpdatingAudio=!1}updateStreamingAudio(){var e,t;if(this.isManuallyStopped||this.stopRequested)this.processNextUpdate();else if(this.audioElement&&0!==this.audioChunks.length)if(this.audioChunks.length<=this.playedChunksCount)this.processNextUpdate();else if(this.audioElement.paused||this.audioElement.ended)try{const e=this.audioChunks.slice(this.playedChunksCount),t=e.reduce((e,t)=>e+t.length,0),n=new Uint8Array(t);let i=0;for(const s of e)n.set(s,i),i+=s.length;const a=this.createWAVFile(n);this.currentBlobURL&&URL.revokeObjectURL(this.currentBlobURL);const o=new Blob([a],{type:"audio/wav"});this.currentBlobURL=URL.createObjectURL(o),this.audioElement.src=this.currentBlobURL,this.isAudioCreated=!0,this.waitForAudioLoadAndPlay()}catch(n){null==(t=(e=this.options).onError)||t.call(e,n),this.processNextUpdate()}else this.processNextUpdate();else this.processNextUpdate()}playAudio(){if(this.isManuallyStopped||this.stopRequested)this.processNextUpdate();else if(this.audioElement){if(this.audioElement.readyState<2){const e=setTimeout(()=>{this.pendingTimeouts.delete(e),this.playAudio()},100);return void this.pendingTimeouts.add(e)}this.audioElement.paused?this.audioElement.play().then(()=>{this.playedChunksCount=this.audioChunks.length,this.retryCount=0,this.processNextUpdate()}).catch(e=>{var t,n;if(this.isManuallyStopped||this.stopRequested)return this.retryCount=0,void this.processNextUpdate();if("AbortError"===e.name||e.message.includes("interrupted"))if(this.retryCount++,this.retryCount<=this.maxRetries){const e=setTimeout(()=>{this.pendingTimeouts.delete(e),this.playAudio()},200*this.retryCount);this.pendingTimeouts.add(e)}else this.retryCount=0,this.processNextUpdate();else this.retryCount=0,null==(n=(t=this.options).onError)||n.call(t,e),this.processNextUpdate()}):this.processNextUpdate()}else this.processNextUpdate()}createWAVFile(e){const t=e.length,n=36+t,i=new ArrayBuffer(44+t),a=new DataView(i);a.setUint32(0,1380533830,!1),a.setUint32(4,n,!0),a.setUint32(8,1463899717,!1),a.setUint32(12,1718449184,!1),a.setUint32(16,16,!0),a.setUint16(20,1,!0),a.setUint16(22,this.channels,!0),a.setUint32(24,this.sampleRate,!0),a.setUint32(28,this.sampleRate*this.channels*this.bitsPerSample/8,!0),a.setUint16(32,this.channels*this.bitsPerSample/8,!0),a.setUint16(34,this.bitsPerSample,!0),a.setUint32(36,1684108385,!1),a.setUint32(40,t,!0);return new Uint8Array(i,44).set(e),i}play(){return P(this,null,function*(){var e,t;if(!this.audioCtxInitialized)throw new Error(" HTML Audio ");if(this._state!==Fk.PLAYING&&this.hasReceivedData)if(this.isStreamPlaying){if(this.audioElement)try{yield this.audioElement.play()}catch(n){null==(t=(e=this.options).onError)||t.call(e,n)}}else this.startStreamingPlayback()})}pause(){return P(this,null,function*(){if(!this.audioCtxInitialized)throw new Error(" HTML Audio ");this.audioElement&&this.audioElement.pause(),this.setState(Fk.PAUSED)})}stop(){return P(this,null,function*(){if(!this.audioCtxInitialized)throw new Error(" HTML Audio ");if(this.stopRequested=!0,this.isManuallyStopped=!0,this.isStreamPlaying=!1,this.clearAllTimeouts(),this.updateQueue=[],this.isUpdatingAudio=!1,this.retryCount=0,this.audioElement)try{this.audioElement.pause(),this.audioElement.currentTime=0,this.audioElement.removeEventListener("ended",()=>{}),this.audioElement.removeEventListener("canplay",()=>{}),this.audioElement.removeEventListener("play",()=>{}),this.audioElement.removeEventListener("pause",()=>{}),this.audioElement.removeEventListener("error",()=>{})}catch(e){}this.setState(Fk.STOPPED)})}reset(){return P(this,null,function*(){yield this.stop(),this.hasReceivedData=!1,this.isDataComplete=!1,this.audioChunks=[],this.isStreamPlaying=!1,this.isAudioCreated=!1,this.playedChunksCount=0,this.lastUpdateTime=0,this.isUpdatingAudio=!1,this.updateQueue=[],this.retryCount=0,this.stopRequested=!1,this.isManuallyStopped=!1,this.setState(Fk.STOPPED)})}resetPlayback(){return P(this,null,function*(){yield this.stop(),this.isStreamPlaying=!1,this.isAudioCreated=!1,this.playedChunksCount=0,this.lastUpdateTime=0,this.isUpdatingAudio=!1,this.updateQueue=[],this.retryCount=0,this.stopRequested=!1,this.isManuallyStopped=!1,this.hasReceivedData?this.setState(Fk.READY):this.setState(Fk.STOPPED)})}destroy(){if(this.stop(),this.currentBlobURL&&(URL.revokeObjectURL(this.currentBlobURL),this.currentBlobURL=null),this.audioElement){try{this.audioElement.remove()}catch(e){}this.audioElement=null}this.clearAllTimeouts(),this.audioCtxInitialized=!1,this.isStreamPlaying=!1,this.isAudioCreated=!1,this.hasReceivedData=!1,this.isDataComplete=!1,this.audioChunks=[],this.playedChunksCount=0,this.lastUpdateTime=0,this.isUpdatingAudio=!1,this.updateQueue=[],this.retryCount=0,this.stopRequested=!1,this.isManuallyStopped=!1,this.setState(Fk.STOPPED)}clearAllTimeouts(){this.pendingTimeouts.forEach(e=>{clearTimeout(e)}),this.pendingTimeouts.clear()}setAudioParams(e,t=1,n=16){this.sampleRate=e,this.channels=t,this.bitsPerSample=n}setState(e){var t,n;this._state!==e&&(this._state=e,null==(n=(t=this.options).onStateChange)||n.call(t,e))}get volume(){var e;if(!this.audioCtxInitialized)throw new Error(" HTML Audio ");return(null==(e=this.audioElement)?void 0:e.volume)||0}set volume(e){if(!this.audioCtxInitialized)throw new Error(" HTML Audio ");this.audioElement&&(this.audioElement.volume=Math.max(0,Math.min(1,e)))}get state(){return this._state}get isReady(){return this._state===Fk.READY}get isLoading(){return this._state===Fk.LOADING}get isPlaying(){return this._state===Fk.PLAYING}get isPaused(){return this._state===Fk.PAUSED}get isStopped(){return this._state===Fk.STOPPED}get hasData(){return this.hasReceivedData}get isComplete(){return this.isDataComplete}removeInitAudioEventListeners(){this.audioElement&&(this.audioElement.removeEventListener("abort",this.audioInitAbortHandler),this.audioElement.removeEventListener("canplay",this.audioInitCanplayHandler),this.audioElement.removeEventListener("play",this.audioInitPlayHandler),this.audioElement.removeEventListener("pause",this.audioInitPauseHandler),this.audioElement.removeEventListener("ended",this.audioInitEndedHandler),this.audioElement.removeEventListener("error",this.audioInitErrorHandler))}removeAudioEventListeners(){this.audioElement&&(this.audioElement.removeEventListener("canplay",this.audioCanPlayHandler),this.audioElement.removeEventListener("error",this.audioErrorHandler))}removeAllAudioEventListeners(){this.removeInitAudioEventListeners(),this.removeAudioEventListeners()}}class $k{constructor(e){k(this,"_state",Fk.STOPPED),k(this,"options"),k(this,"audioElement",null),k(this,"audioContext",null),k(this,"mediaStreamDestination",null),k(this,"bufferQueue",[]),k(this,"sourceNodes",[]),k(this,"nextSchedule",0),k(this,"sampleRate",24e3),k(this,"channels",1),k(this,"isDataComplete",!1),k(this,"_isStreamPlaying",!1),k(this,"_isStreamStopped",!1),k(this,"isUserStopped",!1),k(this,"_isComplete",!1),k(this,"_isPaused",!1),k(this,"_isLoading",!1),k(this,"_isReady",!1),k(this,"_isError",!1),k(this,"_isDestroyed",!1),k(this,"audioCanPlayHandler",()=>{var e;this.setState(Fk.READY),(null==(e=this.audioElement)?void 0:e.paused)&&!this.isUserStopped&&this.audioElement.play().catch(e=>{})}),this.options={onStateChange:e.onStateChange||(()=>{}),onError:e.onError||(()=>{})},this.initAudioContext()}initAudioContext(){var e,t;try{this.audioElement=document.createElement("audio"),this.audioElement.style.display="none",this.audioElement.preload="auto",this.audioElement.controls=!1,this.audioElement.volume=1,document.body.appendChild(this.audioElement),this.audioElement.addEventListener("canplay",this.audioCanPlayHandler),this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.mediaStreamDestination=this.audioContext.createMediaStreamDestination(),this.audioElement.srcObject=this.mediaStreamDestination.stream,this.setState(Fk.INITIALIZED)}catch(n){throw null==(t=(e=this.options).onError)||t.call(e,n),new Error("Web Audio API ")}}appendPCMBuffer(e,t=!1){if(!this.audioContext)throw new Error("Web Audio API ");this.bufferQueue.push({buffer:e,isDone:t}),t&&(this.isDataComplete=!0),this._isStreamPlaying||this.isUserStopped||this.processBufferQueue()}processBufferQueue(){if(0===this.bufferQueue.length)return void(this._isStreamPlaying=!1);const{buffer:e,isDone:t}=this.bufferQueue.shift(),n=this.createAudioBufferFromPCM(e),i=this.audioContext.createBufferSource();i.buffer=n,i.connect(this.mediaStreamDestination),this.sourceNodes.push(i);const a=this.audioContext.currentTime;0===this.nextSchedule&&(this.nextSchedule=a),i.start(this.nextSchedule),this.nextSchedule+=n.duration,i.onended=()=>{const e=this.sourceNodes.indexOf(i);-1!==e&&this.sourceNodes.splice(e,1),this.bufferQueue.length>0&&this.processBufferQueue()}}createAudioBufferFromPCM(e){const t=this.audioContext.createBuffer(1,e.length/2,this.sampleRate),n=t.getChannelData(0),i=new DataView(e.buffer);for(let a=0,o=0;a<e.length;a+=2,o++){const e=i.getInt16(a,!0);n[o]=Math.max(-1,Math.min(1,e/32768))}return t}setState(e){var t,n;this._state!==e&&(this._state=e,null==(n=(t=this.options).onStateChange)||n.call(t,e))}setAudioParams(e,t=1){this.sampleRate=e,this.channels=t}removeAllAudioEventListeners(){this.audioElement&&this.audioElement.removeEventListener("canplay",this.audioCanPlayHandler)}}class Bk{constructor(e){k(this,"_state",Fk.STOPPED),k(this,"options"),k(this,"audioElement",null),k(this,"audioPlayerInitlized",!1),k(this,"mediaSessionInitialized",!1),k(this,"mediaMetadata",{}),k(this,"audioChunks",[]),k(this,"playedChunksCount",0),k(this,"minBufferSize",30720),k(this,"currentBlobURL",null),k(this,"currentBlobChunkLength",0),k(this,"hasReceivedData",!1),k(this,"isDataComplete",!1),k(this,"isStreamPlaying",!1),k(this,"isUserStopped",!1),k(this,"isLoadingAudio",!1),k(this,"isRequestPlaying",!1),k(this,"sampleRate",24e3),k(this,"channels",1),k(this,"bitsPerSample",16),k(this,"pendingTasks",{playTaskId:null,processNextUpdateTaskId:null}),k(this,"audioInitAbortHandler",()=>{}),k(this,"audioInitCanplayHandler",()=>{this.setState(Fk.READY)}),k(this,"audioInitPlayHandler",()=>{this.setState(Fk.PLAYING)}),k(this,"audioInitPauseHandler",()=>{[Fk.PAUSED,Fk.STOPPED].includes(this.state)||this.setState(Fk.PAUSED)}),k(this,"audioInitEndedHandler",()=>{if(this.isUserStopped||this.audioChunks.length===this.playedChunksCount&&this.isDataComplete)return this.isStreamPlaying=!1,this.isUserStopped=!1,void(this.state!==Fk.STOPPED&&this.setState(Fk.STOPPED));this.isStreamPlaying&&this.audioChunks.length>this.playedChunksCount&&this.processNextUpdate()}),k(this,"audioInitErrorHandler",e=>{var t,n;null==(n=(t=this.options).onError)||n.call(t,new Error(""))}),k(this,"audioCanPlayHandler",()=>{this.removeAudioEventListeners(),this.isLoadingAudio=!1,this.playAudio()}),k(this,"audioErrorHandler",()=>{var e,t;this.removeAudioEventListeners(),this.isLoadingAudio=!1,null==(t=(e=this.options).onError)||t.call(e,new Error(""))}),this.options={onStateChange:e.onStateChange||(()=>{}),onError:e.onError||(()=>{})},this.initHTMLAudio()}initHTMLAudio(){return P(this,null,function*(){var e,t;try{this.audioElement=document.createElement("audio"),this.audioElement.style.display="none",this.audioElement.preload="auto",this.audioElement.controls=!1,this.audioElement.volume=1,document.body.appendChild(this.audioElement),this.audioElement.addEventListener("abort",this.audioInitAbortHandler),this.audioElement.addEventListener("canplay",this.audioInitCanplayHandler),this.audioElement.addEventListener("play",this.audioInitPlayHandler),this.audioElement.addEventListener("pause",this.audioInitPauseHandler),this.audioElement.addEventListener("ended",this.audioInitEndedHandler),this.audioElement.addEventListener("error",this.audioInitErrorHandler),this.audioPlayerInitlized=!0,this.setState(Fk.INITIALIZED)}catch(n){throw null==(t=(e=this.options).onError)||t.call(e,n),new Error(" HTML Audio ")}})}initMediaSession(){try{if(!("mediaSession"in navigator))return;this.setMediaMetadata({title:"QwenTTS ",artist:"QwenTTS",album:""}),navigator.mediaSession.setActionHandler("play",()=>{this.play().catch(e=>{})}),navigator.mediaSession.setActionHandler("pause",()=>{this.pause().catch(e=>{})}),navigator.mediaSession.setActionHandler("stop",()=>{this.stop().catch(e=>{})}),this.mediaSessionInitialized=!0}catch(e){}}setMediaMetadata(e){var t;if(this.mediaMetadata=_({},e),this.mediaSessionInitialized&&"mediaSession"in navigator)try{const n=(null==(t=e.artwork)?void 0:t.map(e=>({src:e.src,sizes:e.sizes||"512x512",type:e.type||"image/png"})))||[];navigator.mediaSession.metadata=new MediaMetadata({title:e.title||"QwenTTS ",artist:e.artist||"QwenTTS",album:e.album||"",artwork:n})}catch(n){}}updateMediaSessionPlaybackState(e){if(this.mediaSessionInitialized&&"mediaSession"in navigator)try{let t;switch(e){case Fk.PLAYING:t="playing";break;case Fk.PAUSED:t="paused";break;case Fk.STOPPED:case Fk.INITIALIZED:case Fk.READY:default:t="none"}navigator.mediaSession.playbackState=t}catch(t){}}appendPCMBuffer(e,t=!1){if(!e&&t&&!this.hasReceivedData)return void this.setState(Fk.STOPPED);this.hasReceivedData||(this.setState(Fk.LOADING),this.hasReceivedData=!0),e&&this.audioChunks.push(new Uint8Array(e));const n=this.audioChunks.reduce((e,t)=>e+t.length,0);this.isStreamPlaying||this.isUserStopped||(n>=this.minBufferSize||t)&&this.startStreamingPlayback(),t&&(this.isDataComplete=!0)}float32ToPCM(e){const t=new Uint8Array(2*e.length);for(let n=0;n<e.length;n++){const i=Math.max(-1,Math.min(1,e[n])),a=i<0?32768*i:32767*i,o=Math.round(a);t[2*n]=255&o,t[2*n+1]=o>>8&255}return t}startStreamingPlayback(){this.isStreamPlaying||this.isUserStopped||(this.isStreamPlaying=!0,this.updateStreamingAudio())}waitForAudioLoadAndPlay(){this.isUserStopped||(this.audioElement.readyState>=2?this.playAudio():this.isLoadingAudio||(this.isLoadingAudio=!0,this.audioElement&&(this.audioElement.addEventListener("canplay",this.audioCanPlayHandler),this.audioElement.addEventListener("error",this.audioErrorHandler),this.audioElement.load())))}updateStreamingAudio(){var e,t;if(!this.isUserStopped)if(this.audioChunks.length!==this.playedChunksCount||this.isDataComplete)if(this.isLoadingAudio||this.isRequestPlaying||!this.audioElement.paused&&!this.audioElement.ended)this.processNextUpdate();else try{const e=this.audioChunks.length,t=this.audioChunks.slice(this.playedChunksCount);if(!t.length)return void(this.isDataComplete||this.processNextUpdate());const n=t.reduce((e,t)=>e+t.length,0),i=new Uint8Array(n);let a=0;for(const r of t)i.set(r,a),a+=r.length;this.currentBlobURL&&URL.revokeObjectURL(this.currentBlobURL);const o=this.createWAVFile(i),s=new Blob([o],{type:"audio/wav"});this.currentBlobURL=URL.createObjectURL(s),this.currentBlobChunkLength=e,this.audioElement.src=this.currentBlobURL,this.waitForAudioLoadAndPlay()}catch(n){null==(t=(e=this.options).onError)||t.call(e,n),this.processNextUpdate()}else this.processNextUpdate()}processNextUpdate(){this.pendingTasks.processNextUpdateTaskId&&clearTimeout(this.pendingTasks.processNextUpdateTaskId),this.pendingTasks.processNextUpdateTaskId=setTimeout(()=>{this.updateStreamingAudio()},50)}delayToPlayAudio(){this.pendingTasks.playTaskId&&clearTimeout(this.pendingTasks.playTaskId),this.pendingTasks.playTaskId=setTimeout(()=>{this.playAudio()},50)}playAudio(){this.isUserStopped||(this.audioElement.readyState<2?this.delayToPlayAudio():this.audioElement.paused&&!this.isRequestPlaying?(this.isRequestPlaying=!0,this.audioElement.play().then(()=>{this.playedChunksCount=this.currentBlobChunkLength,this.processNextUpdate()}).catch(e=>{this.isUserStopped||("AbortError"===e.name||e.message.includes("interrupted"))&&this.delayToPlayAudio()}).finally(()=>{this.isRequestPlaying=!1})):this.processNextUpdate())}createWAVFile(e){const t=e.length,n=36+t,i=new ArrayBuffer(44+t),a=new DataView(i);a.setUint32(0,1380533830,!1),a.setUint32(4,n,!0),a.setUint32(8,1463899717,!1),a.setUint32(12,1718449184,!1),a.setUint32(16,16,!0),a.setUint16(20,1,!0),a.setUint16(22,this.channels,!0),a.setUint32(24,this.sampleRate,!0),a.setUint32(28,this.sampleRate*this.channels*this.bitsPerSample/8,!0),a.setUint16(32,this.channels*this.bitsPerSample/8,!0),a.setUint16(34,this.bitsPerSample,!0),a.setUint32(36,1684108385,!1),a.setUint32(40,t,!0);return new Uint8Array(i,44).set(e),i}play(){return P(this,null,function*(){if(!this.audioPlayerInitlized)throw new Error("HTML Audio ");this._state!==Fk.PLAYING&&this.hasReceivedData&&(this.isStreamPlaying||this.startStreamingPlayback())})}pause(){return P(this,null,function*(){if(!this.audioPlayerInitlized)throw new Error("HTML Audio ");this.audioElement&&this.audioElement.pause(),this.setState(Fk.PAUSED)})}stop(){return P(this,null,function*(){if(!this.audioPlayerInitlized)throw new Error("HTML Audio ");this.clearAllTimeouts(),this.isUserStopped=!0,this.isStreamPlaying=!1;try{yield this.audioElement.pause(),this.audioElement.currentTime=0}catch(e){}this.setState(Fk.STOPPED)})}reset(){return P(this,null,function*(){this.isStreamPlaying=!1,this.playedChunksCount=0,this.currentBlobChunkLength=0,this.isUserStopped=!1,this.isRequestPlaying=!1,this.isLoadingAudio=!1,this.setState(Fk.STOPPED)})}resetPlayback(){return P(this,null,function*(){yield this.reset()})}destroy(){return P(this,null,function*(){if(yield this.stop(),this.cleanupMediaSession(),this.currentBlobURL&&(URL.revokeObjectURL(this.currentBlobURL),this.currentBlobURL=null,this.currentBlobChunkLength=0),this.audioElement){try{this.audioElement.remove()}catch(e){}this.audioElement=null}this.setState(Fk.STOPPED)})}cleanupMediaSession(){if(this.mediaSessionInitialized&&"mediaSession"in navigator)try{navigator.mediaSession.setActionHandler("play",null),navigator.mediaSession.setActionHandler("pause",null),navigator.mediaSession.setActionHandler("stop",null),navigator.mediaSession.playbackState="none",navigator.mediaSession.metadata=null,this.mediaSessionInitialized=!1}catch(e){}}clearAllTimeouts(){this.pendingTasks.playTaskId&&(clearTimeout(this.pendingTasks.playTaskId),this.pendingTasks.playTaskId=null),this.pendingTasks.processNextUpdateTaskId&&(clearTimeout(this.pendingTasks.processNextUpdateTaskId),this.pendingTasks.processNextUpdateTaskId=null)}setAudioParams(e,t=1,n=16){this.sampleRate=e,this.channels=t,this.bitsPerSample=n}setState(e){var t,n;this._state=e,this.updateMediaSessionPlaybackState(e),null==(n=(t=this.options).onStateChange)||n.call(t,e)}get volume(){var e;if(!this.audioPlayerInitlized)throw new Error(" HTML Audio ");return(null==(e=this.audioElement)?void 0:e.volume)||0}set volume(e){if(!this.audioPlayerInitlized)throw new Error(" HTML Audio ");this.audioElement&&(this.audioElement.volume=Math.max(0,Math.min(1,e)))}get state(){return this._state}get isReady(){return this._state===Fk.READY}get isLoading(){return this._state===Fk.LOADING}get isPlaying(){return this._state===Fk.PLAYING}get isPaused(){return this._state===Fk.PAUSED}get isStopped(){return this._state===Fk.STOPPED}get hasData(){return this.hasReceivedData}get isComplete(){return this.isDataComplete}removeInitAudioEventListeners(){this.audioElement&&(this.audioElement.removeEventListener("abort",this.audioInitAbortHandler),this.audioElement.removeEventListener("canplay",this.audioInitCanplayHandler),this.audioElement.removeEventListener("play",this.audioInitPlayHandler),this.audioElement.removeEventListener("pause",this.audioInitPauseHandler),this.audioElement.removeEventListener("ended",this.audioInitEndedHandler),this.audioElement.removeEventListener("error",this.audioInitErrorHandler))}removeAudioEventListeners(){this.audioElement&&(this.audioElement.removeEventListener("canplay",this.audioCanPlayHandler),this.audioElement.removeEventListener("error",this.audioErrorHandler))}removeAllAudioEventListeners(){this.removeInitAudioEventListeners(),this.removeAudioEventListeners()}}class qk{constructor(e){k(this,"_state",Fk.STOPPED),k(this,"options"),k(this,"sampleRate",24e3),k(this,"channels",1),k(this,"bitsPerSample",16),k(this,"audioPlayer"),this.options={onStateChange:e.onStateChange||(()=>{}),onError:e.onError||(()=>{}),playerType:e.playerType||Uk.HTML_AUDIO},this.options.playerType===Uk.SIMPLE_HTML_AUDIO?this.audioPlayer=new Hk({onStateChange:e=>{var t,n;this._state=e,null==(n=(t=this.options).onStateChange)||n.call(t,e)},onError:this.options.onError}):this.options.playerType===Uk.HTML_AUDIO?this.audioPlayer=new Bk({onStateChange:e=>{var t,n;this._state=e,null==(n=(t=this.options).onStateChange)||n.call(t,e)},onError:this.options.onError}):this.options.playerType===Uk.HTML_AUDIO_CXT?this.audioPlayer=new $k({onStateChange:e=>{var t,n;this._state=e,null==(n=(t=this.options).onStateChange)||n.call(t,e)},onError:this.options.onError}):this.audioPlayer=new zk({onStateChange:e=>{var t,n;this._state=e,null==(n=(t=this.options).onStateChange)||n.call(t,e)},onError:this.options.onError}),this.audioPlayer.setAudioParams(this.sampleRate,this.channels)}appendBase64PCM(e,t=!1){const n=this.base64ToArrayBuffer(e);(n||t)&&this.audioPlayer.appendPCMBuffer(n,t)}base64ToArrayBuffer(e){if(!e)return null;try{const t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return n}catch(t){return null}}play(){return P(this,null,function*(){yield this.audioPlayer.play()})}pause(){return P(this,null,function*(){yield this.audioPlayer.pause()})}stop(){return P(this,null,function*(){yield this.audioPlayer.stop()})}reset(){return P(this,null,function*(){yield this.audioPlayer.reset()})}resetPlayback(){return P(this,null,function*(){yield this.audioPlayer.resetPlayback()})}destroy(){var e;null==(e=this.audioPlayer)||e.removeAllAudioEventListeners(),this.audioPlayer.destroy()}get volume(){return this.audioPlayer.volume}set volume(e){this.audioPlayer.volume=e}get state(){return this.audioPlayer.state}get isReady(){return this.audioPlayer.isReady}get isLoading(){return this.audioPlayer.isLoading}get isPlaying(){return this.audioPlayer.isPlaying}get isPaused(){return this.audioPlayer.isPaused}get isStopped(){return this.audioPlayer.isStopped}get hasData(){return this.audioPlayer.hasData}get isComplete(){return this.audioPlayer.isComplete}setAudioParams(e,t=1){this.sampleRate=e,this.channels=t,this.audioPlayer.setAudioParams(e,t)}}const Gk=e=>P(void 0,null,function*(){return yield Ox("/tts/voice/synthesis_text",{method:"POST",data:e})}),Vk=e=>P(void 0,null,function*(){return yield Ox("/tts/voice/clone",{method:"POST",data:e})}),Wk=e=>P(void 0,null,function*(){return yield Ox("/tts/voice/rename",{method:"POST",data:e})}),Qk=e=>P(void 0,null,function*(){return yield Ox(`/tts/voice/delete/${e.id}`,{method:"DELETE"})}),Kk=()=>P(void 0,null,function*(){return yield Ox("/tts/voice/list/detail",{method:"GET"})});class Yk{constructor(e){k(this,"player"),k(this,"options"),k(this,"audioElement"),k(this,"chatId"),k(this,"messageId"),k(this,"dataLoadFailed",!1),k(this,"isLoadingData",!1),k(this,"isStoppedByUser",!1),k(this,"isDestroyed",!1),k(this,"hasReceivedData",!1),k(this,"play",()=>P(this,null,function*(){this.dataLoadFailed?yield this.startTTSStream():yield this.player.play()})),k(this,"stop",()=>P(this,null,function*(){this.isStoppedByUser=!0,yield this.player.stop()})),this.options=e,this.initPlayer()}setStateChangeCallback(e){this.options.onStateChange=e}startTTS(e,t=!1){return P(this,null,function*(){if(this.chatId=e.chatId,this.messageId=e.messageId,this.isStoppedByUser=!1,t||!this.hasData||this.dataLoadFailed)return yield this.startTTSStream();yield this.play()})}startTTSStream(){return P(this,null,function*(){var e,t,n;if(this.isLoadingData)return;this.isLoadingData=!0,this.dataLoadFailed=!1;const i=this.getTTSRequestData();if(!i)throw this.isLoadingData=!1,new Error("chatId or messageId is required");const{success:a,data:o,isStream:s}=yield(r=i,P(void 0,null,function*(){return yield zx(),yield Ox(`/tts/completions?chat_id=${r.chat_id}`,{responseType:"stream",method:"POST",data:r})}));var r;if(!a)return this.handleDataLoadError(),void(this.isStoppedByUser||ut.open({type:"error",content:iv.t("Failed to play voice, please try again later.")}));if(!s){const i=o,a=(null==(e=null==i?void 0:i.data)?void 0:e.code)||"Unknown";let s=iv.t("Failed to play voice, please try again later."),r="error";return"RateLimited"===(null==(t=null==i?void 0:i.data)?void 0:t.code)&&(s=iv.t("Reached rate limited: too many requests per minute.")),"UnsupportedLanguage"===(null==(n=null==i?void 0:i.data)?void 0:n.code)&&(s=iv.t("Currently, only Chinese and English are supported. More languages are coming soon."),r="warning"),this.handleDataLoadError(a),void ut.open({type:r,content:s})}try{const e=yield sE(o,!1);try{for(var l,c,u,d=R(e);l=!(c=yield d.next()).done;l=!1){const e=c.value;if(this.isDestroyed)return;const{done:t,tts:n}=e;!this.hasReceivedData&&n&&(this.hasReceivedData=!0),(t||void 0!==n)&&this.player.appendBase64PCM(n,t),t&&!this.hasReceivedData&&(ut.open({type:"warning",content:iv.t("Failed to load voice, nothing can be played.")}),this.handleDataLoadError())}}catch(c){u=[c]}finally{try{l&&(c=d.return)&&(yield c.call(d))}finally{if(u)throw u[0]}}this.dataLoadFailed=!1}catch(h){this.isStoppedByUser||ut.open({type:"error",content:iv.t("Failed to load voice, please try again later.")}),yield this.player.stop(),this.handleDataLoadError()}finally{this.isLoadingData=!1}})}handleDataLoadError(e="Unknown"){return P(this,null,function*(){var t,n;this.dataLoadFailed=!0,this.isLoadingData=!1,"UnsupportedLanguage"===e&&(null==(n=null==(t=this.options)?void 0:t.onStateChange)||n.call(t,Fk.UNSUPPORTED_LANGUAGE)),setTimeout(()=>P(this,null,function*(){yield this.clearCachedData()}),1e3)})}clearCachedData(){return P(this,null,function*(){yield this.player.reset()})}destroy(){this.isDestroyed=!0,this.player.destroy(),this.player=null,this.options=null,this.dataLoadFailed=!1,this.isLoadingData=!1,this.isStoppedByUser=!1}initPlayer(){this.player=new qk({onStateChange:e=>{var t;(null==(t=this.options)?void 0:t.onStateChange)&&this.options.onStateChange(e)}})}getTTSRequestData(){return this.chatId&&this.messageId?{chat_id:this.chatId,timestamp:Math.floor(Date.now()/1e3),messages:[{id:this.messageId,role:"assistant",sub_chat_type:"tts"}]}:null}resetPlayer(){this.player&&this.player.resetPlayback()}get hasData(){var e;return(null==(e=this.player)?void 0:e.hasData)||!1}get isComplete(){var e;return(null==(e=this.player)?void 0:e.isComplete)||!1}get isDataLoadFailed(){return this.dataLoadFailed}get isDataLoading(){return this.isLoadingData}get state(){return this.player.state}get volume(){return this.player.volume}set volume(e){this.player.volume=e}}const Xk=class e{constructor(e=300){k(this,"instances",new Map),k(this,"currentPlayingKey",null),k(this,"maxInstances"),this.maxInstances=e}static getInstance(t){return e.instance||(e.instance=new e(t)),e.instance}generateKey(e,t){return`${e}:${t}`}createStateChangeCallback(e,t){return n=>{[Fk.STOPPED,Fk.PAUSED].includes(n)&&this.currentPlayingKey===e&&(this.currentPlayingKey=null),n===Fk.PLAYING&&this.currentPlayingKey!==e&&(this.currentPlayingKey=e),t&&t(n)}}getTTSInstance(e,t,n){const i=this.generateKey(e,t);if(this.instances.has(i)){const e=this.instances.get(i);return e.lastUsed=Date.now(),n&&(e.onStateChange=n,e.instance.setStateChangeCallback(this.createStateChangeCallback(i,n))),e.instance}this.cleanupLRU();const a=this.createStateChangeCallback(i,n),o=new Yk({onStateChange:a}),s=Date.now();return this.instances.set(i,{chatId:e,messageId:t,instance:o,createdAt:s,lastUsed:s,onStateChange:n}),o}startTTS(e,t,n){return P(this,null,function*(){const i=this.generateKey(e,t);if(this.currentPlayingKey===i)return;const a=this.instances.get(i);yield this.stopAllPlayer(i);const o=this.getTTSInstance(e,t,n);if(this.currentPlayingKey=i,a&&o.hasData)return yield o.resetPlayer(),void(yield o.play());const s=!a||!o.hasData;yield o.startTTS({chatId:e,messageId:t},s)})}stopAllPlayer(e){return P(this,null,function*(){const t=[];for(const[n,i]of this.instances.entries())n!==e&&t.push(i.instance.stop().catch(e=>{}));yield Promise.all(t),this.currentPlayingKey!==e&&(this.currentPlayingKey=null)})}resetAllTTS(){return P(this,null,function*(){for(const[e,t]of this.instances.entries())yield t.instance.resetPlayer()})}stopTTS(e,t){return P(this,null,function*(){const n=this.generateKey(e,t),i=this.instances.get(n);if(i)try{yield i.instance.stop(),this.currentPlayingKey===n&&(this.currentPlayingKey=null)}catch(a){}})}stopAllTTS(){return P(this,null,function*(){yield this.stopAllPlayer(""),this.currentPlayingKey=null})}destroyTTS(e,t){const n=this.generateKey(e,t),i=this.instances.get(n);if(i)try{i.instance.destroy(),this.instances.delete(n),this.currentPlayingKey===n&&(this.currentPlayingKey=null)}catch(a){}}destroyAllTTS(){for(const[t,n]of this.instances.entries())try{n.instance.destroy()}catch(e){}this.instances.clear(),this.currentPlayingKey=null}clearAllCache(){return P(this,null,function*(){yield this.stopAllTTS(),this.destroyAllTTS()})}cleanupLRU(){if(this.instances.size<this.maxInstances)return;const e=Array.from(this.instances.entries()).sort(([,e],[,t])=>e.lastUsed-t.lastUsed),t=this.instances.size-this.maxInstances+1;for(let i=0;i<t;i++){const[t,a]=e[i];if(t!==this.currentPlayingKey)try{a.instance.destroy(),this.instances.delete(t)}catch(n){}}}getCurrentPlayingInstance(){return this.currentPlayingKey&&this.instances.get(this.currentPlayingKey)||null}getAllInstances(){return Array.from(this.instances.values())}getInstanceCount(){return this.instances.size}hasInstance(e,t){const n=this.generateKey(e,t);return this.instances.has(n)}isPlaying(){return null!==this.currentPlayingKey}getMaxInstances(){return this.maxInstances}setMaxInstances(e){this.maxInstances=e,this.instances.size>this.maxInstances&&this.cleanupLRU()}forceCleanupLRU(){this.cleanupLRU()}updateInstanceStateCallback(e,t,n){const i=this.generateKey(e,t),a=this.instances.get(i);a&&(a.onStateChange=n,a.instance.setStateChangeCallback(this.createStateChangeCallback(i,n)))}};k(Xk,"instance");let Jk=Xk;function Zk(e){eE.add(VC.QWEN_EVENT_ON_DISLIKE_FEEDBACK,t=>{const{feedbackInfo:n,messageId:i}=(null==t?void 0:t.detail)||{};e.emit(qC.MESSAGE_FEEDBACK_SUBMIT,{feedbackInfo:{detail:n},messageId:i})}),eE.add(VC.QWEN_EVENT_ON_THEME_CHANGED,t=>{var n;e.adapter.setTheme(null==(n=null==t?void 0:t.detail)?void 0:n.theme)}),eE.add(VC.QWEN_EVENT_ON_LANG_CHANGED,t=>{var n;e.adapter.setLanguage(null==(n=null==t?void 0:t.detail)?void 0:n.lang)}),eE.add(VC.QWEN_EVENT_ON_INPUT_PANEL_ACTIVE,t=>{var n;const i=(null==(n=null==t?void 0:t.detail)?void 0:n.isActive)||!1;e.emit(qC.MESSAGE_INPUT_PANEL_ACTIVE,i)}),eE.add(VC.QWEN_EVENT_ON_CLEAR_ALL_CHATS,()=>{e.clearAllChat()}),eE.add(VC.QWEN_EVENT_ON_LOGOUT,()=>{null==localStorage||localStorage.removeItem("token"),null==localStorage||localStorage.removeItem("settings"),null==localStorage||localStorage.removeItem("locale"),e.adapter.invoke({method:"clearCookie"}),e.adapter.invoke({method:"deleteStoredInfo",params:{key:"chatNativeToken"}})}),eE.add(VC.QWEN_EVENT_ON_ALERTPOSITIVE_BUTTON_CLICK,()=>{e.emit(qC.MESSAGE_LEAVE_CONFIRM)}),eE.add(VC.QWEN_EVENT_ON_CHATCONFIG_CHANGE,e=>{const{actionScene:t}=(null==e?void 0:e.detail)||{},{thinking_enabled:n}=(null==t?void 0:t.featureConfig)||{},{setThinkingEnabled:i}=Zb.getState();i(null!=n&&n);const{setCurrentInputFeature:a}=Wb.getState();(null==t?void 0:t.type)&&a(null==t?void 0:t.type)}),eE.add(VC.QWEN_EVENT_ON_DEPLOY_STATUS_CHANGE,t=>{const{status:n,shareUrl:i,shareId:a,isPublic:o}=(null==t?void 0:t.detail)||{};"deployed"!==n&&TE.getState().updateEquity(),e.emit(qC.MESSAGE_ARTIFACT_DEPLOY_CHANGE,"deployed"===n?{shareId:a,shareUrl:i,isPublic:o}:void 0)}),eE.add(WC.QWEN_CHAT_ONDOWNLOADSTART,()=>{ut.open({type:"loading",content:sv("The file starts downloading.")})}),eE.add(WC.QWEN_CHAT_ONDOWNLOADCOMPLETE,e=>{const{detail:{success:t}}=e||{};t?ut.open({type:"success",content:sv("File downloaded successfully")}):ut.open({type:"error",content:sv("File download failed")})}),eE.add(VC.QWEN_EVENT_ON_USER_PROFILE_UPDATE,e=>{var t;const{user:n,setUser:i}=xE.getState();(null==(t=e.detail)?void 0:t.userName)&&i(C(_({},n||{}),{name:e.detail.userName}))}),eE.add(VC.QWEN_EVENT_ON_USER_PASSWORD_CHANGE,()=>{localStorage.token=vT("token")}),eE.add(VC.QWEN_EVENT_ON_EDIT_MESSAGE,t=>{const{inputText:n}=(null==t?void 0:t.detail)||{};e.emit(qC.MESSAGE_EDIT_SAVE,n)}),eE.add(VC.QWEN_EVENT_ON_SELECT_MODEL,t=>P(this,null,function*(){const{modelId:n}=(null==t?void 0:t.detail)||{};e.emit(QC.NAVBAR_MODEL_SELECT_CHANGE,[n])})),eE.add(VC.QWEN_EVENT_ON_OPEN_CHAT,t=>{var n,i,a,o,s,r;const l=null==(n=null==t?void 0:t.detail)?void 0:n.chatId,c=null==(i=null==t?void 0:t.detail)?void 0:i.messageId,u=(null==(a=null==t?void 0:t.detail)?void 0:a.shareId)||"",d=ET("shareId"),h=(null==(o=null==t?void 0:t.detail)?void 0:o.lang)||"",p=(null==(s=null==t?void 0:t.detail)?void 0:s.projectId)||"",{setTemporaryChatEnabled:m}=Zb.getState();if(u)cx()&&(null==(r=null==e?void 0:e.adapter)||r.invoke({method:"setSendButtonEnabled",params:{value:!1}}),window.location.href=`/?shareId=${u}&lang=${h}`);else if(sessionStorage.setItem(Kg,p),jt(l)){d||e.adapter.invoke({method:"setSendButtonEnabled",params:{value:!0}});const t=sessionStorage.getItem(vg);if(sessionStorage.removeItem(vg),location.pathname.endsWith("/new-branch")&&t)return e.adapter.setNativeStopButton(!1),void e.updateChatInfo({status:"finished"});e.openNewChat({hideToast:!0})}else 36===(null==l?void 0:l.length)?(e.adapter.invoke({method:"setSendButtonEnabled",params:{value:!0}}),m(!1),KT.navigate(`/c/${l}${c?`?messageId=${c}`:""}`)):"temporary"===l&&(e.adapter.invoke({method:"setSendButtonEnabled",params:{value:!0}}),e.updateTemporaryChat(!0),e.emit(qC.MESSAGE_OPEN_TEMPORARY,!0))}),eE.add(VC.QWEN_SEND_MESSAGE,t=>P(this,null,function*(){var n,i;const a=(e=>{const{inputText:t="",actionScene:n={},imageList:i,modelId:a,audioList:o,fileList:s,videoList:r,selectedModels:l}=e,c=(({imageList:e=[],audioList:t=[],fileList:n=[],videoList:i=[]})=>[...e.map(e=>({url:e.imageUrl,type:"image",status:"success",file_class:"vision",showType:"image"})),...t.map(e=>({url:e.audioUrl,type:"audio",status:"success",file_class:"audio",size:+e.audioSize,name:e.audioName,showType:"audio"})),...n.map(e=>({url:e.fileUrl,type:"file",status:"success",file_class:"file",size:+e.fileSize,name:e.fileName,showType:"file"})),...i.map(e=>({url:e.videoUrl,type:"video",status:"success",file_class:"video",size:+e.videoSize,name:e.videoName,showType:"video"}))])({imageList:i,audioList:o,fileList:s,videoList:r});return C(_({inputText:t},n),{files:c,selectedModels:l||(a?[a]:[])})})(t.detail);a.newChat=!0;const o=q(),{type:s,translateLanguage:r}=a;let l=a.subType;const{currentInputFeature:c,setCurrentInputFeature:u,setEmitSendPromptType:d}=Wb.getState(),{setThinkingEnabled:h,setResearchMode:p}=Zb.getState();let m=l||s||c;m===Zf.WebDev&&(m=Zf.Artifacts),m===Zf.DeepResearchWebDev&&(m=s||Zf.DeepResearch);const{featureConfig:f,ext:g,selectedModels:v}=a;p((null==f?void 0:f.research_mode)||"normal"),u(m||Zf.Txt2Txt);const{thinking_budget:y,thinking_enabled:b}=f||{};if(h(null!=b&&b),y&&(null==v?void 0:v.length)){const{updateModelConfig:e}=cT.getState();e({[v[0]]:{thinking_budget:y}})}const x=e.getCurrentChatInstance();if(null==x?void 0:x.isChat)return void ut.open({type:"warning",content:o.t("In the conversation, please wait a moment.")});if(null==g?void 0:g.size){const{setVisionSize:e}=rT.getState();e(g.size)}"translate"===l&&r?(d(Qf.TRANSLATE),m="t2t",u(Zf.Txt2Txt),a.extra=ZE(r)):(d(Qf.CHAT),m===Zf.Txt2Txt&&void 0===l&&(l=Zf.Txt2Txt),m===Zf.WebSearch&&(l=Zf.WebSearch));const w=sessionStorage.getItem(Kg)||"";w&&""!==w&&setTimeout(()=>{sessionStorage.setItem(Kg,"")},1e3),e.beforeSendMessage(C(_({},a),{chatType:m,subChatType:l,projectId:w})),e.emit(qC.MESSAGE_SENT_BEFORE,{id:null==(i=null==(n=e.getCurrentChatInstance)?void 0:n.call(e))?void 0:i.id,from:"native",data:a})})),eE.add(VC.QWEN_EVENT_ON_CLICK_STOP_BUTTON,()=>{const t=e.getCurrentChatInstance();null==t||t.stopResponse()}),eE.add(VC.QWEN_EVENT_ON_PAGE_PAUSE,()=>{Jk.getInstance().stopAllPlayer()}),eE.add(VC.QWEN_EVENT_ON_PAGE_RESUME,()=>{}),eE.add(VC.QWEN_EVENT_ON_TSS_SPEAKER_CHANGE,()=>{Jk.getInstance().clearAllCache()}),eE.add(VC.QWEN_EVENT_ON_PROMPT_SETTINGS_UPDATE,e=>P(this,null,function*(){if(e.detail){const{settings:t}=cT.getState();cT.setState({settings:C(_({},t),{personalization:C(_({},t.personalization),{name:e.detail.userName,enable_for_new_chat:e.detail.enable})})})}})),eE.add(VC.QWEN_EVENT_ON_AUDIO_FOCUS_CHANGE,e=>{const{status:t}=(null==e?void 0:e.detail)||{};"loss"===t&&Jk.getInstance().stopAllPlayer()}),eE.add(VC.QWEN_EVENT_ON_POST_CONTENT_TO_MAIN_CHAT,t=>{const{name:n,content:i}=(null==t?void 0:t.detail)||{};if(n===Zf.DeepResearchWebDev)e.beforeSendMessage({inputText:i,chatType:Zf.DeepResearch,subChatType:Zf.DeepResearchWebDev})}),eE.add(VC.QWEN_EVENT_ON_SEND_PODCAST,t=>P(this,null,function*(){var n;const i=null==(n=null==t?void 0:t.detail)?void 0:n.content;if(!i)return;e.closeShowControls();const{updateQwenChatSettingsbyNative:a}=cT.getState();a({aipodcast:i}),e.beforeSendMessage({inputText:sv("Generate a podcast"),chatType:Zf.DeepResearch,subChatType:Zf.Podcast})})),eE.add(VC.QWEN_EVENT_ON_PLAYBACK_STATE_CHANGED,t=>{const n=(null==t?void 0:t.detail)||{};e.emit(QC.MESSAGE_AUDIO_PLAYBACK_CHANGED,n)}),eE.add(VC.QWEN_EVENT_ON_MEDIA_RATE_CHANGED,t=>{const{rate:n,id:i}=(null==t?void 0:t.detail)||{};e.emit(QC.MESSAGE_AUDIO_PLAYBACK_RATE_CHANGED,{rate:n,id:i})})}const eI=(e,t)=>{const n=t.map(e=>e.id);return e.filter(e=>n.includes(e))},tI=(e,t)=>t.filter(t=>e.includes(t.id)),nI=e=>e.map(e=>e.id),iI={models:[],isLoading:!1,selectedModels:[],selectedModelIds:[],visibleModels:[]},aI=Wy()(Bb((e,t)=>C(_({},iI),{setModels:t=>e({models:t}),setIsLoading:t=>e({isLoading:t}),setSelectedModels:n=>{const i=t(),a=n.filter(e=>i.models.some(t=>t.id===(null==e?void 0:e.id)));e({selectedModels:a,selectedModelIds:nI(a)})},setSelectedModelIds:n=>{const i=t(),a=eI(n,i.models);e({selectedModelIds:a,selectedModels:tI(a,i.models)})},setVisibleModels:t=>e({visibleModels:t}),fetchModels:(n=!1)=>P(void 0,null,function*(){var i;const a=t();if(a.models.length>0&&!n)return a.models;if(a.isLoading)return new Promise(e=>{const n=()=>{const i=t();i.isLoading?setTimeout(n,100):e(i.models)};n()});e({isLoading:!0});const o=yield P(void 0,null,function*(){return yield Ox("/models",{baseURL:"/api"})});if(o.success&&o.data){const n=(null==(i=o.data)?void 0:i.data)||[];e({models:n,isLoading:!1});const a=t();if(a.selectedModelIds&&a.selectedModelIds.length>0){const t=eI(a.selectedModelIds,n);t.length!==a.selectedModelIds.length&&e({selectedModelIds:t,selectedModels:tI(t,n)})}return n}return AC.open({type:"error",content:o.data.message}),[]}),getModels:()=>{const e=t();return 0!==e.models.length||e.isLoading?e.models:e.fetchModels()}}),{name:"modelsStore",store:"modelsStore",enabled:!1})),oI=(e,t)=>{if(!e||0===e.length)return[];const n=e.map(e=>{const n=t.find(t=>t.id===e);if(n)return n.id;const i=t.find(t=>t.name===e);return i?i.id:null}).filter(e=>null!==e);return xx()||bT()?n.slice(0,1):n.slice(0,3)},sI=(e,t)=>{try{const n=t||window.location.href;return new URL(n).searchParams.get(e)}catch(n){return null}},rI=e=>{switch(e){case tg.Artifacts:return"chatNativeArtifact";case tg.WebSearch:return"chatNativeSource";case tg.Thinking:case tg.ThinkingAndSearch:return"chatNativeSearchContent";case tg.DeepResearchLinkSource:case tg.DeepResearch:return"chatNativeDeepResearch";case tg.PdfViewer:return"chatNativePdfViewer";case tg.Feedback:return"chatNativeFeedback";case"chatNativeToken":return"chatNativeToken";case"transTargetLanguageKey":return"transTargetLanguageKey";case tg.ImageReason:return"chatNativeImageReason";default:return"chatNativeHistory"}},lI=e=>{const t=`${location.origin}/mobile/chatcontrols`;switch(e){case tg.Artifacts:return`${t}/artifacts`;case tg.WebSearch:return`${t}/search`;case tg.DeepResearchLinkSource:case tg.DeepResearch:return`${t}/deep_research`;case tg.PdfViewer:return`${t}/pdf_viewer`;case tg.Feedback:return`${t}/feedback`;default:return`${t}/${e}`}};var cI,uI,dI=(e=>(e.startSpeech="startSpeech",e.onAfterStart="onAfterStart",e.onBeforeEnd="onBeforeEnd",e.onBeforeStart="onBeforeStart",e.onAfterEnd="onAfterEnd",e.onConnectionStatusChange="onConnectionStatusChange",e.onOccurError="onOccurError",e.onDataChannelMsg="onDataChannelMsg",e.onUserStop="onUserStop",e.onInitialize="onInitialize",e.onConfigure="onConfigure",e.onAudioSubscribeStateChanged="onAudioSubscribeStateChanged",e.startTiming="startTiming",e.timePassed="timePassed",e.timeUp="timeUp",e.statusChange="statusChange",e.isRunningChange="isRunningChange",e.detectedSoundChange="detectedSoundChange",e.todayRemainingTimesChange="todayRemainingTimesChange",e.reset="reset",e.startCameraPreview="startCameraPreview",e.stopCameraPreview="stopCameraPreview",e.defaultEnabledVideo="defaultEnabledVideo",e.noCameraPermission="noCameraPermission",e.detectMicList="detectMicList",e.userVolumeChange="userVolumeChange",e.channelVolumeChange="channelVolumeChange",e.sendMessage="sendMessage",e.debugger="debugger",e.supportResult="supportResult",e.joinChannelTimeOut="joinChannelTimeOut",e.localDeviceException="localDeviceException",e))(dI||{});class hI{constructor(e){k(this,"context"),k(this,"onReport",null),this.context=e}init(e){this.onReport=e}getSearchToken(){const{model:e}=this.context,{localId:t,aliRtcAuthInfo:n}=e;let i=`localId=${t}`;return n&&"appId channelId userId nonce timestamp token sessionId role".split(" ").forEach(e=>{var t;const a=null!=(t=n[e])?t:"";i=`${i}&${e}=${a}`}),i}report(e,t={}){try{if(!this.onReport)return;const n={type:e,searchToken:this.getSearchToken(),params:t};this.onReport(n)}catch(n){}}}class pI{constructor(){k(this,"_isDefaultPrevented",!1),k(this,"_isStopped",!1)}get isDefaultPrevented(){return this._isDefaultPrevented}get isStopped(){return this._isStopped}preventDefault(){this._isDefaultPrevented=!0}stop(){this._isStopped=!0}}class mI{constructor(){k(this,"listeners",{})}on(e,t){const n=this.listeners[e]||[];return n.push(t),this.listeners[e]=n,()=>this.off(e,t)}pipe(e,t=!0){const{listeners:n}=this;Object.keys(n).forEach(t=>{(n[t]||[]).forEach(n=>e(t,n))}),t&&(this.listeners={})}off(e,t){const n=this.listeners[e]||[];this.listeners[e]=t?n.filter(e=>e!==t):[]}offAll(){Object.keys(this.listeners).forEach(e=>{this.listeners[e]=[]})}emit(e,t){const n=new pI,i=this.listeners[e]||[];for(const a of i)if(a(t,n),n.isStopped)break;return n}emitAsync(e,t){var n;n=()=>this.emit(e,t),"object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(n):"function"==typeof setTimeout?setTimeout(n,1):n()}}function fI(e){return Symbol(e)}class gI{constructor(e){var t;k(this,"context"),k(this,"states"),k(this,"eventer",new mI),this.context=e,this.isEnable&&(null==(t=this.onInitialize)||t.call(this))}get isEnable(){return!0}setStates(e){this.states&&(Object.assign(this.states,e),this.eventer.emit("stateChange",{states:this.states}))}getState(e){if(!this.states)throw new Error("Not provide state in your command");return this.states[e]}getStates(){return this.states}}class vI extends gI{constructor(){super(...arguments),k(this,"beforeUserVolume",0),k(this,"beforeChannelVolume",0),k(this,"handleAudioVolume",e=>{const{model:t}=this.context;e.forEach(e=>{const{userId:n,volume:i}=e;""===n?(t.setUserVolume(i),(this.beforeUserVolume>0&&0===i||0===this.beforeUserVolume&&i>this.beforeUserVolume)&&this.context.reporter.report(dI.userVolumeChange,{userVolume:i}),this.beforeUserVolume=i):(t.setChannelVolume(i),(this.beforeChannelVolume>0&&0===i||0===this.beforeChannelVolume&&i>this.beforeChannelVolume)&&this.context.reporter.report(dI.channelVolumeChange,{channelVolume:i}),this.beforeChannelVolume=i)})})}onAfterStart(){return P(this,null,function*(){const{aliRtcEngine:e}=this.context;e.on("audioVolume",this.handleAudioVolume),e.enableAudioVolumeIndication(100)})}onBeforeEnd(){return P(this,null,function*(){const{aliRtcEngine:e}=this.context;e.off("audioVolume",this.handleAudioVolume),e.enableAudioVolumeIndication(0)})}}"function"==typeof SuppressedError&&SuppressedError,(uI=cI||(cI={}))[uI.ERROR=0]="ERROR",uI[uI.WARN=1]="WARN",uI[uI.INFO=2]="INFO",uI[uI.LOG=3]="LOG",uI[uI.DEBUG=4]="DEBUG",cI.WARN;class yI extends gI{onBeforeEnd(){return P(this,null,function*(){this.context.reporter.report(dI.onBeforeEnd)})}onAfterEnd(){return P(this,null,function*(){this.context.reporter.report(dI.onAfterEnd)})}onBeforeStart(){return P(this,null,function*(){this.context.reporter.report(dI.onBeforeStart)})}onAfterStart(){return P(this,null,function*(){this.context.reporter.report(dI.onAfterStart)})}onConnectionStatusChange(e){return P(this,null,function*(){this.context.reporter.report(dI.onConnectionStatusChange,e)})}onOccurError(e){return P(this,null,function*(){this.context.reporter.report(dI.onOccurError,e)})}onDataChannelMsg(e){return P(this,null,function*(){this.context.reporter.report(dI.onDataChannelMsg,e)})}onUserStop(){return P(this,null,function*(){this.context.reporter.report(dI.onUserStop)})}onInitialize(){return P(this,null,function*(){this.context.reporter.report(dI.onInitialize)})}onConfigure(){return P(this,null,function*(){this.context.reporter.report(dI.onConfigure)})}onAudioSubscribeStateChanged(e){return P(this,null,function*(){this.context.reporter.report(dI.onConfigure,e)})}}function bI(e,t){const{aliRtcEngine:n,reporter:i}=e;i.report(dI.sendMessage,t);let a="";try{a=JSON.stringify(t)}catch(qY){}if(!a)return;const o=(new TextEncoder).encode(a).buffer,s=new zt(o,Ht.AliEngineDataMsgCustom);n.sendDataChannelMessage(s)}function xI(e){return{width:e.height,height:e.width}}function wI(e,t){return{displayResolution:{width:e[0],height:e[1]},webrtcResolution:{width:t[0],height:t[1]}}}function SI(){let e=null;return()=>e||(e=function(){if(ox()){const e=[screen.height,screen.width];return wI(e,e)}return wI([960,540],[1280,720])}())}function _I(e=200,t){return new Promise(n=>{setTimeout(()=>P(this,null,function*(){t&&(yield t()),n()}),e)})}function CI(e=200,t){return new Promise((n,i)=>{setTimeout(()=>P(this,null,function*(){i(t)}),e)})}class EI extends gI{constructor(){super(...arguments),k(this,"states",{requestId:null,dialogId:null,isStarted:!1}),k(this,"resolveStop",null)}onDataChannelMsg(e){return P(this,null,function*(){const{json:t}=e;if(!t)return;const{name:n}=t.header||{};"Started"!==n?"RespondingEnded"===n?this.handleRespondingEnded():"Stopped"===n&&this.handleStopped():this.handleStarted(t)})}handleStarted(e){const{header:t}=e,n={requestId:t.request_id,dialogId:t.dialog_id,isStarted:!0};bI(this.context,{header:{namespace:"VoiceChat",name:"StartedReceived",request_id:n.requestId,dialog_id:n.dialogId},payload:{}}),this.setStates(n)}handleRespondingEnded(){const e=this.getStates();e&&e.dialogId&&bI(this.context,{header:{namespace:"VoiceChat",name:"LocalRespondingEnded",request_id:e.requestId,dialog_id:e.dialogId},payload:{}})}handleStopped(){var e;null==(e=this.resolveStop)||e.call(this),this.resolveStop=null}onBeforeEnd(){return P(this,null,function*(){const e=this.getStates();e&&e.dialogId&&(bI(this.context,{header:{namespace:"VoiceChat",name:"Stop",request_id:e.requestId,dialog_id:e.dialogId},payload:{}}),yield Promise.race([new Promise(e=>{this.resolveStop=e}),_I(300)]))})}}class kI extends gI{constructor(){super(...arguments),k(this,"isMicOpenFailed",!1),k(this,"timeoutToEnd",null)}onBeforeStart(){return P(this,null,function*(){this.context.model.setStatus(Lg.Connecting)})}onAfterStart(){return P(this,null,function*(){const{model:e}=this.context;e.error||e.setStatus(Lg.Listening)})}onOccurError(e){return P(this,null,function*(){const{error:t}=e;switch(t.code){case $t.ERR_MIC_OPEN_FAIL:this.isMicOpenFailed=!0,this.context.model.setError({type:Fg.NoMicphonePermission});break;case $t.ERR_SDK_PUBLISH_AUDIO_STREAM_FAILED:this.isMicOpenFailed||this.context.model.setError({type:Fg.UnknownError});break;default:this.context.model.setError({type:Fg.UnknownError})}})}onUserStop(){return P(this,null,function*(){this.context.model.setStatus(Lg.Default)})}onDataChannelMsg(e){return P(this,null,function*(){const{controller:t,model:n}=this.context,{json:i}=e;if(i)try{const{name:e}=i.header||{};if("RespondingEnded"===e)return void n.setStatus(Lg.Listening);if("Error"===e){const{error_code:e}=i.payload||{};switch(e){case 40020003:case 40020002:case 40020001:n.setError({type:Fg.DataInputInspectionFailed});break;case 40042901:n.setError({type:Fg.CurrentConversationTimeout});break;case 40042902:n.setError({type:Fg.DailyConversationTimeout});break;default:n.setError({type:Fg.InternalServerError})}return void t.onEnd()}if("DialogStateChanged"===e){const{state:e}=i.payload||{};switch(e){case"Responding":n.setStatus(Lg.Speaking);break;case"Listening":n.setStatus(Lg.Listening);break;case"Thinking":n.setStatus(Lg.Thinking)}return}}catch(a){}})}onConnectionStatusChange(e){return P(this,null,function*(){const{status:t}=e,{controller:n,model:i}=this.context;switch(t){case Bt.AliRtcConnectionStatusConnecting:case Bt.AliRtcConnectionStatusReconnecting:i.setStatus(Lg.Connecting),this.reconnectingTimerStart();break;case Bt.AliRtcConnectionStatusConnected:this.clearTimeOut(),i.setStatus(Lg.Listening);break;case Bt.AliRtcConnectionStatusDisconnected:case Bt.AliRtcConnectionStatusFailed:this.clearTimeOut(),i.setError({type:Fg.ConnectionLost}),n.onEnd()}})}reconnectingTimerStart(){this.timeoutToEnd||(this.timeoutToEnd=setTimeout(()=>{this.context.model.isEnding||(this.context.model.setError({type:Fg.ConnectionLost}),this.context.controller.onEnd(),this.clearTimeOut())},1e4))}clearTimeOut(){this.timeoutToEnd&&(clearTimeout(this.timeoutToEnd),this.timeoutToEnd=null)}}var II={exports:{}};II.exports=function(){var e,t,n=1e3,i=6e4,a=36e5,o=864e5,s=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,r=31536e6,l=2628e6,c=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,u={years:r,months:l,days:o,hours:a,minutes:i,seconds:n,milliseconds:1,weeks:6048e5},d=function(e){return e instanceof y},h=function(e,t,n){return new y(e,n,t.$l)},p=function(e){return t.p(e)+"s"},m=function(e){return e<0},f=function(e){return m(e)?Math.ceil(e):Math.floor(e)},g=function(e){return Math.abs(e)},v=function(e,t){return e?m(e)?{negative:!0,format:""+g(e)+t}:{negative:!1,format:""+e+t}:{negative:!1,format:""}},y=function(){function m(e,t,n){var i=this;if(this.$d={},this.$l=n,void 0===e&&(this.$ms=0,this.parseFromMilliseconds()),t)return h(e*u[p(t)],this);if("number"==typeof e)return this.$ms=e,this.parseFromMilliseconds(),this;if("object"==typeof e)return Object.keys(e).forEach(function(t){i.$d[p(t)]=e[t]}),this.calMilliseconds(),this;if("string"==typeof e){var a=e.match(c);if(a){var o=a.slice(2).map(function(e){return null!=e?Number(e):0});return this.$d.years=o[0],this.$d.months=o[1],this.$d.weeks=o[2],this.$d.days=o[3],this.$d.hours=o[4],this.$d.minutes=o[5],this.$d.seconds=o[6],this.calMilliseconds(),this}}return this}var g=m.prototype;return g.calMilliseconds=function(){var e=this;this.$ms=Object.keys(this.$d).reduce(function(t,n){return t+(e.$d[n]||0)*u[n]},0)},g.parseFromMilliseconds=function(){var e=this.$ms;this.$d.years=f(e/r),e%=r,this.$d.months=f(e/l),e%=l,this.$d.days=f(e/o),e%=o,this.$d.hours=f(e/a),e%=a,this.$d.minutes=f(e/i),e%=i,this.$d.seconds=f(e/n),e%=n,this.$d.milliseconds=e},g.toISOString=function(){var e=v(this.$d.years,"Y"),t=v(this.$d.months,"M"),n=+this.$d.days||0;this.$d.weeks&&(n+=7*this.$d.weeks);var i=v(n,"D"),a=v(this.$d.hours,"H"),o=v(this.$d.minutes,"M"),s=this.$d.seconds||0;this.$d.milliseconds&&(s+=this.$d.milliseconds/1e3,s=Math.round(1e3*s)/1e3);var r=v(s,"S"),l=e.negative||t.negative||i.negative||a.negative||o.negative||r.negative,c=a.format||o.format||r.format?"T":"",u=(l?"-":"")+"P"+e.format+t.format+i.format+c+a.format+o.format+r.format;return"P"===u||"-P"===u?"P0D":u},g.toJSON=function(){return this.toISOString()},g.format=function(e){var n=e||"YYYY-MM-DDTHH:mm:ss",i={Y:this.$d.years,YY:t.s(this.$d.years,2,"0"),YYYY:t.s(this.$d.years,4,"0"),M:this.$d.months,MM:t.s(this.$d.months,2,"0"),D:this.$d.days,DD:t.s(this.$d.days,2,"0"),H:this.$d.hours,HH:t.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:t.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:t.s(this.$d.seconds,2,"0"),SSS:t.s(this.$d.milliseconds,3,"0")};return n.replace(s,function(e,t){return t||String(i[e])})},g.as=function(e){return this.$ms/u[p(e)]},g.get=function(e){var t=this.$ms,n=p(e);return"milliseconds"===n?t%=1e3:t="weeks"===n?f(t/u[n]):this.$d[n],t||0},g.add=function(e,t,n){var i;return i=t?e*u[p(t)]:d(e)?e.$ms:h(e,this).$ms,h(this.$ms+i*(n?-1:1),this)},g.subtract=function(e,t){return this.add(e,t,!0)},g.locale=function(e){var t=this.clone();return t.$l=e,t},g.clone=function(){return h(this.$ms,this)},g.humanize=function(t){return e().add(this.$ms,"ms").locale(this.$l).fromNow(!t)},g.valueOf=function(){return this.asMilliseconds()},g.milliseconds=function(){return this.get("milliseconds")},g.asMilliseconds=function(){return this.as("milliseconds")},g.seconds=function(){return this.get("seconds")},g.asSeconds=function(){return this.as("seconds")},g.minutes=function(){return this.get("minutes")},g.asMinutes=function(){return this.as("minutes")},g.hours=function(){return this.get("hours")},g.asHours=function(){return this.as("hours")},g.days=function(){return this.get("days")},g.asDays=function(){return this.as("days")},g.weeks=function(){return this.get("weeks")},g.asWeeks=function(){return this.as("weeks")},g.months=function(){return this.get("months")},g.asMonths=function(){return this.as("months")},g.years=function(){return this.get("years")},g.asYears=function(){return this.as("years")},m}(),b=function(e,t,n){return e.add(t.years()*n,"y").add(t.months()*n,"M").add(t.days()*n,"d").add(t.hours()*n,"h").add(t.minutes()*n,"m").add(t.seconds()*n,"s").add(t.milliseconds()*n,"ms")};return function(n,i,a){e=a,t=a().$utils(),a.duration=function(e,t){var n=a.locale();return h(e,{$l:n},t)},a.isDuration=d;var o=i.prototype.add,s=i.prototype.subtract;i.prototype.add=function(e,t){return d(e)?b(this,e,1):o.bind(this)(e,t)},i.prototype.subtract=function(e,t){return d(e)?b(this,e,-1):s.bind(this)(e,t)}}}();const TI=B(II.exports);function jI(e){return Y.duration(e).format("mm:ss")}Y.extend(TI);class NI extends gI{constructor(e,t={}){super(e),k(this,"states",{duringTime:0}),k(this,"interval",null),k(this,"options"),k(this,"maxTime",0),this.options=t}getDisplayDuringTime(){return jI(this.getState("duringTime"))}getDisplayMaxTime(){return jI(this.maxTime)}getDisplayTime(){return`${this.getDisplayDuringTime()} / ${this.getDisplayMaxTime()}`}clean(){this.interval&&(clearInterval(this.interval),this.interval=null)}handleTimeUp(){const{controller:e}=this.context;this.context.reporter.report(dI.timeUp),this.clean(),e.onEnd()}onConfigure(){return P(this,null,function*(){const{chatType:e}=this.options,{timeConfig:t}=this.context.controller;this.maxTime=t?1e3*(t[e||"voice"]||180):18e4})}onAfterStart(){return P(this,null,function*(){this.clean();const e=Date.now();this.context.reporter.report(dI.startTiming),this.interval=setInterval(()=>{var t,n;const i=Date.now(),a=Math.min(i-e,this.maxTime),o=1e3*Math.floor(1.023);this.setStates({duringTime:a}),null==(n=(t=this.options).onTimeChange)||n.call(t,{soon:a>=this.maxTime-1e4,duringTime:a,maxTime:this.maxTime,displayTime:this.getDisplayTime()}),o%1e4==0&&this.context.reporter.report(dI.timePassed,{ms:o}),a>=this.maxTime&&this.handleTimeUp()},500)})}onBeforeEnd(){return P(this,null,function*(){this.clean()})}}class PI{constructor(e){this.options=e}}class MI extends PI{constructor(){super(...arguments),k(this,"interval",null),k(this,"protectTimes",null),k(this,"isAvailable",!0)}detect(){if(this.isProtected())return;const{videoElement:e,onDetectUnavailable:t,onDetectAvailable:n}=this.options,i=document.createElement("canvas"),{width:a,height:o}={width:4,height:4};i.width=a,i.height=o;const s=i.getContext("2d");if(!s)return;s.drawImage(e,0,0,a,o);const r=function(e){return 0===e.data.filter((e,t)=>t%4<3&&e>0).length}(s.getImageData(0,0,a,o));r?this.isAvailable&&(this.isAvailable=!1,t()):this.isAvailable||(this.isAvailable=!0,n())}isProtected(){return this.protectTimes&&this.protectTimes>Date.now()}start(){this.stop(),this.protectTimes=Date.now()+4e3,this.interval=setInterval(()=>{this.detect()},1e3)}pause(){this.stop()}resume(){this.start()}stop(){this.interval&&(clearInterval(this.interval),this.interval=null),this.protectTimes=null,this.isAvailable=!0}}class AI{constructor(){k(this,"funcs",[]),k(this,"isPretreated",!1)}addPretreat(e){this.isPretreated,this.funcs.push(e)}pretreat(){return P(this,null,function*(){try{if(0===this.funcs.length||this.isPretreated)return;const e=this.funcs;return this.funcs=[],Promise.all(e.map(e=>{return(t=e())instanceof Promise?t:null;var t}))}catch(e){}finally{this.isPretreated=!0}})}}var RI=(e=>(e[e.CAMERA_INVALID=-1]="CAMERA_INVALID",e[e.CAMERA_REAR=0]="CAMERA_REAR",e[e.CAMERA_FRONT=1]="CAMERA_FRONT",e))(RI||{});const OI=ox()?0:1,DI=!1,LI=SI(),FI=()=>{};const UI=class e extends gI{constructor(t,n={}){if(super(t),k(this,"beforeEnablePretreat",new AI),k(this,"cameraWorkDetector",null),k(this,"states",{isEnabledVideo:DI,hasCameraPermission:null,cameraDirection:OI}),k(this,"cameraInfo",null),k(this,"defaultEnabledDualVideoStream",false),k(this,"capturedStream",null),k(this,"options"),k(this,"delegation",new HI(this)),k(this,"cameraIsClose",!1),k(this,"commands",{[e.UseFrontCamera]:{run:()=>{if(1===this.getState("cameraDirection"))return;const{controller:t}=this.context;t.runCommand(e.ToggleCameraDirection)}},[e.UseRearCamera]:{run:()=>{if(0===this.getState("cameraDirection"))return;const{controller:t}=this.context;t.runCommand(e.ToggleCameraDirection)}},[e.ToggleCameraDirection]:{run:()=>P(this,null,function*(){var e,t;null==(e=this.cameraWorkDetector)||e.pause();const n=0===(i=this.getState("cameraDirection"))?1:1===i?0:i;var i;this.setStates({cameraDirection:n});const{aliRtcEngine:a}=this.context;yield a.switchCamera(),yield this.startCameraPreview(),null==(t=this.cameraWorkDetector)||t.resume()})},[e.EnableVideo]:{run:()=>P(this,null,function*(){var e;const{aliRtcEngine:t}=this.context;let n=!0;try{yield this.beforeEnablePretreat.pretreat(),yield t.enableLocalVideo(!0),yield this.startCameraPreview(),null==(e=this.cameraWorkDetector)||e.start(),this.setStates({isEnabledVideo:!0})}catch(i){n=!1}n||this.onNoCameraPermission()})},[e.DisableVideo]:{run:()=>P(this,null,function*(){var e;const{aliRtcEngine:t}=this.context;yield t.enableLocalVideo(!1),yield this.stopCameraPreview(),null==(e=this.cameraWorkDetector)||e.stop(),this.setStates({isEnabledVideo:!1})})},[e.ToggleVideo]:{run:()=>{const{controller:t}=this.context;this.getState("isEnabledVideo")?t.runCommand(e.DisableVideo):t.runCommand(e.EnableVideo)}}}),this.options=function(e){const t={videoElement:null,defaultEnabledVideo:DI,autoOpenCamera:!1,isEnableDetector:!1,onDetectCameraUnavailable:FI,onDetectCameraAvailable:FI};return Object.keys(e).forEach(n=>{const i=(e||{})[n];void 0!==i&&(t[n]=i)}),t}(n),this.states.isEnabledVideo=this.options.defaultEnabledVideo,!this.options.videoElement)throw new Error("videoElement must be provide");this.options.isEnableDetector&&(this.cameraWorkDetector=function(e){const t=E(e,[]);return new MI(t)}({videoElement:this.options.videoElement,onDetectUnavailable:this.options.onDetectCameraUnavailable,onDetectAvailable:this.options.onDetectCameraAvailable}))}startCameraPreview(){return P(this,null,function*(){if(this.delegation.enabled)return yield this.delegation.startCameraPreview();const{videoElement:e}=this.options,{aliRtcEngine:t}=this.context;if(!e)return;const n=yield t.getVideoTrack({streamType:qt.AliRtcSdkStreamTypeCapture});if(!n)return;const i=e.srcObject||new MediaStream;e.srcObject=i;const a=i.getVideoTracks();a.find(e=>e.id===n.id)||(a.forEach(e=>{i.removeTrack(e)}),i.addTrack(n)),e.play(),this.context.reporter.report(dI.startCameraPreview)})}stopCameraPreview(){return P(this,null,function*(){var e;if(this.delegation.enabled)return yield this.delegation.stopCameraPreview();null==(e=this.options.videoElement)||e.pause(),this.context.reporter.report(dI.stopCameraPreview)})}onBeforeStart(){return P(this,null,function*(){this.cameraIsClose=!1})}onConfigure(){return P(this,null,function*(){var e,t;if(this.context.reporter.report(dI.defaultEnabledVideo,{defaultEnabledVideo:this.options.defaultEnabledVideo}),this.options.autoOpenCamera){const e=yield P(void 0,null,function*(){try{return navigator.permissions&&navigator.permissions.query?(yield navigator.permissions.query({name:"camera"})).state:"not-supported"}catch(e){return"not-supported"}});if(["denied"].includes(e))throw this.onNoCameraPermission(),new Ug({type:Fg.UnknownError});if(["prompt","not-supported"].includes(e)){const e=this.getState("cameraDirection"),t=yield(e=>P(void 0,null,function*(){const t=SI(),{displayResolution:n}=t();try{const t=e===RI.CAMERA_REAR?{exact:"environment"}:"user",{width:i,height:a}=ox()?xI(n):n;return(yield navigator.mediaDevices.getUserMedia({audio:!1,video:{width:{ideal:i},height:{ideal:a},facingMode:t}})).getTracks().forEach(e=>{e.stop()}),!0}catch(i){return!1}}))(e);if(!t)throw this.onNoCameraPermission(),new Ug({type:Fg.UnknownError})}}const{webrtcResolution:n}=LI(),{aliRtcEngine:i,aliRtcEngineConfigKeeper:a}=this.context;let o=!0;try{a.setAudioOnlyMode(!1),yield i.setCameraCapturerConfiguration({width:n.width,height:n.height,frameRate:30,bitrate:12e3,cameraDirection:this.getState("cameraDirection"),maxSendFrameRate:4}),this.defaultEnabledDualVideoStream&&Gt.isDualVideoStreamSupported()&&(i.setEnableDualVideoStream(!0,{width:n.width,height:n.height,frameRate:4}),i.setRemoteDefaultVideoStreamType(Vt.AliRtcVideoStreamTypeLow))}catch(s){o=!1}if(!this.options.defaultEnabledVideo)return this.setStates({isEnabledVideo:!1,hasCameraPermission:o}),void(yield i.enableLocalVideo(!1));yield this.beforeEnablePretreat.pretreat(),yield this.startCameraPreview(),null==(e=this.cameraWorkDetector)||e.start(),o||(null==(t=this.options.onNoCameraPermission)||t.call(this),this.context.reporter.report(dI.noCameraPermission)),this.setStates({isEnabledVideo:o,hasCameraPermission:o})})}onNoCameraPermission(){var e,t;null==(t=(e=this.options).onNoCameraPermission)||t.call(e),this.context.controller.onEnd()}onAfterStart(){return P(this,null,function*(){this.context.controller.isStopWhenPreparing||this.cameraIsClose||this.options.autoOpenCamera&&this.context.controller.runCommand(e.ToggleVideo)})}onBeforeEnd(){return P(this,null,function*(){var e;this.cameraIsClose=!0,this.stopCameraPreview(),null==(e=this.cameraWorkDetector)||e.stop()})}};k(UI,"UseFrontCamera",fI("UseFrontCamera")),k(UI,"UseRearCamera",fI("UseRearCamera")),k(UI,"ToggleCameraDirection",fI("ToggleCameraDirection")),k(UI,"EnableVideo",fI("EnableVideo")),k(UI,"DisableVideo",fI("DisableVideo")),k(UI,"ToggleVideo",fI("ToggleVideo"));let zI=UI;class HI{constructor(e){k(this,"command"),k(this,"capturedStream",null),this.command=e}get enabled(){return!1}startCameraPreview(){return P(this,null,function*(){yield this.stopCameraPreview();const{displayResolution:e}=LI();try{const t=0===this.command.getState("cameraDirection")?{exact:"environment"}:"user",{width:n,height:i}=ox()?xI(e):e,a=yield navigator.mediaDevices.getUserMedia({audio:!1,video:{width:{ideal:n},height:{ideal:i},facingMode:t}}),{videoElement:o}=this.command.options;return o&&(this.capturedStream=a,o.srcObject=a,o.play()),!0}catch(t){return!1}})}stopCameraPreview(){var e;this.capturedStream&&(this.capturedStream.getTracks().forEach(e=>{e.stop()}),this.capturedStream=null,null==(e=this.command.options.videoElement)||e.pause())}}class $I{constructor(e){k(this,"context"),k(this,"isSettedAudioOnlyMode",!1),this.context=e}setAudioOnlyMode(e){const{aliRtcEngine:t}=this.context;t.setAudioOnlyMode(e),this.isSettedAudioOnlyMode=!0}finishConfigure(){const{aliRtcEngine:e}=this.context;e.setChannelProfile(Wt.AliRtcSdkCommunication),this.isSettedAudioOnlyMode||e.setAudioOnlyMode(!0),e.setParameter(JSON.stringify({data:{enablePubDataChannel:!0,enableSubDataChannel:!0,reportL1IP:!0}}))}}class BI{constructor(e,t=[]){k(this,"context"),k(this,"commands"),this.context=e,this.commands=t}asyncCall(e){this.commands.forEach(t=>{t.isEnable&&e(t)})}waitAll(e){const t=[];return this.commands.forEach(n=>{if(!n.isEnable)return;const i=e(n);i&&t.push(i)}),Promise.all(t)}waitOneByOne(e){return new Promise(t=>{(()=>{P(this,null,function*(){try{const{length:t}=this.commands;for(let n=0;n<t;n++){const t=this.commands[n];t.isEnable&&(yield e(t))}}catch(n){}finally{t()}})})()})}}function qI(e){return Y(e).format("YYYY-MM-DD HH:mm:ss")}class GI{constructor(e){k(this,"store",new Map),this.hooks=e}start(e){var t;const n=Date.now(),i={key:e,startAt:n};this.store.set(e,i),null==(t=this.hooks)||t.afterStart(C(_({},i),{datetime:qI(n),event:"start"}))}end(e){var t;const n=this.store.get(e),i=Date.now();if(!n)return;const a=i-n.startAt;this.store.delete(e),null==(t=this.hooks)||t.afterEnd(C(_({},n),{event:"end",datetime:qI(i),during:a}))}}class VI extends mI{constructor(e){super(),k(this,"context"),k(this,"localId",null),k(this,"status",Lg.Default),k(this,"error",null),k(this,"isMuted",!1),k(this,"isRemoteMuted",!1),k(this,"isRunning",!1),k(this,"isEnding",!1),k(this,"detectedSound",!1),k(this,"userVolume",0),k(this,"channelVolume",0),k(this,"todayRemainingTimes",null),k(this,"todayMaxTimes",10),k(this,"aliRtcAuthInfo",null),this.context=e}regenerateLocalId(){this.localId=ot()}setStatus(e){this.status=e,this.emit("statusChange",{status:e}),this.context.reporter.report(dI.statusChange,{status:e})}setIsMuted(e){this.isMuted=e,this.emit("isMutedChange",{isMuted:e})}setIsRemoteMuted(e){this.isRemoteMuted=e,this.emit("isRemoteMutedChange",{isRemoteMuted:e})}setIsRunning(e){this.isRunning=e,this.emit("isRunningChange",{isRunning:e}),this.context.reporter.report(dI.isRunningChange,{isRunning:e})}setIsEnding(e){this.isEnding=e,this.emit("isEndingChange",{isEnding:e})}setDetectedSound(e){this.detectedSound!==e&&(this.detectedSound=e,this.emit("detectedSoundChange",{detectedSound:e}),this.context.reporter.report(dI.detectedSoundChange,{detectedSound:e}))}setUserVolume(e){this.userVolume=e,this.emit("userVolumeChange",{userVolume:e})}setChannelVolume(e){this.channelVolume=e,this.emit("channelVolumeChange",{channelVolume:e})}setError(e){this.error=e,this.setStatus(Lg.Error)}setTodayRemainingTimes(e){this.todayRemainingTimes=e,this.emit("todayRemainingTimesChange",{todayRemainingTimes:e}),this.context.reporter.report(dI.todayRemainingTimesChange,{todayRemainingTimes:e})}setAliRtcAuthInfo(e){this.aliRtcAuthInfo=e,this.emit("aliRtcAuthInfoChange",{aliRtcAuthInfo:e})}reset(){this.status=Lg.Default,this.isMuted=!1,this.isRunning=!1,this.detectedSound=!1,this.userVolume=0,this.channelVolume=0,this.todayRemainingTimes=0,this.error=null,this.aliRtcAuthInfo=null,this.localId=null,this.context.reporter.report(dI.reset)}}class WI extends mI{constructor(e){super(),k(this,"context"),k(this,"preparing",!1),k(this,"isStopWhenPreparing",!1),k(this,"audioElement",null),k(this,"timeConfig"),k(this,"chatId",""),this.context=e}get model(){return this.context.model}startSpeech(){return P(this,null,function*(){var e,t;if(!this.preparing){this.model.reset(),this.model.regenerateLocalId();try{const{commandManager:e}=this.context;this.preparing=!0,yield e.waitAll(e=>{var t;return null==(t=e.onBeforeStart)?void 0:t.call(e)}),this.model.setIsRunning(!0),this.context.debugger.start("speech.getSpeechConfig");const{isSuccess:t,aliRtcAuthInfo:i,errorType:a,todayRemainTimes:o,timeConfig:s,chat_id:r}=yield this.context.options.getSpeechConfig(this.context);this.timeConfig=s,this.chatId=r,this.context.debugger.end("speech.getSpeechConfig");const l=yield Gt.isSupported();if(this.context.reporter.report(dI.supportResult,l),!l.support)return this.model.setError({type:Fg.NotSupported}),void this.onEnd();if(!t||!i)return this.model.setError({type:null!=a?a:Fg.InternalServerError}),void this.onEnd();this.model.setAliRtcAuthInfo(i);const c=this.context.aliRtcEngine;if("number"==typeof o&&this.model.setTodayRemainingTimes(o),!o||o<=0)return this.model.setError({type:Fg.TodayExhausted}),void this.onEnd();c.on("rtcLocalAudioStats",e=>{}),c.on("bye",e=>{}),c.on("dataChannelMsg",(t,n)=>{if(this.model.isEnding)return;let i=null;try{const e=(new TextDecoder).decode(n.data);i=JSON.parse(e)}catch(o){i=null}const a={message:n,json:i};e.asyncCall(e=>P(this,null,function*(){var t;return yield null==(t=e.onDataChannelMsg)?void 0:t.call(e,a)}))}),c.on("occurError",(t,n)=>P(this,null,function*(){if(this.model.isEnding)return;const i={error:t,uid:n};yield e.waitAll(e=>{var t;return null==(t=e.onOccurError)?void 0:t.call(e,i)}),yield this.onEnd()})),c.on("connectionStatusChange",(t,n)=>P(this,null,function*(){if(this.model.isEnding)return;const i={status:t,reason:n};yield e.waitAll(e=>{var t;return null==(t=e.onConnectionStatusChange)?void 0:t.call(e,i)})})),c.on("audioSubscribeStateChanged",(t,n,i)=>P(this,null,function*(){var a;if(this.model.isEnding)return;i===Qt.AliRtcStateSubscribed&&(this.audioElement=(null==(a=c.getUserInfo(t))?void 0:a.audioElement)||null);const o={uid:t,oldState:n,newState:i};yield e.waitAll(e=>{var t;return null==(t=e.onAudioSubscribeStateChanged)?void 0:t.call(e,o)})})),c.on("localDeviceException",(e,t)=>{this.model.isEnding||(this.context.reporter.report(dI.localDeviceException,{type:e,exception:t}),e===Kt.AliEngineLocalDeviceTypeMic&&(null==c||c.startAudioCapture()))}),yield e.waitAll(e=>{var t;return null==(t=e.onConfigure)?void 0:t.call(e)}),this.context.aliRtcEngineConfigKeeper.finishConfigure();try{this.context.debugger.start("speech.aliRtcEngine.joinChannel"),yield Promise.race([c.joinChannel(i,i.userId),CI(1e4)])}catch(n){return this.context.reporter.report(dI.joinChannelTimeOut),this.model.setError({type:Fg.UnknownError}),void(yield this.onEnd())}finally{this.context.debugger.end("speech.aliRtcEngine.joinChannel")}if(this.model.error)return;yield e.waitAll(e=>{var t;return null==(t=e.onAfterStart)?void 0:t.call(e)})}catch(n){let i=Fg.UnknownError;n instanceof Ug&&(i=null==(t=null==(e=n.payload)?void 0:e.error)?void 0:t.type),this.model.setError({type:i}),yield this.onEnd()}finally{this.preparing=!1,this.isStopWhenPreparing&&(yield this.stopSpeech())}}})}stopSpeech(){return P(this,null,function*(){this.model.isRunning&&(this.preparing?this.isStopWhenPreparing=!0:(this.isStopWhenPreparing=!1,yield this.context.commandManager.waitAll(e=>P(this,null,function*(){var t;return null==(t=e.onUserStop)?void 0:t.call(e)})),yield this.onEnd()))})}onEnd(){return P(this,null,function*(){const{commandManager:e,aliRtcEngine:t}=this.context;if(this.model.setIsEnding(!0),this.model.isRunning){this.model.isMuted&&(yield this.unmute()),this.model.isRemoteMuted&&(yield this.unmuteRemote()),yield e.waitAll(e=>{var t;return null==(t=e.onBeforeEnd)?void 0:t.call(e)}),this.model.status!==Lg.Error&&this.model.setStatus(Lg.Default),this.model.setIsRunning(!1);try{const{aliRtcEngine:e}=this.context;yield e.stopPreview();try{yield kT(e.leaveChannel(),1e3)}catch(n){}e.destroy(),this.context.resetAliRtcEngine()}catch(n){}e.waitAll(e=>{var t;return null==(t=e.onAfterEnd)?void 0:t.call(e)}),this.model.setIsEnding(!1),t.off("localDeviceException")}})}mute(){return P(this,null,function*(){this.model.isMuted||this.validate(()=>{this.model.setIsMuted(!0),this.context.aliRtcEngine.muteLocalMic(!0)})})}unmute(){return P(this,null,function*(){this.model.isMuted&&this.validate(()=>{this.model.setIsMuted(!1),this.context.aliRtcEngine.muteLocalMic(!1)})})}muteRemote(){return P(this,null,function*(){this.model.isRemoteMuted||this.validate(()=>{this.model.setIsRemoteMuted(!0),this.audioElement&&(this.audioElement.muted=!0)})})}unmuteRemote(){return P(this,null,function*(){this.model.isRemoteMuted&&(yield this.validate(()=>P(this,null,function*(){this.model.setIsRemoteMuted(!1),this.audioElement&&(this.audioElement.muted=!1)})))})}validate(e){return P(this,null,function*(){this.model.isRunning&&(yield e())})}runCommand(e,...t){let n=null;return this.context.commands.forEach(i=>{var a,o;i.commands&&(n=null==(o=null==(a=i.commands)?void 0:a[e])?void 0:o.run.apply(this,t))}),n}findCommand(e){const t=this.context.commands.find(t=>t instanceof e);return t||t}getCommandState(e){var t,n;return null!=(n=null==(t=this.findCommand(e))?void 0:t.states)?n:{}}watchCommmandState(e,t){const n=this.findCommand(e);if(!n)return()=>{};return t({states:n.states||{}}),n.eventer.on("stateChange",t)}destroy(){const{model:e,commands:t}=this.context;e.offAll(),t.forEach(e=>{e.eventer.offAll()})}}const QI={getSpeechConfig(){return P(this,null,function*(){throw new Error("You need reimplement this method")})}};class KI{constructor(e){k(this,"controller",new WI(this)),k(this,"aliRtcEngine",new Gt),k(this,"aliRtcEngineConfigKeeper",new $I(this)),k(this,"model",new VI(this)),k(this,"commandManager",new BI(this,[new vI(this),new kI(this)])),k(this,"reporter",new hI(this)),k(this,"debugger"),k(this,"options",QI),e&&(this.options=e),this.debugger=new GI({afterStart:e=>{this.reporter.report(dI.debugger,e)},afterEnd:e=>{this.reporter.report(dI.debugger,e)}})}get commands(){return this.commandManager.commands}set commands(e){this.commandManager.commands=e}resetAliRtcEngine(){this.aliRtcEngine=new Gt,this.aliRtcEngineConfigKeeper=new $I(this)}}const YI=location.href.search("testing=1")>-1,XI="OMNI_TEST_BUTTON_ID",JI=e=>{var t;if(!window.location.host.includes("pre"))return;const n=document.getElementById(XI);n&&(null==(t=n.parentElement)||t.removeChild(n));const i=document.createElement("button");i.id=XI,i.style.position="fixed",i.style.left="0px",i.style.top="50px",i.style.zIndex="99999999",i.style.background="blue",i.style.color="white",i.style.padding="0 10px",i.textContent="Copy reqs",document.body.appendChild(i),i.addEventListener("click",()=>{C_(e),i.textContent="Copied"},!1)};function ZI(){return P(this,null,function*(){let e="/voice/initialize/v2";location.host.indexOf("test.qwenlm.io")>-1&&(e="http://8.219.114.196/voice/initialize/v2");const t=yield fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"AudioAndVideo",mode:"duplex",voice:"Cherry",model_id:"omni"})}),n=yield t.json(),{app_id:i,user_id_client:a,channel:o,token:s,timestamp:r}=n;return JI(JSON.stringify(n,null,2)),{isSuccess:!0,aliRtcAuthInfo:{appId:i,userId:a,channelId:o,token:s,timestamp:r},todayRemainTimes:1}})}function eT(e){const{voice:t,type:n,projectId:i=""}=e,a={getSpeechConfig(e){return P(this,null,function*(){try{const e=yield e_(_({type:n,model_id:"omni",mode:"duplex",voice:t,timezone:(new Date).toString().replace(/\s*\(.+\)$/,"")},""!==i?{project_id:i}:{}));if(!e.success&&"ERR_NETWORK"===e.data.code)return{isSuccess:!1,errorType:Fg.ConnectionLost};if(!e)return{isSuccess:!1};const{app_id:a,user_id_client:o,channel:s,token:r,timestamp:l,status_code:c,times_left:u,audio_timeout:d,video_timeout:h,chat_id:p}=(null==e?void 0:e.data)||{};if(JI(JSON.stringify(e,null,2)),isNaN(u))return{isSuccess:!1};const m=u?parseInt(u):0;return 0===m?{isSuccess:!1,errorType:Fg.TodayExhausted}:429===c?{isSuccess:!1,errorType:Fg.Limited}:{isSuccess:!0,aliRtcAuthInfo:{appId:a,userId:o,channelId:s,token:r,timestamp:l},todayRemainTimes:m,timeConfig:{voice:d,video:h},chat_id:p}}catch(e){return{isSuccess:!1,errorType:Fg.ConnectionLost}}})}},o={getSpeechConfig:ZI};YI&&X.warning("You are currently using the config for test, please make the config correct before deploy.");const s=new KI(YI?o:a);return s.reporter.init(e.onReport),s.commands=[new vI(s),new kI(s),new zI(s,{videoElement:e.videoElement,defaultEnabledVideo:e.defaultEnabledVideo,autoOpenCamera:e.autoOpenCamera,isEnableDetector:e.isEnableDetector,onNoCameraPermission:e.onNoCameraPermission,onDetectCameraUnavailable:()=>{var t;null==(t=e.onDetectCameraUnavailable)||t.call(e)},onDetectCameraAvailable:()=>{var t;null==(t=e.onDetectCameraAvailable)||t.call(e)}}),new NI(s,{onTimeChange:e.onTimeChange,chatType:e.chatType}),new yI(s),new EI(s)],s.controller}const tT=class e extends Lk{constructor(e){super(),k(this,"adapter"),k(this,"defaultOptions"),k(this,"shareHistory",null),k(this,"__checkModuleHasEquity",(e,t=!0,n=4)=>e.some(e=>{var i,a,o;const s=TE.getState().getModelEquity(e),r=aI.getState().models.find(t=>t.id===e),l=(null==(o=null==(a=null==(i=null==r?void 0:r.info)?void 0:i.meta)?void 0:a.abilities)?void 0:o.thinking)!==n||t;return 0!==s.remains&&null!==(null==s?void 0:s.remains)&&l})),k(this,"editMessage",e=>P(this,null,function*(){const{messageId:t,content:n,history:i,submit:a=!0}=e,o=ZC.getChat(ZC.currentId||""),{chat_type:s,sub_chat_type:r}=i.messages[t||""]||{};if(!a&&o)return yield o.updateToSaveMessage(t,n);const l=i.messages[t];if("assistant"===l.role){if(o){const{responseMessageId:e}=yield o.saveAsCopyMessage(t,n)}}else if("user"===l.role)return yield this.beforeSendMessage({inputText:n,messageId:t,chatType:s,subChatType:r})})),k(this,"deleteMessage",(e,t)=>P(this,null,function*(){const n=Uf();var i;yield(i={chat_id:t,message_id:e},P(void 0,null,function*(){return yield Ox(`/chats/${i.chat_id}/messages/${i.message_id}`,{method:"DELETE"})})).catch(e=>{AC.open({type:"error",content:n.t(e.message)})});const a=ZC.getChat(ZC.currentId||"");null==a||a.deleteMessageById(e)})),k(this,"regenerateResponse",(e,t)=>{var n;const i=Uf(),{isChat:a,chatId:o,setEmitSendPromptType:s}=Wb.getState(),{visionGenerating:r,taskRunning:l}=Zb.getState(),{selectedModelIds:c}=aI.getState();if(a||r||l)return void AC.open({type:"warning",content:i.t("In the conversation, please wait a moment.")});if(!e)return;s(Qf.RETRY),BS("clkRegenerate",{params:{et:"CLK"},aesParams:{c4:null==e?void 0:e.feature_config,c5:null==e?void 0:e.id,c6:o},paramsExtend:{feature_config:null==e?void 0:e.feature_config,msg_id:null==e?void 0:e.id,chat_id:o}});const u=Wb.getState().history;if(u.currentId&&null!==e.parentId){const i=u.messages[e.parentId],a=i.content;1===(null!=(n=null==i?void 0:i.models)?n:[...c]).length?this.beforeSendMessage({chatType:e.chat_type,subChatType:e.sub_chat_type,parentId:i.id,inputText:a,extra:t}):this.beforeSendMessage({chatType:e.chat_type,subChatType:e.sub_chat_type,parentId:i.id,inputText:a,modelIds:[e.model],modelIdx:e.modelIdx})}}),k(this,"loadChat",e=>P(this,null,function*(){const t=this.getCurrentChatInstance();if(!t)return;this.resetChatState();const n=yield t.loadChat(e);return ZC.currentId===t.id&&Zb.setState({taskRunning:t.isChat}),n})),this.defaultOptions=e}static getInstance(t){if(!e.instance){if(!t)throw new Error("ChatController  defaultOptions ");e.instance=new e(t)}return e.instance}static destroyInstance(){e.instance&&(e.instance.destroy(),e.instance=null)}init(){this.registerEventListeners(),this.emit(BC.CHAT_INITIALIZED,{timestamp:Date.now()}),this.adapter=new $C}removeAllEvents(){eE.clear(),window.removeEventListener("resize",uC)}registerEventListeners(){this.removeAllEvents(),Zk(this),window.visualViewport&&window.visualViewport.addEventListener("resize",()=>{this.emit(KC.VIEWPORT_RESIZE)}),window.addEventListener("resize",uC)}validateParams(e){const{inputText:t,files:n=[],selectedModels:i,messages:a}=e;if(t.length>sg)throw new Jf(sv("Prompt cannot exceed {{value}} characters.",{value:sg}),Xf.VALIDATION);if(""===t&&!(null==n?void 0:n.length))throw new Jf(sv("Please enter a prompt or upload a file."),Xf.VALIDATION);if(jt(i))throw new Jf(sv("Model not selected"),Xf.VALIDATION);if(0!=a.length){const e=a.at(-1);if("role"===(null==e?void 0:e.role)&&1!=(null==e?void 0:e.done))throw new Jf("",Xf.VALIDATION)}if(n.length>0&&n.filter(e=>{var t,n,i;return"uploading"===e.status||"running"===(null==(i=null==(n=null==(t=e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)}).length>0)throw new Jf(sv(n.filter(e=>{var t,n,i;return"running"===(null==(i=null==(n=null==(t=e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)}).length>0?"Please wait until the uploaded or currently parsing file has finished processing before sending your message.":"Oops! There are files still uploading. Please wait for the upload to complete."),Xf.VALIDATION);if(e.type===Zf.DeepResearch&&this.checkInterrupt(null==e?void 0:e.sub_chat_type))throw new Jf(sv("During the planning phase of a deep research, you can only supplement information {{num}} times.",{num:5}),Xf.VALIDATION)}submitPrompt(e){const t=e,{userAction:n,singleChat:i}=t,a=E(t,["userAction","singleChat"]);if(n===Qf.RETRY)return void i.regenerateSubmitPrompt(a);if(n===Qf.EDIT)return void i.editSubmitPrompt(a);try{this.validateParams(e)}catch(r){const e=r instanceof Error?r.message:String(r);return this.emit(qC.MESSAGE_VALIDATE_ERROR,r),void(e&&AC.open({type:"error",content:e}))}const{files:o}=a;let s=o;o&&o.length>0&&(s=o.filter(e=>{var t,n,i;return"upload_error"!==e.status&&"failed"!==(null==(i=null==(n=null==(t=e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)}),aT.setFilterFailFiles(s)),aT.reset(["inputValue","files"]),i.submitPrompt(C(_({},a),{files:s})),jt(null==a?void 0:a.messages)&&KT.navigate("/c/new-chat")}createChat({id:e,chatId:t}={}){let n=null;if(null!=t&&(n=ZC.getChatByChatId(t)),!n&&e&&["local","guest"].includes(t||"")&&(n=ZC.getChat(e)),n)ZC.currentId=n.id,ZC.clearChatsStatus();else{const{config:e}=tx.getState(),{settings:t}=cT.getState(),{user:i}=xE.getState(),{chatMode:a="normal"}=Wb.getState();n=new Rk({config:e,settings:t,user:i,chatMode:a}),this.initSelectedModels()}return n}initSelectedModels(){return P(this,null,function*(){var e,t;const{setSelectedModelIds:n,models:i}=aI.getState(),{isSettingLoading:a,settings:o}=cT.getState(),s=At(o,"ui.models",[]);if(!i||0===i.length||!bT()&&a)return void setTimeout(()=>{this.initSelectedModels()},100);const r=new URLSearchParams(window.location.search),l=null==(e=r.get("model")||r.get("models"))?void 0:e.split(","),c=oI(l,i),u=oI(s,i);for(;TE.getState().isUpdating;)yield _I(50);c.length>0?n(yield this.checkModuleEquity([...c],!1)):(null==u?void 0:u.length)>0?n(yield this.checkModuleEquity(s,!1)):n(yield this.checkModuleEquity([null==(t=i[0])?void 0:t.id]))})}checkModuleEquity(){return P(this,arguments,function*(e=[],t=!1,n=!1){var i;const a=TE.getState().getFeatureEquity("thinking"),o=0!==(null==a?void 0:a.remains)&&null!==(null==a?void 0:a.remains),s=cT.getState().settings.ui.models;if(this.__checkModuleHasEquity(e,o))return n&&(yield aI.getState().setSelectedModelIds(e)),e;if(t&&AC.open({type:"warning",content:sv("The currently selected model has no remaining uses, and another model has been switched to.")}),s){if(this.__checkModuleHasEquity(s,o))return n&&(yield aI.getState().setSelectedModelIds(s)),s}const{models:r}=aI.getState(),l=[(null==(i=r.find(e=>0!==TE.getState().getModelEquity(e.id).remains))?void 0:i.id)||""];return n&&(yield aI.getState().setSelectedModelIds(l)),l})}getCurrentChatInstance(){const{currentId:e}=ZC;return e?ZC.getChat(e):void 0}updateMultiChatHistory(e){var t;const{messageId:n}=e;let i=n;const a=Wb.getState().history;let o=a.messages[i||""].childrenIds;for(;0!==o.length;)i=o.slice(-1)[0],o=(null==(t=a.messages[i||""])?void 0:t.childrenIds)||[];this.updateChatHistory({currentId:i})}updateChatHistory(e){const{currentId:t}=e,n=this.getCurrentChatInstance();null==n||n.updateHistory(e),t&&this.adapter.invoke({method:"updateChatInfo",params:{messageId:t,status:(null==n?void 0:n.isChat)?"running":"finished"}})}stopAllResponse(){ZC.forceClearAllChat()}getChatParams(){var e;const{chatId:t}=Wb.getState(),{selectedModels:n}=Zb.getState(),{settings:i}=cT.getState(),a=this.getCurrentChatInstance(),o=null==a?void 0:a.getChatOptions();return{id:t,chat:{title:(null==o?void 0:o.chatTitle)||"",models:[...n],system:null!=(e=i.system)?e:void 0,history:null==o?void 0:o.history,timestamp:Date.now()}}}downloadChatHistory(e="json"){this.adapter.downloadFile({fileType:e,chat:this.getChatParams()})}changeArtifact(e,t,n){return P(this,null,function*(){bx()?this.nativeArtifactsShow(t.messages[e],n):(null==t?void 0:t.currentId)&&t.messages[null==t?void 0:t.currentId]&&(Zb.setState({currentShowControl:tg.Artifacts}),yE.setState({showSidebar:!0}),Zb.setState({selectedArtifactsMessageId:e}))})}selectModel(e){BS("selectAModel",{params:{et:"CLK",c4:e}}),Zb.setState({showModelSelect:!1})}openNewChat(e){return P(this,null,function*(){const{hideToast:t=!1,sendEventTrack:n=!1,keepTemporaryMode:i=!1}=e||{};n&&BS("clkCreateChat",{params:{et:"CLK"}}),aT.reset(["inputValue","files","showDetail","wordsShowMore"]);const a=Zb.getState().temporaryChatEnabled;Zb.setState({webSearchEnabled:!1,visionGenerating:!1}),a&&(Zb.setState({taskRunning:!1}),Zb.setState({temporaryChatEnabled:i})),!t&&"/"===window.location.pathname&&tx.getState().mobile&&jt(this.shareHistory)?AC.openOnce({type:"success",content:sv("Already in a new conversation")}):(yield KT.navigate(i?"/?temporary-chat=true":"/"),yield this.initSelectedModels(),yield this.resetChatState(),this.closeShowControls(),this.shareHistory=null)})}resetChatState(){return P(this,null,function*(){Wb.getState().resetChatState(),aT.resetAll(),this.adapter.resetNativeState()})}updateTemporaryChat(e){return P(this,null,function*(){Zb.setState({temporaryChatEnabled:e,currentShowControl:tg.None}),this.resetChatState(),jt(this.shareHistory)||(this.shareHistory=null,aT.reset(["inputValue","files","showDetail","wordsShowMore"])),e?yield KT.navigate("/?temporary-chat=true"):yield KT.navigate("/")})}webDeploy(e=!1){return P(this,null,function*(){})}changeChatPromot(){}clearAllChat(){return P(this,null,function*(){const{mobile:e}=tx.getState();if(e)this.emit(qC.MESSAGE_CLEAR_ALL);else{this.stopAllResponse(),Zb.setState({taskRunning:!1}),yield lS().catch(e=>{AC.open({type:"error",content:sv(e.message)})}),dC(),Zb.setState({reUpdateFolders:!0}),yield Wb.setState({chatId:""}),KT.navigate("/");const t=document.getElementById("new-chat-button");setTimeout(()=>{null==t||t.click(),e&&yE.setState({showSidebar:!1})},0)}})}deleteSearchSource(e){return P(this,null,function*(){const t=this.getCurrentChatInstance();if(!t)return;const{currentId:n,extra:i={}}=e,{history:a}=t.getChatOptions();if(this.closeShowControls(),bx())this.adapter.invoke({method:"removeSearchReference",params:{reference:JSON.stringify({currentId:n,extra:i})}});else{Wb.setState({emitSendPromptType:Qf.EDIT});const e=a.messages[n].parentId||"",o=ot(),s=C(_({},a.messages[e]||{}),{fid:o,childrenIds:[],extra:_(_({},a.messages[e].extra||{}),i),timestamp:Math.floor(Date.now()/1e3)});s.id&&delete s.id;const r=a.messages[e||""].parentId;r&&(a.messages[r].childrenIds=[...a.messages[r].childrenIds||[],o]),a.messages[o]=s,a.currentId=o,yield this.beforeSendMessage({inputText:s.content,extra:s.extra,parentId:e,messageId:e,singleChat:t})}})}stopResponse(){const e=this.getCurrentChatInstance();null==e||e.stopResponse()}stopThinkingPhase(e){const t=this.getCurrentChatInstance();null==t||t.stopThinkingPhase(e)}logout(){return P(this,null,function*(){Zb.setState({taskRunning:!1}),yield iS(),this.adapter.clearCookie(Kf.SETAPP),xE.setState({user:void 0}),location.href="/"})}closeShowControls(){try{Zb.setState({isSourcesVisible:!1,currentShowControl:tg.None}),yE.setState({showControls:!1}),Wb.setState({currentCitationInfo:{messageId:"",citationIndex:0},currentArtifactsMessage:void 0}),this.adapter.invoke({method:"closeHalfWindow"})}catch(e){}}openArtifacts(e,t){var n;const i=Zb.getState().currentShowControl;if(!t&&e===(null==(n=Wb.getState().currentArtifactsMessage)?void 0:n.id)&&i!==tg.None)return this.closeShowControls(),!1;const a=this.getChatOptions().history.messages[e];return Zb.setState({currentShowControl:tg.Artifacts}),Wb.setState({currentArtifactsMessage:a}),!0}updataArtifacts(e,t){return P(this,null,function*(){const t=this.getChatOptions().history.messages[e];Wb.setState({currentArtifactsMessage:t})})}checkInterrupt(e){var t;if(e!==Zf.INTERRUPT)return!1;const n=null==(t=this.getChatOptions())?void 0:t.history;if(!n)return!1;const i=sC(n.currentId,n).filter(e=>"assistant"===e.role),a=i.findLastIndex(e=>e.chat_type===Zf.DeepResearch&&e.sub_chat_type===Zf.DeepResearch);if(-1===a)return!1;return i.slice(a+1).length>=5}beforeSendMessage(e){return P(this,null,function*(){var t,n,i,a,o,s,r,l,c,u,d,h;Uf();const p=this.getCurrentChatInstance();if(!p)return;const{chatType:m}=e,{currentInputFeature:f,emitSendPromptType:g,currentInputSubType:v}=Wb.getState(),y=cT.getState().mcpSettingList,b=m||f,{thinkingMode:x,mcpEnabled:w,researchMode:S}=Zb.getState(),E=["Thinking","Auto"].includes(x),{selectedModelIds:k}=aI.getState();bx()||(yield this.checkModuleEquity(k,!0,!0));const{models:I}=aI.getState(),{settings:T}=cT.getState(),{config:j}=tx.getState(),{user:N}=xE.getState(),{temporaryChatEnabled:P}=Zb.getState(),{selectedModels:M}=aI.getState(),A=(null==e?void 0:e.selectedModels)||M||[],R=A.map(e=>"string"==typeof e?e:null==e?void 0:e.id),O=I.filter(({id:e})=>R.includes(e)),{history:D}=p.getChatOptions(),{nextModels:L,messages:F}=(({selectedModels:e,allModels:t,history:n})=>{let i=e;const a=e.map(e=>t.map(e=>e.id).includes(e)?e:"");return JSON.stringify(e)!==JSON.stringify(a)&&(i=a),{nextModels:i,messages:sC(n.currentId,n)}})({selectedModels:R,allModels:I,history:D});Zb.getState().setSelectedModels(L);let U=null;if(null==e?void 0:e.parentId)U=e.parentId;else if(0!==F.length){const e=F.filter(e=>"user"!==e.role);if(jt(e))U=null==(t=null==F?void 0:F.at(-1))?void 0:t.id;else{const t=null==(n=null==e?void 0:e.at(-1))?void 0:n.id;U=t||(null==(i=null==e?void 0:e.at(-2))?void 0:i.id)}}jt(U)&&(U=(null==(a=this.shareHistory)?void 0:a.currentId)||null);const z={thinking_enabled:E,local_mcp:Zb.getState().mcpEnabled?{}:void 0,output_schema:"phase",research_mode:S,auto_thinking:"Auto"===x},H=I.find(e=>e.id===R[0]);E&&1===A.length&&1===(null==(r=null==(s=null==(o=null==H?void 0:H.info)?void 0:o.meta)?void 0:s.abilities)?void 0:r.thinking_budget)&&(z.thinking_budget=T.model_config?(null==(l=T.model_config[R[0]])?void 0:l.thinking_budget)||(null==(u=null==(c=null==H?void 0:H.info)?void 0:c.meta)?void 0:u.max_thinking_generation_length):null==(h=null==(d=null==H?void 0:H.info)?void 0:d.meta)?void 0:h.max_thinking_generation_length),w&&wx()&&(z.mcp=y.filter(e=>!e.type&&e.enabled).map(e=>e.id));const $=D.messages[U||""]||{};null==p||p.setChatOptions({settings:T,config:j,user:N,chatMode:bT()?"guest":P?"local":"normal"});const B=nk(F,(null==e?void 0:e.subChatType)||e.extra,{chatType:b,subChatType:(null==e?void 0:e.subChatType)||v||"",extra:e.extra,userAction:g}),q=C(_({},e),{type:null==B?void 0:B.chatType,selectedModels:O,messages:F,userAction:g,userMessageId:null==$?void 0:$.id,globalConfig:j,history:D,parentId:U,feature_config:z,extra:B.extra||{},singleChat:p,sub_chat_type:B.subChatType});this.submitPrompt(q)})}copyMessage(){var e,t;const n=this.getCurrentChatInstance(),i=null==n?void 0:n.getChatOptions();((e,t,n,i)=>{P(void 0,null,function*(){t?(yield C_(yield rC(e)).catch(e=>{}))&&"function"==typeof n&&n():"function"==typeof i&&i()})})({id:Wb.getState().chatId,chat:{title:Wb.getState().chatTitle,models:[...Zb.getState().selectedModels],system:null!=(t=null==(e=cT.getState().settings)?void 0:e.system)?t:void 0,history:null==i?void 0:i.history,timestamp:Date.now()}},!(null==i?void 0:i.isChatIntercept),()=>{AC.open({type:"success",content:sv("Copied to clipboard")})},()=>{AC.open({type:"error",content:sv("Content security warning: output data may contain inappropriate content!")})})}getChatOptions(){const e=this.getCurrentChatInstance();if(e)return e.getChatOptions()}setChatOptions(e){const t=this.getCurrentChatInstance();t&&t.setChatOptions(e)}collectAllSearchAndThinList(e,t=!0){const n={};if(e.forEach(e=>{var t,i,a,o,s,r;const l=null==(t=e.content_list)?void 0:t.some(e=>[ng.WEB_SEARCH].includes(e.phase)),c=e.is_stop_in_thinking,u="learn"===e.chat_type||"learn"===e.sub_chat_type||"learn"===(null==(a=null==(i=e.extra)?void 0:i.meta)?void 0:a.subChatType),d=null==(o=null==e?void 0:e.feature_config)?void 0:o.thinking_enabled,h=e.chat_type===Zf.DeepResearch;e.id&&(l||d||u||h)&&(n[e.id]={},n[e.id].webSearchInfo=c?[]:h?((null==e?void 0:e.content_list)||[]).filter(e=>e.phase===ng.ANSWER).reduce((e,t)=>{var n,i;return e.push(...(null==(i=null==(n=t.extra)?void 0:n.deep_research)?void 0:i.references)||[]),e},[]).map(e=>C(_({},e),{icon:e.hostlogo||e.icon,hostlogo:e.hostlogo||e.icon,snippet:e.description||e.snippet})):bC((null==e?void 0:e.content_list)||[]),n[e.id].type=d?tg.Thinking:tg.WebSearch,l&&d&&h&&(n[e.id].type=tg.ThinkingAndSearch),d&&(n[e.id].contentList=null==(r=null==(s=null==e?void 0:e.content_list)?void 0:s.filter(e=>e.phase!==ng.ANSWER))?void 0:r.map(e=>{var t;return e.phase===ng.WEB_SEARCH?C(_({},e),{content:[null==(t=null==e?void 0:e.extra)?void 0:t.web_search_info]}):e.phase===ng.CODE_INTERPRETER?C(_({},e),{contentTemplate:ng.CODE_INTERPRETER}):_({},e)})))}),t){const e=Wb.getState().allSearchAndThinkLists;Object.keys(n).some(t=>JSON.stringify(e[t])!==JSON.stringify(n[t]))&&Wb.setState({allSearchAndThinkLists:_(_({},e),n)})}return n}collectAllPdfInfo(e,t){const n=Zb.getState().pdfViewInfo;Zb.getState().setPDFViewInfo(C(_({},n),{[t]:e}))}updateMessage(e,t){return P(this,null,function*(){const n=this.getCurrentChatInstance();n&&n.updateMessage(e,t)})}seleteOperation(e){const t=this.getCurrentChatInstance(),n=Uf();if(null==t?void 0:t.isChat)return void AC.open({type:"warning",content:n.t("In the conversation, please wait a moment.")});const{type:i,content:a,inputText:o,messageId:s,extra:r}=e;"explain"===i?this.beforeSendMessage({parentId:s,inputText:`${n.t("Explain this section to me in more detail")}\n\n\`\`\`\n${a.text}\n\`\`\``}):"ask"===i?this.beforeSendMessage({parentId:s,inputText:`\`\`\`\n${a.text}\n\`\`\`\n${o}`,extra:{meta:C(_({},r.meta),{quoteText:a.text})}}):"translate"===i&&this.beforeSendMessage({parentId:s,inputText:a.text,extra:r,subChatType:"translate"})}toast(e){const t=Uf();bx()?this.adapter.invoke({method:"showToast",params:{type:"warning",text:t.t(e.content)}}):AC.open({type:"warning",content:t.t(e.content)})}getSelectLocalLanguageCode(e,t){return P(this,null,function*(){var n,i,a,o,s;const r=(null==e?void 0:e.language)||[];let l=(null==(n=r.find(e=>e.code===t))?void 0:n.code)||(null==(i=r[0])?void 0:i.code),c="";try{if(bx()&&!kx("1.4.0")){const e=yield null==(o=null==(a=window.QwenChat)?void 0:a.getStoredInfo)?void 0:o.call(a,{key:"transTargetLanguageKey"});c=null==(s=null==e?void 0:e.result)?void 0:s.value}else c=localStorage.getItem("transTargetLanguageKey")}catch(u){}return c&&r.find(e=>e.code===c)&&(l=c),l})}setSelectLocalLanguageCode(e){bx()?this.adapter.invoke({method:"storeInfo",params:{key:rI("transTargetLanguageKey"),value:e,needPersist:!0}}):localStorage.setItem("transTargetLanguageKey",e)}navigateToSiblingMessage(e,t,n){var i,a;const o=e.id||e.fid,s=t.indexOf(o);let r;r="previous"===n?Math.max(s-1,0):Math.min(s+1,t.length-1);const l=t[r];let c=t[r];const u=this.getChatOptions().history;if(o!==c){let e=u.messages[c].childrenIds;for(;0!==e.length;)c=e.at(-1),e=u.messages[c].childrenIds;this.updateChatHistory({currentId:c});Zb.getState().currentShowControl===tg.Artifacts&&this.openArtifacts(l);const{settings:t}=cT.getState();(null==(a=null==(i=t.ui)?void 0:i.scrollOnBranchChange)||a)&&setTimeout(()=>{(()=>{const e=document.querySelector(`#${gg}`);e&&e.scrollTo({top:e.scrollHeight,behavior:"smooth"})})()},300)}}nativeArtifactsShow(e,t,n){const{temporaryChatEnabled:i,currentShowControl:a,showDeleteDeployConfirm:o}=Zb.getState(),{currentInputFeature:s,chatId:r,branchInfo:l}=Wb.getState(),{subscriptionPlus:c}=CE.getState(),u={message:e,temporaryChatEnabled:i,currentInputFeature:t||s,loading:!!n,currentShowControl:a,showDeleteDeployConfirm:o,subscriptionPlus:c,chatId:r,branchInfo:l};this.adapter.invoke({method:"storeInfo",params:{key:rI(tg.Artifacts),value:JSON.stringify(u)}}),this.adapter.invoke({method:"openHalfWindow",params:{type:"openUrl",content:`${lI(tg.Artifacts)}?id=${r}&messageId=${e.id}`}})}nativeArtifactsUpdata(e,t){const{temporaryChatEnabled:n,currentShowControl:i,showDeleteDeployConfirm:a}=Zb.getState(),{currentInputFeature:o,chatId:s,branchInfo:r}=Wb.getState(),{subscriptionPlus:l}=CE.getState(),c={message:e,temporaryChatEnabled:n,currentInputFeature:o,loading:!!t,currentShowControl:i,chatId:s,showDeleteDeployConfirm:a,subscriptionPlus:l,branchInfo:r};this.adapter.invoke({method:"storeInfo",params:{key:rI(tg.Artifacts),value:JSON.stringify(c)}})}getCurrentChatsubChatType(){const e=this.getCurrentChatInstance();return null==e?void 0:e.subChatType}getCurrentChatMessageIdsSnapshot(){var e;return[...(null==(e=this.getCurrentChatInstance())?void 0:e.history.currentResponseIds)||[]]}getCurrentChatCurrentId(){var e;return null==(e=this.getCurrentChatInstance())?void 0:e.history.currentId}clearCookie(e){this.adapter.clearCookie(e)}openWindow(e,t){this.adapter.openWindow(e,t)}updateChatInfo(e){const{id:t,status:n,subChatType:i}=e;if(36!==(null==t?void 0:t.length))return;const{temporaryChatEnabled:a}=Zb.getState();let o=t;a&&(o="temporary"),this.adapter.invoke({method:"updateChatInfo",params:{chatId:o,status:n,subChatType:i}})}routeTologin(){this.adapter.routeTologin()}onUpdateVoice(e,t){const{config:n}=tx.getState(),{ttsAudioTTSSpeakers:i}=dT.getState();if(!(null==n?void 0:n.audio_tts_speakers)||!i)return;const a=(t?n.audio_tts_speakers:i).find(t=>t.speaker===e);if(Jk.getInstance().clearAllCache(),a){a.is_personal=!1;const{updateQwenChatSettings:e}=cT.getState();e(t?{tts_speaker:a}:{tts_speaker_v2:a})}}makeVideoOrImageByImageGen(e){return P(this,arguments,function*({chatType:e,subChatType:t,files:n}){this.emit(YC.MESSAGE_INPUT_RECOMMEND_WORDS_CLICK,{suggestItem:{chatType:e,subChatType:t},active:!0}),n&&rT.getState().setFiles(n.map(e=>_({},e)))})}newChatBranch(e){return P(this,null,function*(){var t,n,i,a,o,s;const r=this.getCurrentChatInstance();if(r){const l=this.createChat();Rt(l,r,(e,t,n)=>{if(!["__proto__","constructor","prototype"].includes(n||""))return["id","instanceId","chatId","eventTarget"].includes(n||"")||"function"==typeof e?e:It(t)});const c={};let u=It(r.history.messages[e]);for(u.childrenIds=[];u;){const e=u.id||"";c[e]=u,u=It(r.history.messages[u.parentId||""]),u&&(u.childrenIds=[e])}let d=(null==(t=null==c?void 0:c[e])?void 0:t.chat_type)||Zf.Txt2Txt,h=(null==(n=null==c?void 0:c[e])?void 0:n.sub_chat_type)||Zf.Txt2Txt;if(d===Zf.DeepResearch&&[Zf.DeepResearch,Zf.DeepResearchWebDev,Zf.Podcast].includes(h)&&(d=Zf.Txt2Txt,h=Zf.Txt2Txt),this.closeShowControls(),l.setChatOptions({history:{messages:c,currentId:e,currentResponseIds:[]},isChat:!1,chatLoaded:!0,branchInfo:{isTemp:!0,branch_message_id:e,origin_chat_id:r.chatId||"",origin_chat_title:r.chatTitle||""},currentInputFeature:d,currentInputSubType:h}),yield KT.navigate("/c/new-branch"),bx()){const t=r.history.messages[e],n=((null==(i=t.content_list)?void 0:i.length)||0)>3&&(null==(a=t.content_list)?void 0:a.find(e=>e.phase===ng.PdfMdGen)),{thinking_enabled:c,thinking_budget:u,research_mode:d}=t.feature_config||{},h=r.getChatOption("currentInputFeature")||"",p={type:h,subType:r.getChatOption("subChatType")||"",featureConfig:_({thinking_enabled:c,research_mode:d},u?{thinking_budget:u}:{})},m={inputText:"",modelId:r.getChatOption("models")[0]||"",actionScene:p};switch(h){case Zf.ImageGeneration:p.ext={size:"1:1"};break;case Zf.VideoGeneration:p.ext={size:"16:9"};break;case Zf.WebDev:p.type=Zf.Artifacts;break;case Zf.DeepResearch:sC(e,l.history).length,p.subType=Zf.Txt2Txt;break;case Zf.Travel:sC(e,l.history).length,p.subType=Zf.Txt2Txt;break}if(n&&t.sub_chat_type===Zf.DeepResearch){const{name:e="",link:t="",size:i=0}=(null==(s=null==(o=null==n?void 0:n.extra)?void 0:o.deep_research)?void 0:s.pdf)||{};m.queryFile={fileName:e,fileSize:i,fileUrl:t,fileType:"application/pdf"}}sessionStorage.setItem(vg,"true"),yield this.adapter.invoke({method:"openMainChat",params:m}),rx()&&setTimeout(()=>{sessionStorage.removeItem(vg)},1e3)}return l.forceSetAllState(),Wb.setState({chatId:""}),Zb.setState({taskRunning:!1,visionGenerating:!1}),l}return null})}destroy(){this.removeAllListeners(),this.removeAllEvents()}createShareChat(e){this.createChat().setChatOptions({history:_({},e),isChat:!1,chatLoaded:!0,subChatType:e.subChatType,currentInputFeature:e.chatType,currentInputSubType:e.subChatType})}onExpandHandler({messageId:e,next:t,phaseId:n}){const{setShowControls:i,showControls:a}=yE.getState(),{setCurrentShowControl:o}=Zb.getState(),{setCurrentActionMessageId:s,setCurrentPhaseContentId:r}=Zb.getState();(void 0===t?!a:t)?(i(!0),o(tg.ThinkingAndSources),s(e),r(`${e}_${n}`),this.scrollToThinkingWebSearchPhase()):(i(!1),o(tg.None),s(""),r(""))}scrollToThinkingWebSearchPhase(){return P(this,null,function*(){const e=()=>{setTimeout(()=>{const{currentPhaseContentId:e,currentActionMessageId:t}=Zb.getState();if(!e)return;const n=document.querySelector(".qwen-chat-thinking-and-sources-content-thinking-container");if(!n)return;const[i]=e.split("_")||[];if(i!==t)return;const a=n.querySelector(`[data-phase-id="${e}"]`);a&&(a.style.scrollMarginTop="20px",a.scrollIntoView({behavior:"smooth"}))},150)},t=yE.getState().isSharePage,{mobile:n}=tx.getState();if(document.querySelector(".splitter-container-right-panel")||t||n)e();else{yield wT(100);const t=document.querySelector(".splitter-container-right-panel");if(t){const n=()=>{null==t||t.removeEventListener("transitionend",n),e()};t.addEventListener("transitionend",n)}else this.scrollToThinkingWebSearchPhase()}})}scrollToWebSearch(){return P(this,null,function*(){const e=()=>{setTimeout(()=>{const e=document.querySelector(".qwen-chat-web-search-origins-header");e&&(e.style.scrollMarginTop="20px",e.scrollIntoView({behavior:"smooth"}))},150)};if(document.querySelector(".splitter-container-right-panel"))e();else{yield wT(100);const t=document.querySelector(".splitter-container-right-panel");if(t){const n=()=>{null==t||t.removeEventListener("transitionend",n),e()};t.addEventListener("transitionend",n)}else this.scrollToWebSearch()}})}};k(tT,"instance",null);let nT=tT;const iT=class e extends Lk{constructor(){super(),k(this,"filesManager",null)}static getInstance(){return e.instance||(e.instance=new e),e.instance}init(e){}triggerFocus(){this.emit(YC.MESSAGE_INPUT_TRIGGER_FOCUS)}notifyBlur(){this.emit(YC.MESSAGE_INPUT_ON_BLUR)}emitRecommendWordsClick(e){this.emit(YC.MESSAGE_INPUT_RECOMMEND_WORDS_CLICK,e)}getState(){return rT.getState()}getInputValue(){return rT.getState().inputValue}getFiles(){return rT.getState().files}setInputValue(e){rT.getState().setInputValue(e)}setFiles(e){rT.getState().setFiles(e)}updateFeatureType(e){rT.getState().updateFeatureType(e),rT.getState().setMessageType(e)}setMobileRecommendDetailVisible(e){rT.getState().setMobileRecommendDetailVisible(e)}setFileDragging(e){rT.getState().setFileDragging(e)}reset(e){rT.getState().resetMessageInput(e),this.filesManager&&(null==e?void 0:e.includes("files"))&&this.filesManager.clearFiles(),(null==e?void 0:e.includes("showDetail"))&&rT.getState().setShowDetail(!1),(null==e?void 0:e.includes("wordsShowMore"))&&rT.getState().setWordsShowMore(!1)}getDefaultThinkingEnable(){var e,t,n,i,a,o;const s=tx.getState().config,r=aI.getState().selectedModels;let l=!1,c="Fast";if(1===(null==r?void 0:r.length)&&(l=3===(null==(t=null==(e=null==s?void 0:s.permissions)?void 0:e.chat)?void 0:t.thinking)||3===(null==(o=null==(a=null==(i=null==(n=r[0])?void 0:n.info)?void 0:i.meta)?void 0:a.abilities)?void 0:o.thinking)),l){const e=function(e){var t,n;return(null==(n=null==(t=null==e?void 0:e.info)?void 0:t.meta)?void 0:n.auto_thinking)?{supportThinkingModes:["Auto","Thinking","Fast"],defaultThinkingMode:"Auto"}:{supportThinkingModes:["Thinking","Fast"],defaultThinkingMode:"Thinking"}}(r[0]);c=e.defaultThinkingMode}return{defaultThinkingEnable:l,defaultThinkingMode:c}}resetAll(){this.reset(["inputValue","files","showDetail","wordsShowMore"]);const{defaultThinkingEnable:e,defaultThinkingMode:t}=this.getDefaultThinkingEnable();Zb.setState({webSearchEnabled:!1,visionGenerating:!1,thinkingEnabled:e,mcpEnabled:!1,thinkingMode:t})}sendPrompt(e){rT.getState().onPromptSend(e)}createFilesManager(e){return this.filesManager=new mE(e),this.filesManager}setFilterFailFiles(e){this.filesManager&&(rT.setState({files:e}),this.filesManager.setFiles(e))}};k(iT,"instance",null);const aT=iT.getInstance();aT.init();const oT=nT.getInstance({});oT.init();const sT={mobileRecommendDetailVisible:!1,designStyle:"Minimalist",visionSize:"16:9",messageInputPermissions:{enableThinking:{enable:!1,disabled:!1},enableMCP:{enable:!1,disabled:!1},enableSizeSelector:{enable:!1,disabled:!1},enableUpload:{enable:!1,disabled:!1},enableAdvanced:{enable:!1,disabled:!1},enableDesignStyle:{enable:!1,disabled:!1}},inputValue:"",messageType:Zf.Txt2Txt,files:[],fileDragging:!1,isFocus:!1,showDetail:!1,wordsShowMore:!1,selectedSuggest:""},rT=Wy()(Bb((e,t)=>_(_({},sT),((e,t)=>({setMobileRecommendDetailVisible:t=>e({mobileRecommendDetailVisible:t}),setVisionSize:t=>e({visionSize:t}),setDesignStyle:t=>e({designStyle:t}),setInputValue:t=>e({inputValue:t}),setFiles:t=>e({files:t}),setMessageType:({subChatType:t,chatType:n})=>{let i=n;t===Zf.WebDev&&(i=Zf.WebDev),e({messageType:i})},updateFeatureType:({subChatType:e,chatType:t})=>{const n={};e&&(n.currentInputSubType=e),t&&(n.currentInputFeature=t),Wb.setState(n)},setMessageInputPermissions:t=>e({messageInputPermissions:t}),onPromptSend:e=>{const{inputValue:n,files:i}=t();oT.beforeSendMessage(_({inputText:n,files:i},e))},resetMessageInput:t=>{if(t&&t.length>0){const n={};t.forEach(e=>{n[e]=sT[e]}),e(n)}else e(sT)},setFileDragging:t=>{e({fileDragging:t})},setIsFocus:t=>{e({isFocus:t})},setShowDetail:t=>{e({showDetail:t})},setWordsShowMore:t=>{e({wordsShowMore:t})},setSelectedSuggest:t=>{e({selectedSuggest:t})}}))(e,t)),{name:"messageInputStore",store:"messageInputStore",enabled:!1})),lT={ui:{chatBubble:!0,autoTags:!0,largeTextAsFile:!0,scrollOnBranchChange:!0,landingPageMode:"",chatDirection:"LTR",params:{},models:[]},model_config:{},memory:{enable_memory:!0,enable_history_memory:!0,memory_version_reminder:!1},personalization:{name:"",description:"",style:void 0,instruction:"",enable_for_new_chat:!0}},cT=Wy()(Gb(Lb(Bb((e,t)=>({isSettingLoading:!0,settings:lT,mcpSettingList:[],getSettings:()=>P(void 0,null,function*(){var n;e({isSettingLoading:!0});const i=yield P(void 0,null,function*(){return yield Ox("/users/user/settings")});if(i.success&&i.data){const n=i.data||lT;return bx()?e({settings:C(_({},t().settings),{tts_speaker:n.tts_speaker,tts_speaker_v2:n.tts_speaker_v2,ui:{language:n.ui.language,scrollOnBranchChange:n.ui.scrollOnBranchChange},personalization:n.personalization||lT.personalization}),isSettingLoading:!1}):e({settings:C(_({},n),{personalization:n.personalization||lT.personalization}),isSettingLoading:!1}),n}return ut.open({type:"error",content:(null==(n=i.data)?void 0:n.message)||""}),e({isSettingLoading:!1}),lT}),setSettings:t=>P(void 0,null,function*(){var n;const i=yield t_(t);return i.success?e(e=>{e.settings=i.data}):ut.openOnce({type:"error",content:sv(null==(n=null==i?void 0:i.data)?void 0:n.message)}),i}),setMcpSettingList:t=>e({mcpSettingList:t}),updateLocalUiSettings:t=>P(void 0,null,function*(){e(e=>{e.settings.ui=_(_({},e.settings.ui),t)})}),updateModelConfig:t=>e(e=>{e.settings.model_config=_(_({},e.settings.model_config),t)}),updateQwenChatSettingsbyNative:e=>P(void 0,null,function*(){yield t_(e)}),updateQwenChatSettings:n=>P(void 0,null,function*(){const i=t(),a=nv(i.settings,n);e({settings:a,isSettingLoading:!1});const o=yield t_(n);o.success&&o.data||ut.openOnce({type:"error",content:sv(o.data.message)})})}),{name:"settingsStore",store:"settingsStore",enabled:!1})))),uT={deepResearchEndTimes:{},knowledge:null,tools:null,functions:null,showMobileGenerateModeControl:!1,audioTTSSpeakers:[],ttsAudioTTSSpeakers:[],voiceCloneList:[],onNativeCalling:!1,unsupportedLanguageVoicePlayMessageIds:[],voicePlayingMessageId:"",ossUrls:[],subscriptionTestAreaEnable:!1,showRegionUnenablePayment:!1,entrySettingsRouter:"",voiceListSelected:"female"},dT=Wy()(Bb(e=>_(_({},uT),(e=>({setDeepResearchEndTimes:t=>e({deepResearchEndTimes:t}),setKnowledge:t=>e({knowledge:t}),setTools:t=>e({tools:t}),setFunctions:t=>e({functions:t}),setShowMobileGenerateModeControl:t=>e({showMobileGenerateModeControl:t}),setAudioTTSSpeakers:t=>e({audioTTSSpeakers:t}),setTTSAudioTTSSpeakers:t=>e({ttsAudioTTSSpeakers:t}),setOnNativeCalling:t=>e({onNativeCalling:t}),setUnsupportedLanguageVoicePlayMessageIds:t=>e({unsupportedLanguageVoicePlayMessageIds:t}),setVoicePlayingMessageId:t=>e({voicePlayingMessageId:t}),setOssUrls:t=>e({ossUrls:t}),setShowRegionUnenablePayment:t=>e({showRegionUnenablePayment:t}),setVoiceCloneList:t=>e({voiceCloneList:t}),setEntrySettingsRouter:t=>e({entrySettingsRouter:t}),setVoiceListSelected:t=>e({voiceListSelected:t})}))(e)),{name:"temporaryStatusStore",store:"temporaryStatusStore",enabled:!1})),hT={notification:[],memoryNotification:void 0},pT=Wy()(Lb(Bb((e,t)=>_(_({},hT),((e,t)=>({setNotification:n=>{const{clearNotificationById:i}=t(),a=ot(),o=n,{duration:s=1e4,id:r=a,props:l}=o,c=E(o,["duration","id","props"]),u=setTimeout(()=>{0!==s&&i(r)},s),d=_({id:r,timer:u,duration:s},c);e(e=>{e.notification=[d,...e.notification],e.memoryNotification=l})},clearNotificationById:n=>{const{notification:i}=t(),a=i.find(e=>e.id===n);a&&clearTimeout(a.timer),e(e=>{e.notification=e.notification.filter(e=>e.id!==n)})},clearAllNotification:()=>{e(e=>{e.notification=[]})},setMemoryNotification:t=>{e(e=>{e.memoryNotification=t})}}))(e,t)),{name:"notificationStore",store:"notificationStore",enabled:!1}))),mT={projectSettingOpen:!1,projectName:"",projectIcon:"",instructionValue:"",showDeleteConfirm:!1,showEditModal:!1,operationProject:{},operationProjectFiles:[],deleteFiles:[],projectInfo:{},projectInfoFiles:[],showAllList:!1,activeProjectId:null,projectChats:[],projectArr:[],chatProjectId:null,moveNewProjectId:"",projectExpandChats:[],activeChatDetails:null},fT=Wy()(Bb(e=>_(_({},mT),(e=>({setProjectSettingOpen:t=>e({projectSettingOpen:t}),setProjectName:t=>e({projectName:t}),setProjectIcon:t=>e({projectIcon:t}),setInstructionValue:t=>e({instructionValue:t}),setShowDeleteConfirm:t=>e({showDeleteConfirm:t}),setShowEditModal:t=>e({showEditModal:t}),setOperationProject:t=>e({operationProject:t}),setOperationProjectFiles:t=>e({operationProjectFiles:t}),setDeleteFiles:t=>e({deleteFiles:t}),setProjectInfo:t=>e({projectInfo:t}),setProjectInfoFiles:t=>e({projectInfoFiles:t}),setShowAllList:t=>e({showAllList:t}),setActiveProjectId:t=>e({activeProjectId:t}),setProjectChats:t=>e({projectChats:t}),setProjectArr:t=>e({projectArr:t}),setChatProjectId:t=>e({chatProjectId:t}),setMoveNewProjectId:t=>e({moveNewProjectId:t}),resetProjectState:()=>e(mT),setProjectExpandChats:t=>e({projectExpandChats:t}),setActiveChatDetails:t=>e({activeChatDetails:t})}))(e)),{name:"projectStore",store:"projectStore",enabled:!1})),gT=e=>{localStorage.removeItem(e)};function vT(e){const t=document.cookie.split(";").map(function(e){return e.trim().split("=")}).find(function(t){return(null==t?void 0:t[0])==e});return t?encodeURIComponent(t[1]||""):""}const yT=()=>(null==localStorage?void 0:localStorage.token)||vT("qwen_token")||vT("token"),bT=()=>{const e=xE.getState().user;return bx(),void 0===e},xT=()=>new Promise(e=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{const n={lat:t.coords.latitude,lon:t.coords.longitude};e(n)},t=>{e(null)},{timeout:3e3}):e(null)});const wT=e=>new Promise(t=>{setTimeout(t,e)}),ST=e=>{if(!e)return;const t=document.createElement("canvas"),n=t.getContext("2d");if(t.width=100,t.height=100,!(()=>{const e=document.createElement("canvas"),t=e.getContext("2d");e.height=1,e.width=1;const n=new ImageData(e.width,e.height),i=n.data;for(let o=0;o<n.data.length;o+=1)i[o]=o%4!=3?Math.floor(256*Math.random()):255;t.putImageData(n,0,0);const a=t.getImageData(0,0,e.width,e.height).data;for(let o=0;o<a.length;o+=1)if(a[o]!==i[o])return!1;return!0})())return"https://img.alicdn.com/imgextra/i4/O1CN01HixsDs1PEZYpgigdP_!!6000000001809-0-tps-400-400.jpg";n.fillStyle="#615CED",n.fillRect(0,0,t.width,t.height),n.fillStyle="#FFFFFF",n.font="40px NotoSansHans",n.textAlign="center",n.textBaseline="middle";const i=(e=>{if(!e||0===e.length)return"";const t=e.normalize("NFC");return Array.from(t)[0]||""})(null==e?void 0:e.trim());return n.fillText(i.toUpperCase(),t.width/2,t.height/2),t.toDataURL()},_T=()=>{const e=document.getElementById("splash-screen");e&&e.remove()},CT=e=>{const t={};Object.keys(e).forEach(n=>{t[n]=C(_({},e[n]),{level:0})});const n=(e,i=new Set)=>{if(i.has(e.id))return 0;if(e.level>0||null===e.parent_id)return e.level;i.add(e.id);const a=t[e.parent_id];return e.level=a?n(a,new Set(i))+1:0,e.level};return Object.values(t).forEach(e=>{null===e.parent_id?e.level=0:n(e)}),t},ET=e=>{const t={},n=new URLSearchParams(window.location.search);for(const[i,a]of n.entries())t[i]=a;return t[e]||""},kT=(e,t,n="Operation timeout")=>Promise.race([e,new Promise((e,i)=>{setTimeout(()=>i(new Error(n)),t)})]);function IT(e){const t=new Date(e),n=yE.getState().language;if(isNaN(t.getTime()))throw new Error("Invalid timestamp");const i=new Date,a=new Date(i.getFullYear(),i.getMonth(),i.getDate()),o=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(a.getTime()===o.getTime())return"Today";if(t.getFullYear()===i.getFullYear())return new Intl.DateTimeFormat(n,{month:"short",day:"numeric"}).format(t);return`${t.getFullYear()} ${new Intl.DateTimeFormat(n,{month:"short",day:"numeric"}).format(t)}`}const TT=()=>"true"===localStorage.getItem(Vf),jT=O.createContext(null),NT={didCatch:!1,error:null};class PT extends O.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=NT}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(...e){var t,n;const{error:i}=this.state;null!==i&&(null==(n=(t=this.props).onReset)||n.call(t,{args:e,reason:"imperative-api"}),this.setState(NT))}componentDidCatch(e,t){var n,i;null==(i=(n=this.props).onError)||i.call(n,e,t)}componentDidUpdate(e,t){var n,i;const{didCatch:a}=this.state,{resetKeys:o}=this.props;a&&null!==t.error&&function(e=[],t=[]){return e.length!==t.length||e.some((e,n)=>!Object.is(e,t[n]))}(e.resetKeys,o)&&(null==(i=(n=this.props).onReset)||i.call(n,{next:o,prev:e.resetKeys,reason:"keys"}),this.setState(NT))}render(){const{children:e,fallbackRender:t,FallbackComponent:n,fallback:i}=this.props,{didCatch:a,error:o}=this.state;let s=e;if(a){const e={error:o,resetErrorBoundary:this.resetErrorBoundary};if("function"==typeof t)s=t(e);else if(n)s=O.createElement(n,e);else{if(void 0===i)throw o;s=i}}return O.createElement(jT.Provider,{value:{didCatch:a,error:o,resetErrorBoundary:this.resetErrorBoundary}},s)}}const MT=e=>{const[t,n]=O.useState("");return tn.jsx(PT,{fallback:tn.jsx("div",{className:"error-boundary-content",children:tn.jsxs("div",{className:"error-boundary-tip",children:[tn.jsx("img",{className:"error-boundary-icon",src:"https://img.alicdn.com/imgextra/i3/O1CN01xUtwzH1r8tvR6MPA4_!!6000000005587-2-tps-160-160.png",alt:""}),tn.jsx("div",{className:"error-boundary-tip-text",children:Uf().t("Oops! Something unexpected happened.")}),tn.jsx("div",{className:"error-boundary-tip-des",children:Uf().t("Try refreshing, and if the issue persists, please contact support.")}),tn.jsx("div",{className:"error-boundary-tip-des error-boundary-tip-key",children:Uf().t("Failure code: {{code}}",{code:t})}),tn.jsx("div",{className:"error-boundary-tip-button",onClick:()=>{window.location.replace(window.location.origin)},children:Uf().t("Refresh")})]})}),onError:(e,t)=>{const i=Date.now().toString();n(i),BS("sendErrorBoundary",{params:{et:"OTHER",c5:i,c6:e.toString(),c7:t.componentStack||"",c8:(null==e?void 0:e.stack)||""}})},children:e.children})},AT=({children:e})=>{const[t,n]=O.useState(!1),i=$y(void 0,!1);return O.useEffect(()=>{(()=>{const e=document.getElementById("low-version-browser");i&&e?(e.remove(),n(!0)):!i&&e&&(e.style.display="flex",_T(),n(!0))})()},[i]),t&&i?tn.jsx(MT,{children:e}):null},RT=()=>{const{setMobile:e}=tx(),t=iy(),n=O.useCallback(()=>{const n=px();if("undefined"!=typeof window&&window.location){const e=window.location.pathname,i=n||window.innerWidth<768,a=["/settings/model","/settings/account","/settings/about","/settings/voice","/settings/voice/clone","/settings/voice/design","/settings/change-password","/settings/personalization","/settings/personalization/memory","/settings/personalization/custom-instr"],o=["/settings/voice"];if(i&&e.includes("/settings/")&&!a.includes(e)){const n=e.replace(/\/settings\/.+/,"/settings");t(n)}else i||"/settings"!==e&&!o.includes(e)||t("/settings/general")}(e=>{e?document.documentElement.classList.add("mobile"):document.documentElement.classList.remove("mobile"),bx()&&document.documentElement.classList.add("native");const t=["iPad"].includes(ux()),n=["tablet"].includes(ux());t||n?document.documentElement.classList.add("is-tablet"):document.documentElement.classList.remove("is-tablet")})(n),e(n)},[t,e]);return O.useEffect(()=>(n(),window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}),[]),{onResizeHandler:n}},OT=[{key:"both",label:"All"},{key:"male",label:"Male"},{key:"female",label:"Female"}],DT=[{code:"en-US",title:"English"},{code:"ar-BH",title:""},{code:"de-DE",title:"Deutsch"},{code:"es-ES",title:"Espaol"},{code:"fr-FR",title:"France"},{code:"hi-IN",title:""},{code:"it-IT",title:"Italiano"},{code:"ja-JP",title:""},{code:"ko-KR",title:""},{code:"pt-PT",title:"Portugal"},{code:"ru-RU",title:"Russia"},{code:"th-TH",title:""},{code:"zh-CN",title:""},{code:"zh-TW",title:""},{code:"zh-Dialect",title:"-"}],LT=(e=!1,t="light")=>"dark"===t?e?"https://img.alicdn.com/imgextra/i2/O1CN01J8AmJN1cZGSJ5xFjV_!!6000000003614-54-tps-60-60.apng":"https://img.alicdn.com/imgextra/i1/O1CN01lSOiPA1VfwvV2cZw6_!!6000000002681-54-tps-60-60.apng":"light"===t?e?"https://img.alicdn.com/imgextra/i4/O1CN01Jwyf191eaIa5xowFe_!!6000000003887-54-tps-60-60.apng":"https://img.alicdn.com/imgextra/i1/O1CN01pNHavt1CykU9z9sPI_!!6000000000150-54-tps-60-60.apng":void 0,FT=(e,t={genders:"both",languages:""})=>e.filter(e=>!!e.urls.some(e=>e.language===t.languages)&&("both"===t.genders||e.gender===t.genders)).sort((e,n)=>{var i,a;return((null==(i=n.urls.find(e=>e.language===t.languages))?void 0:i.sort)||0)-((null==(a=e.urls.find(e=>e.language===t.languages))?void 0:a.sort)||0)}),UT=e=>{const t=e.reduce((e,t)=>Array.from(new Set([...e,...t.urls.map(e=>e.language)])),[]);return DT.filter(e=>t.includes(e.code))},zT=(e,t,n="en-US")=>UT(e).map(e=>e.code).includes(t)?t:n,HT=[{key:"female",label:"Female"},{key:"male",label:"Male"},{key:"myVoice",label:"My Voice"}],$T=[{key:"both",label:"All"},{key:"male",label:"Male"},{key:"female",label:"Female"}],BT=[{code:"en-US",title:"English"},{code:"ar-BH",title:""},{code:"de-DE",title:"Deutsch"},{code:"es-ES",title:"Espaol"},{code:"fr-FR",title:"France"},{code:"hi-IN",title:""},{code:"it-IT",title:"Italiano"},{code:"ja-JP",title:""},{code:"ko-KR",title:""},{code:"pt-PT",title:"Portugal"},{code:"ru-RU",title:"Russia"},{code:"th-TH",title:""},{code:"zh-CN",title:""},{code:"zh-TW",title:""},{code:"zh-Dialect",title:"-"}],qT=(e=!1,t="light")=>"dark"===t?e?"https://img.alicdn.com/imgextra/i2/O1CN01J8AmJN1cZGSJ5xFjV_!!6000000003614-54-tps-60-60.apng":"https://img.alicdn.com/imgextra/i1/O1CN01lSOiPA1VfwvV2cZw6_!!6000000002681-54-tps-60-60.apng":"light"===t?e?"https://img.alicdn.com/imgextra/i4/O1CN01Jwyf191eaIa5xowFe_!!6000000003887-54-tps-60-60.apng":"https://img.alicdn.com/imgextra/i1/O1CN01pNHavt1CykU9z9sPI_!!6000000000150-54-tps-60-60.apng":void 0,GT=(e=[],t={genders:"both",languages:""})=>e.filter(e=>!!e.urls.some(e=>e.language===t.languages)&&("both"===t.genders||e.gender===t.genders)).sort((e,n)=>{var i,a;return((null==(i=n.urls.find(e=>e.language===t.languages))?void 0:i.sort)||0)-((null==(a=e.urls.find(e=>e.language===t.languages))?void 0:a.sort)||0)}),VT=e=>{const t=e.reduce((e,t)=>Array.from(new Set([...e,...t.urls.map(e=>e.language)])),[]);return BT.filter(e=>t.includes(e.code))},WT=(e,t,n="en-US")=>VT(e).map(e=>e.code).includes(t)?t:n;let QT=null;const KT={navigate:(e,t)=>{QT&&QT(e,t)}},YT=({filesManager:e,appLayoutEmit:t})=>{const n=G(),i=tx(e=>e.mobile),a=rT(e=>e.setFiles),o=aI(e=>e.models),s=aI(e=>e.selectedModelIds),r=aI(e=>e.setSelectedModelIds),l=cT(e=>e.setSettings),c=cT(e=>e.updateModelConfig),u=Wb(e=>e.history),d=rT(e=>e.setVisionSize),h=rT(e=>e.setInputValue),p=Zb(e=>e.setResearchMode),m=Zb(e=>e.setThinkingEnabled),f=Zb(e=>e.setThinkingMode),g=new URLSearchParams(window.location.search),v=g.get("shareId"),y=g.get("lang"),b=iy(),[x,w]=O.useState({visible:!1}),S=O.useCallback(e=>P(void 0,null,function*(){var t;const{messageList:n=[],context:i,parentId:a}=e;let o=e.chat_type,s=e.sub_chat_type;if(o===Zf.ImageEdit&&s===Zf.ImageEdit&&(o=Zf.ImageGeneration,s=Zf.ImageGeneration),!jt(i)&&n.length){let e=a,r=i;if(o===Zf.DeepResearch&&s===Zf.INTERRUPT){const i=WE(n,"user"),a=n.slice(0,i);r=a.reduce((e,t)=>C(_({},e),{[t.id]:t}),{}),e=null==(t=a[a.length-1])?void 0:t.id,s=Zf.DeepResearch}const l={shareId:v,currentId:e,messages:Object.fromEntries(Object.entries(r).map(([e,t])=>[e,C(_({},t),{isShare:!0,fid:e})])),currentResponseIds:[e],chatType:o,subChatType:s};oT.createShareChat(l),oT.shareHistory=l,Promise.resolve().then(()=>{XC.emit(BC.CHAT_HISTORY_LOADED)})}else{const e={shareId:v,chatType:o,subChatType:s};oT.shareHistory=e}}),[v]),E=O.useCallback((e,t,n)=>{const i=aI.getState().models,a=aI.getState().selectedModelIds,{availableModelId:o,availableModelName:s}=(e=>{var t,n,i;const{modelName:a="",selectedModels:o=[],chatType:s,models:r=[],thinking:l}=e,c=r.find(e=>e.name===a),u=o.map(e=>{const{name:t}=r.find(t=>t.id===e)||{};return t});if(u.includes(a)||c){if(!l)return{availableModelId:(null==c?void 0:c.id)||o[0],availableModelName:(null==c?void 0:c.name)||u[0]||""};if(null==(i=null==(n=null==(t=null==c?void 0:c.info)?void 0:t.meta)?void 0:n.capabilities)?void 0:i.thinking)return{availableModelId:c.id,availableModelName:c.name}}const d=r.find(e=>{var t,n,i,a,o,r;return l?(null==(n=null==(t=e.info)?void 0:t.meta.chat_type)?void 0:n.includes(s))&&(null==(a=null==(i=e.info)?void 0:i.meta.capabilities)?void 0:a.thinking):null==(r=null==(o=e.info)?void 0:o.meta.chat_type)?void 0:r.includes(s)});return{availableModelId:(null==d?void 0:d.id)||r[0].id,availableModelName:(null==d?void 0:d.name)||r[0].name}})({modelName:e,selectedModels:a,models:i,chatType:t,thinking:n});return r([o]),w({visible:s!==e,type:"model"}),o},[r]),k=O.useCallback((e,t)=>{var n,i,a,o,s,r;const{shareMessage:l,sharedContent:c}=t;if(e===Zf.ImageGeneration){const[e,t]=(null==(o=null==(a=null==(i=null==(n=null==l?void 0:l.content_list)?void 0:n[0])?void 0:i.extra)?void 0:a.output_image_hw)?void 0:o[0])||[];let s=rg["1:1"];Object.values(rg).forEach(n=>{const[i,a]=n.split(":");Math.abs(Number(t)/Number(e)-Number(i)/Number(a))<.1&&(s=n)}),d(s)}else if(e===Zf.VideoGeneration){const e=`${(null==(s=null==c?void 0:c[0])?void 0:s.size[0])||16}:${(null==(r=null==c?void 0:c[0])?void 0:r.size[1])||9}`;d(e)}},[d]),I=O.useCallback(t=>{const n=[...t||[]].map(e=>{var t,n,i,a;if("image"===e.showType){const o=null==(i=null==(n=null==(t=e.url.split("?"))?void 0:t[0])?void 0:n.split("/"))?void 0:i.at(-1);e.name=e.name||o,e.file_type=e.file_type||`image/${null==(a=o.split("."))?void 0:a.at(-1)}`}return e});null==e||e.pushFile(n),a([...n])},[e,a]),T=O.useCallback((e,t,n)=>{const i=![Zf.DeepResearch,Zf.Podcast,Zf.DeepResearchWebDev].includes(n)&&(null==e?void 0:e.thinking_enabled);m(i),(null==e?void 0:e.auto_thinking)?f("Auto"):f(i?"Thinking":"Fast"),(null==e?void 0:e.thinking_enabled)&&(bT()?c({[t]:{thinking_budget:e.thinking_budget}}):l({model_config:{[t]:{thinking_budget:e.thinking_budget}}})),"advance"===(null==e?void 0:e.research_mode)&&p("advance")},[p,l,m,c]),j=O.useCallback(e=>{const{chat_type:t,sub_chat_type:n,messageList:i,content:a,files:o}=e;if(t===Zf.DeepResearch&&n===Zf.INTERRUPT){const e=WE(i,"user"),t=null==i?void 0:i[e];null==h||h((null==t?void 0:t.content)||""),I(null==t?void 0:t.files)}else null==h||h(a),I(o)},[I,h]),N=O.useCallback((e,t)=>{t===Zf.Image2Video?t=Zf.VideoGeneration:t===Zf.INTERRUPT?t=Zf.DeepResearch:t===Zf.ImageEdit&&(t=Zf.ImageGeneration),e===Zf.Image2Video?e=Zf.VideoGeneration:e===Zf.ImageEdit&&(e=Zf.ImageGeneration),oT.emit(YC.MESSAGE_INPUT_RECOMMEND_WORDS_CLICK,{suggestItem:{chatType:e,subChatType:t},active:e!==Zf.Txt2Txt})},[]),M=O.useCallback(e=>{bx()&&oT.adapter.invoke({method:"setSendButtonEnabled",params:{value:e}})},[]),A=O.useCallback(()=>P(void 0,null,function*(){var e,t,n,i,a,o,s,r;if(!u.currentId&&v){M(!1);try{const c=yield(l={shareId:v},P(void 0,null,function*(){return yield zx(),yield Ox(`/community/share/${l.shareId}`,{toast:!1})}));if((null==c?void 0:c.success)&&!(null==c?void 0:c.data))return(()=>{const e=new URL(window.location.href),t=e.origin+e.pathname;window.history.replaceState({},document.title,t)})(),void w({visible:!0,type:"deleted"});if(bx()&&!jt(null==(e=null==c?void 0:c.data)?void 0:e.context)&&"/"===location.pathname)return void b(`/c/new-chat?shareId=${v}&lang=${y}`);if(c.success&&c.data){const e=(null==(t=null==c?void 0:c.data)?void 0:t.shared_message)||{},l=(null==(n=null==c?void 0:c.data)?void 0:n.shared_content)||{},{chat_type:u,sub_chat_type:d,files:h,content:p="",parentId:m,feature_config:f={},id:g}=(null==(i=null==c?void 0:c.data)?void 0:i.last_user_message)||{};let v=[];if(jt(null==(a=null==c?void 0:c.data)?void 0:a.context)||(v=sC(null==e?void 0:e.id,{messages:C(_({},null==(o=null==c?void 0:c.data)?void 0:o.context),{[g]:null==(s=null==c?void 0:c.data)?void 0:s.last_user_message,[e.id]:e})})),yield S({messageList:v,context:null==(r=null==c?void 0:c.data)?void 0:r.context,parentId:m,chat_type:u,sub_chat_type:d}),bx())return;j({chat_type:u,sub_chat_type:d,messageList:v,content:p,files:h});const y=E(e.modelName,u,!!f.thinking_enabled);N(u,d),T(f,y,d),k(u,{shareMessage:e,sharedContent:l})}}catch(c){}finally{M(!0),_T()}var l}else M(!0)}),[u.currentId,v,M,b,y,S,j,E,N,T,k]),R=O.useMemo(()=>{var e;return tn.jsxs(ht,{visible:x.visible,title:n.t("Tips"),onCancel:()=>w({visible:!1}),headerBorderNone:!0,maskClosable:!0,closable:!i,type:"confirm",actions:[{text:n.t("Got it"),type:i?"brandprimary":"tertiary",rounded:"circle",onClick:()=>w({visible:!1})}],children:["model"===(null==x?void 0:x.type)?n.t("The model originally used to generate this work is no longer available. Weve automatically switched you to: {{modelName}}.",{modelName:null==(e=o.find(e=>e.id===s[0]))?void 0:e.name}):"","deleted"===(null==x?void 0:x.type)?n.t("This creations original full chat has been deleted and is no longer viewable."):""]})},[n,i,o,s,null==x?void 0:x.type,x.visible]);return O.useEffect(()=>{t&&!bx()||A()},[]),{renderTipsModels:R}},XT=()=>{var e;const t=tx(e=>e.setConfig),n=tx(e=>e.config),i=dT(e=>e.setAudioTTSSpeakers),a=dT(e=>e.setTTSAudioTTSSpeakers),o=xE(e=>e.fetchUser),s=tx(e=>e.mobile),r=cT(e=>e.getSettings),l=xE(e=>e.user),c=iy(),u=O.useRef(!1),d=aI(e=>e.getModels),h=yE(e=>e.setTheme),p=yE(e=>e.setLanguage),m=cT(e=>e.settings)||{},f=cT(e=>e.updateLocalUiSettings),{i18n:g}=G(),[v]=Ay(),y=yE(e=>e.isSharePage),{ui:b}=m,x=null==b?void 0:b.theme,w=null!=(e=null==b?void 0:b.language)?e:g.language;let S=!1;const _=v.get("shareId");YT({appLayoutEmit:!0}),O.useEffect(()=>{QT=c},[c]);const[C,E]=O.useState(!1);RT();O.useEffect(()=>{const e=sI("theme");x&&!e&&(h(x),NC(x))},[x,h]);const k=O.useCallback(()=>{const e=$y(void 0,s),t=document.getElementById("low-version-browser");e&&(null==t||t.remove()),!e&&t&&(t.style.display="flex",_T(),E(!0))},[s]),I=O.useCallback(e=>P(void 0,null,function*(){var t,n,o,s,r,l;try{const{data:{audio_tts_speakers:t}}=yield(l=e,P(void 0,null,function*(){return yield Ox("/configs/",{headers:{"Accept-Language":`${l},${l.split("-")[0]};q=0.9`}})}));i(t)}catch(c){}try{const{data:{audio_tts_speakers:i}}=yield(e=>P(void 0,null,function*(){return yield Ox("/tts/config",{headers:{"Accept-Language":`${e},${e.split("-")[0]};q=0.9`}})}))(e);if(a(i),bT()||"pending"===(null==(t=xE.getState().user)?void 0:t.role)||0===(null==i?void 0:i.length))return;const l=FT(i||[],{languages:WT(i,e),genders:"female"});if(0===l.length)return;if(""===(null==(n=null==m?void 0:m.tts_speaker_v2)?void 0:n.speaker)){const e=l[0];(null==m?void 0:m.tts_speaker_v2)&&i.every(e=>{var t;return e.speaker!==(null==(t=m.tts_speaker_v2)?void 0:t.speaker)})?(null==(o=null==m?void 0:m.tts_speaker_v2)?void 0:o.is_personal)||oT.onUpdateVoice(e.speaker):((null==m?void 0:m.tts_speaker_v2)||(null==(s=null==m?void 0:m.tts_speaker_v2)?void 0:s.is_personal))&&(null==(r=m.tts_speaker_v2)?void 0:r.speaker)||oT.onUpdateVoice(e.speaker)}}catch(c){}}),[i,a,m.tts_speaker_v2]);O.useEffect(()=>{void 0!==b.language&&null!==b.language&&P(void 0,null,function*(){const e=v.get("lang"),t=yield av(),i=(null==n?void 0:n.default_locale)||"en-US";let a="";if(e)a=tv(t,[e],i);else if(w)fx()||(a=w);else if(localStorage.getItem("locale"))a=localStorage.getItem("locale");else{const e=navigator.languages||[navigator.language||navigator.userLanguage];a=tv(t,e,i)}g.changeLanguage(a),p(a),I(a)}),bx()&&localStorage.locale&&""===b.language&&f({language:localStorage.locale})},[b.language]),O.useEffect(()=>{bx()&&localStorage.theme&&(NC(localStorage.theme),f({theme:localStorage.theme}))},[f]);O.useEffect(()=>{u.current&&qS(null==l?void 0:l.id)},[location.pathname]);const T=["/auth","/reset","/s/","/legal-agreement/terms-of-service","/legal-agreement/privacy-policy","/legal-agreement/usage-policy","/legal-agreement/contact-us","/legal-agreement/models","/legal-agreement/about","/mobile/chatcontrols/"],j=O.useCallback(()=>P(void 0,null,function*(){var e;const t=yield o(!1);if(S)return void c("/auth");if(!t){if(!l){if(!T.some(e=>location.pathname.startsWith(e))&&"/"!==location.pathname){if(_)return;c("/",{replace:!0})}return}return location.pathname.length>=36&&!y?void c("/c/guest"):(null==(e=oT.adapter)||e.clearCookie(Kf.SETAPP),void(fx()?oT.adapter.routeTologin():c("/auth")))}if("user"!==t.role)return;yield r(),yield d(),Nk.subscribePolling(),fx()&&oT.adapter.saveCookie(localStorage.token,Kf.SETAPP),bx()&&oT.adapter.invoke({method:"storeInfo",params:{key:rI("chatNativeToken"),value:JSON.stringify({token:localStorage.token}),needPersist:!0}});const n=t.id;n&&(HS("setUid",{params:{et:"OTHER",c1:n}}),Object.defineProperty(window,"userId",{value:n,writable:!0})),fx()||bx()||(yield P(void 0,null,function*(){const e=new URLSearchParams(window.location.search).get("temporary-chat");bT()||"true"!==e||(yield oT.updateTemporaryChat(!0))}))}),[o,l,y,c]),N=()=>P(void 0,null,function*(){var e;(()=>{const e=sI("qsrc");e&&HS("reportingSource",{params:{et:"OTHER",c2:e}})})();const n=sI("theme");NC(null!=(e=null!=n?n:null==localStorage?void 0:localStorage.theme)?e:"system");if(!(yield P(void 0,null,function*(){let e=null;try{const{data:t}=(yield Jw())||{};e=t}catch(n){e=null}return e?(t(e),kE(),!0):(c("/error"),!1)})))return;yield P(void 0,null,function*(){var e;let t=yT();if(bx()){let i={};try{(null==window?void 0:window.QwenChat)||(yield wT(1e3));let t={};kx("1.2.10")||(t=yield oT.adapter.invoke({method:"getStoredInfo",params:{key:"chatNativeToken"}})),i=JSON.parse(null==(e=null==t?void 0:t.result)?void 0:e.value)}catch(n){}t=vT("token")||(null==i?void 0:i.token),localStorage.token=t||""}return t}),d(),yield j(),u.current=!0,qS(null==l?void 0:l.id);new URLSearchParams(window.location.search).get("shareId")||_T(),E(!0),P(void 0,null,function*(){var e;zy().then(e=>{e.isPrivate&&tx.getState().setIsDisableGuestAccess(!0)}),fx()&&(document.body.style.setProperty("padding-top",Cx()),document.body.style.setProperty("padding-bottom",Ex()),document.getElementById("splash-screen")||(oT.adapter.invoke({method:"onPageReady"}),oT.adapter.resetNativeState())),wx()&&(null==(e=window.electronAPI)||e.on_event("set_cookie",e=>P(void 0,null,function*(){e&&(localStorage.token=e),window.location.replace("/")})))})});return O.useEffect(()=>(S="/c/guest"===location.pathname,k(),zx(),N(),(()=>{if(new URLSearchParams(window.location.search).get("shareId")){const e=document.getElementById("logo-description"),t=g.t("Preparing to customize the creation...");e&&t&&(e.innerText=g.t("Preparing to customize the creation..."))}})(),()=>{var e;null==(e=window.electronAPI)||e.on_event(void 0),nT.destroyInstance()}),[]),O.useEffect(()=>{w&&!(null==l?void 0:l.id)&&I(w)},[I,w,null==l?void 0:l.id]),tn.jsx(AT,{children:C&&tn.jsx("div",{className:"app",children:tn.jsx(gy,{})})})},JT=e=>Symbol.iterator in e,ZT=e=>"entries"in e,ej=(e,t)=>{const n=e instanceof Map?e:new Map(e.entries()),i=t instanceof Map?t:new Map(t.entries());if(n.size!==i.size)return!1;for(const[a,o]of n)if(!i.has(a)||!Object.is(o,i.get(a)))return!1;return!0};function tj(e,t){return!!Object.is(e,t)||"object"==typeof e&&null!==e&&"object"==typeof t&&null!==t&&(Object.getPrototypeOf(e)===Object.getPrototypeOf(t)&&(JT(e)&&JT(t)?ZT(e)&&ZT(t)?ej(e,t):((e,t)=>{const n=e[Symbol.iterator](),i=t[Symbol.iterator]();let a=n.next(),o=i.next();for(;!a.done&&!o.done;){if(!Object.is(a.value,o.value))return!1;a=n.next(),o=i.next()}return!!a.done&&!!o.done})(e,t):ej({entries:()=>Object.entries(e)},{entries:()=>Object.entries(t)})))}function nj(e){const t=H.useRef(void 0);return n=>{const i=e(n);return tj(t.current,i)?t.current:t.current=i}}const ij=({className:e="size-5",color:t="currentColor",style:n,containerClassName:i=""})=>tn.jsx("div",{className:i,style:n,children:tn.jsxs("svg",{className:J("circle-spinner",e),viewBox:"0 0 24 24",fill:t,xmlns:"http://www.w3.org/2000/svg",children:[tn.jsx("path",{d:"M12,1A11,11,0,1,0,23,12,11,11,0,0,0,12,1Zm0,19a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z",opacity:".25",fill:t}),tn.jsx("path",{d:"M10.14,1.16a11,11,0,0,0-9,8.92A1.59,1.59,0,0,0,2.46,12,1.52,1.52,0,0,0,4.11,10.7a8,8,0,0,1,6.66-6.61A1.42,1.42,0,0,0,12,2.69h0A1.57,1.57,0,0,0,10.14,1.16Z",className:"spinner_ajPY",fill:t})]})}),aj="index-module__model-selector-loading___mkq-P",oj="index-module__model-selector-loading-text___Klahu",sj=()=>{const e=G();return tn.jsxs(Z,{className:aj,align:"center",gap:8,children:[tn.jsx(ij,{containerClassName:"spinner"}),tn.jsx("div",{className:oj,children:e.t("Model loading...")})]})},rj=O.memo(({showRegister:e=!1,size:t="small",rounded:n,buttonClass:i})=>{const{t:a}=G();return tn.jsxs(Z,{className:"auth-buttons",align:"center",gap:8,children:[tn.jsx(Ty,{to:"/auth",onClick:e=>{wx()&&(e.preventDefault(),oT.adapter.openWindow(`${window.location.origin}/auth?callback=qwen://open`)),BS("clkLogOn",{params:{et:"CLK"}})},children:tn.jsx(pt,{size:t,rounded:n,buttonClass:i,children:a("Log in")})}),e&&tn.jsx(Ty,{to:"/auth?mode=register",onClick:e=>{wx()&&(e.preventDefault(),oT.adapter.openWindow(`${window.location.origin}/auth?mode=register&callback=qwen://open`)),BS("clkRegister",{params:{et:"CLK"}})},children:tn.jsx(pt,{type:"ghost",size:t,rounded:n,buttonClass:i,children:a("Sign up")})})]})}),lj=({equity:e,onUpdate:t})=>{const{i18n:n}=G(),i=tx(e=>e.mobile),a=CE(e=>e.subscriptionPlus);return tn.jsxs("div",{className:"qwen-chat-equity-message-content",children:[tn.jsx("div",{className:"qwen-chat-equity-message-text",children:gE({remains:null==e?void 0:e.remains,unit:null==e?void 0:e.unit,currentI18n:n})}),i&&!fx()&&!a&&tn.jsx("div",{className:"qwen-chat-equity-message-btn",onClick:t,children:n.t("Upgrade")})]})},cj=()=>{const e=yE(e=>e.setSettingActionMenuItemId),t=yE(e=>e.setCloseSubscriptionPopupToSetting),n=iy();return{updateEquityHandlerByMessage:O.useCallback(()=>P(void 0,null,function*(){X.destroy(),yield t(!1),yield e("subscription"),n("/settings")}),[n,t,e])}},uj="index-module__mobile-model-selector___-iaic",dj="index-module__model-selector-name___zc6Lm",hj="index-module__model-selector-plus___qJZrZ",pj="index-module__text___M-u73",mj="index-module__model-selector-icon___K91li",fj="index-module__mobile-model-selector-popup-wrapper___RJ8rs",gj="index-module__mobile-model-selector-popup___Qe6C-",vj="index-module__model-list___7F09n",yj="index-module__model-list-pb24___zQIso",bj="index-module__model-item___8rK-g",xj="index-module__model-item-name___admtE",wj="index-module__model-item-desc___hQkXJ",Sj="index-module__model-item-selected___V53cX",_j="index-module__model-list-view-more___zxWR7",Cj="index-module__auth-buttons___UJdJJ",Ej=({visibleModels:e})=>{var t,n;const i=G();iy();const{pathname:a}=ty(),o=CE(e=>e.subscriptionPlus),s=Wb(e=>e.projectId),r=tx(e=>e.mobile),l=aI(e=>e.isLoading),c=aI(e=>e.selectedModels),u=aI(e=>e.selectedModelIds),d=aI(e=>e.setSelectedModels),{updateEquityHandlerByMessage:h}=cj(),[p,m]=O.useState(!1),[f,g]=O.useState(!1),v=l||0===c.length;O.useMemo(()=>!a.includes("/p/")&&!s,[a,s]);const y=()=>{m(!1),g(!1)},b=e=>{if(u.includes(e.id))return;const{disabled:t,content:n}=(e=>{const t=TE.getState().getModelEquity(e);let n=!1,i="";return null!==t.remains&&0!==t.remains||(n=!0,i=tn.jsx(lj,{equity:t,onUpdate:h})),{disabled:n,content:i}})(e.id);t?ut.open({type:"warning",content:n,closable:o}):(d([e]),y())};return v?tn.jsx(sj,{}):tn.jsxs("div",{className:uj,children:[tn.jsxs(Z,{onClick:()=>{m(!0)},align:"center",gap:4,children:[tn.jsx("div",{className:dj,children:null==(t=c[0])?void 0:t.name}),r&&o&&tn.jsx("div",{className:hj,children:tn.jsx("div",{className:pj,children:"Plus"})}),tn.jsx(dt,{className:mj,type:"icon-fill-triangle-down-01"})]}),tn.jsxs(mt,{open:p,heightType:f?"full":"auto",onClose:y,leftFirstIcon:"icon-line-chevron-left-02",title:i.t("Models"),destroyOnHidden:!0,className:gj,style:{paddingBottom:Ex()},rootClassName:fj,children:[tn.jsxs(Z,{className:J(vj,{[yj]:f}),vertical:!0,gap:20,children:[null==(n=f?e:e.slice(0,3))?void 0:n.map(e=>{var t,n,a,o;return tn.jsxs(Z,{className:bj,gap:24,onClick:()=>b(e),children:[tn.jsxs(Z,{vertical:!0,gap:2,flex:1,children:[tn.jsx("div",{className:xj,children:e.name}),tn.jsx("div",{className:wj,children:(null==(n=null==(t=null==e?void 0:e.info)?void 0:t.meta)?void 0:n.short_description)?i.t(null==(o=null==(a=null==e?void 0:e.info)?void 0:a.meta)?void 0:o.short_description):i.t("No model description available")})]}),u.includes(e.id)&&tn.jsx(dt,{className:Sj,type:"icon-line-check-02"})]},e.id)}),!bT()&&!f&&tn.jsx(Z,{className:_j,onClick:()=>g(!0),children:i.t("Expand more models")})]}),bT()&&tn.jsx("div",{className:Cj,children:tn.jsx(rj,{rounded:"circle",size:"large",showRegister:!0})})]})]})},kj=({isPro:e=!1,showUpgrade:t=!1,showTopBorder:n=!1,onClick:i})=>{const a=G(),o=CE(e=>e.fetchPaymentSubscriptionInfo),s=CE(e=>e.paymentSubscriptionInfo),r=O.useMemo(()=>e?{title:a.t("Qwen Plus"),iconType:"icon-line-star-02",desc:null==s?void 0:s.plus.description}:{title:a.t("Qwen"),iconType:"icon-line-free",desc:null==s?void 0:s.normal.description},[a,e,null==s?void 0:s.normal.description,null==s?void 0:s.plus.description]);return O.useEffect(()=>{o()},[]),tn.jsxs("div",{className:J("chat-model-selector-pro-info",{"chat-model-selector-pro-info-top-border":n}),children:[tn.jsx("div",{className:"chat-model-selector-pro-info-avatar",children:tn.jsx(dt,{type:r.iconType,className:"chat-model-selector-pro-info-avatar-icon"})}),tn.jsxs("div",{className:"chat-model-selector-pro-info-middle",children:[tn.jsx("div",{className:"chat-model-selector-pro-info-title",children:r.title}),tn.jsx("div",{className:"chat-model-selector-pro-info-des",children:r.desc})]}),t&&tn.jsx(pt,{type:"tertiary",rounded:"circle",onClick:i,children:a.t("Upgrade")})]})},Ij=()=>{},Tj=O.createContext({open:!1,onOpenChange:Ij,battle:!1,onBattleChange:Ij,disabledBattle:!1}),jj={modelIntro:"index-module__model-intro___Jg3XY",introText:"index-module__intro-text___qZWCH",introIcon:"index-module__intro-icon___wumYu",battleText:"index-module__battle-text___gRTDg"},Nj=()=>{const e=G(),t=iy(),n=tx(e=>e.mobile),{battle:i,onBattleChange:a,disabledBattle:o}=O.useContext(Tj);return tn.jsxs(Z,{className:jj.modelIntro,align:"center",justify:"space-between",children:[tn.jsxs(Z,{className:jj.intro,gap:4,children:[tn.jsx("div",{className:jj.introText,children:e.t("Model")}),!bT()&&tn.jsx(ft,{title:!n&&e.t("Model description"),children:tn.jsx(dt,{className:jj.introIcon,type:"icon-line-information-circle",onClick:()=>{t("/settings/model")}})})]}),!bT()&&tn.jsx(ft,{title:o&&e.t("Model comparison is not supported under the current settings"),children:tn.jsxs(Z,{className:jj.battle,gap:8,align:"center",children:[tn.jsx("div",{className:jj.battleText,children:e.t("Model Comparison")}),tn.jsx(gt,{disabled:o,checked:i,onChange:a})]})})]})},Pj="index-module__model-list___-NnN5",Mj="index-module__model-item___MkLlj",Aj="index-module__model-item-not-allowed___nYbxz",Rj="index-module__model-item-selected___0WMb1",Oj="index-module__model-item-name___X8Hec",Dj="index-module__model-set-default-icon-hidden___SzTEt",Lj="index-module__model-item-content___ydaoe",Fj="index-module__model-set-default-icon___Ibwo2",Uj="index-module__model-item-desc___sIEVp",zj="index-module__model-item-operation___nMq-D",Hj="index-module__radio___4fhLr",$j="index-module__checkbox___cSlSd",Bj=({models:e,className:t,renderSubscribePrefix:n})=>{const i=G(),a=aI(e=>e.selectedModelIds),o=aI(e=>e.selectedModels),s=aI(e=>e.setSelectedModels),r=cT(e=>{var t,n;return null==(n=null==(t=e.settings)?void 0:t.ui)?void 0:n.models}),l=cT(e=>e.updateQwenChatSettings),{battle:c,onOpenChange:u}=O.useContext(Tj);Zb(e=>e.thinkingEnabled),rT(e=>e.setShowDetail);const d=rT(e=>e.updateFeatureType),h=Wb(e=>e.currentInputFeature),p=e=>{if(c)if(a.includes(e.id)){const t=o.filter(t=>(null==t?void 0:t.id)!==e.id);0!==t.length&&s(t)}else{[...o,e].length<=3&&s([...o,e])}else(e=>{var t,n;h===Zf.WebSearch&&(null==(n=null==(t=null==e?void 0:e.info)?void 0:t.meta)?void 0:n.auto_search)&&d({chatType:Zf.Txt2Txt,subChatType:Zf.Txt2Txt})})(e),s([e]);c||u(!1)};return tn.jsx("div",{className:J(Pj,t),children:null==e?void 0:e.map((e,t)=>{var s,u,d,h;const m=a.includes(e.id),f=!!c&&(!m&&o.length>=3),g=null==r?void 0:r.includes(e.id);return tn.jsxs(Z,{className:J(Mj,{[Rj]:m,[Aj]:f}),align:"center",gap:8,onClick:()=>p(e),children:[null==n?void 0:n(0===t),tn.jsxs(Z,{flex:1,vertical:!0,className:Lj,children:[tn.jsxs(Z,{className:Oj,gap:8,align:"center",children:[tn.jsx("span",{children:e.name}),tn.jsx(ft,{title:g?i.t("Cancel default"):i.t("Set as default"),children:tn.jsx(dt,{className:J(Fj,{[Dj]:!g}),type:g?"icon-fill-pin-01":"icon-line-pin-01",onClick:t=>{var n,a;t.stopPropagation(),n=e.id,a=g?"remove":"add",P(void 0,null,function*(){"add"===a?(yield l({ui:{models:[n]}}),ut.open({type:"success",content:i.t("Default model updated"),closable:!1})):(yield l({ui:{models:void 0}}),ut.open({type:"success",closable:!1,content:i.t("The default model has been cleared.")}))})}})})]}),tn.jsx("div",{className:Uj,children:(null==(u=null==(s=null==e?void 0:e.info)?void 0:s.meta)?void 0:u.short_description)?i.t(null==(h=null==(d=null==e?void 0:e.info)?void 0:d.meta)?void 0:h.short_description):i.t("No model description available")})]}),tn.jsx("div",{className:zj,children:c?tn.jsx(vt,{className:$j,disabled:!m&&o.length>=3,checked:m,style:{},onChange:()=>p(e)}):m&&tn.jsx(dt,{className:Hj,type:"icon-line-check-02"})})]},e.id)})})},qj={modelSelectorText:"index-module__model-selector-text___XvWe0",modelSelectorIcon:"index-module__model-selector-icon___-po5j",subscribePrefix:"index-module__subscribe-prefix___O3z8I",subscribePrefixNobg:"index-module__subscribe-prefix-nobg___gpBRA",modelSelectorPopup:"index-module__model-selector-popup___TGWn8",modelSelectorPopupSecondary:"index-module__model-selector-popup-secondary___Ukrgv",moreModelList:"index-module__more-model-list___5IZ7S",viewMore:"index-module__view-more___iP0nb",viewMoreText:"index-module__view-more-text___DlmZJ",viewMoreIcon:"index-module__view-more-icon___45kdG",divider:"index-module__divider___fFhyz",upgradeSubscribe:"index-module__upgrade-subscribe___-q1Bl"},Gj=({disabled:e,visibleModels:t})=>{var n;const i=G(),a=aI(e=>e.isLoading),o=aI(e=>e.selectedModels),s=aI(e=>e.setSelectedModels),r=tx(e=>{var t,n;return null==(n=null==(t=null==e?void 0:e.config)?void 0:t.features)?void 0:n.enable_payment_and_quota}),l=tx(e=>{var t,n,i,a;return(null==(n=null==(t=null==e?void 0:e.config)?void 0:t.features)?void 0:n.enable_payment)&&(null==(a=null==(i=null==e?void 0:e.config)?void 0:i.features)?void 0:a.enable_payment_and_quota)}),c=CE(e=>e.subscriptionPlus),u=CE(e=>e.setShowSubscriptionDetail),d=O.useRef(null),[h,p]=O.useState(!1),[m,f]=O.useState(!1),g=a||0===o.length,v=(null==t?void 0:t.slice(0,3))||[],y=(null==t?void 0:t.slice(3))||[],b=e=>{e&&BS("clkSelectModelBtn",{params:{et:"CLK"}}),p(e)},x=e=>bT()||!r?null:e?tn.jsx("div",{className:qj.subscribePrefix,children:tn.jsx(dt,{type:"icon-line-free"})}):tn.jsx("div",{className:J(qj.subscribePrefix,qj.subscribePrefixNobg)});return O.useEffect(()=>{e?f(!1):h||f(o.length>1)},[e,o,h]),g?tn.jsx(sj,{}):tn.jsx(Tj.Provider,{value:{open:h,onOpenChange:b,battle:m,onBattleChange:e=>{!e&&o.length>1&&s([o[0]]),f(e)},disabledBattle:e},children:tn.jsx(yt,{open:h,onOpenChange:b,placement:"bottomLeft",menu:null,popupRender:()=>tn.jsxs("div",{className:qj.modelSelectorPopup,children:[tn.jsx(Nj,{}),tn.jsx(Bj,{models:v,renderSubscribePrefix:x}),bT()?tn.jsxs(tn.Fragment,{children:[tn.jsx("div",{className:qj.divider}),tn.jsx(rj,{showRegister:!0,size:"middle",rounded:"circle",buttonClass:qj.authButtons})]}):tn.jsxs(tn.Fragment,{children:[tn.jsx("div",{ref:d,style:{position:"relative"},children:tn.jsx(yt,{trigger:["hover"],menu:null,overlayStyle:{left:"100%",top:"0",right:"0",bottom:"0"},getPopupContainer:e=>e,popupRender:()=>tn.jsx("div",{className:J(qj.modelSelectorPopup,qj.modelSelectorPopupSecondary),children:tn.jsx(Bj,{models:y,className:qj.moreModelList})}),children:tn.jsxs(Z,{className:qj.viewMore,align:"center",justify:"space-between",gap:8,children:[x(!1),tn.jsx(Z,{className:qj.viewMoreText,flex:1,children:i.t("Expand more models")}),tn.jsx(dt,{className:qj.viewMoreIcon,type:"icon-line-chevron-right"})]})})}),l&&!c&&tn.jsxs("div",{className:qj.upgradeSubscribe,children:[tn.jsx("div",{className:qj.divider}),tn.jsx(kj,{isPro:!0,showUpgrade:!0,onClick:()=>{b(!1),u(!0)}})]})]})]}),children:tn.jsxs(Z,{className:qj.modelSelector,align:"center",gap:6,children:[tn.jsx("div",{className:qj.modelSelectorText,children:(null==o?void 0:o.length)>1?`${o.length} ${i.t("Models")}`:null==(n=o[0])?void 0:n.name}),tn.jsx(dt,{className:qj.modelSelectorIcon,type:"icon-line-chevron-down"})]})})})},Vj=()=>{const e=Wb(e=>e.currentInputFeature),t=aI(e=>e.visibleModels),{thinkingEnabled:n,mcpEnabled:i}=Zb(nj(e=>({thinkingEnabled:e.thinkingEnabled,mcpEnabled:e.mcpEnabled}))),a=tx(e=>e.mobile),{temporary:o,userRole:s}=xE(nj(e=>{var t,n,i,a;return{temporary:null==(i=null==(n=null==(t=e.user)?void 0:t.permissions)?void 0:n.chat)?void 0:i.temporary,userRole:null==(a=e.user)?void 0:a.role}})),r="user"!==s||(null==o||o);return a?tn.jsx(Ej,{visibleModels:t,disabled:e!==Zf.Txt2Txt||n||i,showTemporaryChatControl:r}):tn.jsx(Gj,{visibleModels:t,disabled:e!==Zf.Txt2Txt||n||i,showTemporaryChatControl:r})},Wj=({isShow:e,children:t,title:n})=>{const i=tx(e=>e.mobile);return(null!=e?e:!i)?tn.jsx(ft,{title:n,children:t}):tn.jsx(tn.Fragment,{children:t})},Qj=()=>{const{t:e}=G(),t=xx(),n=rT(e=>e.setMobileRecommendDetailVisible);return tn.jsx("div",{onClick:()=>{t&&"/"!==window.location.pathname&&n(!1),oT.openNewChat(),BS("clkCreateChat",{params:{et:"CLK"}})},className:"new-chat",children:tn.jsx(Wj,{title:e("New Chat"),children:tn.jsx(dt,{type:t?"icon-line-message-alert-plus":"icon-line-edit-contained"})})})},Kj=({isSetting:e=!1})=>{const t=tx(e=>e.mobile),n=yE(e=>e.showSidebar),i=yE(e=>e.setShowSidebar),a=yE(e=>e.setUserActiveSidebar),o=yE(e=>e.setSettingSidebar),s=yE(e=>e.showSettingSidebar);return bT()||!e&&n?null:tn.jsx("div",{id:qf.SIDEBAR_TOGGLE_BUTTON,className:"sidebar-toggle-button",onClick:()=>{e?o(!s):(i(!n),a(!0))},children:tn.jsx(dt,{type:t?"icon-line-menu-04":"icon-line-sidePanel",className:"sidebar-toggle-icon"})})},Yj=e=>{const{chatId:t,show:n,onClose:i}=e,a=G(),[o,s]=O.useState(null),r=O.useRef(!1),l=tx(e=>e.mobile),c=Zb(e=>e.taskRunning),u=O.useCallback(()=>P(void 0,null,function*(){var e;let n;try{if(n=yield(o=t,P(void 0,null,function*(){return yield Ox(`/chats/${o}/share`,{method:"POST"})})),!n.success)return ut.open({type:"error",content:a.t(null==(e=n.data)?void 0:e.message)}),i(),""}catch(qY){}var o;if(!n)throw i(),new Error("sharedChat is null");const r=yield pS({chat_id:t});return s(r.data),`${window.location.origin}/s/${n.data.id}`}),[t,a,i]),d=O.useCallback(e=>!o||!!e&&((null==o?void 0:o.id)!==e.id||(null==o?void 0:o.share_id)!==e.share_id),[o]),h=O.useCallback(()=>P(void 0,null,function*(){if(c)return void ut.openOnce({type:"error",content:a.t("The current chat is not yet complete, please wait for a while and retry.")});if(r.current)return;r.current=!0;const e=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);try{if(dx()||e||rx())yield navigator.clipboard.write([new ClipboardItem({"text/plain":new Promise((e,n)=>P(void 0,null,function*(){try{let n=yield u();n+=`?${Ck}=${kk()}`,e(new Blob([n],{type:"text/plain"})),BS("clkShareCopyLink",{params:{et:"CLK",c6:n},paramsExtend:{chat_id:t}})}catch(i){n(i)}}))})]);else{let e=yield u();if(!e)return;e+=`?${Ck}=${kk()}`,BS("clkShareCopyLink",{params:{et:"CLK",c6:e},paramsExtend:{chat_id:t}}),setTimeout(()=>{C_(e)},0)}ut.open({type:"success",content:a.t("Copied shared chat URL to clipboard!")}),i()}catch(n){}r.current=!1}),[t,a,i,u,c]);return O.useEffect(()=>{P(void 0,null,function*(){if(t&&n){const e=yield pS({chat_id:t});d(e)&&s(e.data)}else s(null)})},[t,n]),o?l?tn.jsx(ht,{visible:n,header:!1,footer:!1,closable:!1,size:"small",maskClosable:!0,onCancel:i,children:tn.jsxs("div",{className:"mobile-share-modal",children:[tn.jsx("div",{className:"mobile-share-modal-title",children:a.t("Share Chat")}),tn.jsxs("div",{className:"mobile-share-modal-content",children:[tn.jsx("div",{className:"mobile-share-modal-content-main",children:(null==o?void 0:o.share_id)?tn.jsxs(tn.Fragment,{children:[fx()&&!kx("1.0.0")?tn.jsxs(tn.Fragment,{children:[a.t("You have shared this chat"),tn.jsx("span",{children:a.t("before")}),"."]}):tn.jsx(tn.Fragment,{children:tn.jsxs("a",{href:`/s/${o.share_id}`,target:"_blank",children:[a.t("You have shared this chat"),tn.jsxs("span",{children:[a.t("before"),"."]})]})}),a.t("Click here to"),tn.jsx("button",{onClick:()=>P(void 0,null,function*(){if(yield kS(t).catch(e=>(ut.open({type:"error",content:a.t(e.message)}),null))){const e=yield pS({chat_id:t});s(e.data)}}),children:a.t("delete this link")}),a.t("and create a new shared link.")]}):a.t("Messages you send after creating your link won't be shared. Users with the URL will be able to view the shared chat.")}),tn.jsx("div",{className:"mobile-share-modal-content-end",children:tn.jsx("div",{className:"mobile-share-modal-content-end-content",children:tn.jsx("div",{})})})]}),tn.jsxs("div",{className:"mobile-share-modal-footer",children:[tn.jsx(pt,{onClick:h,children:(null==o?void 0:o.share_id)?a.t("Update and Copy Link"):a.t("Copy Link")}),tn.jsx(pt,{type:"link",onClick:i,children:a.t("Cancel")})]})]})}):tn.jsx(ht,{className:"web-share-modal",size:"small",title:a.t("Share Chat"),onCancel:i,visible:n,headerBorderNone:!0,onOk:h,okText:o.share_id?a.t("Update and Copy Link"):a.t("Copy Link"),cancelButtonProps:{hidden:!0},okButtonProps:{iconFontType:"icon-Link1",iconFontStyle:{fontSize:12},type:"brandprimary",size:"middle",buttonStyle:{height:"36px"},rounded:"circle"},children:tn.jsx("div",{children:tn.jsx("div",{className:"share-modal-main",children:tn.jsx("div",{className:"share-modal-main-content",children:o.share_id?tn.jsxs(tn.Fragment,{children:[wx()?tn.jsxs("a",{className:"share-modal-main-conten-link",children:[a.t("You have shared this chat"),tn.jsx("span",{onClick:e=>Tx(e,`${window.location.origin}/s/${o.share_id}`),children:a.t("before")}),"."]}):tn.jsxs("a",{href:`/s/${o.share_id}`,className:"share-modal-main-conten-link",target:"_blank",children:[a.t("You have shared this chat"),tn.jsxs("span",{children:[a.t("before"),"."]})]}),a.t("Click here to"),tn.jsx("button",{onClick:()=>P(void 0,null,function*(){if(yield kS(t).catch(e=>(ut.open({type:"error",content:a.t(e.message)}),null))){const e=yield pS({chat_id:t});s(e.data)}}),children:a.t("delete this link")}),a.t("and create a new shared link.")]}):a.t("Messages you send after creating your link won't be shared. Users with the URL will be able to view the shared chat.")})})})}):null},Xj=()=>{const e=fT(e=>e.setOperationProjectFiles),t=fT(e=>e.setProjectArr),n=()=>P(void 0,null,function*(){try{const e=yield P(void 0,null,function*(){return yield Ox("/projects/")});if(e.success){const n=Array.isArray(null==e?void 0:e.data)?e.data:[];return t(n),n}return[]}catch(e){return[]}});return{getNewProjectList:n,getProjectFilesList:t=>P(void 0,null,function*(){try{const{data:i,success:a}=yield a_(t);if(!a)return void("Not_Found"===i.code&&n());if(!(null==i?void 0:i.files)||!Array.isArray(i.files))return;const o=i.files.map(e=>C(_({},e),{uploadStatus:"success"}));return yield e(o),o}catch(i){}}),getProjectChatList:(e,t=1)=>P(void 0,null,function*(){try{const{data:n,success:i}=yield o_(e,t);if(!i)return;return n}catch(n){}}),extractProjectId:e=>{const t=e.match(/^\/p\/([a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12})/i);return t?t[1]:null}}},Jj=()=>{const e=Wb(e=>e.currentChatPage),t=Zb(e=>e.setFolders),n=G(),i=tx(e=>{var t,n;return null==(n=null==(t=null==e?void 0:e.config)?void 0:t.features)?void 0:n.enable_project}),a=()=>P(void 0,null,function*(){const{data:e}=yield(t=i,P(void 0,null,function*(){return yield Ox("/folders/"+(t?"?exclude_project=true":""))}));var t;return e});return{getChatListData:e=>P(void 0,null,function*(){const{data:t}=yield uS({page:e,exclude_project:!0});return t||[]}),getAllTagsData:()=>P(void 0,null,function*(){const{data:e}=yield P(void 0,null,function*(){return yield zx(),yield Ox("/chats/all/tags")});return e}),getChatListBySearchTextData:(t,...n)=>P(void 0,[t,...n],function*(t,n=e){const{data:i}=yield hS({text:t,page:n});return i}),getPinnedChatListData:()=>P(void 0,null,function*(){const{data:e,success:t}=yield dS();return t?e:[]}),getFoldersData:a,initFolders:()=>P(void 0,null,function*(){const e=yield a().catch(e=>(ut.open({type:"error",content:n.t(e.message)}),[])),i={};for(const t of e)i[t.id]=_(_({},i[t.id]||{}),t);for(const t of e)t.parent_id&&(i[t.parent_id]||(i[t.parent_id]={}),i[t.parent_id].childrenIds=i[t.parent_id].childrenIds?[...i[t.parent_id].childrenIds,t.id]:[t.id],i[t.parent_id].childrenIds.sort((e,t)=>i[t].updated_at-i[e].updated_at));t(i)})}},Zj=e=>{const t=new URLSearchParams(e||"");return{icon:t.get("icon")||"",style:t.get("style")||""}},eN=({styleTop:e=0,styleLeft:t=0,isAdd:n=!1,chatId:i="",projectId:a,onClose:o=()=>{}})=>{const{i18n:s}=G(),r=iy(),{getNewProjectList:l,getProjectChatList:c}=Xj(),{getChatListData:u,initFolders:d,getPinnedChatListData:h}=Jj(),p=tx(e=>e.mobile),m=fT(e=>e.projectArr),f=Kb(e=>e.setChats),g=Kb(e=>e.setPinnedChats),v=fT(e=>e.setOperationProject),y=fT(e=>e.setProjectSettingOpen),b=fT(e=>e.setOperationProjectFiles),x=fT(e=>e.setShowEditModal),w=fT(e=>e.setMoveNewProjectId),S=fT(e=>e.setProjectExpandChats),_=fT(e=>e.activeProjectId),C=fT(e=>e.setProjectChats),E=yE(e=>e.setActiveChatMenuId),[k,I]=O.useState(null),T=m.length>=20;return O.useEffect(()=>{if(!n){if(document.querySelector(".project-panel-container")){let n={top:e,left:t};e+308>window.innerHeight&&(n={top:window.innerHeight-414,left:t}),I(n)}}},[n,e,t]),tn.jsx("div",{className:"project-panel",style:n?{}:{position:"fixed",top:`${null==k?void 0:k.top}px`,left:`${null==k?void 0:k.left}px`,display:(null==k?void 0:k.top)?"block":"none"},children:tn.jsxs("div",{className:"project-panel-container "+(p?"project-panel-container-mobile":""),children:[n&&!T&&tn.jsxs(ee.Item,{className:"project-panel-add "+(T?"project-panel-add-disabled":""),onClick:()=>{T||(v({}),y(!1),b([]),x(!0),w(i),o())},children:[tn.jsx(dt,{type:"icon-line-folder-plus",className:"project-panel-add-icon"}),tn.jsx("div",{className:"project-panel-add-text",children:s.t("New Project")})]},"project-panel-add"),tn.jsx("div",{className:"project-panel-list",children:m.slice(n?0:5,m.length).filter(e=>!a||e.id!==a).map(e=>{const t=Zj(e.icon);return tn.jsxs("div",{className:"project-panel-item",onClick:()=>P(void 0,null,function*(){if(i){const t=yield s_(e.id,[i]).catch(e=>(ut.open({type:"error",content:s.t(e.message)}),null));if(t&&t.success){E(null);const t=yield u(1);if(f(t),l(),!p){const e=yield h();Array.isArray(e)&&g(e)}if(yield d(),_){const e=yield c(String(_));Array.isArray(e)&&S(e)}const n=yield c(String(e.id));Array.isArray(n)&&C(n),r(`/p/${e.id}`),o()}else"Not_Found"===(null==t?void 0:t.data.code)&&(l(),o())}else r(`/p/${e.id}`)}),children:[e.icon?t.icon.includes("icon-")?tn.jsx(dt,{type:t.icon,className:`project-panel-item-icon ${t.style}`}):tn.jsx("div",{className:"project-panel-item-icon",children:Jg[t.icon]}):tn.jsx(dt,{type:"icon-line-folder-01",className:`project-panel-item-icon ${t.style}`}),tn.jsx("div",{className:"project-panel-item-text",children:e.name})]},e.id)})})]})})},{saveAs:tN}=ax,nN=({shareHandler:e=()=>{},cloneChatHandler:t=()=>{},archiveChatHandler:n=()=>{},renameHandler:i=()=>{},deleteHandler:a=()=>{},chatId:o,show:s,onClose:r=()=>{},children:l,onChange:c=()=>{},projectChat:u=!1,projectChatPined:d=!1,projectId:h,isMobileClickOpen:p=!1,tagsDropdownOffsetAuto:m=!1})=>{const f=G(),g=iy(),{getNewProjectList:v,getProjectChatList:y,extractProjectId:b}=Xj(),{getChatListData:x}=Jj(),w=tx(e=>e.mobile),S=Kb(e=>e.pinnedChats),_=Zb(e=>e.taskRunning),C=Zb(e=>e.visionGenerating),E=yE(e=>e.setShowSidebar),k=fT(e=>e.activeProjectId),I=fT(e=>e.setProjectExpandChats),T=fT(e=>e.setProjectChats),[j,N]=O.useState(!1),M=Kb(e=>e.setChats),A=Kb(e=>e.setPinnedChats),R=Wb(e=>e.chatId),D=tx(e=>{var t,n;return null==(n=null==(t=null==e?void 0:e.config)?void 0:t.features)?void 0:n.enable_project}),[L,F]=O.useState(!1),[U,z]=O.useState(!1),H=O.useCallback(()=>P(void 0,null,function*(){BS("clkStickyChat",{params:{et:"CLK"},aesParams:{c4:o},paramsExtend:{chat_id:o}}),z(!0),yield CS(o).catch(e=>(ut.open({type:"error",content:f.t(e.message)}),null)),c(),z(!1)}),[o,f,c]),$=O.useCallback(e=>P(void 0,null,function*(){const t=e.chat.history;return sC(t.currentId,t).reduce((e,t)=>{if("assistant"===t.role){if(t.content_list&&Array.isArray(t.content_list)){const e=(null==(n=t)?void 0:n.content_list)&&(null==(i=null==n?void 0:n.content_list)?void 0:i.length)?null==(o=null==(a=null==n?void 0:n.content_list)?void 0:a.filter(e=>(null==e?void 0:e.phase)===ng.ANSWER))?void 0:o.map(e=>e.content).join("\n"):"";t.content=e.replace(/\[\[\d+\]\]/g,"")||""}else t.content=t.content.replace(/\[\[\d+\]\]/g,"")||"";t.content=t.content.replace(/\[\[\d+\]\]/g,"")}var n,i,a,o;return`${e}### ${t.role.toUpperCase()}\n${t.content}\n\n`},"").trim()}),[]),B=O.useCallback((e="clkdownloadBtn")=>{BS(e,{params:{et:"CLK",c5:"chatList"},aesParams:{c4:o},paramsExtend:{chat_id:o}})},[o]),q=O.useCallback(()=>{r(),w&&E(!1)},[w,r,E]),V=O.useCallback(()=>P(void 0,null,function*(){try{const e=yield s_("",[o]).catch(e=>(ut.open({type:"error",content:f.t(e.message)}),null));if(null==e?void 0:e.success){v();const e=yield dS();Array.isArray(e.data)&&A(e.data);const t=yield x(1);if(M(t),k){const e=yield y(String(k));Array.isArray(e)&&I(e)}if(location.pathname.includes("/p/")){const e=b(location.pathname);if(e){const t=yield y(String(e));Array.isArray(t)&&T(t)}}o===R&&g(`/p/${h}`,{replace:!0})}else"Not_Found"===(null==e?void 0:e.data.code)&&v()}catch(e){}}),[k,o,R,b,x,v,y,f,g,h,M,A,T,I]),W=O.useCallback(()=>{BS("clkShareBtn",{params:{et:"CLK",c5:"chatList"},aesParams:{c4:o},paramsExtend:{chat_id:o}}),e()},[e,o]),Q=O.useCallback(()=>P(void 0,null,function*(){const e=(yield pS({chat_id:o})).data;if(!e)return;B();const t=yield $(e),n=new Blob([t],{type:"text/plain;charset=utf-8"}),i=`chat-${e.title}.txt`;if(hx())try{yield M_(n,i)}catch(qY){ut.open({type:"warning",content:qY})}else tN(n,i)}),[o,B,$]),K=O.useCallback(()=>P(void 0,null,function*(){var e,t;const n=(yield pS({chat_id:o})).data;if(n){B();const i={};for(const o in n.chat.history.messages)(null==(e=n.chat.history.messages)?void 0:e.hasOwnProperty(o))&&(i[o]=kt(n.chat.history.messages[o],["webSearchInfo","extra.web_search_info"]),"assistant"===i[o].role&&(null==(t=i[o])?void 0:t.content)&&(i[o].content=i[o].content.replace(/\[\[\d+\]\]/g,"")));n.chat.history.messages=i,n.chat.messages&&n.chat.messages.length&&(n.chat.messages=n.chat.messages.map(e=>{const t=kt(e,["webSearchInfo","extra.web_search_info"]);return"assistant"===t.role&&(null==i?void 0:i.content)&&(t.content=t.content.replace(/\[\[\d+\]\]/g,"")),t}));const a=new Blob([JSON.stringify([n])],{type:"application/json;charset=utf-8"});tN(a,`chat-export-${Date.now()}.json`)}}),[o,B]),Y=O.useCallback(()=>tn.jsx(ee,{mode:"inline",className:"chat-menu-content",id:"menu-content",children:w?tn.jsxs(tn.Fragment,{children:[tn.jsxs(ee.Item,{className:"chat-menu-item",onClick:e=>{null==e||e.domEvent.stopPropagation(),null==e||e.domEvent.preventDefault(),i()},children:[f.t("Rename"),tn.jsx(dt,{type:"icon-line-edit-contained",className:"chat-menu-item-icon-20"})]},"rename-mobile"),tn.jsxs(ee.Item,{className:"chat-menu-item",disabled:_||C,onClick:e=>{null==e||e.domEvent.stopPropagation(),null==e||e.domEvent.preventDefault(),C||_||t()},children:[f.t("Clone"),tn.jsx(dt,{type:"icon-line-clone-01",className:"chat-menu-item-icon-18"})]},"clone-mobile"),tn.jsxs(ee.Item,{className:"chat-menu-item",onClick:t=>{null==t||t.domEvent.stopPropagation(),null==t||t.domEvent.preventDefault(),e()},children:[f.t("Share"),tn.jsx(dt,{type:"icon-line-share-01",className:"chat-menu-item-icon-18"})]},"share-mobile"),tn.jsx(ee.Divider,{className:"chat-menu-hr"}),D&&tn.jsx(te,{className:"chat-menu-submenu chat-menu-submenu-move",popupClassName:"chat-menu-submenu-project",title:f.t("Move to Project"),icon:tn.jsx(dt,{type:"icon-line-folder-01"}),popupOffset:[-280,0],onClick:e=>{null==e||e.domEvent.stopPropagation(),null==e||e.domEvent.preventDefault()},children:tn.jsx(eN,{isAdd:!0,chatId:o,projectId:h,onClose:q})},"moveToProject"),u&&D&&tn.jsxs(ee.Item,{className:"chat-menu-item ",onClick:e=>{null==e||e.domEvent.stopPropagation(),null==e||e.domEvent.preventDefault(),V()},children:[f.t("Move from Project"),tn.jsx(dt,{type:"icon-line-arrow-curve-left-right"})]},"SwapProject"),tn.jsx(ee.Divider,{className:"chat-menu-hr"}),tn.jsxs(ee.Item,{className:"chat-menu-item chat-menu-delete-item",danger:!0,onClick:e=>{null==e||e.domEvent.stopPropagation(),null==e||e.domEvent.preventDefault(),a()},children:[f.t("Delete"),tn.jsx(dt,{type:"icon-line-trash-01",className:"chat-menu-item-icon-18"})]},"delete-mobile")]}):tn.jsxs(tn.Fragment,{children:[tn.jsx(ee.Item,{onClick:H,className:"chat-menu-item",children:U?tn.jsx("div",{className:"chat-menu-item-pin-loading",children:tn.jsx(bt,{})}):L?tn.jsxs(tn.Fragment,{children:[tn.jsx(dt,{type:"icon-line-unpin-01"}),tn.jsx("span",{className:"chat-menu-item-icon-text",children:f.t("Unpin")})]}):tn.jsxs(tn.Fragment,{children:[tn.jsx(dt,{type:"icon-line-pin-01"}),tn.jsx("span",{className:"chat-menu-item-icon-text",children:f.t("Pin")})]})},"pin"),tn.jsxs(ee.Item,{className:"chat-menu-item",onClick:i,children:[tn.jsx(dt,{type:"icon-line-edit-contained"}),tn.jsx("span",{className:"chat-menu-item-icon-text",children:f.t("Rename")})]},"rename"),tn.jsxs(ee.Item,{className:"chat-menu-item "+(_?"chat-menu-item-task-running":""),disabled:_||C,onClick:()=>{C||_||t()},children:[tn.jsx(dt,{type:"icon-line-clone-01"}),tn.jsx("span",{className:"chat-menu-item-icon-text",children:f.t("Clone")})]},"clone"),tn.jsxs(ee.Item,{className:"chat-menu-item",onClick:n,children:[tn.jsx(dt,{type:"icon-line-archive-02"}),tn.jsx("span",{className:"chat-menu-item-icon-text",children:f.t("Archive")})]},"archive"),tn.jsxs(ee.Item,{className:"chat-menu-item",onClick:W,children:[tn.jsx(dt,{type:"icon-a-share20"}),tn.jsx("span",{className:"chat-menu-item-icon-text",children:f.t("Share")})]},"share"),tn.jsxs(te,{className:"chat-menu-submenu",title:f.t("Download"),icon:tn.jsx(dt,{type:"icon-line-download-02"}),children:[tn.jsx(ee.Item,{className:"chat-menu-item",onClick:K,children:f.t("Export chat (.json)")},"json"),tn.jsx(ee.Item,{className:"chat-menu-item",onClick:Q,children:f.t("Plain text (.txt)")},"txt")]},"download"),D&&tn.jsx(te,{className:"chat-menu-submenu",popupClassName:"chat-menu-submenu-project",title:f.t("Move to Project"),icon:tn.jsx(dt,{type:"icon-line-folder-01"}),children:tn.jsx(eN,{isAdd:!0,chatId:o,projectId:h,onClose:q})},"moveToProject"),u&&D&&tn.jsxs(ee.Item,{className:"chat-menu-item",onClick:V,children:[tn.jsx(dt,{type:"icon-line-arrow-curve-left-right"}),tn.jsx("span",{className:"chat-menu-item-icon-text",children:f.t("Move from Project")})]},"SwapProject"),tn.jsxs(ee.Item,{className:"chat-menu-item chat-menu-item-error",onClick:a,children:[tn.jsx(dt,{type:"icon-line-trash-01"}),tn.jsx("span",{className:"chat-menu-item-icon-text",children:f.t("Delete")})]},"delete")]})}),[w,H,U,L,f,i,_,C,n,W,K,Q,o,h,q,u,V,a,c,t,e]);return O.useEffect(()=>{s&&F(d||S.find(e=>e.id===o))},[o,S,s,d]),O.useEffect(()=>{const e=document.getElementById("menu-content");if(!p&&e&&w){const t=t=>{if(s){(null==e?void 0:e.contains(t.target))||r()}};return document.addEventListener("click",t),()=>{document.removeEventListener("click",t)}}},[s,w,r]),tn.jsx(ne,{open:s,onOpenChange:e=>{e||r()},trigger:p?["click"]:w?[]:["click"],popupRender:Y,placement:"bottomLeft",children:tn.jsx("div",{className:"chat-menu-trigger",children:l})})},iN=O.memo(e=>{const{placeholder:t="",rows:n=1,maxLength:i=1e3,maxRows:a,isMcp:o=!1,showMaxLength:s=!0,autoFocus:r=!1,onKeyDown:l}=e,[c,u]=O.useState(""),[d,h]=O.useState(n>1),p=O.useRef(null),m=O.useRef(null),f=O.useCallback(t=>{var n;u(t.target.value),null==(n=e.onChange)||n.call(e,t.target.value)},[e]),g=()=>{var e,t,i,a,o,s,r,l,c,u;if(!(null==(t=null==(e=p.current)?void 0:e.resizableTextArea)?void 0:t.textArea)||n>1)return;const d=null==(a=null==(i=p.current)?void 0:i.resizableTextArea)?void 0:a.textArea.getBoundingClientRect(),f=null==(o=m.current)?void 0:o.getBoundingClientRect(),g=null==(l=null==(r=null==(s=p.current)?void 0:s.resizableTextArea)?void 0:r.textArea)?void 0:l.value,v=document.createElement("span");v.style.font=window.getComputedStyle(null==(u=null==(c=p.current)?void 0:c.resizableTextArea)?void 0:u.textArea).font,v.style.visibility="hidden",v.style.position="absolute",v.textContent=g,document.body.appendChild(v);const y=v.offsetWidth;document.body.removeChild(v);const b=d.left+y,x=(null==f?void 0:f.left)||0;h(b>x)};return O.useEffect(()=>{var t;u(null!=(t=e.value)?t:"")},[e.value]),O.useEffect(()=>{setTimeout(()=>{g()},0)},[]),tn.jsxs("div",{className:"comment-textarea",children:[tn.jsx(ie.TextArea,{ref:p,rows:a?void 0:n,maxLength:i,placeholder:t,value:c,onChange:f,onInput:g,autoSize:!!a&&{maxRows:a||4},onKeyDown:l,autoFocus:r,className:""+(o?"comment-textarea-mcp":"")}),s&&tn.jsx("div",{className:J("comment-textarea-count",{"comment-textarea-count-position":!d,"comment-textarea-count-error":c.length>=i}),children:tn.jsxs("div",{ref:m,children:[c.length,"/",i]})})]})}),aN=({isShow:e,chatProjectId:t})=>{const n=iy(),i=G(),a=xx(),o=Zb(e=>e.temporaryChatEnabled),s=Wb(e=>e.chatId);Wb(e=>e.currentInputFeature);const[r,l]=O.useState(!1),c=yE(e=>e.setActiveChatMenuId),u=Kb(e=>e.setPinnedChats),d=Zb(e=>e.setTaskRunning),h=yE(e=>e.setShowSidebar),p=tx(e=>e.mobile),[m,f]=O.useState(""),[g,v]=O.useState(!1),y=O.useRef(null),b=Wb(e=>e.chatTitle),[x,w]=O.useState(!1),S=Wb(e=>e.setChatTitle),_=Kb(e=>e.chats),C=Kb(e=>e.pinnedChats),[E,k]=O.useState(!1),[I,T]=O.useState([]),j=fT(e=>e.setChatProjectId),[N,M]=O.useState(!1),{getPinnedChatListData:A}=Jj(),R=O.useCallback(()=>P(void 0,null,function*(){hC(),dC();const e=yield A();Array.isArray(e)&&u(e)}),[A,u]),D=O.useCallback(()=>{M(!1)},[]),L=O.useCallback(()=>P(void 0,null,function*(){p&&h(!1),oT.openNewChat(),j("")}),[p,j,h]),F=O.useCallback(e=>P(void 0,null,function*(){const t=yield ES(e).catch(e=>(ut.open({type:"error",content:i.t(e.message)}),null));if(null==t?void 0:t.success){oT.shareHistory=null,n(`/c/${t.data.id}`),yield dC();const e=yield dS();Array.isArray(e.data)&&u(e.data),hC()}else ut.open({type:"error",content:i.t(null==t?void 0:t.data.message)})}),[i,n,u]),U=O.useCallback(e=>P(void 0,null,function*(){(yield SS(e).catch(e=>{ut.open({type:"error",content:i.t(e.message)})}))&&s===e&&(d(!1),R(),t?n(`/p/${t}`,{replace:!0}):yield L())}),[s,t,L,i,n,R,d]),z=O.useCallback(()=>P(void 0,null,function*(){var e;c(null),f(b||""),v(!0),null==(e=y.current)||e.focus()}),[c,b]);O.useCallback(e=>{let t=[];if(e)for(const n in e)e[n].items&&Array.isArray(e[n].items.chats)&&(t=t.concat(e[n].items.chats));return t},[]);const H=O.useCallback(e=>P(void 0,null,function*(){var a,o;w(!1),e===s&&d(!1);const r=yield _S(e).catch(e=>(ut.open({type:"error",content:i.t(e.message)}),null));null==(a=null==_?void 0:_.filter(e=>e.id===s))||a.length,null==(o=null==C?void 0:C.filter(e=>e.id===s))||o.length,r&&(R(),s===e&&t?n(`/p/${t}`,{replace:!0}):L())}),[s,t,_,L,i,n,R,C,d]),$=O.useMemo(()=>tn.jsxs(ht,{visible:x,title:i.t("Delete chat"),className:"chat-item-delete-confirm",closable:!1,headerBorderNone:!0,maskClosable:!0,onCancel:()=>w(!1),size:"small",actions:[{text:i.t("Cancel"),type:"tertiary",size:"large",rounded:"circle",onClick:()=>{w(!1)}},{text:i.t("Delete"),type:"dangerprimary",size:"large",rounded:"circle",onClick:()=>{H(s)}}],children:[!(E||!I.length)&&tn.jsxs(tn.Fragment,{children:[i.t("The chat contains the following deployed content. Once the chat is deleted, the associated links will no longer be accessible. Please confirm to proceed."),tn.jsx("div",{className:"deploy-url-container",children:I.map(e=>tn.jsx("div",{className:"deploy-url-item",children:e},e))})]}),!E&&i.t("This action will permanently delete all the chats you've created and cannot be undone. Please confirm to proceed.")]}),[H,E,I,i,s,x]),B=O.useMemo(()=>!(!t||""===t),[t]),q=O.useMemo(()=>tn.jsx(nN,{show:r,chatId:s,projectChat:B,projectId:t,cloneChatHandler:()=>{c(null),F(s),BS("clkCloneChat",{params:{et:"CLK"},aesParams:{c4:s},paramsExtend:{chat_id:s}})},shareHandler:()=>{c(null),M(!0)},archiveChatHandler:()=>{U(s)},renameHandler:z,deleteHandler:()=>{c(null),w(!0)},onClose:()=>{l(!1)},onChange:R,children:null,isMobileClickOpen:p,tagsDropdownOffsetAuto:!0}),[r,s,B,t,z,R,p,c,F,U]),V=O.useCallback((e,t)=>P(void 0,null,function*(){if(0!==t.trim().length)if(""===t)ut.open({type:"error",content:i.t("Title cannot be an empty string.")});else{if(!(yield mS({chat_id:e,chat:{title:t}}).catch(e=>{ut.open({type:"error",content:i.t(e.message)})})).success)return void S(b||"");e===s&&S(t),R()}else S(b||"")}),[s,i,R,b,S]),W=O.useMemo(()=>tn.jsx(ht,{visible:g,className:"qwen-chat-comp-item-rename-modal",title:i.t("Rename Chat"),headerBorderNone:!0,closable:!p,size:"small",cancelText:i.t("Cancel"),onCancel:()=>{v(!1),f("")},okText:i.t("Confirm"),actions:[{text:i.t("Cancel"),type:"tertiary",rounded:"circle",onClick:()=>{v(!1),f("")}},{text:i.t("Confirm"),rounded:"circle",disabled:!m.trim(),onClick:()=>P(void 0,null,function*(){yield V(s,m),R(),v(!1)})}],children:tn.jsx("div",{className:"rename-confirm",children:tn.jsx("div",{className:"rename-confirm-content",children:tn.jsx(iN,{showMaxLength:!1,value:m,onChange:f,maxLength:100,maxRows:4,placeholder:i.t("Enter your message"),autoFocus:!0})})})}),[V,i,s,p,R,m,g]);return!e&&a||bT()||!s||!s&&!o||o?null:tn.jsxs("div",{className:"chat-extension-modal",children:[tn.jsxs(Z,{className:"chat-extension-modal-icon",align:"center",justify:"center",onClick:()=>{r||l(!r)},children:[tn.jsx(dt,{type:"icon-line-more-01"}),q]}),W,$,tn.jsx(Yj,{show:N,chatId:s,onClose:D})]})},oN=({show:e,onClose:t=()=>{},editHandler:n=()=>{},deleteHandler:i=()=>{}})=>{const{i18n:a}=G(),o=tx(e=>e.mobile);return O.useEffect(()=>{const n=document.getElementById("menu-content");if(n&&o){const i=i=>{if(e){(null==n?void 0:n.contains(i.target))||t()}};return document.addEventListener("click",i),()=>{document.removeEventListener("click",i)}}},[e,o,t]),tn.jsx(ne,{open:e,onOpenChange:e=>{e||t()},trigger:["click"],popupRender:()=>tn.jsxs(ee,{mode:"inline",className:"project-operation-menu-content",children:[tn.jsxs(ee.Item,{className:"project-operation-menu-item",onClick:n,children:[tn.jsx(dt,{type:"icon-line-edit-contained",className:"project-operation-menu-item-icon"}),tn.jsx("div",{className:"project-operation-menu-item-text",children:a.t("Edit Project")})]},"edit"),tn.jsxs(ee.Item,{className:"project-operation-menu-item project-item-delete",onClick:i,children:[tn.jsx(dt,{type:"icon-line-trash-01",className:"project-operation-menu-item-icon"}),tn.jsx("div",{className:"project-operation-menu-item-text",children:a.t("Delete Project")})]},"delete")]}),placement:"bottomLeft",children:tn.jsx("div",{className:"project-operation-menu-trigger"})})},sN=({center:e=!1})=>{const t=G(),n=tx(e=>e.mobile),i=CE(e=>e.paymentReminderNotification),a=CE(e=>e.fetchPaymentUserNotifications),[o,s]=O.useState({visible:!1,icon:"icon-line-star-02",text:"",onClose:void 0}),r=O.useCallback(()=>P(void 0,null,function*(){if(null==i?void 0:i.type)try{const{data:{code:e}}=yield b_([null==i?void 0:i.type]);e||a()}catch(e){}}),[a,null==i?void 0:i.type]);return O.useEffect(()=>{i&&!o.visible?s({visible:Boolean(i),icon:"icon-line-star-02",text:t.t(n?"{{number}} days":"Your Plus subscription will end in {{number}} days. Renew soon!",{number:Y(1e3*Number(i.detail.subscription_expired_at)).diff(Y(),"days")+1}),onClose:r}):!i&&o.visible&&s({visible:!1,icon:"icon-line-star-02",text:"",onClose:void 0})},[t,n,r,i,o.visible]),o.visible&&tn.jsxs("div",{className:J("qwen-chat-nav-bar-warning-info",{"qwen-chat-nav-bar-warning-info-center":e}),children:[tn.jsx(dt,{type:o.icon,className:"qwen-chat-nav-bar-warning-info-icon"}),tn.jsx("div",{className:"qwen-chat-nav-bar-warning-info-text",children:o.text}),o.onClose&&tn.jsx("div",{className:"qwen-chat-nav-bar-warning-info-close",onClick:o.onClose,children:tn.jsx(dt,{type:"icon-line-x-02",className:"qwen-chat-nav-bar-warning-info-icon"})})]})},rN=()=>{const e=G(),t=tx(e=>e.mobile),n=Zb(e=>e.temporaryChatEnabled);return tn.jsx(ft,{title:e.t("Temporary Chat"),show:!t,placement:"bottomLeft",children:tn.jsxs(Z,{align:"center",justify:"center",className:"temporary-chat-entry "+(n&&!t?"temporary-chat-entry-out":""),onClick:()=>P(void 0,null,function*(){yield oT.updateTemporaryChat(!n)}),children:[tn.jsx(dt,{type:n?"icon-line-privateon-chat-01":"icon-line-private-chat-01",className:n&&!t?"temporary-chat-entry-out-icon":"temporary-chat-entry-icon"}),n&&!t&&tn.jsxs(tn.Fragment,{children:[tn.jsx("span",{className:"temporary-chat-entry-text",children:e.t("Temporary Chat")}),tn.jsx(dt,{type:"icon-line-x-02",className:"temporary-chat-entry-out-close"})]})]})})},lN=()=>{const e=xE(nj(e=>e.user)),t=ty(),{pathname:n}=ty(),{getProjectFilesList:i}=Xj(),a=iy(),[o,s]=H.useState(!1),r=fT(e=>e.setShowEditModal),l=fT(e=>e.projectInfo),c=fT(e=>e.setOperationProject),u=fT(e=>e.setShowDeleteConfirm),d=yE(e=>e.setActiveChatMenuId),h=yE(e=>e.activeChatMenuId),p=Wb(e=>e.projectId),m=O.useCallback(()=>P(void 0,null,function*(){s(!1),(yield i(l.id))&&(yield c(JSON.parse(JSON.stringify(l))),r(!0))}),[i,l,c,r]),f=O.useCallback(()=>{s(!1),c(JSON.parse(JSON.stringify(l))),u(!0)},[l,c,u]),g=O.useMemo(()=>e&&n.includes("/p/")?tn.jsxs("div",{className:"herder-project-edit-btn",children:[tn.jsx("div",{onClick:e=>{e.stopPropagation(),s(!0),h&&d("")},children:tn.jsx(dt,{type:"icon-line-more-01",className:"chat-item-drag-web-default-btn-icon"})}),o&&tn.jsx(oN,{show:o,onClose:()=>{s(!1)},editHandler:m,deleteHandler:f})]}):e&&p&&""!==p?tn.jsx(aN,{isShow:!0,chatProjectId:p||""}):e?e&&"/"===t.pathname?tn.jsx(rN,{}):!e||p||n.includes("/p/")?null:tn.jsx(tn.Fragment,{children:tn.jsx(Qj,{})}):tn.jsxs(Z,{gap:16,children:[tn.jsx(Qj,{}),tn.jsx(rj,{rounded:"circle"})]}),[h,f,m,t.pathname,n,p,d,o,e]),v=O.useMemo(()=>e&&p&&""!==p?tn.jsx(dt,{type:"icon-line-chevron-left",onClick:()=>{a(`/p/${p}`)},className:"header-left-project-back"}):e&&!p?tn.jsx(Kj,{}):void 0,[a,p,e]);return tn.jsx("header",{className:"header-mobile",children:tn.jsxs("div",{className:"header-content",children:[tn.jsxs("div",{className:"header-left",children:[v,tn.jsx(Vj,{})]}),tn.jsxs("div",{className:"header-right",children:[tn.jsx(sN,{}),g]})]})})},cN=()=>{const{getProjectFilesList:e}=Xj(),t=xE(nj(e=>e.user)),[n,i]=H.useState(!1),a=fT(e=>e.setShowEditModal),o=fT(e=>e.projectInfo),s=fT(e=>e.setOperationProject),r=fT(e=>e.setShowDeleteConfirm),{pathname:l}=ty(),c=fT(e=>e.projectName),u=fT(e=>e.setProjectName),d=fT(e=>e.projectIcon),h=fT(e=>e.setProjectIcon),p=aI(e=>e.selectedModelIds),m=iy(),f=Wb(e=>e.projectId),g=fT(e=>e.projectChats),v=Zb(e=>e.temporaryChatEnabled),y=yE(e=>e.showHeaderBorder),b=Wb(e=>e.chatId);O.useEffect(()=>{var e;f&&(e=f,P(void 0,null,function*(){const t=yield r_(e);t.success&&(u(t.data.name),h(t.data.icon))}))},[f,h,u]);O.useMemo(()=>location.pathname.includes("/p/")&&g.length>0,[g]);const x=d?Zj(d):{icon:"icon-line-folder-01",style:""};return tn.jsx("header",{className:J("header-desktop",{"header-desktop-border":y&&"/"!==location.pathname}),children:tn.jsxs("div",{className:"header-content",id:"qwen-chat-header-content",children:[tn.jsxs("div",{className:"header-left",id:"qwen-chat-header-left",children:[f&&""!==f&&tn.jsxs("div",{className:"herder-project",onClick:()=>{m(`/p/${f}`)},children:[d?x.icon.includes("icon-")?tn.jsx(dt,{type:x.icon,className:`herder-project-icon ${x.style}`}):tn.jsx("div",{className:"herder-project-icon",children:x.icon}):tn.jsx(dt,{type:"icon-line-folder-01",className:`herder-project-icon ${x.style}`}),tn.jsx("div",{className:"project-name",children:c})]}),f&&""!==f&&tn.jsx(dt,{type:"icon-line-Slash",className:"herder-project-piont"}),!t&&tn.jsx(Qj,{}),tn.jsx(Vj,{})]}),tn.jsx(sN,{center:p.length<=1}),tn.jsx("div",{className:"header-right",id:"qwen-chat-header-right",children:l.includes("/p/")?tn.jsxs("div",{className:"herder-project-edit-btn",children:[tn.jsx("div",{onClick:e=>{e.stopPropagation(),i(!0)},children:tn.jsx(dt,{type:"icon-line-more-01",className:"chat-item-drag-web-default-btn-icon"})}),n&&tn.jsx(oN,{show:n,onClose:()=>{i(!1)},editHandler:()=>P(void 0,null,function*(){yield i(!1),(yield e(o.id))&&(yield s(JSON.parse(JSON.stringify(o))),a(!0))}),deleteHandler:()=>{i(!1),s(JSON.parse(JSON.stringify(o))),r(!0)}})]}):tn.jsxs(tn.Fragment,{children:[tn.jsx(aN,{chatProjectId:f||""}),t?!b||v?tn.jsx(rN,{}):null:tn.jsx(rj,{showRegister:!0,size:"small",rounded:"circle",buttonClass:"header-right-auth-button"})]})})]})})},uN=["icon-line-folder-01","icon-line-Investing","icon-line-lightbulb-03","icon-image-icon","icon-line-video-01","icon-line-audio","icon-line-star-02","icon-line-rename-01","icon-line-Travel","icon-line-globe-07","icon-line-deepresearch-02","icon-line-Wallet","icon-line-like-unselected","icon-line-Exercise","icon-line-Food-02","icon-line-coffee","icon-line-markdown","icon-line-Plants","icon-line-cat","icon-line-dog","icon-line-Transportation-02","icon-line-book-02","icon-line-Vacation","icon-line-calendar","icon-line-computer","icon-line-Volume","icon-line-Data","icon-line-email-01"],dN=["character-primary-text","red-500","yellow-400","green-600","blue-500","violet-500","electricviolet-500"],hN=({icon:e=uN[0],style:t=dN[0],onIconChange:n=()=>{},onIconClose:i=()=>{}})=>{const{t:a}=G(),o=tx(e=>e.mobile),[s,r]=O.useState(()=>e.startsWith("icon-")||!e?"icon":"emoji"),[l,c]=O.useState(e),[u,d]=O.useState(dN.find(e=>e===t)||dN[0]);O.useEffect(()=>{c(e),d(dN.find(e=>e===t)||dN[0]),r(e.startsWith("icon-")||!e?"icon":"emoji")},[e,t]);const h=e=>{const t={icon:e,style:u};t.style="emoji"===s?"":u,c(e),d(t.style),n(t)};return tn.jsxs("div",{className:"project-icon-picker",children:[tn.jsxs("div",{className:"project-icon-picker-tab",children:[[{key:"icon",label:"Icon"},{key:"emoji",label:"Emoji"}].map(e=>tn.jsx("div",{className:"project-icon-picker-tab-item "+(e.key===s?"active":""),onClick:()=>(e=>{r(e)})(e.key),children:a(e.label)},e.key)),o&&tn.jsx("div",{className:"project-icon-picker-close",onClick:i,children:tn.jsx(dt,{type:"icon-line-x-01",className:"project-icon-picker-close-icon"})})]}),o&&tn.jsx("div",{className:"project-icon-picker-icon",children:l.startsWith("icon-")?tn.jsx(dt,{type:l,className:`${u} `}):l||tn.jsx(dt,{type:"icon-line-folder-01",className:"character-primary-text"})}),tn.jsx("div",{className:"project-icon-picker-icons",children:"icon"===s?tn.jsx(tn.Fragment,{children:uN.map(e=>tn.jsx("div",{className:`project-icon-picker-icons-item ${o?"":u} ${l===e?"active":""}`,onClick:()=>h(e),children:tn.jsx(dt,{type:e})},e))}):"emoji"===s?tn.jsx(tn.Fragment,{children:(navigator.userAgent.includes("Windows")?Xg:Yg).map(e=>tn.jsx("div",{className:"project-icon-picker-icons-item project-icon-picker-icons-emoji "+(l===e?"active":""),onClick:()=>h(e),children:e},e))}):null}),"icon"===s&&tn.jsxs(tn.Fragment,{children:[tn.jsx("div",{className:"project-icon-picker-divider"}),tn.jsx("div",{className:"project-icon-picker-style icon",children:dN.map(e=>tn.jsx("div",{className:`project-icon-picker-style-color ${e} ${e===u?"active":""}`,onClick:()=>d(e),children:e===u&&tn.jsx("div",{className:`project-icon-picker-style-color-circle ${e}`})},e))})]})]})},pN=({data:e,setData:t,isProjectDetail:n})=>{const{t:i}=G(),a=tx(e=>e.mobile),[o,s]=O.useState(!1),[r,l]=O.useState(""),[c,u]=O.useState({icon:"",style:""});O.useEffect(()=>{u(Zj(null==e?void 0:e.icon))},[null==e?void 0:e.icon]);const d=n=>{let i=`icon=${n.icon}`;if(n.style&&(i+=`&style=${n.style}`),!a)return t(C(_({},e),{icon:i})),u(Zj(i)),void s(!1);l(i)},h=()=>tn.jsx("div",{className:"project-new-name-edit-icon-picker-popover",children:tn.jsx(hN,{icon:c.icon,style:c.style,onIconChange:d})}),p=()=>{var t;return tn.jsx("div",{className:"project-new-name-edit-icon "+(n?"project-new-name-edit-project":""),onClick:()=>{s(!0)},children:!(null==e?void 0:e.icon)||(null==(t=c.icon)?void 0:t.startsWith("icon-"))?tn.jsx(dt,{type:c.icon||"icon-line-plus-01",className:`project-new-name-edit-icon-default ${c.style}`}):tn.jsx("div",{className:"project-new-name-edit-emoji",children:Jg[c.icon]})})};return a?tn.jsxs(tn.Fragment,{children:[tn.jsx(mt,{open:o,onClose:()=>{s(!1)},push:!1,heightType:"full",className:"project-new-name-edit-icon-mobile-container",children:tn.jsxs("div",{className:"project-new-name-edit-icon-mobile",children:[tn.jsx(hN,{icon:c.icon,style:c.style,onIconChange:d,onIconClose:()=>{s(!1)}}),tn.jsx(pt,{type:"brandprimary",rounded:"circle",buttonClass:"project-new-name-edit-icon-done",size:"large",onClick:()=>{t(C(_({},e),{icon:r})),u(Zj(r)),s(!1)},children:i("Done")})]})}),p()]}):tn.jsx(ae,{open:o,arrow:!1,onOpenChange:e=>s(e),content:h,trigger:["click"],placement:"bottomLeft",classNames:{root:"project-icon-trigger-popover-shell "},children:p()})},mN=({data:e,setData:t})=>{const{i18n:n}=G(),[i,a]=O.useState(e.name||""),[o,s]=O.useState([]),r=yE(e=>e.language),l=fT(e=>e.setProjectSettingOpen),c=O.useMemo(()=>r||n.language,[n.language,r]),u=O.useCallback(()=>P(void 0,null,function*(){const e=yield P(void 0,null,function*(){return yield Ox("/configs/?code=projectTitle")});if(e.success){const{language:t,projectIcon:n,projectInstruction:i,projectTitle:a}=e.data,o=n.map((e,n)=>{const o=a[n],s=i[n];return{icon:`icon=${e}&style=${dN[0]}`,title:t[c][o],instruction:t[c][s]}});s(o)}}),[c]);O.useEffect(()=>{u()},[u]);return O.useEffect(()=>{a(e.name||"")},[e]),tn.jsxs("div",{className:"project-new-name",children:[tn.jsxs("div",{className:"project-new-name-edit",children:[tn.jsx(pN,{data:e,setData:t}),tn.jsx(xt,{className:"project-new-name-edit-input",value:i,onChange:n=>{a(n),t(C(_({},e),{name:n}))},placeholder:n.t("Project Name"),maxLength:150})]}),tn.jsx("div",{className:"project-new-name-examples",children:o.map((n,i)=>tn.jsx(pt,{iconFontType:Zj(n.icon).icon,type:"ghost",shape:"circle",onClick:()=>{return i=n,l(!0),a(i.title),void t(C(_({},e),{icon:i.icon,name:i.title,custom_instruction:i.instruction}));var i},children:n.title},i))})]})},fN=({value:e="",items:t=[{label:"",value:"default",info:""}],onChange:n,disabled:i})=>{const[a,o]=O.useState(!1),s=G(),r=O.useRef(null);return tn.jsx("div",{className:"project-memory-select-container "+(i?"project-memory-select-containe-disabled":""),onClick:()=>{i||o(!a)},children:tn.jsx(ft,{title:i?s.t("Memory settings cannot be changed later."):"",children:tn.jsx(oe,{ref:r,open:a,value:e,disabled:i,onChange:e=>{null==n||n(e),o(!1)},className:"project-memory-selector",popupMatchSelectWidth:!1,placement:"bottomRight",suffixIcon:tn.jsx(dt,{type:a?"icon-line-chevron-up":"icon-line-chevron-down",className:"project-memory-selector-arrow"}),optionRender:t=>tn.jsxs("div",{className:"project-memory-selector-item",children:[tn.jsxs("div",{className:"project-memory-selector-item-text",children:[tn.jsx("div",{className:"project-memory-selector-item-name",children:t.data.label}),tn.jsx("div",{className:"project-memory-selector-item-info",children:t.data.info})]}),e===t.data.value&&tn.jsx(dt,{type:"icon-line-check-02",className:"project-memory-selector-item-checked"})]}),options:t})})})},gN=({data:e,setData:t})=>{const{i18n:n}=G(),i=tx(e=>e.mobile);O.useEffect(()=>{e.memory_span||t(C(_({},e),{memory_span:"default"}))},[e,t]);const a=O.useMemo(()=>[{value:"default",label:n.t("Default"),info:n.t("Chats will access and contribute to your account-wide memories.")},{value:"project_only",label:n.t("Project-only"),info:n.t("Memories are isolated to this project and won't affect your main account.")}],[n]);return tn.jsxs("div",{className:"project-memory-container",children:[tn.jsxs("div",{className:"project-memory-info",children:[tn.jsx("div",{className:"project-memory-info-text",children:n.t("Memory")}),!i&&tn.jsx(ft,{title:n.t("Choose whether this project has its own isolated memory or shares context with your global memory."),children:tn.jsx(dt,{type:"icon-line-information-circle",className:"project-memory-info-tooltip"})})]}),i?tn.jsx("div",{className:"project-memory-select-mobile",children:a.map(n=>tn.jsxs("div",{className:"project-memory-select-mobile-item "+(e.id?"project-memory-select-mobile-item-disabled":""),onClick:()=>{e.id||t(C(_({},e),{memory_span:n.value}))},children:[tn.jsxs("div",{className:"project-memory-selector-mobile-item-text",children:[tn.jsx("div",{className:"project-memory-selector-mobile-item-name",children:n.label}),tn.jsx("div",{className:"project-memory-selector-mobile-item-info",children:n.info})]}),e.memory_span===n.value&&tn.jsx(dt,{type:"icon-line-check-02",className:"project-memory-selector-mobile-item-checked"})]},n.value))}):tn.jsx(fN,{disabled:!!e.id,items:a,value:e.memory_span,onChange:n=>{t(C(_({},e),{memory_span:n}))}})]})},vN=({title:e,tooltip:t="",props:n})=>{const i=tx(e=>e.mobile);return tn.jsxs("div",{className:"project-instruction-container",children:[tn.jsxs("div",{className:"project-instruction-label",children:[e&&tn.jsx("div",{className:"project-instruction-label-text",children:e}),t&&!i&&tn.jsx(ft,{title:t,children:tn.jsx(dt,{type:"icon-line-information-circle",className:"project-instruction-label-tooltip"})})]}),tn.jsx("div",{className:"project-instruction-textarea",children:tn.jsx(wt,_({},n))})]})},yN=({file:e,actions:t=["delete"],onReUpload:n,onDownload:i,onDelete:a,isMobileProjectDetail:o})=>{var s,r,l;const[c,u]=O.useState(!1),d=tx(e=>e.mobile),{i18n:h}=G(),p={download:{icon:"icon-download",text:"Download"},delete:{icon:"icon-line-trash-01",text:"Delete"}},m=O.useMemo(()=>{var t,n;const i=(null==(t=e.name)?void 0:t.lastIndexOf("."))||-1;return(null==(n=null==e?void 0:e.name)?void 0:n.slice(i+1))||""},[e.name]),f=(()=>{var t,n,i,a,o,s,r,l,c;const u=Dg[e.file_type||e.type]||Dg.others;let d=u.bg,h=u.icon;if(Tg.includes(m)&&(h="icon-playground",d="#3F3F47"),null==(i=null==(n=null==(t=null==e?void 0:e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)switch(null==(s=null==(o=null==(a=null==e?void 0:e.file)?void 0:a.meta)?void 0:o.parse_meta)?void 0:s.parse_status){case"success":return{icon:h,bg:d};case"failed":return(null==(c=null==(l=null==(r=null==e?void 0:e.file)?void 0:r.meta)?void 0:l.parse_meta)?void 0:c.retry)?{icon:"icon-regenerate",bg:d}:u;case"running":return{icon:"icon-loading-icon",bg:d};default:return""}switch(e.uploadStatus){case"success":return{icon:h,bg:d};case"uploading":default:return{icon:"icon-loading-icon",bg:d};case"error":return{icon:"icon-regenerate",bg:d}}})(),g=O.useMemo(()=>{var t,n,i,a,o,s,r,l;if(null==(i=null==(n=null==(t=null==e?void 0:e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)switch(null==(s=null==(o=null==(a=null==e?void 0:e.file)?void 0:a.meta)?void 0:o.parse_meta)?void 0:s.parse_status){case"success":default:return"parsed";case"failed":return"parsed_error";case"running":return"parsing"}switch(e.uploadStatus){case"success":return(null==(l=null==(r=null==e?void 0:e.file)?void 0:r.meta)?void 0:l.parse_meta)?"success":"parsed";case"uploading":return"uploading";case"error":return"error";default:return"success"}},[e.uploadStatus,null==(l=null==(r=null==(s=e.file)?void 0:s.meta)?void 0:r.parse_meta)?void 0:l.parse_status]),v=t=>{switch(t){case"download":i(e);break;case"delete":a(e)}},y=O.useMemo(()=>"green_error"===e.greenNet,[e.greenNet]);return tn.jsxs("div",{className:J("project-file-card",{"project-file-card-greening":y}),children:[tn.jsxs("div",{className:"project-file-card-left",children:[tn.jsx("div",{className:"project-file-card-left-icon",onClick:()=>{"error"===e.uploadStatus&&n(e)},style:y?{}:{backgroundColor:f.bg},children:y?tn.jsx(dt,{type:"icon-line-file-none",className:"fileitem-icon"}):tn.jsx(dt,{type:f.icon,className:e.uploadStatus})}),tn.jsxs("div",{className:"project-file-card-left-info",children:[tn.jsx("div",{className:"project-file-card-left-info-name",children:tn.jsx("div",{className:"project-file-card-left-info-text",children:e.name})}),tn.jsx("div",{className:"project-file-card-left-info-size",children:tn.jsxs("div",{className:"project-file-card-left-info-text",children:[tn.jsx("span",{children:((e,t=1)=>{if(0===e)return"0 B";const n=["B","K","M"],i=Math.floor(Math.log(e)/Math.log(1024)),a=n[Math.min(i,n.length-1)];return`${(e/Math.pow(1024,i)).toFixed(t)}${a}`})(e.size)}),"parsing"===g&&tn.jsx("span",{children:h.t("Parsing...")}),"parsed_error"===g&&!y&&tn.jsx("span",{className:"project-file-error",children:h.t("Parsing failed")}),"error"===g&&!y&&tn.jsx("span",{className:"project-file-error",children:h.t("Upload failed")}),y&&tn.jsx("span",{className:"fileitem-file-error",children:h.t("Invalid File")})]})})]})]}),tn.jsx("div",{className:"project-file-card-right",children:tn.jsx("div",{className:"project-file-card-right-actions",children:d&&o?tn.jsx(ne,{open:c,onOpenChange:e=>{e||u(!1)},trigger:["click"],popupRender:()=>tn.jsx(ee,{mode:"inline",className:"project-file-operation-menu-content",children:t.map(e=>"download"===e&&"parsed"===g||"delete"===e?tn.jsxs(ee.Item,{className:"project-file-operation-menu-item "+("delete"===e?"project-file-item-delete":""),onClick:()=>v(e),children:[tn.jsx("div",{className:"project-file-operation-menu-item-text",children:h.t(p[e].text)}),tn.jsx(dt,{className:"project-file-operation-menu-item-icon",type:p[e].icon})]},e):null)}),placement:"bottomLeft",children:tn.jsx("div",{onClick:()=>{u(!0)},children:tn.jsx(dt,{type:"icon-line-more-01",className:"project-file-card-right-actions-icon "})})}):tn.jsx(tn.Fragment,{children:t.map(e=>"download"===e&&"parsed"===g||"delete"===e?tn.jsx("div",{className:"project-file-card-right-actions-icon",onClick:()=>v(e),children:tn.jsx(dt,{type:p[e].icon})},e):null)})})})]})},bN=({files:e=[],actions:t=["delete"],onReUpload:n,onDownload:i,onDelete:a,isMobileProjectDetail:o})=>{const s=fT(e=>e.deleteFiles),r=e.filter(e=>!s.includes(e.file_id||e.itemId));return tn.jsx(tn.Fragment,{children:r.length?tn.jsx("div",{className:"project-file-list",children:r.map(e=>tn.jsx(yN,{file:e,actions:t,onReUpload:n,onDownload:i,onDelete:a,isMobileProjectDetail:o},e.file_id||e.itemId))}):null})},xN=q();class wN{constructor(e){if(k(this,"input"),k(this,"options"),this.input=e,!this.input)throw new Error(" input ");this.input.addEventListener("change",this.handleFileSelect.bind(this)),this.input.addEventListener("error",this.handleError)}setInputAcceptAttribute(){var e,t;const n=null==(t=null==(e=this.options)?void 0:e.acceptedTypes)?void 0:t.join(","),i="image/*"===n?"image":"file";hx()&&"file"===i?this.input.removeAttribute("accept"):(this.input.setAttribute("accept",n||""),this.input.setAttribute("data-type",i))}setCapture(){var e,t;(null==(e=this.options)?void 0:e.capture)?this.input.setAttribute("capture",null==(t=this.options)?void 0:t.capture):this.input.removeAttribute("capture")}handleError(){}updateOptions(e){this.options=e,this.setInputAcceptAttribute(),this.setCapture()}triggerUpload(){this.input.click()}handleFileSelect(e){var t,n;const i=null==(t=e.target)?void 0:t.files,a=Array.from(i||[]);0!==a.length&&(null==(n=this.options)||n.callBack(a),this.input.value="")}static validateFile(e,t){var n,i,a;if(!e)throw new Error("");let o=e;"md"===(null==(a=null==(i=null==(n=null==e?void 0:e.name)?void 0:n.split("."))?void 0:i.at(-1))?void 0:a.toLowerCase())&&""===e.type&&(o=new File([e],e.name,{type:"text/markdown"}));const{maxSize:s=0,acceptType:r="*"}=t||{};if(s){const e=o.size<=s,t=xN.t("File size should not exceed {{maxSize}} MB.",{maxSize:s/1024/1024});if(!e)throw AC.openOnce({type:"error",message:t}),new Error(t)}const l=e.type,c=l.startsWith("image/")?"image":l.startsWith("video/")?"video":l.startsWith("audio/")?"audio":"file";if("file"===r)if(["image","video","audio"].includes(c))throw new Error(` ${e.type}  ${r} `);return o}clearSelectedFiles(){this.input.value=""}destroy(){this.input.removeEventListener("change",this.handleFileSelect),this.input.removeEventListener("error",this.handleError)}}const SN=({styles:e,ref:t})=>{var n,i,a;const o=CE(e=>e.subscriptionPlus),s=tx(e=>{var t,n;return null==(n=null==(t=null==e?void 0:e.config)?void 0:t.features)?void 0:n.enable_payment_and_quota}),r=CE(e=>e.setShowSubscriptionDetail),l=xE(e=>e.user),c=tx(e=>e.mobile),u=tx(e=>e.config),d=fT(e=>e.operationProjectFiles),h=fT(e=>e.setOperationProjectFiles),p=fT(e=>e.deleteFiles),m=O.useRef(null),f=O.useRef(null),{i18n:g}=G(),v=O.useMemo(()=>new mE({onAddProcess:(e,t)=>{if(t){const e=C(_({},t),{uploadStatus:"uploading"}),n=fT.getState().operationProjectFiles;h([It(C(_({},e),{uploadStatus:"uploading"})),...n.filter(t=>t.itemId!==e.itemId)])}},onAddSuccess:(e,t)=>{var n,i,a;const o=C(_({},t),{uploadStatus:"success"}),s=fT.getState().operationProjectFiles;e.length&&e.some(e=>e.itemId===t.itemId)&&!p.includes(o.itemId)&&(h([It(o),...s.filter(e=>e.itemId!==o.itemId)]),BS("uploadedFileData",{params:{et:"OTHER",c1:null==(n=null==t?void 0:t.file)?void 0:n.user_id,c4:null==t?void 0:t.id,c5:null==t?void 0:t.name,c6:t.file_type,c7:(null==(i=null==t?void 0:t.file)?void 0:i.meta)?JSON.stringify(null==(a=null==t?void 0:t.file)?void 0:a.meta):"",c8:t.status}}))},onAddFail:(e,t)=>{if(t){const e=C(_({},t),{uploadStatus:"uploading"===t.status?"uploading":"error"}),n=fT.getState().operationProjectFiles;h([It(e),...n.filter(t=>t.itemId!==e.itemId)])}BS("uploadedFileErr",{params:{et:"OTHER"}})},onPaseSuccess:(e,t)=>{const n=C(_({},t),{uploadStatus:"success"}),i=fT.getState().operationProjectFiles;e.length&&e.some(e=>e.itemId===t.itemId)&&!p.includes(n.itemId)&&h([It(n),...i.filter(e=>e.itemId!==n.itemId)])},onPaseFail:(e,t)=>{if(t){const e=C(_({},t),{uploadStatus:"uploading"===t.status?"uploading":"error"}),n=fT.getState().operationProjectFiles;h([It(e),...n.filter(t=>t.itemId!==e.itemId)])}},userId:null==l?void 0:l.id,parsedFileTypes:[Rg.FILE]}),[p,h,null==l?void 0:l.id]);O.useEffect(()=>{t&&(t.current=v)},[t,v]);O.useEffect(()=>{var e;const t=null==(e=null==u?void 0:u.features)?void 0:e.limits;t&&v.updateLimitRules(pE(t))},[v,null==(n=null==u?void 0:u.features)?void 0:n.limits]),O.useEffect(()=>{m.current&&(f.current=new wN(m.current))},[]);const y=O.useMemo(()=>{var e,t,n;return(null==(n=null==(t=null==(e=null==u?void 0:u.features)?void 0:e.limits)?void 0:t.project)?void 0:n.project_file_max_count)||5},[null==(i=null==u?void 0:u.features)?void 0:i.limits]),b=O.useMemo(()=>{var e,t,n;return(null==(n=null==(t=null==(e=null==u?void 0:u.features)?void 0:e.limits)?void 0:t.project)?void 0:n.project_max_count)||20},[null==(a=null==u?void 0:u.features)?void 0:a.limits]),x=O.useMemo(()=>s&&o?b:y,[s,y,b,o]),w=O.useMemo(()=>{if(!x)return!0;return fT.getState().operationProjectFiles.length-p.length>=x},[d.length,p.length,x]),S=O.useMemo(()=>s?o?g.t(w?"File limit reached. Maximum {{number}} files allowed.":"Upload up to {{number}} files.",{number:b}):tn.jsx(V,{i18nKey:w?"File limit reached. {{upgrade}} to increase your limit to {{filesNumber}} files.":"Free plan includes {{fileNumber}} files. {{upgrade}} to add up to {{filesNumber}} files.",values:{fileNumber:y,filesNumber:b,upgrade:"<a />"},components:{a:tn.jsx("span",{className:"qwen-chat-project-file-list-tooltip-enable-link",onClick:()=>{r(!0)},children:g.t("Upgrade to plus")})}}):g.t(w?"File limit reached. Maximum {{number}} files allowed.":"Upload up to {{number}} files.",{number:x}),[s,w,g,x,o,y,b,r]);return O.useEffect(()=>{v.updateLimitRules(Pt(It(Og),{[Ag.DOC]:{max_count:x}}))},[x,v]),tn.jsxs(tn.Fragment,{children:[tn.jsx(ft,{show:Boolean(S),rootClassName:"qwen-chat-project-file-list-tooltip",title:S,children:tn.jsx(pt,{type:"tertiary",rounded:"circle",buttonClass:"project-file-list-add",disabled:w,size:"small",onClick:()=>{return e="document",P(void 0,null,function*(){var t,n;null==(t=f.current)||t.updateOptions({acceptedTypes:U_(e),type:e,callBack:t=>{const n=d.length-p.length,i=o?b:y;if(n+t.length>i){const a=t.slice(0,i-n);return AC.open({type:"error",content:g.t("In a single-turn conversation, up to {{number}} documents can be uploaded.",{number:i})}),void v.addFiles(a,e)}v.addFiles(t,e)}}),null==(n=f.current)||n.triggerUpload()});var e},buttonStyle:_({},e),children:g.t("Add Files")})}),tn.jsx("input",{ref:m,type:"file",id:"filesUpload",multiple:!c,style:{display:"none"}})]})},_N=({data:e,setData:t})=>{const{i18n:n}=G(),i=tx(e=>e.mobile),a=fT(e=>e.projectSettingOpen),o=fT(e=>e.setProjectSettingOpen),s=fT(e=>e.operationProjectFiles),r=fT(e=>e.deleteFiles),l=fT(e=>e.setDeleteFiles),c=O.useRef(null),u=e=>{var t;null==(t=null==c?void 0:c.current)||t.removeFile(e),l([...r,e.file_id||e.itemId])},d=e=>{u(e)};return O.useEffect(()=>{oT.on(BC.FILE_PASE_REMOVE,d)},[]),tn.jsxs("div",{className:"advanced-settings-container",children:[tn.jsxs("div",{className:"advanced-settings-title",onClick:()=>{o(!a)},children:[tn.jsx("div",{className:"advanced-settings-title-text",children:n.t("Advanced Settings")}),tn.jsx(dt,{type:a?"icon-line-chevron-down":"icon-line-chevron-right",className:"advanced-settings-title-icon"})]}),a&&tn.jsxs("div",{className:"advanced-settings-content",children:[tn.jsx(gN,{data:e,setData:t}),tn.jsx(vN,{title:n.t("Instructions"),tooltip:`${n.t("Define the specific role, tone, and response format you expect Qwen Chat to follow for this project.")}`,props:{value:e.custom_instruction||"",onChange:n=>{t(C(_({},e),{custom_instruction:n}))},minRows:2,maxRows:10,maxLength:1e3,placeholder:n.t("What should the AI know about this project? (e.g., specific rules, tone, or formatting)")}}),tn.jsxs("div",{className:"project-file-list-container",children:[tn.jsxs("div",{className:"project-file-list-title",children:[tn.jsxs("div",{className:"project-file-list-info",children:[tn.jsx("div",{className:"project-file-list-info-text",children:n.t("Files")}),!i&&tn.jsx(ft,{title:n.t("Upload documents, images, or code to serve as a knowledge base for Qwen Chat within this project."),children:tn.jsx(dt,{type:"icon-line-information-circle",className:"project-file-list-info-tooltip"})})]}),tn.jsx(SN,{ref:c})]}),tn.jsx(bN,{files:s,actions:["delete"],onReUpload:e=>P(void 0,null,function*(){var t,n,i,a;e&&"failed"===(null==(i=null==(n=null==(t=e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)?null==(a=null==c?void 0:c.current)||a.startParse(e,!0):e&&e.uploadTaskId&&(yield dE.resumeUpload(e.uploadTaskId))}),onDownload:e=>{},onDelete:u})]})]})]})},CN=e=>P(void 0,null,function*(){const t=fT.getState().projectInfo,n=fT.getState().setProjectInfo;if(e)try{const{data:i,success:a}=yield a_(e);if(!a)return void i.code;if(!(null==i?void 0:i.files)||!Array.isArray(i.files))return;const o=i.files.map(e=>C(_({},e),{uploadStatus:"success"}));n(C(_({},t),{fileLength:o.length}))}catch(i){}}),EN=({editData:e,onCancel:t,operationProjectRef:n})=>{const{t:i}=G(),{getNewProjectList:a,extractProjectId:o}=Xj(),{getChatListData:s,getPinnedChatListData:r}=Jj(),l=tx(e=>e.mobile),c=fT(e=>e.deleteFiles),u=fT(e=>e.moveNewProjectId),d=fT(e=>e.operationProjectFiles),h=fT(e=>e.setProjectInfo),p=fT(e=>e.projectSettingOpen),m=fT(e=>e.setProjectSettingOpen),f=fT(e=>e.showEditModal);fT(e=>e.setShowEditModal);const g=fT(e=>e.setProjectIcon),v=fT(e=>e.setProjectName),y=fT(e=>e.chatProjectId),b=Kb(e=>e.setPinnedChats),[x,w]=O.useState(e),[S,E]=O.useState(!1),k=iy(),I=O.useRef(!1);O.useEffect(()=>{w(e)},[e]),O.useEffect(()=>{n&&(n.current=x)},[x,n]);const T=O.useMemo(()=>d.filter(e=>!c.includes(e.itemId)).some(e=>{var t,n,i;return"uploading"===e.status||"running"===(null==(i=null==(n=null==(t=null==e?void 0:e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)}),[c,d]),j=()=>P(void 0,null,function*(){if(I.current)return;I.current=!0;const e=C(_({},x),{memory_span:x.memory_span||"default",icon:(null==x?void 0:x.icon)?null==x?void 0:x.icon:"icon=icon-line-folder-01&style=character-primary-text"});d.length&&p?e.files=d.filter(e=>!e.file_id&&"success"===e.uploadStatus&&"success"===e.greenNet).filter(e=>!c.includes(e.itemId)):e.files=[];const n=yield(o=_({},e),P(void 0,null,function*(){return yield Ox("/projects/",{method:"POST",data:o})}));var o;if(n.success){const{data:e}=n;if(u){const n=yield s_(e.id,[u]).catch(e=>(ut.open({type:"error",content:i(e.message)}),I.current=!1,null));if(n.success){if(s(1),a(),hC(),dC(),!l){const e=yield r();Array.isArray(e)&&b(e)}return t("createHandle"),void k(`/p/${e.id}`)}"Not_Found"===(null==n?void 0:n.data.code)&&a()}a(),t("createHandle"),k(`/p/${e.id}`)}I.current=!1}),N=()=>P(void 0,null,function*(){if(I.current)return;const e=d.filter(e=>{var t,n,i,a,o;return!e.file_id&&("success"===e.uploadStatus&&!(null==(n=null==(t=null==e?void 0:e.file)?void 0:t.meta)?void 0:n.parse_meta)||"success"===(null==(o=null==(a=null==(i=null==e?void 0:e.file)?void 0:i.meta)?void 0:a.parse_meta)?void 0:o.parse_status)||"success"===e.uploadStatus&&"success"===e.greenNet)}).filter(e=>!c.includes(e.itemId));I.current=!0;if((yield i_(C(_({},x),{add_files:e,delete_files:c}),x.id)).success){if(I.current=!1,location.pathname.includes("/p/")){const e=o(location.pathname);h(_({},x)),x.id===e&&CN(x.id)}y===x.id&&(v(x.name),g(x.icon)),a(),t("updateHandle")}I.current=!1});O.useEffect(()=>{E(!(null==x?void 0:x.name)||!(null==x?void 0:x.name.trim()))},[null==x?void 0:x.custom_instruction,null==x?void 0:x.name,c.length,d.length,p]),O.useEffect(()=>{if(x.id){const e=d.length-c.length>0;(x.custom_instruction||e)&&f&&m(!0)}},[x,c.length,d.length,m,f]),O.useEffect(()=>{x.id||m(!1)},[x.id]);return l&&f?tn.jsx(mt,{open:f,onClose:()=>{t()},push:!1,heightType:"full",className:"project-edit-modal-menu-container",children:tn.jsxs("div",{className:"project-edit-modal-menu-box",children:[tn.jsxs("div",{className:"project-edit-modal-menu-header",children:[tn.jsx("div",{className:"project-edit-modal-menu-header-text",children:i((null==x?void 0:x.id)?"Edit project":"New Project")}),tn.jsx("div",{className:"project-edit-modal-menu-header-close",onClick:()=>{t()},children:tn.jsx(dt,{type:"icon-line-x-01",className:"project-edit-modal-menu-header-icon"})})]}),tn.jsxs("div",{className:"project-edit-modal-menu-content",children:[tn.jsx(mN,{data:x,setData:w}),tn.jsx(_N,{data:x,setData:w})]}),tn.jsx("div",{className:"project-edit-modal-menu-buttons",children:x.id?tn.jsxs(tn.Fragment,{children:[tn.jsx(pt,{type:"tertiary",rounded:"circle",buttonClass:"project-edit-modal-menu-button-cancel",size:"large",onClick:()=>{t()},children:i("Cancel")}),tn.jsx(pt,{type:"brandprimary",rounded:"circle",buttonClass:"project-edit-modal-menu-button-save",size:"large",disabled:S,onClick:N,children:i("Save")})]}):tn.jsx(pt,{type:"brandprimary",rounded:"circle",buttonClass:"project-edit-modal-menu-button-create",size:"large",disabled:S||T,onClick:j,children:i("Create project")})})]})}):tn.jsxs(ht,{className:"project-edit-modal",visible:f,title:i((null==x?void 0:x.id)?"Edit project":"New Project"),headerBorderNone:!0,onCancel:()=>{t()},actions:[{text:i((null==x?void 0:x.id)?"Save":"Create project"),type:"brandprimary",rounded:"circle",buttonClass:"project-edit-modal-button",size:"middle",disabled:S||T,onClick:()=>{x.id?N():j()}}],children:[tn.jsx(mN,{data:x,setData:w}),tn.jsx(_N,{data:x,setData:w})]})},kN=({onCancel:e,onConfirm:t})=>{const n=G(),i=tx(e=>e.mobile);return tn.jsx(ht,{visible:!0,title:n.t("Discard this project?"),closable:!0,headerBorderNone:!0,onCancel:e,className:"project-delete-modal",actions:[{text:n.t("Cancel"),type:"tertiary",onClick:e,rounded:"circle",size:i?"large":"middle"},{text:n.t("Confirm"),type:"dangerprimary",onClick:t,rounded:"circle",size:i?"large":"middle"}],size:"small",children:n.t("Your project hasn't been saved yetclosing this window will discard all your input, including any ongoing work.")})},IN=()=>{const e=G(),t=fT(e=>e.setShowEditModal),n=fT(e=>e.setOperationProject),i=fT(e=>e.setShowDeleteConfirm),a=!mx(),o=fT(e=>e.showDeleteConfirm),s=fT(e=>e.setProjectSettingOpen),r=fT(e=>e.operationProject),l=fT(e=>e.operationProjectFiles),c=fT(e=>e.setOperationProjectFiles),{getNewProjectList:u}=Xj(),d=tx(e=>e.mobile),h=iy(),p=fT(e=>e.deleteFiles),m=fT(e=>e.setDeleteFiles),f=fT(e=>e.setMoveNewProjectId),g=fT(e=>e.setChatProjectId),v=fT(e=>e.showEditModal),[y,b]=O.useState(!1),x=e=>{const i=l.filter(e=>"uploading"===e.status).map(e=>e.itemId);l.forEach(e=>{var t,n,i;"running"===(null==(i=null==(n=null==(t=e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)&&oT.emit(BC.FILE_PASE_REMOVE,e)}),b(!1),s(!1),n({}),t(!1),m(i),c([]),f("")},w=O.useRef([]),S=O.useRef(r);return O.useEffect(()=>{if(v){const e=[];l.forEach(t=>{e.push(t.itemId||t.file_id)}),w.current=e}else w.current=[]},[v]),tn.jsxs(tn.Fragment,{children:[a?tn.jsx(lN,{}):tn.jsx(cN,{}),tn.jsx(EN,{editData:r,operationProjectRef:S,onCancel:e=>{var t,n;let i=!0;if(e||(null==(t=S.current)?void 0:t.custom_instruction)===r.custom_instruction&&(null==(n=S.current)?void 0:n.name)===r.name||(i=!1),!e&&i){const e=l.filter(e=>!(p.includes(e.itemId)||p.includes(e.file_id)));if(w.current.length!==e.length)i=!1;else{i=e.every(e=>{var t,n,i;return(w.current.includes(e.itemId)||w.current.includes(e.file_id))&&"uploading"!==e.status&&"running"!==(null==(i=null==(n=null==(t=null==e?void 0:e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)})}}i?x():b(!0)}}),tn.jsx(ht,{visible:o,title:e.t("Delete this project?"),closable:!1,headerBorderNone:!0,onCancel:()=>{i(!1)},className:"project-delete-modal",actions:[{text:e.t("Cancel"),type:"tertiary",onClick:()=>{i(!1)},rounded:"circle",size:d?"large":"middle",style:d?{}:{height:"48px",fontSize:"16px"}},{text:e.t("Delete"),type:"dangerprimary",onClick:()=>P(void 0,null,function*(){const e=yield(t=null==r?void 0:r.id,P(void 0,null,function*(){return yield Ox(`/projects/${t}`,{method:"DELETE"})}));var t;(e.success||"Not_Found"===e.data.code)&&(u(),g(""),h("/")),i(!1)}),rounded:"circle",size:d?"large":"middle",style:d?{}:{height:"48px",fontSize:"16px"}}],size:"small",children:e.t("This action cannot be undone. All files and chats within this project will be permanently deleted.")}),y&&tn.jsx(kN,{onCancel:()=>{b(!1)},onConfirm:()=>{x()}})]})},TN=({greetingText:e,userName:t})=>{const n=aI(e=>e.selectedModels),{i18n:i}=G(),a=Zb(e=>e.temporaryChatEnabled);return jt(n)?tn.jsxs("div",{className:"placeholder-logo-pc-container placeholder-loading-container",children:[tn.jsx(ij,{className:"spinner"}),tn.jsx("span",{className:"loading-text",children:i.t("Model loading...")})]}):n.length>1?tn.jsx("div",{className:J("placeholder-logo-pc-container"),children:tn.jsx(Z,{className:"placeholder-logo-pc-container-multi-model",vertical:!0,children:tn.jsx(Z,{align:"center",justify:"center",children:n.map((e,t)=>tn.jsxs(H.Fragment,{children:[tn.jsx("div",{className:"placeholder-logo-text",children:null==e?void 0:e.name}),t!==n.length-1&&tn.jsx(dt,{type:"icon-line-compare",className:"icon-compare"})]},null==e?void 0:e.id))})})}):tn.jsx(tn.Fragment,{children:tn.jsxs("div",{className:J("placeholder-logo-pc-container"),children:[tn.jsx("div",{className:"placeholder-logo-text",children:a?i.t("Temporary Chat"):e}),a&&tn.jsx("div",{className:"placeholder-logo-text-desc",children:i.t("This chat won't appear in history and your messages will not be saved.")})]})})},jN=({greetingText:e,userName:t,theme:n})=>{const{i18n:i}=G(),a=Zb(e=>e.temporaryChatEnabled),o=rT(e=>e.isFocus);return(e=>{var t;const n=O.useRef((null==(t=window.visualViewport)?void 0:t.height)||window.innerHeight),i=O.useCallback(()=>{var t,i;((null==(t=window.visualViewport)?void 0:t.height)||window.innerHeight)<n.current-10?e(!0):(e(!1),null==(i=window.scrollTo)||i.call(window,0,0))},[e]);O.useEffect(()=>{if(bx())return;const e=window.visualViewport;return n.current=(null==e?void 0:e.height)||window.innerHeight,e?e.addEventListener("resize",i):window.addEventListener("resize",i),()=>{e?e.removeEventListener("resize",i):window.removeEventListener("resize",i)}},[i])})(rT(e=>e.setIsFocus)),o?null:a&&!bT()?tn.jsx("div",{className:"placeholder-logo-container",children:tn.jsxs("div",{className:"ph5-temporary-container",children:[tn.jsx(dt,{className:"ph5-temporary-icon",type:"icon-line-private-chat-01"}),tn.jsx("div",{className:"ph5-temporary-title",children:i.t("Temporary Chat")}),tn.jsx("div",{className:"ph5-temporary-description",children:i.t("This chat won't appear in history and your messages will not be saved.")})]})}):tn.jsxs("div",{className:"placeholder-logo-container",children:[tn.jsx("img",{src:`//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.2.8/static/${"dark"===n?"qwen_icon_dark_84":"qwen_icon_light_84"}.png`,className:"logo-img",alt:"logo"}),tn.jsxs("div",{className:"placeholder-logo-text",children:[tn.jsx("p",{children:e}),tn.jsx("p",{children:bT()?i.t("Ask Qwen, Know More."):t||""})]})]})};function NN({children:e=null,fallback:t=null}){const[n,i]=O.useState(!1);return O.useEffect(()=>{i(!0)},[]),n?tn.jsx(O.Suspense,{fallback:null,children:e}):"function"==typeof t?t():tn.jsx(tn.Fragment,{children:t})}function PN(){var e;const t=null==(e=null==globalThis?void 0:globalThis.localStorage)?void 0:e.getItem("theme");return t||function(){var e;return(null==globalThis?void 0:globalThis.matchMedia)&&(null==(e=globalThis.matchMedia("(prefers-color-scheme: dark)"))?void 0:e.matches)?"dark":"light"}()}const MN=H.memo(({greetingText:e})=>{const t=PN();return tn.jsxs("div",{className:"placeholder-logo-container",children:[tn.jsx("img",{src:`//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.2.8/static/${"dark"===t?"qwen_icon_dark_84":"qwen_icon_light_84"}.png`,className:"logo-img",alt:"logo"}),tn.jsxs("div",{className:"placeholder-logo-text",children:[tn.jsx("p",{children:e}),tn.jsx("p",{children:"Ask Qwen, Know More."})]})]})}),AN=({greetingText:e})=>{const t=tx(e=>e.mobile),n=yE(e=>e.theme),i=xE(e=>e.user),a=cT(e=>{var t,n;return null==(n=null==(t=e.settings)?void 0:t.personalization)?void 0:n.enable_for_new_chat}),o=cT(e=>{var t,n;return null==(n=null==(t=e.settings)?void 0:t.personalization)?void 0:n.name}),s=O.useMemo(()=>a?o||(null==i?void 0:i.name)||"":(null==i?void 0:i.name)||"",[o,a,null==i?void 0:i.name]);return t?tn.jsx(jN,{greetingText:e,userName:s,theme:n}):tn.jsx(TN,{greetingText:e,userName:s})},RN=H.memo(({greetingText:e})=>tn.jsx(NN,{fallback:tn.jsx(MN,{greetingText:e}),children:tn.jsx(AN,{greetingText:e})})),ON=O.forwardRef(({uploadHandler:e=()=>{}},t)=>{const n=tx(e=>e.mobile),i=O.useRef(null),a=O.useRef(null);O.useCallback(e=>{BS((e=>({[Ag.DOC]:"clkUploadFileBtn",[Ag.IMAGE]:"clkUploadImgBtn",[Ag.VIDEO]:"clkUploadVideoBtn",[Ag.AUDIO]:"clkUploadAudioBtn"}[e]))(e),{params:{et:"CLK"}})},[]);const o=t=>{var n,i;const o=[];t.forEach(e=>{const t=U_(e);o.push(...t)}),null==(n=a.current)||n.updateOptions({acceptedTypes:o,capture:t.includes(Ag.CAMERA)?"environment":void 0,callBack:n=>{e({files:n,type:t})}}),null==(i=a.current)||i.triggerUpload()};return O.useImperativeHandle(t,()=>({onClickUpload:o})),O.useEffect(()=>{i.current&&(a.current=new wN(i.current))},[]),tn.jsx("input",{type:"file",id:"filesUpload",ref:i,multiple:!n,style:{display:"none"}})}),DN=O.memo(ON),LN=({value:e,onChange:t,offset:n,disabled:i=!1})=>{const[a,o]=O.useState(!1),s=tx(e=>e.mobile),r=O.useMemo(()=>s?a?"icon-fill-triangle-up":"icon-fill-triangle-down":a?"icon-line-chevron-up":"icon-line-chevron-down",[s,a]);return tn.jsx(se,{theme:{token:{colorPrimary:"#615CED",controlItemBgActive:"#E1E1FE",borderRadiusLG:12,borderRadiusSM:12}},children:tn.jsx(yt,{open:a,disabled:i,overlayClassName:"size-selector-popup",onOpenChange:e=>{o(e)},placement:"bottomLeft",trigger:["click"],menu:{items:(l=e[0],[{label:"1:1",key:"1:1",icon:tn.jsx(dt,{type:"icon-line-size-11-01"}),extra:"1:1"===l?tn.jsx(dt,{type:"icon-line-check-02",className:"ratio-active-icon"}):void 0},{label:"3:4",key:"3:4",icon:tn.jsx(dt,{type:"icon-line-size-34-01"}),extra:"3:4"===l?tn.jsx(dt,{type:"icon-line-check-02",className:"ratio-active-icon"}):void 0},{label:"4:3",key:"4:3",icon:tn.jsx(dt,{type:"icon-line-size-43-01"}),extra:"4:3"===l?tn.jsx(dt,{type:"icon-line-check-02",className:"ratio-active-icon"}):void 0},{label:"16:9",key:"16:9",icon:tn.jsx(dt,{type:"icon-line-size-169-01"}),extra:"16:9"===l?tn.jsx(dt,{type:"icon-line-check-02",className:"ratio-active-icon"}):void 0},{label:"9:16",key:"9:16",icon:tn.jsx(dt,{type:"icon-line-size-916-01"}),extra:"9:16"===l?tn.jsx(dt,{type:"icon-line-check-02",className:"ratio-active-icon"}):void 0}]),selectable:!0,onSelect:e=>{t(e.key),BS("selectImageScale",{params:{et:"CLK",c4:e.key}})},selectedKeys:e},align:n?{offset:n}:void 0,children:tn.jsxs(re,{className:J("selector-text",{"selector-text-disabled":i}),size:s?0:4,children:[e[0],tn.jsx(dt,{type:r,className:"selector-icon"})]})})});var l},FN=()=>{const e=rT(e=>e.visionSize),t=rT(e=>e.setVisionSize),n=tx(e=>e.mobile);return tn.jsx("div",{className:J("size-selector"),children:tn.jsx(LN,{value:[e],onChange:t,offset:n?[-25,10]:[-35,20]})})},UN=()=>{const{i18n:e}=G(),t=iy(),[n,i]=O.useState(!1),a=cT(e=>e.mcpSettingList),o=O.useMemo(()=>a.filter(e=>e.enabled).length,[a]),s=O.useMemo(()=>({items:[{key:"mcpEnabledList",label:tn.jsxs(tn.Fragment,{children:[tn.jsxs("div",{className:"mcp-button-menu-title",onClick:e=>e.stopPropagation(),onMouseEnter:e=>e.stopPropagation(),children:[e.t("Enabled MCP  {{number}}",{number:o}),tn.jsx(dt,{type:"icon-line-settings",onClick:()=>{t("/settings/mcp")}})]}),tn.jsx("div",{className:"mcp-button-menu-list",onClick:e=>e.stopPropagation(),children:a.filter(e=>e.enabled).map(t=>{let n="";switch(t.connectionStatus){case"available":n=e.t("MCP available");break;case"connecting":n=e.t("Connecting to the MCP server: Once connected, it can be used in chat.");break;case"failed":n=e.t("Connection to the MCP server failed: It is not available for use in chat.");break;default:n=""}return tn.jsxs("div",{className:"mcp-button-menu-item-wrapper",children:[tn.jsxs("div",{className:"mcp-button-menu-item",children:[tn.jsx("div",{className:"mcp-button-menu-item-header",children:tn.jsx("div",{className:"mcp-button-menu-item-header-name",children:t.name})}),tn.jsx("div",{className:"mcp-button-menu-item-content",children:e.t(t.description)})]}),tn.jsx(ft,{title:n,children:tn.jsx("div",{className:J("mcp-button-menu-item-header-status",{[t.connectionStatus]:!0})})})]},t.id)})})]})}]}),[o,e,a,t]);return o<=0?null:tn.jsx("div",{id:"mcp-button",className:"mcp-button",children:tn.jsx("div",{onClick:e=>{e.stopPropagation()},children:tn.jsx(yt,{open:n,onOpenChange:i,rootClassName:"mcp-button-dropdown",menu:s,trigger:["click"],placement:"bottom",children:tn.jsxs("div",{className:"mcp-button-num",children:[tn.jsx("div",{children:e.t("{{number}} tools",{number:o})}),tn.jsx(dt,{type:n?"icon-line-chevron-down":"icon-line-chevron-up"})]})})})})},zN={thinking:"thinking",search:"search",deep_research:"deep_research_deep_research",t2i:"t2i",t2v:"t2v",artifacts_deploy_artifacts:"artifacts_deploy_artifacts",artifacts_deploy_web_dev:"artifacts_deploy_web_dev",artifacts_deploy_deep_research:"artifacts_deploy_deep_research",audio_chat_audio_only:"audio_chat_AudioOnly",audio_chat_audio_and_video:"audio_chat_AudioAndVideo",deep_research_aipodcast:"deep_research_aipodcast",image_edit:"image_edit",deep_research_advanced:"deep_research_deep_research_advanced"},HN=()=>{const e=tx(e=>e.mobile),t=CE(e=>e.subscriptionPlus),{updateEquityHandlerByMessage:n}=cj(),[i,a]=O.useState(()=>{const e={},t=TE.getState();for(const[n,i]of Object.entries(zN))e[n]=t.getFeatureEquity(i);return e});O.useEffect(()=>{const e=TE.subscribe(e=>{const t={};for(const[n,i]of Object.entries(zN))t[n]=e.getFeatureEquity(i);a(t)});return()=>{e()}},[]);const o=O.useCallback(i=>{if(null===(null==i?void 0:i.remains)||0===(null==i?void 0:i.remains)){if(e){const e=H.createElement(lj,{equity:i,onUpdate:n});ut.openOnce({type:"warning",content:e,closable:t})}return!1}return!0},[e,t,n]),s=O.useCallback(e=>{let t=e;if(e===Zf.DeepResearch&&(t="deep_research_deep_research"),Wg.includes(t)){const e=TE.getState().getFeatureEquity(t);return o(e)}return!0},[o]);return{qThinkingEquity:i.thinking,qSearchEquity:i.search,qDeepResearchEquity:i.deep_research,qT2IEquity:i.t2i,qT2VEquity:i.t2v,qArtifactsDeployArtifacts:i.artifacts_deploy_artifacts,qArtifactsDeployWebDev:i.artifacts_deploy_web_dev,qArtifactsDeployDeepResearch:i.artifacts_deploy_deep_research,qAudioChatAudioOnly:i.audio_chat_audio_only,qAudioChatAudioAndVideo:i.audio_chat_audio_and_video,qDeepResearchAipodcast:i.deep_research_aipodcast,qImageEditEquity:i.image_edit,qDeepResearchAdvanced:i.deep_research_advanced,checkEquityPassByEquity:o,checkEquityPassByInputFeatureType:s}},$N=({disabled:e=!1})=>{const t=G(),[n,i]=O.useState(!1),a=tx(e=>e.mobile),o=Zb(e=>e.researchMode),s=Zb(e=>e.setResearchMode),r=rT(e=>e.messageInputPermissions),{qDeepResearchAdvanced:l,checkEquityPassByEquity:c}=HN(),u=O.useMemo(()=>null===(null==l?void 0:l.remains)||0===(null==l?void 0:l.remains),[l]),d=O.useMemo(()=>[{key:"advance",extra:t.t(r.enableAdvanced.msg||"Devoting extra time to a deeper analysis"),label:t.t("Advanced"),icon:a?null:tn.jsx(dt,{type:"icon-line-advanced-02"})},{key:"normal",extra:t.t("Fast, reliable responses for quick tasks."),label:t.t("Normal"),icon:a?null:tn.jsx(dt,{type:"icon-line-size-34-01"})}],[t,r.enableAdvanced.msg,a]),h=O.useCallback(e=>{c(l)&&!u&&e&&s(e)},[c,l,u,s]),p=O.useCallback(e=>{const{key:t,icon:n,label:i="",extra:a=""}=e;return{key:t,disabled:"advance"===t&&u,label:tn.jsxs("div",{className:"advanced-dropdown-item",children:[n,tn.jsxs("div",{className:"advanced-dropdown-content",children:[tn.jsx("span",{className:"advanced-dropdown-content-label",children:i}),tn.jsx("span",{className:"advanced-dropdown-content-description",children:a})]}),o===t&&tn.jsx(dt,{type:"icon-line-check-02",className:"advanced-dropdown-item-checked"})]}),onClick:()=>{h(t)}}},[h,o,u]),m=O.useMemo(()=>{var e;return null==(e=d.find(e=>(null==e?void 0:e.key)===o))?void 0:e.label},[d,o]),f=O.useMemo(()=>a?n?"icon-fill-triangle-up":"icon-fill-triangle-down":n?"icon-line-chevron-up":"icon-line-chevron-down",[a,n]);return tn.jsx(yt,{open:n,onOpenChange:e?()=>{}:i,placement:a?"topCenter":"bottomLeft",trigger:["click"],menu:{items:d.map(p)},rootClassName:"advanced-dropdown",children:tn.jsxs("div",{className:J("advanced",{"advanced-disabled":e}),children:[m,tn.jsx(dt,{type:f,className:"advanced-icon"})]})})};const BN=[Zf.Artifacts,Zf.DeepResearch,Zf.ImageGeneration,Zf.VideoGeneration,Zf.WebDev,Zf.Travel,Zf.Thinking,Zf.WebSearch,Zf.LEARN,Zf.Slides,"text"],qN=e=>{const{featureSwitchList:t}=e,n=xE(e=>e.user),i=tx(e=>e.config),a=tx(e=>{var t,n;return null==(n=null==(t=null==e?void 0:e.config)?void 0:t.features)?void 0:n.limits}),o=aI(e=>e.models),s=aI(e=>e.selectedModels),r=rT(e=>e.files),l=rT(e=>e.setFiles),c=Wb(e=>e.history),u=Wb(e=>e.currentInputFeature),d=Wb(e=>e.currentInputSubType),h=O.useMemo(()=>aT.createFilesManager({onAddProcess:(e,t)=>{const n=rT.getState().files;if(t&&Array.isArray(n)){const e=[...n.filter(e=>e.itemId!==t.itemId),It(t)];l(e)}},onAddSuccess:(e,t)=>{var n,i,a;const o=rT.getState().files;if(!o.length||!o.some(e=>e.itemId===t.itemId))return;const s=[...o.filter(e=>e.itemId!==t.itemId),It(t)];l(s),BS("uploadedFileData",{params:{et:"OTHER",c1:null==(n=null==t?void 0:t.file)?void 0:n.user_id,c4:null==t?void 0:t.id,c5:null==t?void 0:t.name,c6:t.file_type,c7:(null==(i=null==t?void 0:t.file)?void 0:i.meta)?JSON.stringify(null==(a=null==t?void 0:t.file)?void 0:a.meta):"",c8:t.status}})},onAddFail:(e,t)=>{t&&l([...e.filter(e=>e.itemId!==t.itemId),It(t)]),BS("uploadedFileErr",{params:{et:"OTHER"}})},onPaseSuccess:(e,t)=>{var i,a,o;const s=rT.getState().files;if(s.length&&s.some(e=>e.itemId===t.itemId)&&t){const e=C(_({},t),{file:It(t.file)});l([...s.filter(e=>e.id!==t.id),It(e)]),BS("filePaseSuccess",{params:{et:"OTHER",c1:(null==n?void 0:n.id)||(null==(i=null==t?void 0:t.file)?void 0:i.user_id)||"",c4:null==t?void 0:t.id,c5:null==t?void 0:t.name,c6:t.file_type,c7:(null==(a=null==t?void 0:t.file)?void 0:a.meta)?JSON.stringify(null==(o=null==t?void 0:t.file)?void 0:o.meta):""}})}},onPaseFail:(e,t)=>{var i,a,o,s,r,c,u;if(e.length&&e.some(e=>e.itemId===t.itemId)&&t){const d=C(_({},t),{file:It(t.file)});l([...e.filter(e=>e.id!==t.id),It(d)]),BS("filePaseFail",{params:{et:"OTHER",c1:(null==n?void 0:n.id)||(null==(i=null==t?void 0:t.file)?void 0:i.user_id)||"",c4:null==t?void 0:t.id,c5:null==t?void 0:t.name,c6:t.file_type,c7:(null==(a=null==t?void 0:t.file)?void 0:a.meta)?JSON.stringify(null==(o=null==t?void 0:t.file)?void 0:o.meta):"",c8:(null==(r=null==(s=t.file)?void 0:s.meta)?void 0:r.parse_meta)?JSON.stringify(null==(u=null==(c=t.file)?void 0:c.meta)?void 0:u.parse_meta):""}})}},userId:null==n?void 0:n.id,parsedFileTypes:[Rg.FILE]}),[l,null==n?void 0:n.id]),p=O.useCallback(e=>{let t=e;return t=((e,{currentInputFeature:t,config:n,files:i})=>{var a,o;if(t===Zf.ImageGeneration){const t=e.filter(e=>UE(e)),s=e.filter(e=>!UE(e)&&!e.type.includes("image")),r=(null==(o=null==(a=null==n?void 0:n.features.limits)?void 0:a.image_edit)?void 0:o.image_max_count)||1;i.length+t.length+s.length>r&&ut.openOnce({type:"warning",content:Uf().t("In a single-turn conversation, up to {{number}} images can be uploaded.",{number:r})}),e.length>r&&e.splice(r-i.length,i.length+e.length-r)}return e})(t,{currentInputFeature:u,config:i,files:r}),t=((e,{currentInputFeature:t,config:n,files:i})=>{var a,o,s;if(t===Zf.VideoGeneration&&e){const t=FE[Zf.VideoGeneration];if(t){const r=e.filter(e=>e.type.startsWith("image")),l=e.filter(e=>!e.type.startsWith("image")),c=r.filter(e=>{const{type:n="",name:i=""}=e||{};return t.mineType.includes(n)&&t.extensions.find(e=>i.toLowerCase().endsWith(e))}),u=(null==(s=null==(o=null==(a=null==n?void 0:n.features)?void 0:a.limits)?void 0:o.video_generation)?void 0:s.image_max_count)||1;c.length<r.length?ut.openOnce({type:"warning",content:Uf().t(`Only ${t.fileType.join(", ")} files are supported.`)}):i.filter(e=>"image"===e.type).length+c.length>u&&ut.openOnce({type:"warning",content:Uf().t("In a single-turn conversation, up to {{number}} images can be uploaded.",{number:u})});const d=i.filter(e=>"image"===e.type);return d.length+c.length>u&&c.splice(u-d.length,d.length+c.length-u),[...l,...c]}}return e||[]})(t,{currentInputFeature:u,config:i,files:r}),t},[i,u,r]),m=O.useCallback(e=>{const{files:t,type:n}=e,i=p(t);i.length>0&&h.addFiles(i,n)},[h,p]),f=O.useCallback(e=>P(void 0,null,function*(){const t=r[e];t&&"uploading"===t.status&&t.uploadTaskId&&(yield dE.stopAndRemoveTask(t.uploadTaskId)),h.removeFile(t),l(null==r?void 0:r.filter(e=>t.itemId!==e.itemId))}),[r,h,l]),g=(e=>{const{config:t,history:n,currentInputFeature:i,currentInputSubType:a,models:o,selectedModelsStore:s=[],featureSwitchList:r,files:l}=e,c=O.useMemo(()=>Object.keys(n.messages).some(e=>{var t;return(null==(t=n.messages[e])?void 0:t.chat_type)===Zf.DeepResearch}),[n]),u=O.useMemo(()=>c&&a===Zf.WebSearch?Zf.WebSearch:i,[i,a,c]),d=O.useMemo(()=>o.filter(e=>s.find(t=>(null==t?void 0:t.id)===e.id)),[o,s]),h=O.useMemo(()=>{var e,t,i,a;const{id:o}=(null==(e=Object.values(n.messages))?void 0:e.find(e=>(null==e?void 0:e.sub_chat_type)===Zf.DeepResearch&&"assistant"===e.role))||{};return!!o&&!(null==(i=null==(t=null==n?void 0:n.messages[o||""])?void 0:t.content_list)?void 0:i.some(e=>"answer"===e.phase))&&!(null==(a=null==n?void 0:n.messages[o||""])?void 0:a.done)},[n.messages]),p=O.useMemo(()=>zE(Rg.IMAGE,u,r,t,d,l),[t,u,r,d,l]),m=O.useMemo(()=>zE(Rg.FILE,u,r,t,d),[t,u,r,d]),f=O.useMemo(()=>!!h||zE(Rg.AUDIO,u,r,t,d),[t,u,r,h,d]),g=O.useMemo(()=>!!h||zE(Rg.VIDEO,u,r,t,d),[t,u,r,h,d]),v=O.useMemo(()=>i===Zf.Travel,[i]);return{[Ag.IMAGE]:{disable:p||v,show:!0},[Ag.DOC]:{disable:m||v,show:!0},[Ag.DEFAULT]:{disable:m||v,show:!0},[Ag.AUDIO]:{disable:f||v,show:!0},[Ag.VIDEO]:{disable:g||v,show:!0}}})({history:c,config:i,currentInputFeature:u,currentInputSubType:null!=d?d:u,models:o,selectedModelsStore:s,featureSwitchList:t,files:r}),{fileDragging:v}=(e=>{const{filesManager:t,uploadFilePreCheck:n}=e,[i,a]=O.useState(!1),o=Wb(e=>e.currentInputFeature),s=O.useCallback(e=>{var t,n;e.preventDefault(),o!==Zf.ImageGeneration&&((null==(n=null==(t=e.dataTransfer)?void 0:t.types)?void 0:n.includes("Files"))?a(!0):a(!1))},[o]),r=O.useCallback(e=>P(void 0,null,function*(){var i,s;if(e.preventDefault(),o!==Zf.ImageGeneration){if(null==(i=e.dataTransfer)?void 0:i.files){const i=Array.from(null==(s=e.dataTransfer)?void 0:s.files),a=n(i);a.length>0&&t.addFiles(a)}a(!1)}}),[o,t,n]),l=()=>{a(!1)};return O.useEffect(()=>{const e=document.getElementById("dropzone-container");return null==e||e.addEventListener("dragover",s),null==e||e.addEventListener("drop",r),null==e||e.addEventListener("dragleave",l),()=>{null==e||e.removeEventListener("dragover",s),null==e||e.removeEventListener("drop",r),null==e||e.removeEventListener("dragleave",l)}},[s,r]),{fileDragging:i}})({filesManager:h,uploadFilePreCheck:p});return O.useEffect(()=>{const e=[];!g.audio.disable&&g.audio.show&&e.push(Ag.AUDIO),!g.document.disable&&g.document.show&&e.push(Ag.DEFAULT,Ag.DOC),!g.video.disable&&g.video.show&&e.push(Ag.VIDEO),!g.vision.disable&&g.vision.show&&e.push(Ag.IMAGE),h.updateLimitTypes(e)},[h,g]),O.useEffect(()=>{a&&h.updateLimitRules(pE(a))},[h,a]),O.useEffect(()=>{var e,t;if(s.length){let n;if(n=s.map(e=>e.id).includes(Pg)?s.find(e=>e.id===Pg):s[0],n){const i=null==(t=null==(e=n.info)?void 0:e.meta)?void 0:t.file_limits;h.updateLimitRules(pE(i))}}},[h,s]),{filesManager:h,uploadInfo:g,fileDragging:v,uploadHandler:m,handleCloseFileCard:f}},GN=e=>{const{uploadInfo:t,featureSwitchList:n}=e,{i18n:i}=G(),a=xE(e=>e.user),o=tx(e=>e.config),s=Zb(e=>e.setMcpEnabled),r=Zb(e=>e.setThinkingEnabled),l=aI(e=>e.selectedModels),c=aI(e=>e.selectedModelIds),u=rT(e=>e.files),d=rT(e=>e.setMessageInputPermissions),h=Wb(e=>e.currentInputFeature),p=Wb(e=>e.currentInputSubType),m=O.useMemo(()=>{const e=[Zf.Podcast,Zf.DeepResearchWebDev].includes(p)&&oT.shareHistory;return{enable:!(t.vision.disable&&t.document.disable&&t.video.disable&&t.audio.disable||e),disabled:!1}},[p,t.vision.disable,t.document.disable,t.video.disable,t.audio.disable]),f=O.useMemo(()=>{const e=((e,t,n=[],i,a)=>{var o,s;if(["thinking"].includes(e)&&$E.includes(t))return!1;if(Array.isArray(a)){const t=e;if(a.map(e=>{var n,i,a;return null==(a=null==(i=null==(n=null==e?void 0:e.info)?void 0:n.meta)?void 0:i.abilities)?void 0:a[t]}).includes(2))return!1}return!(e!==LE(t)&&!n.includes(e))||function(...e){if(0===e.length)return[];let t=e[0];for(let n=1;n<e.length&&(t=t.filter(t=>e[n].includes(t)),0!==t.length);n++);return t}((null==(s=null==(o=null==i?void 0:i.features)?void 0:o.feature_feature)?void 0:s[LE(t)])||[e],...n.map(t=>{var n,a;return(null==(a=null==(n=null==i?void 0:i.features)?void 0:n.feature_feature)?void 0:a[LE(t)])||[e]})).includes(e)})("thinking",h,n,o,l),{disabled:t,msg:a}=HE(Zf.Thinking,i.t("Thinking Btn"),o,l,u,c);return t&&r(!1),{enable:e,disabled:t,msg:a}},[o,h,n,u,i,c,l,r]),g=O.useMemo(()=>{const e=wx(),{disabled:t,msg:n}=bT()&&!a?{disabled:!0,msg:i.t("Login required to use")}:HE(Zf.Mcp,i.t("MCP"),o,l,u,c);return e&&!t||s(!1),{enable:e,disabled:t,msg:n}},[o,a,i,l,u,c,s]),v=O.useMemo(()=>{const e=[Zf.ImageGeneration,Zf.VideoGeneration].includes(h);if(e&&(null==u?void 0:u.find(e=>"image"===e.type)))return{enable:!1,disabled:!1,msg:""};return{enable:e,disabled:!1,msg:""}},[h,u]),y=O.useMemo(()=>({enable:h===Zf.DeepResearch,disabled:!1,msg:""}),[h]),b=O.useMemo(()=>({enable:h===Zf.Slides,disabled:!1,msg:""}),[h]),x=O.useMemo(()=>({enableThinking:f,enableMCP:g,enableSizeSelector:v,enableUpload:m,enableAdvanced:y,enableDesignStyle:b}),[f,g,v,m,y,b]);O.useEffect(()=>{d(x)},[x,d])},VN=()=>{var e,t,n,i;const{i18n:a}=G(),o=O.useRef(!1),s=tx(e=>e.config),r=aI(e=>e.selectedModels),l=Zb(e=>e.disableOtherFeature),c=Zb(e=>e.thinkingEnabled),u=Zb(e=>e.setThinkingEnabled),d=rT(e=>e.files),h=rT(e=>e.messageInputPermissions),p=Zb(e=>e.setThinkingMode),m=Zb(e=>e.supportThinkingModes),f=Zb(e=>e.setSupportThinkingModes),{qThinkingEquity:g,checkEquityPassByEquity:v}=HN(),y=O.useMemo(()=>{var e;const t=null===(null==g?void 0:g.remains)||0===(null==g?void 0:g.remains),n=null==(e=null==h?void 0:h.enableThinking)?void 0:e.disabled;return t||n},[null==(e=null==h?void 0:h.enableThinking)?void 0:e.disabled,null==g?void 0:g.remains]),b=O.useMemo(()=>{var e,t,n;return(null==(e=null==h?void 0:h.enableThinking)?void 0:e.disabled)&&(null==(t=null==h?void 0:h.enableThinking)?void 0:t.msg)?null==(n=null==h?void 0:h.enableThinking)?void 0:n.msg:-1!==(null==g?void 0:g.remains)?gE({remains:(null==g?void 0:g.remains)||0,unit:null==g?void 0:g.unit,capability:a.t("Thinking Btn"),allowHtml:!0,currentI18n:a}):c?a.t("Thinking: on"):a.t("Thinking: off")},[c,a,null==(t=null==h?void 0:h.enableThinking)?void 0:t.disabled,null==(n=null==h?void 0:h.enableThinking)?void 0:n.msg,null==g?void 0:g.remains,null==g?void 0:g.unit]),x=O.useCallback(e=>{var t;if(v(g)&&!y){if(BS("clkGenerateMode",{params:{et:"CLK"},aesParams:{c4:"thinking"},paramsExtend:{msg_type:"thinking"}}),(null==(t=h.enableThinking)?void 0:t.disabled)||o.current)return;if(l)return;if(void 0!==e)return void u(e);u(!c)}},[v,l,y,null==(i=h.enableThinking)?void 0:i.disabled,g,u,c]);O.useEffect(()=>{0!==(null==g?void 0:g.remains)&&null!==(null==g?void 0:g.remains)||!c||x()},[c,null==g?void 0:g.remains,x]),O.useEffect(()=>{o.current=((e,t,n,i,a)=>BE(e,t,n,i,a,4))(Zf.Thinking,a.t("Thinking Btn"),s,r,d),o.current&&u(!0)},[s,d,a,r,u]);const w=O.useMemo(()=>{var e,t;const n=r[0];return!!n&&(null==(t=null==(e=n.info)?void 0:e.meta)?void 0:t.auto_thinking)},[r]);return O.useEffect(()=>{let e=aI.getState().selectedModels[0];const t=aI.subscribe(t=>{var n,i,a,o,s;const r=t.selectedModels[0];if(!r||(null==e?void 0:e.id)===(null==r?void 0:r.id))return;e=r;const l=null==(a=null==(i=null==(n=null==r?void 0:r.info)?void 0:n.meta)?void 0:i.abilities)?void 0:a.thinking;if(null==(s=null==(o=r.info)?void 0:o.meta)?void 0:s.auto_thinking)return f(["Auto","Thinking","Fast"]),void p("Auto");switch(l){case 1:f(["Thinking","Fast"]),p("Fast");break;case 2:f([]),p("Thinking");break;case 3:f(["Thinking","Fast"]),p("Thinking");break;case 4:f(["Thinking"])}});return()=>t()},[f,p]),{tooltipText:b,disabled:y,enabled:h.enableThinking.enable,thinkingEnabled:c,autoThinkingEnabled:w,supportThinkingModes:m,onSwitchThinkingMode:x}},WN=e=>{const{inDetail:t=!1,chatId:n,projectId:i}=e||{},a=Zb(e=>e.selectedText),{i18n:o}=G(),[s,r]=O.useState({}),l=tx(e=>e.mobile),c=Wb(e=>e.currentInputFeature),u=Wb(e=>e.currentInputSubType),d=Zb(e=>e.thinkingEnabled),h=Zb(e=>e.mcpEnabled),p=rT(e=>e.files),m=rT(e=>e.inputValue),f=rT(e=>e.setMessageType),[g,v]=O.useState("combination"),[y,b]=O.useState({}),x=O.useMemo(()=>{const e=[Zf.DeepResearch,Zf.DeepThinking,Zf.TRAVEL_FEEDBACK,Zf.TRAVEL_RESEARCH,Zf.DeepResearchWebDev];return d&&(void 0===u||!e.includes(u))},[d,u]),w=O.useMemo(()=>[x?"thinking":"",h?"mcp":""].filter(e=>""!==e),[x,h]),S=O.useMemo(()=>{let e=!1;return e=i?""===m&&!p.length:""===m&&!p.length&&!n,e},[i,m,p.length,n]),C=O.useMemo(()=>s[o.language]||{},[s,o.language]),E=O.useCallback(e=>{b(t=>_(_({},t),e))},[]),k=O.useCallback(()=>P(void 0,null,function*(){try{const e=yield P(void 0,null,function*(){return yield Ox("/configs/?code=query-suggestion")});(null==e?void 0:e.success)&&r(e.data)}catch(e){}}),[]);return(()=>{const e=aI(e=>e.models),t=aI(e=>e.setVisibleModels),n=rT(e=>e.files),i=Wb(e=>e.currentInputFeature),a=Zb(e=>e.thinkingEnabled);O.useEffect(()=>{const a=e.filter(e=>{var t,a;if("qwen3-max-2025-09-23"===e.id||"Qwen3-Max"===e.name)return!0;const o=null==(a=null==(t=e.info)?void 0:t.meta.chat_type)?void 0:a.includes(i),s=n.every(t=>{var n,i;return 1===(null==(i=null==(n=e.info)?void 0:n.meta.abilities)?void 0:i["default"===t.file_class?"document":t.file_class])});return o&&s});t(a)},[a,i,n,e,t])})(),O.useEffect(()=>{k()},[]),O.useEffect(()=>{f({subChatType:u,chatType:c})},[c,u]),O.useEffect(()=>{E({filesIsNotEmpty:!l&&!!p.length})},[p,l]),O.useEffect(()=>{E({quoteTextIsNotEmpty:!!a.length})},[a]),O.useEffect(()=>{E({inDetailAndHasMode:t&&c!==Zf.Txt2Txt,manualChooseMode:!t&&c!==Zf.Txt2Txt})},[c,t,E]),O.useEffect(()=>{E({mcpEnabled:h&&c===Zf.Txt2Txt})},[c,h,E]),O.useEffect(()=>{const e=Object.values(y).filter(Boolean);v(e.length?"separation":"combination")},[y]),{messageInputMode:g,featureSwitchList:w,isShowOmniButton:S,currentI18nRecommend:C,onUpdateSeparationNeeds:E}},QN=H.memo(e=>{var t,n,i,a;const{open:o=!1,modeItems:s=[],uploadInfo:r,onClickUpload:l=()=>{},onClose:c=()=>{},onChangeItem:u=()=>{}}=e,{i18n:d}=G(),[h,p]=O.useState(!1),m=Wb(e=>e.currentInputSubType),f=Zb(e=>e.thinkingMode),g=Zb(e=>e.setThinkingMode),{checkEquityPassByInputFeatureType:v}=HN(),y=O.useMemo(()=>{if(!Array.isArray(s)||!s.length||s.every(({chatType:e})=>!e))return 204;const e=document.body.clientHeight;return h?.94*e:458},[h,s]),b=O.useCallback(()=>{p(!0)},[]);!function(e,t,n={}){const{threshold:i=50,maxTime:a=500,preventDefault:o=!1,isFull:s=!1}=n,r=O.useRef(t),l=O.useRef({threshold:i,maxTime:a,preventDefault:o,isFull:s});O.useEffect(()=>{r.current=t,l.current={threshold:i,maxTime:a,preventDefault:o,isFull:s}},[t,i,a,o,s]);const c=O.useRef(null),u=O.useRef(null),d=O.useCallback(e=>{1===e.touches.length&&(c.current=e.touches[0].pageY,u.current=Date.now())},[]),h=O.useCallback(e=>{if(l.current.preventDefault){if(l.current.isFull)return;e.preventDefault()}},[]),p=O.useCallback(e=>{if(!c.current||1!==e.changedTouches.length)return;const t=e.changedTouches[0].pageY,n=c.current-t,i=Date.now()-(u.current||0),{threshold:a,maxTime:o}=l.current;n>a&&i<o&&r.current({deltaY:Math.round(n),duration:i}),c.current=null,u.current=null},[]);O.useEffect(()=>{let t=null;if(e&&"current"in e?t=e.current:e instanceof HTMLElement&&(t=e),t)return t.addEventListener("touchstart",d,{passive:!0}),t.addEventListener("touchmove",h,{passive:!1}),t.addEventListener("touchend",p,{passive:!0}),()=>{null==t||t.removeEventListener("touchstart",d),null==t||t.removeEventListener("touchmove",h),null==t||t.removeEventListener("touchend",p)}},[e,d,h,p])}(document.body,b,{threshold:60,maxTime:400,preventDefault:o&&!h,isFull:h});const{disabled:x,enabled:w,supportThinkingModes:S,onSwitchThinkingMode:_}=VN(),C=O.useMemo(()=>{var e,t,n,i,a,o,s;return[{icon:"icon-line-camera-01",disabled:null==(e=null==r?void 0:r.vision)?void 0:e.disable,key:[Ag.CAMERA]},{icon:"icon-line-image-011",disabled:null==(t=null==r?void 0:r.vision)?void 0:t.disable,key:[Ag.IMAGE]},{icon:"icon-line-video-01",disabled:null==(n=null==r?void 0:r.video)?void 0:n.disable,key:[Ag.VIDEO]},{icon:"icon-line-file-02",disabled:(null==(i=null==r?void 0:r.document)?void 0:i.disable)&&(null==(a=null==r?void 0:r.audio)?void 0:a.disable),key:[...(null==(o=null==r?void 0:r.document)?void 0:o.disable)?[]:[Ag.DOC],...(null==(s=null==r?void 0:r.audio)?void 0:s.disable)?[]:[Ag.AUDIO]]}]},[null==(t=null==r?void 0:r.audio)?void 0:t.disable,null==(n=null==r?void 0:r.document)?void 0:n.disable,null==(i=null==r?void 0:r.video)?void 0:i.disable,null==(a=null==r?void 0:r.vision)?void 0:a.disable]),E=O.useCallback(({icon:e,key:t,disabled:n})=>tn.jsx("div",{onClick:()=>{n||l([...t])},className:J("mode-selector-drawer-control-item",{"mode-selector-drawer-control-item-disabled":n}),children:tn.jsx(dt,{type:e,className:"mode-selector-drawer-control-item-icon"})},e),[l]),k=O.useCallback(e=>{g(e),_("Fast"!==e)},[_,g]),I=O.useMemo(()=>w?tn.jsxs("div",{className:J("mode-selector-drawer-item",{"mode-selector-drawer-item-disabled":x}),children:[tn.jsxs(Z,{align:"center",gap:8,children:[tn.jsx(dt,{className:"mode-selector-drawer-item-icon",type:"icon-line-deepthink-01"}),tn.jsx("div",{className:"mode-selector-drawer-item-title",children:d.t("Thinking")})]}),tn.jsx(St,{className:"mode-selector-drawer-item-select",popupClassName:"mode-selector-drawer-item-select-popup",options:S.map(e=>({label:d.t(e.replace("ing","")),value:e})),value:f,labelRender:({label:e})=>tn.jsxs("div",{className:"mode-selector-drawer-item-select-label",children:[tn.jsx("div",{children:e}),tn.jsx(dt,{type:"icon-line-sort-vertical-01"})]}),transitionName:"",animation:"",onChange:k})]}):null,[x,w,d,k,S,f]),T=O.useCallback(e=>{if(!e)return null;const t=m===Zf.DeepThinking&&e===Zf.DeepResearch;return m===e||t?tn.jsx(dt,{className:"mode-selector-drawer-list-item-check",type:"icon-line-check-02"}):void 0},[m]),j=O.useCallback(e=>{const{value:t="",icon:n="",key:i,childrens:a,disabledInfo:o,chatType:s,subChatType:r}=e;if(null==a?void 0:a.length)return a.map(j);if(!s)return null;const l=null==o?void 0:o.disabled,h=(null==o?void 0:o.msg)||"";return tn.jsxs("div",{onClick:()=>{if(l){if(!v(r||s))return;ut.openOnce({type:"message",content:h,closable:!1})}else c(),u(e)},className:J("mode-selector-drawer-list-item",{"mode-selector-drawer-list-item-disabled":l}),children:[tn.jsx(dt,{className:"mode-selector-drawer-list-item-icon",type:n}),tn.jsx("div",{className:"mode-selector-drawer-list-item-title",children:d.t(t)}),T(r)]},i)},[d,v,c,u,T]);return tn.jsxs(le,{rootClassName:"mode-selector-drawer",className:"mode-selector-drawer-container",placement:"bottom",open:o,height:y,onClose:e=>{e.stopPropagation(),c(),p(!1)},children:[tn.jsx(dt,{type:"icon-close-4",onClick:()=>{c(),p(!1)},className:"mode-selector-drawer-close"}),tn.jsx("div",{className:"mode-selector-drawer-title",children:d.t("Upload")}),tn.jsxs("div",{onScroll:e=>{0<e.target.scrollTop&&p(!0)},className:"mode-selector-drawer-content",children:[tn.jsx("div",{className:"mode-selector-drawer-control",children:C.map(E)}),tn.jsxs("div",{className:J("mode-selector-drawer-list",{"mode-selector-drawer-list-full":h}),children:[I,s.map(j)]})]})]})}),KN=e=>{const{open:t,onOk:n,onCancel:i}=e,{i18n:a}=G();return tn.jsx(ht,{className:"mcp-first-time-guide-modal",visible:t,width:700,header:!1,footer:!1,children:tn.jsxs("div",{className:"mcp-first-time-guide-modal-content",children:[tn.jsx("div",{className:"mcp-first-time-guide-modal-content-close",onClick:i,children:tn.jsx(dt,{type:"icon-close-4"})}),tn.jsxs("div",{className:"mcp-first-time-guide-modal-content-inner",children:[tn.jsxs("div",{className:"mcp-first-time-guide-modal-content-inner-left",children:[tn.jsxs("div",{className:"mcp-first-time-guide-modal-content-inner-left-header",children:[tn.jsx("div",{className:"mcp-first-time-guide-modal-content-inner-left-header-title",children:a.t("MCP: Limitless AI")}),tn.jsx("div",{className:"mcp-first-time-guide-modal-content-inner-left-header-desc",children:a.t('The Model Context Protocol (MCP), introduced by Anthropic, is an open-source standard designed to facilitate the integration of large language models (LLMs) with external data sources and tools. MCP provides a unified interface, allowing AI models to connect with external data (e.g., files, databases, APIs) and integrate various functionalities more effectively. Described as a "universal plug," MCP enables consistent context sharing between AI systems and external environments, enhancing the flexibility and utility of AI applications. In essence, MCP acts like a "super network cable" for AI, enabling seamless external connectivity.')})]}),tn.jsx("div",{className:"mcp-first-time-guide-modal-content-inner-left-button",children:tn.jsx(pt,{type:"brandprimary",iconFontType:"icon-line-arrow-down-right-sm",onClick:n,children:a.t("Set up MCP to start")})})]}),tn.jsx("div",{className:"mcp-first-time-guide-modal-content-inner-right",children:tn.jsx("img",{src:"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.2.8/static/images/mcp-intro.png",alt:""})})]})]})})},YN=e=>{const{open:t,onOk:n,onCancel:i}=e,{i18n:a}=G();return tn.jsx(ht,{className:"no-mcp-available-modal",visible:t,width:480,header:!1,footer:!1,children:tn.jsxs("div",{className:"no-mcp-available-modal-content",children:[tn.jsx("div",{className:"no-mcp-available-modal-content-close",onClick:i,children:tn.jsx(dt,{type:"icon-close-4"})}),tn.jsxs("div",{className:"no-mcp-available-modal-content-inner",children:[tn.jsx("div",{className:"no-mcp-available-modal-content-inner-header",children:a.t("No MCP available")}),tn.jsx("div",{className:"no-mcp-available-modal-content-inner-desc",children:a.t("No MCP is available, please go to Settings to enable it.")}),tn.jsxs("div",{className:"no-mcp-available-modal-content-inner-button",children:[tn.jsx(pt,{type:"brandprimary",shape:"circle",onClick:n,children:a.t("MCP Settings")}),tn.jsx(pt,{type:"textonly",shape:"circle",onClick:i,children:a.t("Not use for now")})]})]})]})})},XN=e=>{var t,n,i,a,o,s;const{uploadInfo:r,uploadGroupRef:l,onUpdateSeparationNeeds:c=()=>{}}=e||{},{i18n:u}=G(),d=tx(e=>e.config),h=Zb(e=>e.setThinkingEnabled),p=Zb(e=>e.setMcpEnabled),m=rT(e=>e.updateFeatureType),f=rT(e=>e.setShowDetail),g=rT(e=>e.messageInputPermissions),v=rT(e=>e.files),y=Wb(e=>e.currentInputFeature);Wb(e=>e.currentInputSubType);const b=Zb(e=>e.taskRunning),x=Wb(e=>e.history),{enabledMcpList:w,renderMcpModal:S,onChangeMCP:C}=(e=>{const{onUpdateSeparationNeeds:t=()=>{}}=e||{},n=iy(),[i,a]=O.useState(!1),[o,s]=O.useState(!1),r=xE(e=>e.user),l=cT(e=>e.settings.mcp),c=Zb(e=>e.setMcpEnabled),u=cT(e=>e.mcpSettingList),d=cT(e=>e.settings.mcp_remind),h=rT(e=>e.messageInputPermissions),p=rT(e=>e.updateFeatureType),m=O.useMemo(()=>{const e=u.filter(e=>!e.type);return[...aC.getMCPServers(),...e].filter(e=>e.enabled)},[u]),f=O.useCallback(()=>{h.enableMCP.disabled||(0===m.length?d?a(!0):s(!0):(t({mcpEnabled:!0}),c(!0),p({chatType:Zf.Txt2Txt,subChatType:Zf.Txt2Txt})))},[m.length,d,h.enableMCP.disabled,t,c,p]),g=O.useCallback(()=>{a(!1)},[]),v=O.useCallback(()=>{n("/settings/mcp"),g()},[n,g]),y=O.useCallback(()=>{s(!1)},[]),b=O.useCallback(()=>{n("/settings/mcp"),y()},[n,y]),x=O.useMemo(()=>tn.jsxs(tn.Fragment,{children:[tn.jsx(KN,{open:i,onOk:v,onCancel:g}),tn.jsx(YN,{open:o,onOk:b,onCancel:y})]}),[i,o,g,v,y,b]);return O.useEffect(()=>{r&&l&&h.enableMCP.enable&&oC()},[r,l,h.enableMCP.enable]),O.useEffect(()=>{m.length<=0&&c(!1)},[m,c]),{enabledMcpList:m,renderMcpModal:x,onChangeMCP:f}})({onUpdateSeparationNeeds:c}),E=O.useMemo(()=>{var e,t,n,i;return[{key:Ag.DOC,disabled:null==(e=null==r?void 0:r.document)?void 0:e.disable,eventID:"clkUploadFileBtn",text:u.t("file")},{key:Ag.IMAGE,disabled:null==(t=null==r?void 0:r.vision)?void 0:t.disable,eventID:"clkUploadImgBtn",text:u.t("image")},{key:Ag.VIDEO,disabled:null==(n=null==r?void 0:r.video)?void 0:n.disable,eventID:"clkUploadVideoBtn",text:u.t("video")},{key:Ag.AUDIO,disabled:null==(i=null==r?void 0:r.audio)?void 0:i.disable,eventID:"clkUploadAudioBtn",text:u.t("audio")}].filter(({disabled:e})=>!e)},[u,r]),k=O.useCallback(e=>{BS("clkGenerateMode",{params:{et:"OTHER"},paramsExtend:{msg_type:e},aesParams:{c5:e}})},[]),I=O.useCallback(e=>{const{chatType:t,subChatType:n}=e;if(f(!0),[Zf.ImageGeneration,Zf.VideoGeneration].includes(t)){Zf.ImageGeneration;rT.getState().setVisionSize("16:9")}switch(t){case Zf.ImageGeneration:case Zf.VideoGeneration:case Zf.DeepResearch:case Zf.Travel:h(!1)}p(!1),c({mcpEnabled:!1}),m({subChatType:n||t,chatType:t}),k(n||t),c({manualChooseMode:!0})},[f,p,m,k,c,h]),T=O.useMemo(()=>{var e;const t=null==(e=null==x?void 0:x.messages)?void 0:e[(null==x?void 0:x.currentId)||""],n=(null==t?void 0:t.chat_type)===Zf.DeepResearch&&(null==t?void 0:t.sub_chat_type)===Zf.DeepResearch,i=(null==t?void 0:t.chat_type)===Zf.DeepResearch&&(null==t?void 0:t.sub_chat_type)===Zf.INTERRUPT,a=(null==t?void 0:t.chat_type)===Zf.Travel&&(null==t?void 0:t.sub_chat_type)===Zf.TRAVEL_RESEARCH;return(n||i||a)&&b?{disabled:!0,msg:a?"":u.t("Deep Research in progress. Please wait.")}:{disabled:!1,msg:""}},[null==x?void 0:x.currentId,null==x?void 0:x.messages,u,b]),j=O.useCallback(()=>{if(null==T?void 0:T.disabled)return;p(!1),c({manualChooseMode:!1,mcpEnabled:!1}),m({chatType:Zf.Txt2Txt,subChatType:Zf.Txt2Txt});const e=new URL(window.location.href);e.searchParams.delete("inputFeature"),window.history.replaceState({},"",e.toString())},[null==T?void 0:T.disabled,c,p,m]),N=O.useCallback(e=>{if(e===Zf.Thinking)return void h(!0);const t=GE(Qg,e,e);t&&I(t)},[I,h]),P=O.useCallback((e,t)=>"upload"!==e?"":t?u.t("Not available"):E.map(e=>e.text).join(","),[u,E]),M=O.useCallback((e=[])=>{var t;null==(t=null==l?void 0:l.current)||t.onClickUpload((null==e?void 0:e.length)?e:E.map(e=>e.key)),BS("clkUploadBtn",{params:{et:"CLK"}})},[E,l]),A=O.useCallback(e=>{const{key:t,uploadType:n}=e;switch(oT.emit(YC.MESSAGE_INPUT_TRIGGER_FOCUS),t){case"upload":M();break;case"mcp":C();break;default:return I(e),(null==n?void 0:n.length)&&M(n),!1}},[C,I,M]),R=O.useCallback(e=>{var t;if("mcp"===e){const e=w.length?u.t("{{number}} tools",{number:null==w?void 0:w.length}):u.t("No tools");return(null==(t=g.enableMCP)?void 0:t.msg)||e}return""},[w.length,u,null==(t=g.enableMCP)?void 0:t.msg]),D=O.useCallback(e=>{var t,n,i,a,o;switch(e){case"upload":{const e=y===Zf.ImageGeneration&&(null==v?void 0:v.length)>=((null==(i=null==(n=null==(t=null==d?void 0:d.features)?void 0:t.limits)?void 0:n.image_edit)?void 0:i.image_max_count)||1),o=!E.length;return(null==(a=g.enableUpload)?void 0:a.disabled)||e||o}case"mcp":return null==(o=g.enableMCP)?void 0:o.disabled;default:return!1}},[null==(a=null==(i=null==(n=null==d?void 0:d.features)?void 0:n.limits)?void 0:i.image_edit)?void 0:a.image_max_count,y,null==v?void 0:v.length,null==(o=g.enableMCP)?void 0:o.disabled,null==(s=g.enableUpload)?void 0:s.disabled,E.length]);return O.useEffect(()=>{oT.firstOn(YC.MESSAGE_INPUT_RECOMMEND_WORDS_CLICK,({suggestItem:e,active:t})=>{t&&A(_({key:e.subChatType||e.chatType},e))})},[A]),{modeDisabledInfo:T,renderMcpModal:S,onChangeItem:A,onExitMode:j,onFeatureCallback:N,onTooltipHandle:R,onDisabledHandle:D,generateDescription:P}},JN=O.memo(e=>{var t,n,i,a,o;const{messageInputMode:s,uploadInfo:r,isPlanning:l,uploadHandler:c,onUpdateSeparationNeeds:u,onInputCallback:d}=e,{i18n:h}=G(),[p,m]=O.useState(!1),[f,g]=O.useState(!1),[v,y]=O.useState(!1),[b,x]=O.useState(!1),w=Zb(e=>e.mcpEnabled),S=tx(e=>e.mobile),_=tx(e=>e.config),C=rT(e=>e.files),E=rT(e=>e.messageInputPermissions),k=Wb(e=>e.currentInputFeature),I=Wb(e=>e.currentInputSubType),T=aI(e=>e.selectedModels),j=aI(e=>e.selectedModelIds),N=O.useRef(null),P=xE(e=>e.user),{qDeepResearchEquity:M,qT2IEquity:A,qT2VEquity:R,qImageEditEquity:D,qSearchEquity:L}=HN(),{modeDisabledInfo:F,renderMcpModal:U,onChangeItem:z,onExitMode:H,onDisabledHandle:$,generateDescription:B,onTooltipHandle:q,onFeatureCallback:V}=XN({uploadGroupRef:N,uploadInfo:r,onUpdateSeparationNeeds:u});(({onInputCallback:e,onFeatureCallback:t})=>{const{t:n}=G(),i=tx(e=>e.config),a=rT(e=>e.files),o=aI(e=>e.selectedModels),s=Wb(e=>e.history),r=aI(e=>e.selectedModelIds),l=O.useRef(!1),c=O.useCallback(e=>BN.includes(e),[]),u=O.useCallback(e=>({[Zf.WebSearch]:n("Web Search"),[Zf.Artifacts]:n("Artifacts"),[Zf.DeepResearch]:n("Deep Research"),[Zf.ImageGeneration]:n("Image Generation"),[Zf.VideoGeneration]:n("Video Generation"),[Zf.WebDev]:n("Web Dev"),[Zf.Travel]:n("Travel Planner"),[Zf.LEARN]:n("Learn"),[Zf.Slides]:n("Slides")}[e]||null),[n]),d=O.useCallback(()=>{const n=new URLSearchParams(window.location.search);"true"===n.get(Zf.Thinking)&&c(Zf.Thinking)&&1===o.length&&(null==t||t(Zf.Thinking));const s=n.get("inputFeature");if(s&&c(s)){const e=u(s);if(e){const{disabled:n,msg:l}=HE(s,e,i,o,a,r);if(n)return void(l&&ut.open({type:"warning",content:l}));null==t||t(s,e)}}const l=n.get("text");l&&c("text")&&(null==e||e(l))},[i,a,u,t,e,r,o,c]);O.useEffect(()=>{l.current||"/"!==window.location.pathname||s.currentId||!o.length||(l.current=!0,d())},[s.currentId,o.length,d])})({onInputCallback:d,onFeatureCallback:V});const W=O.useMemo(()=>{const e=k===Zf.Image2Video?Zf.VideoGeneration:k,t=I===Zf.Image2Video?Zf.VideoGeneration:I;return GE(Qg,e,t,w)},[k,I,w]),Q=O.useMemo(()=>{var e,t,n,i,a,o;if(null==F?void 0:F.disabled)return[Qg[0]];const s=j.length>1,r=T[0],l=[],c=((e,t,n,i,a,o,s,r)=>{var l;const c=null==(l=null==i?void 0:i.permissions)?void 0:l.chat;return t.map(t=>{var s,l,u,d,h,p;const m=t.subChatType||t.chatType;if(!m)return t;const f=e.t(t.value||"");let g=null;if(r){let t;m===Zf.ImageGeneration?t=r.qT2IEquity:m===Zf.VideoGeneration?t=r.qT2VEquity:m===Zf.ImageEdit?t=r.qImageEditEquity:m===Zf.DeepResearch?t=r.qDeepResearchEquity:m===Zf.WebSearch&&(t=r.qSearchEquity),t&&-1!==t.remains&&(g={disabled:null===t.remains||0===t.remains,msg:gE({remains:t.remains,unit:t.unit,allowHtml:!0,capability:f,currentI18n:e})})}n&&m!==Zf.Txt2Txt&&(g={disabled:!0,msg:e.t("The function {{capability}} is not supported in battle mode.",{capability:f})}),0===(null==c?void 0:c[m])&&(g={disabled:!0,msg:e.t("Coming soon")}),2===(null==c?void 0:c[m])&&(g={disabled:!0,enable:!1,msg:e.t("Disabled")}),5===(null==c?void 0:c[m])&&bT()&&(g={disabled:!0,msg:e.t("{{capability}} is not supported in guest mode.",{capability:f})});let v=!1;if(v=!((null==(l=null==(s=null==a?void 0:a.info)?void 0:s.meta)?void 0:l.chat_type)||[]).includes(m),v)return t.disabledInfo={disabled:!0,msg:e.t("{{model}} does not support {{capability}}",{model:null==a?void 0:a.name,capability:f})},t;if(!jt(o)){let n=(null==(d=null==(u=null==i?void 0:i.features)?void 0:u.feature_file)?void 0:d[LE(m)])||Object.values(Rg);if(m!==Zf.DeepResearch&&m!==Zf.DeepThinking||(n=[Rg.FILE,Rg.IMAGE]),o.filter(e=>!n.includes(e.showType)).length>0)return g={disabled:!0,msg:e.t("The selected model or feature does not support the file type you uploaded.")},t.disabledInfo=g||{disabled:!1,msg:""},t}const y=null==(p=null==(h=null==i?void 0:i.features)?void 0:h.limits)?void 0:p[LE(m)];if(y){const e=o.filter(e=>"image"===e.type),t=y.image_max_count;"number"==typeof t&&e.length>t&&(g={disabled:!0,msg:Uf().t("In a single-turn conversation, up to {{number}} images can be uploaded.",{number:t})})}const b=FE[m];return b&&o.filter(e=>"image"===e.type).find(e=>{const{name:t="",file_type:n=""}=e;return!(b.mineType.includes(n)&&b.extensions.find(e=>t.toLowerCase().endsWith(e)))})&&(g={disabled:!0,msg:Uf().t(`Only ${b.fileType.join(", ")} files are supported.`)}),t.disabledInfo=g||{disabled:!1,msg:""},t})})(h,Qg,s,_,r,C,0,{qDeepResearchEquity:M,qT2IEquity:A,qT2VEquity:R,qImageEditEquity:D,qSearchEquity:L});for(const[u,d]of c.entries())!1!==(null==(e=d.disabledInfo)?void 0:e.enable)&&(0!==u?"mcp"!==d.key?l.length>=7?(null==(n=l.at(-1))?void 0:n.childrens)?null==(o=null==(a=null==(i=l.at(-1))?void 0:i.childrens)?void 0:a.push)||o.call(a,d):l.push({icon:"icon-line-more-01",value:h.t("More"),childrens:[d]}):l.push(d):(null==(t=E.enableMCP)?void 0:t.enable)&&l.push(d):l.push(d,{isDivider:!0}));return l},[_,k,C,h,null==(t=E.enableMCP)?void 0:t.enable,null==F?void 0:F.disabled,M,D,L,A,R,j.length,T,null==P?void 0:P.id]),K=O.useCallback(e=>{var t,n;const{value:i="",icon:a="",isDivider:o,key:s,childrens:r,disabledInfo:l}=e;if(o)return{type:"divider",className:"mode-select-dropdown-divider"};const c=null!=(t=null==l?void 0:l.disabled)?t:$(s),u=null!=(n=null==l?void 0:l.msg)?n:q(s),d=B(s,c);return{key:s,className:"mode-select-common-item",children:null==r?void 0:r.map(K),disabled:c,onClick:(null==r?void 0:r.length)?void 0:()=>z(e),expandIcon:tn.jsx(dt,{type:"icon-line-chevron-right",className:"mode-select-common-item-expand"}),label:tn.jsx(ft,{show:!!u,title:u?tn.jsx("span",{dangerouslySetInnerHTML:{__html:u}}):"",placement:"right",children:tn.jsxs("div",{className:"mode-select-dropdown-item",children:[tn.jsx(dt,{type:a,className:"mode-select-dropdown-item-icon"}),d?tn.jsxs("div",{className:"mode-select-dropdown-item-content",children:[tn.jsx("span",{children:h.t(i)}),tn.jsx("span",{className:J("mode-select-dropdown-item-description",{"mode-select-dropdown-item-description-disabled":c}),children:d})]}):tn.jsx("span",{children:h.t(i)})]})})}},[B,h,z,$,q]),Y=O.useMemo(()=>{var e,t;return"combination"===s?null:tn.jsxs("div",{className:"message-input-column-footer-submode",children:[(null==(e=null==E?void 0:E.enableSizeSelector)?void 0:e.enable)&&tn.jsx(FN,{}),w&&tn.jsx(UN,{}),(null==(t=null==E?void 0:E.enableAdvanced)?void 0:t.enable)&&tn.jsx($N,{disabled:F.disabled})]})},[w,s,null==(n=null==E?void 0:E.enableAdvanced)?void 0:n.enable,null==(i=null==E?void 0:E.enableDesignStyle)?void 0:i.enable,null==(a=null==E?void 0:E.enableSizeSelector)?void 0:a.enable,F.disabled]),X=O.useMemo(()=>(null==F?void 0:F.disabled)?null:tn.jsx(dt,{type:S?"icon-line-x-03":"icon-close-4",className:"mode-select-current-mode-close",onClick:H}),[S,null==F?void 0:F.disabled,H]),Z=O.useMemo(()=>tn.jsxs("div",{className:"mode-select-popover-content",children:[tn.jsxs("div",{className:"mode-select-popover-header",children:[tn.jsx("p",{className:"mode-select-popover-title",children:h.t("Add more details")}),tn.jsx("div",{className:"mode-select-popover-close-box",onClick:()=>{m(!1)},children:tn.jsx(dt,{type:"icon-close-4",className:"mode-select-popover-close-icon"})})]}),tn.jsx("div",{className:"mode-select-popover-body",children:h.t("You can provide extra information for better results.")})]}),[h]),ee=O.useMemo(()=>{if(!W||"combination"===s)return;const{icon:e="",value:t=""}=W,{disabled:n,msg:i}=F;return tn.jsx(ae,{classNames:{root:"mode-select-popover-container"},trigger:"click",placement:"top",autoAdjustOverflow:!0,content:Z,open:p,onOpenChange:e=>{l&&(f?m(!1):(g(!0),m(e)))},children:tn.jsx(ft,{show:!!i,title:i,placement:"top",children:tn.jsxs("div",{className:J("mode-select-current-mode",{"mode-select-current-mode-disabled":n}),children:[!S&&X,tn.jsx(dt,{type:e,className:"mode-select-current-mode-icon"}),S&&X,!S&&tn.jsx("span",{children:h.t(t)})]})})})},[W,f,h,l,s,S,F,p,X,Z]),te=O.useMemo(()=>S?tn.jsx("div",{className:"mode-select-open",onClick:()=>y(!0),children:tn.jsx(dt,{type:"icon-line-plus-01"})}):tn.jsx(yt,{rootClassName:"mode-select-dropdown",placement:"bottomLeft",menu:{items:Q.map(K)},open:b,onOpenChange:x,children:tn.jsx("div",{className:J("mode-select-open",{"mode-select-open-active":b}),children:tn.jsx(dt,{type:"icon-line-plus-01"})})}),[Q,S,b,K]);return O.useEffect(()=>{(null==C?void 0:C.length)&&y(!1)},[null==C?void 0:C.length]),tn.jsxs("div",{className:"mode-select",children:[te,ee,Y,tn.jsx(QN,{open:v,modeItems:Q,uploadInfo:r,onChangeItem:z,onClose:()=>y(!1),onClickUpload:null==(o=null==N?void 0:N.current)?void 0:o.onClickUpload}),tn.jsx(DN,{ref:N,uploadHandler:c}),U]})}),ZN=e=>{var t=e,{rounded:n="round",popupClassName:i,selectorClassName:a,selectAntdRef:o}=t,s=E(t,["rounded","popupClassName","selectorClassName","selectAntdRef"]);const r=O.useRef(null);return O.useEffect(()=>{r.current&&o&&(o.current=r.current)},[null==o?void 0:o.current,r.current]),tn.jsx(oe,_({ref:r,suffixIcon:tn.jsx(dt,{type:"icon-line-chevron-down",className:"qwen-select-down-icon"}),classNames:{popup:{root:`qwen-select-dropdown qwen-select-thinking-dropdown ${i}`},root:`qwen-select-thinking qwen-select-${n} ${a||""}`.trim()},optionRender:(e,t)=>tn.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",alignItems:"center"},children:[tn.jsx("span",{className:"qwen-select-option-selected-label",children:e.label}),e.value===s.value||(null==t?void 0:t.value)===s.value?tn.jsx(dt,{type:"icon-line-check-02",className:"qwen-select-option-selected-icon"}):null]})},s))},eP=[{label:"Auto",value:"Auto"},{label:"Think",value:"Thinking"},{label:"Fast",value:"Fast"}],tP=({value:e,onChange:t,selectAntdRef:n,disabled:i,supportThinkingModes:a})=>{const o=G(),s=O.useRef(null),[r,l]=O.useState(!1),c=O.useMemo(()=>eP.filter(e=>a.includes(e.value)).map(e=>({label:o.t(e.label.replace("ing","")),value:e.value})),[a]);return O.useEffect(()=>{s.current&&n&&(n.current=s.current)},[null==n?void 0:n.current,s.current]),tn.jsx("div",{className:"qwen-thinking-selector",children:tn.jsx(ZN,{selectAntdRef:s,listHeight:768,disabled:i,placement:"bottomLeft",rounded:"none",popupMatchSelectWidth:240,options:c,value:e,open:r,onChange:t,onDropdownVisibleChange:l,suffixIcon:tn.jsx(dt,{onClick:e=>{e.stopPropagation(),l(!r)},type:"icon-line-chevron-down",style:{fontSize:16}})})})},nP=()=>{const{tooltipText:e,disabled:t,enabled:n,supportThinkingModes:i,onSwitchThinkingMode:a}=VN(),o=Zb(e=>e.setThinkingMode),s=Zb(e=>e.thinkingMode);return n?tn.jsx(ft,{show:Boolean(e),title:e?tn.jsx("span",{dangerouslySetInnerHTML:{__html:e}}):"",placement:"top",children:tn.jsx(tP,{value:s,onChange:e=>{o(e),a("Thinking"===e)},disabled:t,supportThinkingModes:i})}):null},iP=()=>{const{i18n:e}=G(),t=tx(e=>e.mobile),n=Zb(e=>e.setWelcomeModalShow),i=Zb(e=>e.setOmniType),a=xE(e=>e.user),o=yE(e=>e.omniButtonBackgroundImg),{qAudioChatAudioAndVideo:s,qAudioChatAudioOnly:r,checkEquityPassByEquity:l}=HN(),c=O.useMemo(()=>null===(null==r?void 0:r.remains)||0===(null==r?void 0:r.remains),[r]),u=O.useMemo(()=>null===(null==s?void 0:s.remains)||0===(null==s?void 0:s.remains),[s]),d=O.useCallback(e=>{l("voice"===e?r:s)},[l,s,r]),h=O.useCallback(e=>{c&&"voice"===e||u&&"video"===e?t&&d(e):bT()?n(!0):(BS("speechVoiceChatStart",{params:{et:"CLK",c1:null==a?void 0:a.id}}),i(e))},[c,u,null==a?void 0:a.id,i,t,d,n]),p=O.useMemo(()=>t?null:bT()?e.t("{{capability}} is not supported in guest mode.",{capability:e.t("Use voice and video chat")}):e.t("Use voice and video chat"),[e,null==a?void 0:a.id]),m=O.useMemo(()=>t||bT()?"":-1!==(null==r?void 0:r.remains)?gE({remains:(null==r?void 0:r.remains)||0,unit:null==r?void 0:r.unit,currentI18n:e,capability:e.t("Voice Chat"),allowHtml:!0}):"",[e,t,null==r?void 0:r.remains,null==r?void 0:r.unit]),f=O.useMemo(()=>t||bT()?"":-1!==(null==s?void 0:s.remains)?gE({remains:(null==s?void 0:s.remains)||0,unit:null==s?void 0:s.unit,currentI18n:e,capability:e.t("Video Chat"),allowHtml:!0}):"",[e,t,null==s?void 0:s.remains,null==s?void 0:s.unit]),g=O.useMemo(()=>[{key:"voice",label:tn.jsx(ft,{title:m?tn.jsx("span",{dangerouslySetInnerHTML:{__html:m}}):"",placement:"bottom",children:tn.jsxs("div",{className:"omni-button-drop-item "+(c?"omni-button-drop-item-disabled":""),onClick:()=>h("voice"),children:[tn.jsx(dt,{type:"icon-line-voiceChat",className:"omni-button-drop-item-icon"}),tn.jsx("div",{className:"omni-button-drop-item-label",children:e.t("Voice Chat")})]})})},{key:"video",label:tn.jsx(ft,{title:f?tn.jsx("span",{dangerouslySetInnerHTML:{__html:f}}):"",placement:"bottom",children:tn.jsxs("div",{className:"omni-button-drop-item "+(u?"omni-button-drop-item-disabled":""),onClick:()=>h("video"),children:[tn.jsx(dt,{type:"icon-line-video-on",className:"omni-button-drop-item-icon"}),tn.jsxs("div",{className:"omni-button-drop-item-label",children:[e.t("Video Chat"),tn.jsx("div",{className:"omni-button-drop-item-label-beta",children:"Beta"})]})]})})}],[e,h,f,m,u,c]);return tn.jsx("div",{className:"omni-button-content",children:tn.jsx(ft,{title:p,arrow:!1,children:tn.jsx(ne,{menu:{items:g},trigger:["click"],overlayClassName:"omni-button-drop",children:tn.jsx(ce,{className:J("omni-button-content-btn",{"omni-button-content-btn-no-bg-color":t&&o}),type:"primary",shape:"circle",style:t&&o?{background:`url(${o}) no-repeat center/cover`}:{},icon:tn.jsx(dt,{type:"icon-line-waveform"})})})})})};var aP={},oP={exports:{}};!function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports}(oP);var sP=oP.exports,rP={exports:{}},lP={exports:{}};!function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(lP);var cP=lP.exports;!function(e){var t=cP.default;function n(i,a){if("function"==typeof WeakMap)var o=new WeakMap,s=new WeakMap;return(e.exports=n=function(e,n){if(!n&&e&&e.__esModule)return e;var i,a,r={__proto__:null,default:e};if(null===e||"object"!=t(e)&&"function"!=typeof e)return r;if(i=n?s:o){if(i.has(e))return i.get(e);i.set(e,r)}for(var l in e)"default"!==l&&{}.hasOwnProperty.call(e,l)&&((a=(i=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,l))&&(a.get||a.set)?i(r,l,a):r[l]=e[l]);return r},e.exports.__esModule=!0,e.exports.default=e.exports)(i,a)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}(rP);var uP=rP.exports;const dP=W(ue);var hP={},pP={exports:{}},mP={exports:{}};!function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports}(mP);var fP=mP.exports,gP={exports:{}};!function(e){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,a,o,s,r=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=o.call(n)).done)&&(r.push(i.value),r.length!==t);l=!0);}catch(u){c=!0,a=u}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw a}}return r}},e.exports.__esModule=!0,e.exports.default=e.exports}(gP);var vP=gP.exports,yP={exports:{}},bP={exports:{}};!function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i},e.exports.__esModule=!0,e.exports.default=e.exports}(bP);var xP=bP.exports;!function(e){var t=xP;e.exports=function(e,n){if(e){if("string"==typeof e)return t(e,n);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?t(e,n):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports}(yP);var wP=yP.exports,SP={exports:{}};!function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports}(SP);var _P=SP.exports;!function(e){var t=fP,n=vP,i=wP,a=_P;e.exports=function(e,o){return t(e)||n(e,o)||i(e,o)||a()},e.exports.__esModule=!0,e.exports.default=e.exports}(pP);var CP=pP.exports,EP={},kP=uP.default;Object.defineProperty(EP,"__esModule",{value:!0}),EP.default=function(e){var t=IP.useRef();return t.current=e,IP.useCallback(function(){for(var e,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return null===(e=t.current)||void 0===e?void 0:e.call.apply(e,[t].concat(i))},[])};var IP=kP(O);var TP={},jP={};Object.defineProperty(jP,"__esModule",{value:!0}),jP.default=function(){return!("undefined"==typeof window||!window.document||!window.document.createElement)};var NP=sP.default,PP=uP.default;Object.defineProperty(TP,"__esModule",{value:!0}),TP.useLayoutUpdateEffect=TP.default=void 0;var MP=PP(O),AP=(0,NP(jP).default)()?MP.useLayoutEffect:MP.useEffect,RP=function(e,t){var n=MP.useRef(!0);AP(function(){return e(n.current)},t),AP(function(){return n.current=!1,function(){n.current=!0}},[])};TP.useLayoutUpdateEffect=function(e,t){RP(function(t){if(!t)return e()},t)},TP.default=RP;var OP={},DP=uP.default,LP=sP.default;Object.defineProperty(OP,"__esModule",{value:!0}),OP.default=function(e){var t=UP.useRef(!1),n=UP.useState(e),i=(0,FP.default)(n,2),a=i[0],o=i[1];return UP.useEffect(function(){return t.current=!1,function(){t.current=!0}},[]),[a,function(e,n){if(n&&t.current)return;o(e)}]};var FP=LP(CP),UP=DP(O);var zP=sP.default;Object.defineProperty(hP,"__esModule",{value:!0}),hP.default=function(e,t){var n=t||{},i=n.defaultValue,a=n.value,o=n.onChange,s=n.postState,r=(0,qP.default)(function(){return GP(a)?a:GP(i)?"function"==typeof i?i():i:"function"==typeof e?e():e}),l=(0,HP.default)(r,2),c=l[0],u=l[1],d=void 0!==a?a:c,h=s?s(d):d,p=(0,$P.default)(o),m=(0,qP.default)([d]),f=(0,HP.default)(m,2),g=f[0],v=f[1];(0,BP.useLayoutUpdateEffect)(function(){var e=g[0];c!==e&&p(c,e)},[g]),(0,BP.useLayoutUpdateEffect)(function(){GP(a)||u(a)},[a]);var y=(0,$P.default)(function(e,t){u(e,t),v([d],t)});return[h,y]};var HP=zP(CP),$P=zP(EP),BP=TP,qP=zP(OP);function GP(e){return void 0!==e}var VP={},WP={};const QP=W(de);var KP={};Object.defineProperty(KP,"__esModule",{value:!0}),KP.default=function(e,t){var n=Object.assign({},e);Array.isArray(t)&&t.forEach(function(e){delete n[e]});return n};var YP=sP.default,XP=uP.default;Object.defineProperty(WP,"__esModule",{value:!0}),WP.VariantContext=WP.NoStyleItemContext=WP.NoFormStyle=WP.FormProvider=WP.FormItemPrefixContext=WP.FormItemInputContext=WP.FormContext=void 0;var JP=XP(O),ZP=QP,eM=YP(KP);WP.FormContext=JP.createContext({labelAlign:"right",layout:"horizontal",itemRef:()=>{}}),WP.NoStyleItemContext=JP.createContext(null);WP.FormProvider=e=>{const t=(0,eM.default)(e,["prefixCls"]);return JP.createElement(ZP.FormProvider,Object.assign({},t))},WP.FormItemPrefixContext=JP.createContext({prefixCls:""});const tM=WP.FormItemInputContext=JP.createContext({});WP.NoFormStyle=({children:e,status:t,override:n})=>{const i=JP.useContext(tM),a=JP.useMemo(()=>{const e=Object.assign({},i);return n&&delete e.isFormItemInput,t&&(delete e.status,delete e.hasFeedback,delete e.feedbackIcon),e},[t,n,i]);return JP.createElement(tM.Provider,{value:a},e)},WP.VariantContext=JP.createContext(void 0);var nM={},iM={},aM={},oM=sP.default;Object.defineProperty(aM,"__esModule",{value:!0}),aM.default=function(e){return e&&"object"===(0,sM.default)(e)&&(e.$$typeof===rM||e.$$typeof===lM)&&e.type===cM};var sM=oM(cP),rM=Symbol.for("react.element"),lM=Symbol.for("react.transitional.element"),cM=Symbol.for("react.fragment");var uM=sP.default;Object.defineProperty(iM,"__esModule",{value:!0}),iM.default=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=[];return hM.default.Children.forEach(t,function(t){(null!=t||n.keepEmpty)&&(Array.isArray(t)?i=i.concat(e(t)):(0,dM.default)(t)&&t.props?i=i.concat(e(t.props.children,n)):i.push(t))}),i};var dM=uM(aM),hM=uM(O);var pM={};const mM=W(he);var fM={};Object.defineProperty(fM,"__esModule",{value:!0}),fM.default=void 0;var gM=(0,O.createContext)({});fM.default=gM;var vM={},yM=uP.default;Object.defineProperty(vM,"__esModule",{value:!0}),vM.default=function(e,t,n){var i=bM.useRef({});"value"in i.current&&!n(i.current.condition,t)||(i.current.value=e(),i.current.condition=t);return i.current.value};var bM=yM(O);var xM={},wM={exports:{}},SM={exports:{}},_M={exports:{}},CM={exports:{}};!function(e){var t=cP.default;e.exports=function(e,n){if("object"!=t(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var a=i.call(e,n||"default");if("object"!=t(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports}(CM);var EM=CM.exports;!function(e){var t=cP.default,n=EM;e.exports=function(e){var i=n(e,"string");return"symbol"==t(i)?i:i+""},e.exports.__esModule=!0,e.exports.default=e.exports}(_M);var kM=_M.exports;!function(e){var t=kM;e.exports=function(e,n,i){return(n=t(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e},e.exports.__esModule=!0,e.exports.default=e.exports}(SM);var IM=SM.exports;!function(e){var t=IM;function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}e.exports=function(e){for(var i=1;i<arguments.length;i++){var a=null!=arguments[i]?arguments[i]:{};i%2?n(Object(a),!0).forEach(function(n){t(e,n,a[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e},e.exports.__esModule=!0,e.exports.default=e.exports}(wM);var TM=wM.exports,jM={exports:{}},NM={exports:{}};!function(e){var t=xP;e.exports=function(e){if(Array.isArray(e))return t(e)},e.exports.__esModule=!0,e.exports.default=e.exports}(NM);var PM=NM.exports,MM={exports:{}};!function(e){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports}(MM);var AM=MM.exports,RM={exports:{}};!function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports}(RM);var OM=RM.exports;!function(e){var t=PM,n=AM,i=wP,a=OM;e.exports=function(e){return t(e)||n(e)||i(e)||a()},e.exports.__esModule=!0,e.exports.default=e.exports}(jM);var DM=jM.exports,LM={exports:{}};!function(e){var t=fP,n=AM,i=wP,a=_P;e.exports=function(e){return t(e)||n(e)||i(e)||a()},e.exports.__esModule=!0,e.exports.default=e.exports}(LM);var FM=LM.exports,UM={};Object.defineProperty(UM,"__esModule",{value:!0}),UM.default=function(e,t){for(var n=e,i=0;i<t.length;i+=1){if(null==n)return;n=n[t[i]]}return n};var zM=sP.default;Object.defineProperty(xM,"__esModule",{value:!0}),xM.default=WM,xM.merge=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=QM(t[0]);return t.forEach(function(e){!function t(n,a){var o,s=new Set(a),r=(0,GM.default)(e,n),l=Array.isArray(r);if(l||(o=r,"object"===(0,HM.default)(o)&&null!==o&&Object.getPrototypeOf(o)===Object.prototype)){if(!s.has(r)){s.add(r);var c=(0,GM.default)(i,n);l?i=WM(i,n,[]):c&&"object"===(0,HM.default)(c)||(i=WM(i,n,QM(r))),KM(r).forEach(function(e){t([].concat((0,BM.default)(n),[e]),s)})}}else i=WM(i,n,r)}([])}),i};var HM=zM(cP),$M=zM(TM),BM=zM(DM),qM=zM(FM),GM=zM(UM);function VM(e,t,n,i){if(!t.length)return n;var a,o=(0,qM.default)(t),s=o[0],r=o.slice(1);return a=e||"number"!=typeof s?Array.isArray(e)?(0,BM.default)(e):(0,$M.default)({},e):[],i&&void 0===n&&1===r.length?delete a[s][r[0]]:a[s]=VM(a[s],r,n,i),a}function WM(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return t.length&&i&&void 0===n&&!(0,GM.default)(e,t.slice(0,-1))?e:VM(e,t,n,i)}function QM(e){return Array.isArray(e)?[]:{}}var KM="undefined"==typeof Reflect?Object.keys:Reflect.ownKeys;var YM={},XM={};Object.defineProperty(XM,"__esModule",{value:!0}),XM.call=iA,XM.default=void 0,XM.note=tA,XM.noteOnce=oA,XM.preMessage=void 0,XM.resetWarned=nA,XM.warning=eA,XM.warningOnce=aA;var JM={},ZM=XM.preMessage=function(e){};function eA(e,t){}function tA(e,t){}function nA(){JM={}}function iA(e,t,n){t||JM[n]||(e(!1,n),JM[n]=!0)}function aA(e,t){iA(eA,e,t)}function oA(e,t){iA(tA,e,t)}aA.preMessage=ZM,aA.resetWarned=nA,aA.noteOnce=oA,XM.default=aA;var sA=uP.default;Object.defineProperty(YM,"__esModule",{value:!0}),YM.devUseWarning=YM.default=YM.WarningContext=void 0,YM.noop=cA,YM.resetWarned=function(){(0,lA.resetWarned)()};var rA=sA(O),lA=sA(XM);function cA(){}const uA=cA;YM.WarningContext=rA.createContext({}),YM.devUseWarning=()=>{const e=()=>{};return e.deprecated=cA,e},YM.default=uA;var dA={};Object.defineProperty(dA,"__esModule",{value:!0}),dA.default=void 0;var hA=O;dA.default=(0,hA.createContext)(void 0);var pA={},mA={},fA={},gA={};Object.defineProperty(gA,"__esModule",{value:!0}),gA.default=void 0;gA.default={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"};var vA={},yA={},bA={},xA={};Object.defineProperty(xA,"__esModule",{value:!0}),xA.commonLocale=void 0,xA.commonLocale={yearFormat:"YYYY",dayFormat:"D",cellMeridiemFormat:"A",monthBeforeYear:!0};var wA=sP.default;Object.defineProperty(bA,"__esModule",{value:!0}),bA.default=void 0;var SA=wA(TM),_A=xA,CA=(0,SA.default)((0,SA.default)({},_A.commonLocale),{},{locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"OK",clear:"Clear",week:"Week",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",dateFormat:"M/D/YYYY",dateTimeFormat:"M/D/YYYY HH:mm:ss",previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"});bA.default=CA;var EA={};Object.defineProperty(EA,"__esModule",{value:!0}),EA.default=void 0;EA.default={placeholder:"Select time",rangePlaceholder:["Start time","End time"]};var kA=sP.default;Object.defineProperty(yA,"__esModule",{value:!0}),yA.default=void 0;var IA=kA(bA),TA=kA(EA);const jA={lang:Object.assign({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeQuarterPlaceholder:["Start quarter","End quarter"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},IA.default),timePickerLocale:Object.assign({},TA.default)};yA.default=jA;var NA=sP.default;Object.defineProperty(vA,"__esModule",{value:!0}),vA.default=void 0;var PA=NA(yA);vA.default=PA.default;var MA=sP.default;Object.defineProperty(fA,"__esModule",{value:!0}),fA.default=void 0;var AA=MA(gA),RA=MA(vA),OA=MA(yA),DA=MA(EA);const LA="${label} is not a valid ${type}",FA={locale:"en",Pagination:AA.default,DatePicker:OA.default,TimePicker:DA.default,Calendar:RA.default,global:{placeholder:"Please select",close:"Close"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",filterCheckAll:"Select all items",filterSearchPlaceholder:"Search in filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Tour:{Next:"Next",Previous:"Previous",Finish:"Finish"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",deselectAll:"Deselect all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand",collapse:"Collapse"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:LA,method:LA,array:LA,object:LA,number:LA,date:LA,boolean:LA,integer:LA,float:LA,regexp:LA,email:LA,url:LA,hex:LA},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"},QRCode:{expired:"QR code expired",refresh:"Refresh",scanned:"Scanned"},ColorPicker:{presetEmpty:"Empty",transparent:"Transparent",singleColor:"Single",gradientColor:"Gradient"}};fA.default=FA;var UA=sP.default;Object.defineProperty(mA,"__esModule",{value:!0}),mA.changeConfirmLocale=function(e){if(e){const t=Object.assign({},e);return $A.push(t),HA=BA(),()=>{$A=$A.filter(e=>e!==t),HA=BA()}}HA=Object.assign({},zA.default.Modal)},mA.getConfirmLocale=function(){return HA};var zA=UA(fA);let HA=Object.assign({},zA.default.Modal),$A=[];const BA=()=>$A.reduce((e,t)=>Object.assign(Object.assign({},e),t),zA.default.Modal);var qA={};Object.defineProperty(qA,"__esModule",{value:!0}),qA.default=void 0;const GA=(0,O.createContext)(void 0);qA.default=GA;var VA={},WA=sP.default,QA=uP.default;Object.defineProperty(VA,"__esModule",{value:!0}),VA.default=void 0;var KA=QA(O),YA=WA(qA),XA=WA(fA);VA.default=(e,t)=>{const n=KA.useContext(YA.default);return[KA.useMemo(()=>{var i;const a=t||XA.default[e],o=null!==(i=null==n?void 0:n[e])&&void 0!==i?i:{};return Object.assign(Object.assign({},"function"==typeof a?a():a),o||{})},[e,t,n]),KA.useMemo(()=>{const e=null==n?void 0:n.locale;return(null==n?void 0:n.exist)&&!e?XA.default.locale:e},[n])]},function(e){var t=sP.default,n=uP.default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.ANT_MARK=void 0,Object.defineProperty(e,"useLocale",{enumerable:!0,get:function(){return s.default}});var i=n(O),a=mA,o=t(qA),s=t(VA);e.ANT_MARK="internalMark";e.default=e=>{const{locale:t={},children:n,_ANT_MARK__:s}=e;i.useEffect(()=>(0,a.changeConfirmLocale)(null==t?void 0:t.Modal),[t]);const r=i.useMemo(()=>Object.assign(Object.assign({},t),{exist:!0}),[t]);return i.createElement(o.default.Provider,{value:r},n)}}(pA);var JA={},ZA={};Object.defineProperty(ZA,"__esModule",{value:!0}),ZA.defaultPresetColors=ZA.default=void 0;const eR=ZA.defaultPresetColors={blue:"#1677FF",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#EB2F96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},tR=Object.assign(Object.assign({},eR),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorLink:"",colorTextBase:"",colorBgBase:"",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,\n'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',\n'Noto Color Emoji'",fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1,motion:!0});ZA.default=tR;var nR={},iR={};const aR=W(pe);var oR={};const sR=W(me);Object.defineProperty(oR,"__esModule",{value:!0}),oR.default=function(e,{generateColorPalettes:t,generateNeutralColorPalettes:n}){const{colorSuccess:i,colorWarning:a,colorError:o,colorInfo:s,colorPrimary:r,colorBgBase:l,colorTextBase:c}=e,u=t(r),d=t(i),h=t(a),p=t(o),m=t(s),f=n(l,c),g=e.colorLink||e.colorInfo,v=t(g),y=new rR.FastColor(p[1]).mix(new rR.FastColor(p[3]),50).toHexString();return Object.assign(Object.assign({},f),{colorPrimaryBg:u[1],colorPrimaryBgHover:u[2],colorPrimaryBorder:u[3],colorPrimaryBorderHover:u[4],colorPrimaryHover:u[5],colorPrimary:u[6],colorPrimaryActive:u[7],colorPrimaryTextHover:u[8],colorPrimaryText:u[9],colorPrimaryTextActive:u[10],colorSuccessBg:d[1],colorSuccessBgHover:d[2],colorSuccessBorder:d[3],colorSuccessBorderHover:d[4],colorSuccessHover:d[4],colorSuccess:d[6],colorSuccessActive:d[7],colorSuccessTextHover:d[8],colorSuccessText:d[9],colorSuccessTextActive:d[10],colorErrorBg:p[1],colorErrorBgHover:p[2],colorErrorBgFilledHover:y,colorErrorBgActive:p[3],colorErrorBorder:p[3],colorErrorBorderHover:p[4],colorErrorHover:p[5],colorError:p[6],colorErrorActive:p[7],colorErrorTextHover:p[8],colorErrorText:p[9],colorErrorTextActive:p[10],colorWarningBg:h[1],colorWarningBgHover:h[2],colorWarningBorder:h[3],colorWarningBorderHover:h[4],colorWarningHover:h[4],colorWarning:h[6],colorWarningActive:h[7],colorWarningTextHover:h[8],colorWarningText:h[9],colorWarningTextActive:h[10],colorInfoBg:m[1],colorInfoBgHover:m[2],colorInfoBorder:m[3],colorInfoBorderHover:m[4],colorInfoHover:m[4],colorInfo:m[6],colorInfoActive:m[7],colorInfoTextHover:m[8],colorInfoText:m[9],colorInfoTextActive:m[10],colorLinkHover:v[4],colorLink:v[6],colorLinkActive:v[7],colorBgMask:new rR.FastColor("#000").setA(.45).toRgbString(),colorWhite:"#fff"})};var rR=sR;var lR={},cR={};Object.defineProperty(cR,"__esModule",{value:!0}),cR.default=void 0;cR.default=e=>{let t=e,n=e,i=e,a=e;return e<6&&e>=5?t=e+1:e<16&&e>=6?t=e+2:e>=16&&(t=16),e<7&&e>=5?n=4:e<8&&e>=7?n=5:e<14&&e>=8?n=6:e<16&&e>=14?n=7:e>=16&&(n=8),e<6&&e>=2?i=1:e>=6&&(i=2),e>4&&e<8?a=4:e>=8&&(a=6),{borderRadius:e,borderRadiusXS:i,borderRadiusSM:n,borderRadiusLG:t,borderRadiusOuter:a}};var uR=sP.default;Object.defineProperty(lR,"__esModule",{value:!0}),lR.default=function(e){const{motionUnit:t,motionBase:n,borderRadius:i,lineWidth:a}=e;return Object.assign({motionDurationFast:`${(n+t).toFixed(1)}s`,motionDurationMid:`${(n+2*t).toFixed(1)}s`,motionDurationSlow:`${(n+3*t).toFixed(1)}s`,lineWidthBold:a+1},(0,dR.default)(i))};var dR=uR(cR);var hR={};Object.defineProperty(hR,"__esModule",{value:!0}),hR.default=void 0;hR.default=e=>{const{controlHeight:t}=e;return{controlHeightSM:.75*t,controlHeightXS:.5*t,controlHeightLG:1.25*t}};var pR={},mR={};function fR(e){return(e+8)/e}Object.defineProperty(mR,"__esModule",{value:!0}),mR.default=function(e){const t=Array.from({length:10}).map((t,n)=>{const i=n-1,a=e*Math.pow(Math.E,i/5),o=n>1?Math.floor(a):Math.ceil(a);return 2*Math.floor(o/2)});return t[1]=e,t.map(e=>({size:e,lineHeight:fR(e)}))},mR.getLineHeight=fR;var gR=sP.default;Object.defineProperty(pR,"__esModule",{value:!0}),pR.default=void 0;var vR=gR(mR);pR.default=e=>{const t=(0,vR.default)(e),n=t.map(e=>e.size),i=t.map(e=>e.lineHeight),a=n[1],o=n[0],s=n[2],r=i[1],l=i[0],c=i[2];return{fontSizeSM:o,fontSize:a,fontSizeLG:s,fontSizeXL:n[3],fontSizeHeading1:n[6],fontSizeHeading2:n[5],fontSizeHeading3:n[4],fontSizeHeading4:n[3],fontSizeHeading5:n[2],lineHeight:r,lineHeightLG:c,lineHeightSM:l,fontHeight:Math.round(r*a),fontHeightLG:Math.round(c*s),fontHeightSM:Math.round(l*o),lineHeightHeading1:i[6],lineHeightHeading2:i[5],lineHeightHeading3:i[4],lineHeightHeading4:i[3],lineHeightHeading5:i[2]}};var yR={};Object.defineProperty(yR,"__esModule",{value:!0}),yR.default=function(e){const{sizeUnit:t,sizeStep:n}=e;return{sizeXXL:t*(n+8),sizeXL:t*(n+4),sizeLG:t*(n+2),sizeMD:t*(n+1),sizeMS:t*n,size:t*n,sizeSM:t*(n-1),sizeXS:t*(n-2),sizeXXS:t*(n-3)}};var bR={},xR={};Object.defineProperty(xR,"__esModule",{value:!0}),xR.getSolidColor=xR.getAlphaColor=void 0;var wR=sR;xR.getAlphaColor=(e,t)=>new wR.FastColor(e).setA(t).toRgbString();xR.getSolidColor=(e,t)=>new wR.FastColor(e).darken(t).toHexString(),Object.defineProperty(bR,"__esModule",{value:!0}),bR.generateNeutralColorPalettes=bR.generateColorPalettes=void 0;var SR=aR,_R=xR;bR.generateColorPalettes=e=>{const t=(0,SR.generate)(e);return{1:t[0],2:t[1],3:t[2],4:t[3],5:t[4],6:t[5],7:t[6],8:t[4],9:t[5],10:t[6]}};bR.generateNeutralColorPalettes=(e,t)=>{const n=e||"#fff",i=t||"#000";return{colorBgBase:n,colorTextBase:i,colorText:(0,_R.getAlphaColor)(i,.88),colorTextSecondary:(0,_R.getAlphaColor)(i,.65),colorTextTertiary:(0,_R.getAlphaColor)(i,.45),colorTextQuaternary:(0,_R.getAlphaColor)(i,.25),colorFill:(0,_R.getAlphaColor)(i,.15),colorFillSecondary:(0,_R.getAlphaColor)(i,.06),colorFillTertiary:(0,_R.getAlphaColor)(i,.04),colorFillQuaternary:(0,_R.getAlphaColor)(i,.02),colorBgSolid:(0,_R.getAlphaColor)(i,1),colorBgSolidHover:(0,_R.getAlphaColor)(i,.75),colorBgSolidActive:(0,_R.getAlphaColor)(i,.95),colorBgLayout:(0,_R.getSolidColor)(n,4),colorBgContainer:(0,_R.getSolidColor)(n,0),colorBgElevated:(0,_R.getSolidColor)(n,0),colorBgSpotlight:(0,_R.getAlphaColor)(i,.85),colorBgBlur:"transparent",colorBorder:(0,_R.getSolidColor)(n,15),colorBorderSecondary:(0,_R.getSolidColor)(n,6)}};var CR=sP.default;Object.defineProperty(iR,"__esModule",{value:!0}),iR.default=function(e){ER.presetPrimaryColors.pink=ER.presetPrimaryColors.magenta,ER.presetPalettes.pink=ER.presetPalettes.magenta;const t=Object.keys(kR.defaultPresetColors).map(t=>{const n=e[t]===ER.presetPrimaryColors[t]?ER.presetPalettes[t]:(0,ER.generate)(e[t]);return Array.from({length:10},()=>1).reduce((e,i,a)=>(e[`${t}-${a+1}`]=n[a],e[`${t}${a+1}`]=n[a],e),{})}).reduce((e,t)=>e=Object.assign(Object.assign({},e),t),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),t),(0,IR.default)(e,{generateColorPalettes:MR.generateColorPalettes,generateNeutralColorPalettes:MR.generateNeutralColorPalettes})),(0,NR.default)(e.fontSize)),(0,PR.default)(e)),(0,jR.default)(e)),(0,TR.default)(e))};var ER=aR,kR=ZA,IR=CR(oR),TR=CR(lR),jR=CR(hR),NR=CR(pR),PR=CR(yR),MR=bR;var AR=sP.default;Object.defineProperty(nR,"__esModule",{value:!0}),nR.default=void 0;var RR=mM,OR=AR(iR);const DR=(0,RR.createTheme)(OR.default);nR.default=DR,function(e){var t=sP.default;Object.defineProperty(e,"__esModule",{value:!0}),e.defaultConfig=e.DesignTokenContext=void 0,Object.defineProperty(e,"defaultTheme",{enumerable:!0,get:function(){return a.default}});var n=t(O),i=t(ZA),a=t(nR);const o=e.defaultConfig={token:i.default,override:{override:i.default},hashed:!0};e.DesignTokenContext=n.default.createContext(o)}(JA);var LR={},FR=uP.default;Object.defineProperty(LR,"__esModule",{value:!0}),LR.defaultPrefixCls=LR.defaultIconPrefixCls=LR.Variants=LR.ConfigContext=LR.ConfigConsumer=void 0,LR.useComponentConfig=function(e){const t=UR.useContext($R),{getPrefixCls:n,direction:i,getPopupContainer:a}=t,o=t[e];return Object.assign(Object.assign({classNames:qR,styles:qR},o),{getPrefixCls:n,direction:i,getPopupContainer:a})};var UR=FR(O);const zR=LR.defaultPrefixCls="ant",HR=LR.defaultIconPrefixCls="anticon";LR.Variants=["outlined","borderless","filled","underlined"];const $R=LR.ConfigContext=UR.createContext({getPrefixCls:(e,t)=>t||(e?`${zR}-${e}`:zR),iconPrefixCls:HR}),{Consumer:BR}=$R;LR.ConfigConsumer=BR;const qR={};var GR={},VR={},WR={};Object.defineProperty(WR,"__esModule",{value:!0}),WR.default=function(e,t){if(!e)return!1;if(e.contains)return e.contains(t);var n=t;for(;n;){if(n===e)return!0;n=n.parentNode}return!1};var QR=sP.default;Object.defineProperty(VR,"__esModule",{value:!0}),VR.clearContainerCache=function(){tO.clear()},VR.injectCSS=oO,VR.removeCSS=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=sO(e,t);if(n){iO(t).removeChild(n)}},VR.updateCSS=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=iO(n),a=aO(i),o=(0,KR.default)((0,KR.default)({},n),{},{styles:a});!function(e,t){var n=tO.get(e);if(!n||!(0,XR.default)(document,n)){var i=oO("",t),a=i.parentNode;tO.set(e,a),e.removeChild(i)}}(i,o);var s=sO(t,o);if(s){var r,l,c;if(null!==(r=o.csp)&&void 0!==r&&r.nonce&&s.nonce!==(null===(l=o.csp)||void 0===l?void 0:l.nonce))s.nonce=null===(c=o.csp)||void 0===c?void 0:c.nonce;return s.innerHTML!==e&&(s.innerHTML=e),s}var u=oO(e,o);return u.setAttribute(nO(o),t),u};var KR=QR(TM),YR=QR(jP),XR=QR(WR),JR="data-rc-order",ZR="data-rc-priority",eO="rc-util-key",tO=new Map;function nO(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).mark;return e?e.startsWith("data-")?e:"data-".concat(e):eO}function iO(e){return e.attachTo?e.attachTo:document.querySelector("head")||document.body}function aO(e){return Array.from((tO.get(e)||e).children).filter(function(e){return"STYLE"===e.tagName})}function oO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,YR.default)())return null;var n=t.csp,i=t.prepend,a=t.priority,o=void 0===a?0:a,s=function(e){return"queue"===e?"prependQueue":e?"prepend":"append"}(i),r="prependQueue"===s,l=document.createElement("style");l.setAttribute(JR,s),r&&o&&l.setAttribute(ZR,"".concat(o)),null!=n&&n.nonce&&(l.nonce=null==n?void 0:n.nonce),l.innerHTML=e;var c=iO(t),u=c.firstChild;if(i){if(r){var d=(t.styles||aO(c)).filter(function(e){if(!["prepend","prependQueue"].includes(e.getAttribute(JR)))return!1;var t=Number(e.getAttribute(ZR)||0);return o>=t});if(d.length)return c.insertBefore(l,d[d.length-1].nextSibling),l}c.insertBefore(l,u)}else c.appendChild(l);return l}function sO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=iO(t);return(t.styles||aO(n)).find(function(n){return n.getAttribute(nO(t))===e})}var rO=sP.default;Object.defineProperty(GR,"__esModule",{value:!0}),GR.getStyle=pO,GR.registerTheme=function(e,t){const n=pO(e,t);(0,uO.default)()&&(0,dO.updateCSS)(n,`${hO}-dynamic-theme`)};var lO=aR,cO=sR,uO=rO(jP),dO=VR;rO(YM);const hO=`-ant-${Date.now()}-${Math.random()}`;function pO(e,t){const n={},i=(e,t)=>{let n=e.clone();return n=(null==t?void 0:t(n))||n,n.toRgbString()},a=(e,t)=>{const a=new cO.FastColor(e),o=(0,lO.generate)(a.toRgbString());n[`${t}-color`]=i(a),n[`${t}-color-disabled`]=o[1],n[`${t}-color-hover`]=o[4],n[`${t}-color-active`]=o[6],n[`${t}-color-outline`]=a.clone().setA(.2).toRgbString(),n[`${t}-color-deprecated-bg`]=o[0],n[`${t}-color-deprecated-border`]=o[2]};if(t.primaryColor){a(t.primaryColor,"primary");const e=new cO.FastColor(t.primaryColor),o=(0,lO.generate)(e.toRgbString());o.forEach((e,t)=>{n[`primary-${t+1}`]=e}),n["primary-color-deprecated-l-35"]=i(e,e=>e.lighten(35)),n["primary-color-deprecated-l-20"]=i(e,e=>e.lighten(20)),n["primary-color-deprecated-t-20"]=i(e,e=>e.tint(20)),n["primary-color-deprecated-t-50"]=i(e,e=>e.tint(50)),n["primary-color-deprecated-f-12"]=i(e,e=>e.setA(.12*e.a));const s=new cO.FastColor(o[0]);n["primary-color-active-deprecated-f-30"]=i(s,e=>e.setA(.3*e.a)),n["primary-color-active-deprecated-d-02"]=i(s,e=>e.darken(2))}t.successColor&&a(t.successColor,"success"),t.warningColor&&a(t.warningColor,"warning"),t.errorColor&&a(t.errorColor,"error"),t.infoColor&&a(t.infoColor,"info");return`\n  :root {\n    ${Object.keys(n).map(t=>`--${e}-${t}: ${n[t]};`).join("\n")}\n  }\n  `.trim()}var mO={},fO=uP.default;Object.defineProperty(mO,"__esModule",{value:!0}),mO.default=mO.DisabledContextProvider=void 0;var gO=fO(O);const vO=gO.createContext(!1);mO.DisabledContextProvider=({children:e,disabled:t})=>{const n=gO.useContext(vO);return gO.createElement(vO.Provider,{value:null!=t?t:n},e)},mO.default=vO;var yO={},bO={},xO=uP.default;Object.defineProperty(bO,"__esModule",{value:!0}),bO.default=bO.SizeContextProvider=void 0;var wO=xO(O);const SO=wO.createContext(void 0);bO.SizeContextProvider=({children:e,size:t})=>{const n=wO.useContext(SO);return wO.createElement(SO.Provider,{value:t||n},e)},bO.default=SO;var _O=sP.default;Object.defineProperty(yO,"__esModule",{value:!0}),yO.default=void 0;var CO=O,EO=_O(mO),kO=_O(bO);yO.default=function(){return{componentDisabled:(0,CO.useContext)(EO.default),componentSize:(0,CO.useContext)(kO.default)}};var IO={},TO={},jO=sP.default;Object.defineProperty(TO,"__esModule",{value:!0}),TO.default=void 0;var NO=jO(cP),PO=jO(XM);TO.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=new Set;return function e(t,a){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=i.has(t);if((0,PO.default)(!s,"Warning: There may be circular references"),s)return!1;if(t===a)return!0;if(n&&o>1)return!1;i.add(t);var r=o+1;if(Array.isArray(t)){if(!Array.isArray(a)||t.length!==a.length)return!1;for(var l=0;l<t.length;l++)if(!e(t[l],a[l],r))return!1;return!0}if(t&&a&&"object"===(0,NO.default)(t)&&"object"===(0,NO.default)(a)){var c=Object.keys(t);return c.length===Object.keys(a).length&&c.every(function(n){return e(t[n],a[n],r)})}return!1}(e,t)};var MO={};const AO=W(fe);var RO={},OO={};Object.defineProperty(OO,"__esModule",{value:!0}),OO.PresetColors=void 0,OO.PresetColors=["blue","purple","cyan","green","magenta","pink","red","orange","yellow","volcano","geekblue","lime","gold"],function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"PresetColors",{enumerable:!0,get:function(){return t.PresetColors}});var t=OO}(RO);var DO={},LO={},FO={};Object.defineProperty(FO,"__esModule",{value:!0}),FO.default=void 0,FO.default="5.29.3";var UO=sP.default;Object.defineProperty(LO,"__esModule",{value:!0}),LO.default=void 0;var zO=UO(FO);LO.default=zO.default;var HO={},$O={};Object.defineProperty($O,"__esModule",{value:!0}),$O.default=void 0;var BO=sR;function qO(e){return e>=0&&e<=255}$O.default=function(e,t){const{r:n,g:i,b:a,a:o}=new BO.FastColor(e).toRgb();if(o<1)return e;const{r:s,g:r,b:l}=new BO.FastColor(t).toRgb();for(let c=.01;c<=1;c+=.01){const e=Math.round((n-s*(1-c))/c),t=Math.round((i-r*(1-c))/c),o=Math.round((a-l*(1-c))/c);if(qO(e)&&qO(t)&&qO(o))return new BO.FastColor({r:e,g:t,b:o,a:Math.round(100*c)/100}).toRgbString()}return new BO.FastColor({r:n,g:i,b:a,a:1}).toRgbString()};var GO=sP.default;Object.defineProperty(HO,"__esModule",{value:!0}),HO.default=function(e){const{override:t}=e,n=KO(e,["override"]),i=Object.assign({},t);Object.keys(WO.default).forEach(e=>{delete i[e]});const a=Object.assign(Object.assign({},n),i),o=1200,s=1600;if(!1===a.motion){const e="0s";a.motionDurationFast=e,a.motionDurationMid=e,a.motionDurationSlow=e}return Object.assign(Object.assign(Object.assign({},a),{colorFillContent:a.colorFillSecondary,colorFillContentHover:a.colorFill,colorFillAlter:a.colorFillQuaternary,colorBgContainerDisabled:a.colorFillTertiary,colorBorderBg:a.colorBgContainer,colorSplit:(0,QO.default)(a.colorBorderSecondary,a.colorBgContainer),colorTextPlaceholder:a.colorTextQuaternary,colorTextDisabled:a.colorTextQuaternary,colorTextHeading:a.colorText,colorTextLabel:a.colorTextSecondary,colorTextDescription:a.colorTextTertiary,colorTextLightSolid:a.colorWhite,colorHighlight:a.colorError,colorBgTextHover:a.colorFillSecondary,colorBgTextActive:a.colorFill,colorIcon:a.colorTextTertiary,colorIconHover:a.colorText,colorErrorOutline:(0,QO.default)(a.colorErrorBg,a.colorBgContainer),colorWarningOutline:(0,QO.default)(a.colorWarningBg,a.colorBgContainer),fontSizeIcon:a.fontSizeSM,lineWidthFocus:3*a.lineWidth,lineWidth:a.lineWidth,controlOutlineWidth:2*a.lineWidth,controlInteractiveSize:a.controlHeight/2,controlItemBgHover:a.colorFillTertiary,controlItemBgActive:a.colorPrimaryBg,controlItemBgActiveHover:a.colorPrimaryBgHover,controlItemBgActiveDisabled:a.colorFill,controlTmpOutline:a.colorFillQuaternary,controlOutline:(0,QO.default)(a.colorPrimaryBg,a.colorBgContainer),lineType:a.lineType,borderRadius:a.borderRadius,borderRadiusXS:a.borderRadiusXS,borderRadiusSM:a.borderRadiusSM,borderRadiusLG:a.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:a.sizeXXS,paddingXS:a.sizeXS,paddingSM:a.sizeSM,padding:a.size,paddingMD:a.sizeMD,paddingLG:a.sizeLG,paddingXL:a.sizeXL,paddingContentHorizontalLG:a.sizeLG,paddingContentVerticalLG:a.sizeMS,paddingContentHorizontal:a.sizeMS,paddingContentVertical:a.sizeSM,paddingContentHorizontalSM:a.size,paddingContentVerticalSM:a.sizeXS,marginXXS:a.sizeXXS,marginXS:a.sizeXS,marginSM:a.sizeSM,margin:a.size,marginMD:a.sizeMD,marginLG:a.sizeLG,marginXL:a.sizeXL,marginXXL:a.sizeXXL,boxShadow:"\n      0 6px 16px 0 rgba(0, 0, 0, 0.08),\n      0 3px 6px -4px rgba(0, 0, 0, 0.12),\n      0 9px 28px 8px rgba(0, 0, 0, 0.05)\n    ",boxShadowSecondary:"\n      0 6px 16px 0 rgba(0, 0, 0, 0.08),\n      0 3px 6px -4px rgba(0, 0, 0, 0.12),\n      0 9px 28px 8px rgba(0, 0, 0, 0.05)\n    ",boxShadowTertiary:"\n      0 1px 2px 0 rgba(0, 0, 0, 0.03),\n      0 1px 6px -1px rgba(0, 0, 0, 0.02),\n      0 2px 4px 0 rgba(0, 0, 0, 0.02)\n    ",screenXS:480,screenXSMin:480,screenXSMax:575,screenSM:576,screenSMMin:576,screenSMMax:767,screenMD:768,screenMDMin:768,screenMDMax:991,screenLG:992,screenLGMin:992,screenLGMax:1199,screenXL:o,screenXLMin:o,screenXLMax:1599,screenXXL:s,screenXXLMin:s,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`\n      0 1px 2px -2px ${new VO.FastColor("rgba(0, 0, 0, 0.16)").toRgbString()},\n      0 3px 6px 0 ${new VO.FastColor("rgba(0, 0, 0, 0.12)").toRgbString()},\n      0 5px 12px 4px ${new VO.FastColor("rgba(0, 0, 0, 0.09)").toRgbString()}\n    `,boxShadowDrawerRight:"\n      -6px 0 16px 0 rgba(0, 0, 0, 0.08),\n      -3px 0 6px -4px rgba(0, 0, 0, 0.12),\n      -9px 0 28px 8px rgba(0, 0, 0, 0.05)\n    ",boxShadowDrawerLeft:"\n      6px 0 16px 0 rgba(0, 0, 0, 0.08),\n      3px 0 6px -4px rgba(0, 0, 0, 0.12),\n      9px 0 28px 8px rgba(0, 0, 0, 0.05)\n    ",boxShadowDrawerUp:"\n      0 6px 16px 0 rgba(0, 0, 0, 0.08),\n      0 3px 6px -4px rgba(0, 0, 0, 0.12),\n      0 9px 28px 8px rgba(0, 0, 0, 0.05)\n    ",boxShadowDrawerDown:"\n      0 -6px 16px 0 rgba(0, 0, 0, 0.08),\n      0 -3px 6px -4px rgba(0, 0, 0, 0.12),\n      0 -9px 28px 8px rgba(0, 0, 0, 0.05)\n    ",boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),i)};var VO=sR,WO=GO(ZA),QO=GO($O),KO=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(n[i[a]]=e[i[a]])}return n};var YO=sP.default;Object.defineProperty(DO,"__esModule",{value:!0}),DO.default=function(){const{token:e,hashed:t,theme:n,override:i,cssVar:a}=XO.default.useContext(eD.DesignTokenContext),o=`${ZO.default}-${t||""}`,s=n||eD.defaultTheme,[r,l,c]=(0,JO.useCacheToken)(s,[tD.default,e],{salt:o,override:i,getComputedToken:rD,formatToken:nD.default,cssVar:a&&{prefix:a.prefix,key:a.key,unitless:aD,ignore:oD,preserve:sD}});return[s,c,t?l:"",r,a]},DO.unitless=DO.ignore=DO.getComputedToken=void 0;var XO=YO(O),JO=mM,ZO=YO(LO),eD=JA,tD=YO(ZA),nD=YO(HO),iD=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(n[i[a]]=e[i[a]])}return n};const aD=DO.unitless={lineHeight:!0,lineHeightSM:!0,lineHeightLG:!0,lineHeightHeading1:!0,lineHeightHeading2:!0,lineHeightHeading3:!0,lineHeightHeading4:!0,lineHeightHeading5:!0,opacityLoading:!0,fontWeightStrong:!0,zIndexPopupBase:!0,zIndexBase:!0,opacityImage:!0},oD=DO.ignore={motionBase:!0,motionUnit:!0},sD={screenXS:!0,screenXSMin:!0,screenXSMax:!0,screenSM:!0,screenSMMin:!0,screenSMMax:!0,screenMD:!0,screenMDMin:!0,screenMDMax:!0,screenLG:!0,screenLGMin:!0,screenLGMax:!0,screenXL:!0,screenXLMin:!0,screenXLMax:!0,screenXXL:!0,screenXXLMin:!0},rD=(e,t,n)=>{const i=n.getDerivativeToken(e),{override:a}=t,o=iD(t,["override"]);let s=Object.assign(Object.assign({},i),{override:a});return s=(0,nD.default)(s),o&&Object.entries(o).forEach(([e,t])=>{const{theme:n}=t,i=iD(t,["theme"]);let a=i;n&&(a=rD(Object.assign(Object.assign({},s),i),{override:i},n)),s[e]=a}),s};DO.getComputedToken=rD;var lD={},cD={};Object.defineProperty(cD,"__esModule",{value:!0}),cD.textEllipsis=cD.resetIcon=cD.resetComponent=cD.operationUnit=cD.genLinkStyle=cD.genIconStyle=cD.genFocusStyle=cD.genFocusOutline=cD.genCommonStyle=cD.clearFix=void 0;var uD=mM;cD.textEllipsis={overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"};cD.resetComponent=(e,t=!1)=>({boxSizing:"border-box",margin:0,padding:0,color:e.colorText,fontSize:e.fontSize,lineHeight:e.lineHeight,listStyle:"none",fontFamily:t?"inherit":e.fontFamily});const dD=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}});cD.resetIcon=dD;cD.clearFix=()=>({"&::before":{display:"table",content:'""'},"&::after":{display:"table",clear:"both",content:'""'}});cD.genLinkStyle=e=>({a:{color:e.colorLink,textDecoration:e.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${e.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:e.colorLinkHover},"&:active":{color:e.colorLinkActive},"&:active, &:hover":{textDecoration:e.linkHoverDecoration,outline:0},"&:focus":{textDecoration:e.linkFocusDecoration,outline:0},"&[disabled]":{color:e.colorTextDisabled,cursor:"not-allowed"}}});cD.genCommonStyle=(e,t,n,i)=>{const a=`[class^="${t}"], [class*=" ${t}"]`,o=n?`.${n}`:a,s={boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}};let r={};return!1!==i&&(r={fontFamily:e.fontFamily,fontSize:e.fontSize}),{[o]:Object.assign(Object.assign(Object.assign({},r),s),{[a]:s})}};const hD=(e,t)=>({outline:`${(0,uD.unit)(e.lineWidthFocus)} solid ${e.colorPrimaryBorder}`,outlineOffset:null!=t?t:1,transition:"outline-offset 0s, outline 0s"});cD.genFocusOutline=hD;const pD=(e,t)=>({"&:focus-visible":hD(e,t)});cD.genFocusStyle=pD;cD.genIconStyle=e=>({[`.${e}`]:Object.assign(Object.assign({},{display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}}),{[`.${e} .${e}-icon`]:{display:"block"}})});cD.operationUnit=e=>Object.assign(Object.assign({color:e.colorLink,textDecoration:e.linkDecoration,outline:"none",cursor:"pointer",transition:`all ${e.motionDurationSlow}`,border:0,padding:0,background:"none",userSelect:"none"},pD(e)),{"&:hover":{color:e.colorLinkHover,textDecoration:e.linkHoverDecoration},"&:focus":{color:e.colorLinkHover,textDecoration:e.linkFocusDecoration},"&:active":{color:e.colorLinkActive,textDecoration:e.linkHoverDecoration}});var mD=uP.default;Object.defineProperty(lD,"__esModule",{value:!0}),lD.genSubStyleComponent=lD.genStyleHooks=lD.genComponentStyleHook=void 0;var fD=O,gD=AO,vD=LR,yD=cD,bD=mD(DO);const{genStyleHooks:xD,genComponentStyleHook:wD,genSubStyleComponent:SD}=(0,gD.genStyleUtils)({usePrefix:()=>{const{getPrefixCls:e,iconPrefixCls:t}=(0,fD.useContext)(vD.ConfigContext);return{rootPrefixCls:e(),iconPrefixCls:t}},useToken:()=>{const[e,t,n,i,a]=(0,bD.default)();return{theme:e,realToken:t,hashId:n,token:i,cssVar:a}},useCSP:()=>{const{csp:e}=(0,fD.useContext)(vD.ConfigContext);return null!=e?e:{}},getResetStyles:(e,t)=>{var n;const i=(0,yD.genLinkStyle)(e);return[i,{"&":i},(0,yD.genIconStyle)(null!==(n=null==t?void 0:t.prefix.iconPrefixCls)&&void 0!==n?n:vD.defaultIconPrefixCls)]},getCommonStyle:yD.genCommonStyle,getCompUnitless:()=>bD.unitless});lD.genSubStyleComponent=SD,lD.genComponentStyleHook=wD,lD.genStyleHooks=xD;var _D={};Object.defineProperty(_D,"__esModule",{value:!0}),_D.default=function(e,t){return CD.PresetColors.reduce((n,i)=>{const a=e[`${i}1`],o=e[`${i}3`],s=e[`${i}6`],r=e[`${i}7`];return Object.assign(Object.assign({},n),t(i,{lightColor:a,lightBorderColor:o,darkColor:s,textColor:r}))},{})};var CD=RO;var ED={},kD=sP.default;Object.defineProperty(ED,"__esModule",{value:!0}),ED.default=void 0;var ID=mM,TD=cD,jD=kD(DO);ED.default=(e,t)=>{const[n,i]=(0,jD.default)();return(0,ID.useStyleRegister)({theme:n,token:i,hashId:"",path:["ant-design-icons",e],nonce:()=>null==t?void 0:t.nonce,layer:{name:"antd"}},()=>(0,TD.genIconStyle)(e))},function(e){var t=sP.default;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"DesignTokenContext",{enumerable:!0,get:function(){return u.DesignTokenContext}}),Object.defineProperty(e,"PresetColors",{enumerable:!0,get:function(){return a.PresetColors}}),Object.defineProperty(e,"calc",{enumerable:!0,get:function(){return i.genCalc}}),Object.defineProperty(e,"defaultConfig",{enumerable:!0,get:function(){return u.defaultConfig}}),Object.defineProperty(e,"genComponentStyleHook",{enumerable:!0,get:function(){return r.genComponentStyleHook}}),Object.defineProperty(e,"genPresetColor",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(e,"genStyleHooks",{enumerable:!0,get:function(){return r.genStyleHooks}}),Object.defineProperty(e,"genSubStyleComponent",{enumerable:!0,get:function(){return r.genSubStyleComponent}}),Object.defineProperty(e,"getLineHeight",{enumerable:!0,get:function(){return o.getLineHeight}}),Object.defineProperty(e,"mergeToken",{enumerable:!0,get:function(){return i.mergeToken}}),Object.defineProperty(e,"statistic",{enumerable:!0,get:function(){return i.statistic}}),Object.defineProperty(e,"statisticToken",{enumerable:!0,get:function(){return i.statisticToken}}),Object.defineProperty(e,"useResetIconStyle",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"useStyleRegister",{enumerable:!0,get:function(){return n.useStyleRegister}}),Object.defineProperty(e,"useToken",{enumerable:!0,get:function(){return s.default}});var n=mM,i=AO,a=RO,o=mR,s=t(DO),r=lD,l=t(_D),c=t(ED),u=JA}(MO);var ND={},PD=uP.default;Object.defineProperty(ND,"__esModule",{value:!0}),ND.default=void 0;var MD=PD(O);const AD=Object.assign({},MD),{useId:RD}=AD,OD=void 0===RD?()=>"":RD;ND.default=OD;var DD=sP.default;Object.defineProperty(IO,"__esModule",{value:!0}),IO.default=function(e,t,n){var i;(0,UD.devUseWarning)("ConfigProvider");const a=e||{},o=!1!==a.inherit&&t?t:Object.assign(Object.assign({},zD.defaultConfig),{hashed:null!==(i=null==t?void 0:t.hashed)&&void 0!==i?i:zD.defaultConfig.hashed,cssVar:null==t?void 0:t.cssVar}),s=(0,HD.default)();return(0,LD.default)(()=>{var i,r;if(!e)return t;const l=Object.assign({},o.components);Object.keys(e.components||{}).forEach(t=>{l[t]=Object.assign(Object.assign({},l[t]),e.components[t])});const c=`css-var-${s.replace(/:/g,"")}`,u=(null!==(i=a.cssVar)&&void 0!==i?i:o.cssVar)&&Object.assign(Object.assign(Object.assign({prefix:null==n?void 0:n.prefixCls},"object"==typeof o.cssVar?o.cssVar:{}),"object"==typeof a.cssVar?a.cssVar:{}),{key:"object"==typeof a.cssVar&&(null===(r=a.cssVar)||void 0===r?void 0:r.key)||c});return Object.assign(Object.assign(Object.assign({},o),a),{token:Object.assign(Object.assign({},o.token),a.token),components:l,cssVar:u})},[a,o],(e,t)=>e.some((e,n)=>{const i=t[n];return!(0,FD.default)(e,i,!0)}))};var LD=DD(vM),FD=DD(TO),UD=YM,zD=MO,HD=DD(ND);var $D={};const BD=W(ge);var qD=uP.default;Object.defineProperty($D,"__esModule",{value:!0}),$D.default=function(e){const t=GD.useContext(QD),{children:n}=e,[,i]=(0,WD.useToken)(),{motion:a}=i,o=GD.useRef(!1);if(o.current||(o.current=t!==a),o.current)return GD.createElement(QD.Provider,{value:a},GD.createElement(VD.Provider,{motion:a},n));return n};var GD=qD(O),VD=BD,WD=MO;const QD=GD.createContext(!0);var KD={},YD=uP.default;Object.defineProperty(KD,"__esModule",{value:!0}),KD.default=void 0,YD(O),KD.default=()=>null;var XD={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return t.useResetIconStyle}});var t=MO}(XD),function(e){var t=sP.default,n=uP.default;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"ConfigConsumer",{enumerable:!0,get:function(){return f.ConfigConsumer}}),Object.defineProperty(e,"ConfigContext",{enumerable:!0,get:function(){return f.ConfigContext}}),Object.defineProperty(e,"Variants",{enumerable:!0,get:function(){return f.Variants}}),e.default=e.configConsumerProps=void 0,Object.defineProperty(e,"defaultIconPrefixCls",{enumerable:!0,get:function(){return f.defaultIconPrefixCls}}),Object.defineProperty(e,"defaultPrefixCls",{enumerable:!0,get:function(){return f.defaultPrefixCls}}),e.warnContext=e.globalConfig=void 0;var i=n(O),a=mM,o=t(fM),s=t(vM),r=xM,l=n(YM),c=t(dA),u=n(pA),d=t(qA),h=t(fA),p=JA,m=t(ZA),f=LR,g=GR,v=mO,y=t(yO),b=t(IO),x=t($D),w=t(KD),S=n(bO),_=t(XD);e.warnContext=null,e.configConsumerProps=["getTargetContainer","getPopupContainer","rootPrefixCls","getPrefixCls","renderEmpty","csp","autoInsertSpaceInButton","locale"];const C=["getTargetContainer","getPopupContainer","renderEmpty","input","pagination","form","select","button"];let E,k,I,T;function j(){return E||f.defaultPrefixCls}function N(){return k||f.defaultIconPrefixCls}e.globalConfig=()=>({getPrefixCls:(e,t)=>t||(e?`${j()}-${e}`:j()),getIconPrefixCls:N,getRootPrefixCls:()=>E||j(),getTheme:()=>I,holderRender:T});const P=e=>{const{children:t,csp:n,autoInsertSpaceInButton:d,alert:g,anchor:y,form:E,locale:k,componentSize:I,direction:T,space:j,splitter:N,virtual:P,dropdownMatchSelectWidth:M,popupMatchSelectWidth:A,popupOverflow:R,legacyLocale:O,parentContext:D,iconPrefixCls:L,theme:F,componentDisabled:U,segmented:z,statistic:H,spin:$,calendar:B,carousel:q,cascader:G,collapse:V,typography:W,checkbox:Q,descriptions:K,divider:Y,drawer:X,skeleton:J,steps:Z,image:ee,layout:te,list:ne,mentions:ie,modal:ae,progress:oe,result:se,slider:re,breadcrumb:le,menu:ce,pagination:ue,input:de,textArea:he,empty:pe,badge:me,radio:fe,rate:ge,switch:ve,transfer:ye,avatar:be,message:xe,tag:we,table:Se,card:_e,tabs:Ce,timeline:Ee,timePicker:ke,upload:Ie,notification:Te,tree:je,colorPicker:Ne,datePicker:Pe,rangePicker:Me,flex:Ae,wave:Re,dropdown:Oe,warning:De,tour:Le,tooltip:Fe,popover:Ue,popconfirm:ze,floatButton:He,floatButtonGroup:$e,variant:Be,inputNumber:qe,treeSelect:Ge}=e,Ve=i.useCallback((t,n)=>{const{prefixCls:i}=e;if(n)return n;const a=i||D.getPrefixCls("");return t?`${a}-${t}`:a},[D.getPrefixCls,e.prefixCls]),We=L||D.iconPrefixCls||f.defaultIconPrefixCls,Qe=n||D.csp;(0,_.default)(We,Qe);const Ke=(0,b.default)(F,D.theme,{prefixCls:Ve("")}),Ye={csp:Qe,autoInsertSpaceInButton:d,alert:g,anchor:y,locale:k||O,direction:T,space:j,splitter:N,virtual:P,popupMatchSelectWidth:null!=A?A:M,popupOverflow:R,getPrefixCls:Ve,iconPrefixCls:We,theme:Ke,segmented:z,statistic:H,spin:$,calendar:B,carousel:q,cascader:G,collapse:V,typography:W,checkbox:Q,descriptions:K,divider:Y,drawer:X,skeleton:J,steps:Z,image:ee,input:de,textArea:he,layout:te,list:ne,mentions:ie,modal:ae,progress:oe,result:se,slider:re,breadcrumb:le,menu:ce,pagination:ue,empty:pe,badge:me,radio:fe,rate:ge,switch:ve,transfer:ye,avatar:be,message:xe,tag:we,table:Se,card:_e,tabs:Ce,timeline:Ee,timePicker:ke,upload:Ie,notification:Te,tree:je,colorPicker:Ne,datePicker:Pe,rangePicker:Me,flex:Ae,wave:Re,dropdown:Oe,warning:De,tour:Le,tooltip:Fe,popover:Ue,popconfirm:ze,floatButton:He,floatButtonGroup:$e,variant:Be,inputNumber:qe,treeSelect:Ge},Xe=Object.assign({},D);Object.keys(Ye).forEach(e=>{void 0!==Ye[e]&&(Xe[e]=Ye[e])}),C.forEach(t=>{const n=e[t];n&&(Xe[t]=n)}),void 0!==d&&(Xe.button=Object.assign({autoInsertSpace:d},Xe.button));const Je=(0,s.default)(()=>Xe,Xe,(e,t)=>{const n=Object.keys(e),i=Object.keys(t);return n.length!==i.length||n.some(n=>e[n]!==t[n])}),{layer:Ze}=i.useContext(a.StyleContext),et=i.useMemo(()=>({prefixCls:We,csp:Qe,layer:Ze?"antd":void 0}),[We,Qe,Ze]);let tt=i.createElement(i.Fragment,null,i.createElement(w.default,{dropdownMatchSelectWidth:M}),t);const nt=i.useMemo(()=>{var e,t,n,i;return(0,r.merge)((null===(e=h.default.Form)||void 0===e?void 0:e.defaultValidateMessages)||{},(null===(n=null===(t=Je.locale)||void 0===t?void 0:t.Form)||void 0===n?void 0:n.defaultValidateMessages)||{},(null===(i=Je.form)||void 0===i?void 0:i.validateMessages)||{},(null==E?void 0:E.validateMessages)||{})},[Je,null==E?void 0:E.validateMessages]);Object.keys(nt).length>0&&(tt=i.createElement(c.default.Provider,{value:nt},tt)),k&&(tt=i.createElement(u.default,{locale:k,_ANT_MARK__:u.ANT_MARK},tt)),(We||Qe)&&(tt=i.createElement(o.default.Provider,{value:et},tt)),I&&(tt=i.createElement(S.SizeContextProvider,{size:I},tt)),tt=i.createElement(x.default,null,tt);const it=i.useMemo(()=>{const e=Ke||{},{algorithm:t,token:n,components:i,cssVar:o}=e,s=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(n[i[a]]=e[i[a]])}return n}(e,["algorithm","token","components","cssVar"]),r=t&&(!Array.isArray(t)||t.length>0)?(0,a.createTheme)(t):p.defaultTheme,l={};Object.entries(i||{}).forEach(([e,t])=>{const n=Object.assign({},t);"algorithm"in n&&(!0===n.algorithm?n.theme=r:(Array.isArray(n.algorithm)||"function"==typeof n.algorithm)&&(n.theme=(0,a.createTheme)(n.algorithm)),delete n.algorithm),l[e]=n});const c=Object.assign(Object.assign({},m.default),n);return Object.assign(Object.assign({},s),{theme:r,token:c,components:l,override:Object.assign({override:c},l),cssVar:o})},[Ke]);return F&&(tt=i.createElement(p.DesignTokenContext.Provider,{value:it},tt)),Je.warning&&(tt=i.createElement(l.WarningContext.Provider,{value:Je.warning},tt)),void 0!==U&&(tt=i.createElement(v.DisabledContextProvider,{disabled:U},tt)),i.createElement(f.ConfigContext.Provider,{value:Je},tt)},M=e=>{const t=i.useContext(f.ConfigContext),n=i.useContext(d.default);return i.createElement(P,Object.assign({parentContext:t,legacyLocale:n},e))};M.ConfigContext=f.ConfigContext,M.SizeContext=S.default,M.config=e=>{const{prefixCls:t,iconPrefixCls:n,theme:i,holderRender:a}=e;void 0!==t&&(E=t),void 0!==n&&(k=n),"holderRender"in e&&(T=a),i&&(!function(e){return Object.keys(e).some(e=>e.endsWith("Color"))}(i)?I=i:(0,g.registerTheme)(j(),i))},M.useConfig=y.default,Object.defineProperty(M,"SizeContext",{get:()=>S.default}),e.default=M}(pM);var JD={},ZD=sP.default;Object.defineProperty(JD,"__esModule",{value:!0}),JD.default=void 0;var eL=ZD(O),tL=ZD(bO);JD.default=e=>{const t=eL.default.useContext(tL.default);return eL.default.useMemo(()=>e?"string"==typeof e?null!=e?e:t:"function"==typeof e?e(t):t:t,[e,t])};var nL={};Object.defineProperty(nL,"__esModule",{value:!0}),nL.default=void 0;var iL=MO;const aL=e=>{const{componentCls:t}=e;return{[t]:{display:"inline-flex","&-block":{display:"flex",width:"100%"},"&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"}}}};nL.default=(0,iL.genStyleHooks)(["Space","Compact"],e=>[aL(e)],()=>({}),{resetStyle:!1});var oL=sP.default,sL=uP.default;Object.defineProperty(nM,"__esModule",{value:!0}),nM.useCompactItemContext=nM.default=nM.SpaceCompactItemContext=nM.NoCompactStyle=void 0;var rL=sL(O),lL=oL(ve),cL=oL(iM),uL=pM,dL=oL(JD),hL=oL(nL),pL=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(n[i[a]]=e[i[a]])}return n};const mL=nM.SpaceCompactItemContext=rL.createContext(null);nM.useCompactItemContext=(e,t)=>{const n=rL.useContext(mL),i=rL.useMemo(()=>{if(!n)return"";const{compactDirection:i,isFirstItem:a,isLastItem:o}=n,s="vertical"===i?"-vertical-":"-";return(0,lL.default)(`${e}-compact${s}item`,{[`${e}-compact${s}first-item`]:a,[`${e}-compact${s}last-item`]:o,[`${e}-compact${s}item-rtl`]:"rtl"===t})},[e,t,n]);return{compactSize:null==n?void 0:n.compactSize,compactDirection:null==n?void 0:n.compactDirection,compactItemClassnames:i}};nM.NoCompactStyle=e=>{const{children:t}=e;return rL.createElement(mL.Provider,{value:null},t)};const fL=e=>{const{children:t}=e,n=pL(e,["children"]);return rL.createElement(mL.Provider,{value:rL.useMemo(()=>n,[n])},t)};nM.default=e=>{const{getPrefixCls:t,direction:n}=rL.useContext(uL.ConfigContext),{size:i,direction:a,block:o,prefixCls:s,className:r,rootClassName:l,children:c}=e,u=pL(e,["size","direction","block","prefixCls","className","rootClassName","children"]),d=(0,dL.default)(e=>null!=i?i:e),h=t("space-compact",s),[p,m]=(0,hL.default)(h),f=(0,lL.default)(h,m,{[`${h}-rtl`]:"rtl"===n,[`${h}-block`]:o,[`${h}-vertical`]:"vertical"===a},r,l),g=rL.useContext(mL),v=(0,cL.default)(c),y=rL.useMemo(()=>v.map((e,t)=>{const n=(null==e?void 0:e.key)||`${h}-item-${t}`;return rL.createElement(fL,{key:n,compactSize:d,compactDirection:a,isFirstItem:0===t&&(!g||(null==g?void 0:g.isFirstItem)),isLastItem:t===v.length-1&&(!g||(null==g?void 0:g.isLastItem))},e)}),[v,g,a,d,h]);return 0===v.length?null:p(rL.createElement("div",Object.assign({className:f},u),y))};var gL=sP.default;Object.defineProperty(VP,"__esModule",{value:!0}),VP.default=void 0;var vL=gL(O),yL=WP,bL=nM;VP.default=e=>{const{space:t,form:n,children:i}=e;if(null==i)return null;let a=i;return n&&(a=vL.default.createElement(yL.NoFormStyle,{override:!0,status:!0},a)),t&&(a=vL.default.createElement(bL.NoCompactStyle,null,a)),a};var xL={},wL={},SL={exports:{}},_L={},CL={exports:{}};!function(e){function t(){return e.exports=t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,t.apply(null,arguments)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(CL);var EL=CL.exports,kL={};Object.defineProperty(kL,"__esModule",{value:!0});kL.default={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M799.86 166.31c.02 0 .04.02.08.06l57.69 57.7c.04.03.05.05.06.08a.12.12 0 010 .06c0 .03-.02.05-.06.09L569.93 512l287.7 287.7c.04.04.05.06.06.09a.12.12 0 010 .07c0 .02-.02.04-.06.08l-57.7 57.69c-.03.04-.05.05-.07.06a.12.12 0 01-.07 0c-.03 0-.05-.02-.09-.06L512 569.93l-287.7 287.7c-.04.04-.06.05-.09.06a.12.12 0 01-.07 0c-.02 0-.04-.02-.08-.06l-57.69-57.7c-.04-.03-.05-.05-.06-.07a.12.12 0 010-.07c0-.03.02-.05.06-.09L454.07 512l-287.7-287.7c-.04-.04-.05-.06-.06-.09a.12.12 0 010-.07c0-.02.02-.04.06-.08l57.7-57.69c.03-.04.05-.05.07-.06a.12.12 0 01.07 0c.03 0 .05.02.09.06L512 454.07l287.7-287.7c.04-.04.06-.05.09-.06a.12.12 0 01.07 0z"}}]},name:"close",theme:"outlined"};var IL={},TL={exports:{}},jL={exports:{}};!function(e){e.exports=function(e,t){if(null==e)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(-1!==t.indexOf(i))continue;n[i]=e[i]}return n},e.exports.__esModule=!0,e.exports.default=e.exports}(jL);var NL=jL.exports;!function(e){var t=NL;e.exports=function(e,n){if(null==e)return{};var i,a,o=t(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)i=s[a],-1===n.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o},e.exports.__esModule=!0,e.exports.default=e.exports}(TL);var PL=TL.exports,ML={},AL={},RL={};function OL(e){var t;return null==e||null===(t=e.getRootNode)||void 0===t?void 0:t.call(e)}function DL(e){return OL(e)instanceof ShadowRoot}Object.defineProperty(RL,"__esModule",{value:!0}),RL.getShadowRoot=function(e){return DL(e)?OL(e):null},RL.inShadow=DL;var LL=uP.default,FL=sP.default;Object.defineProperty(AL,"__esModule",{value:!0}),AL.generate=function e(t,n,i){if(!i)return GL.default.createElement(t.tag,(0,UL.default)({key:n},WL(t.attrs)),(t.children||[]).map(function(i,a){return e(i,"".concat(n,"-").concat(t.tag,"-").concat(a))}));return GL.default.createElement(t.tag,(0,UL.default)((0,UL.default)({key:n},WL(t.attrs)),i),(t.children||[]).map(function(i,a){return e(i,"".concat(n,"-").concat(t.tag,"-").concat(a))}))},AL.getSecondaryColor=function(e){return(0,HL.generate)(e)[0]},AL.iconStyles=void 0,AL.isIconDefinition=function(e){return"object"===(0,zL.default)(e)&&"string"==typeof e.name&&"string"==typeof e.theme&&("object"===(0,zL.default)(e.icon)||"function"==typeof e.icon)},AL.normalizeAttrs=WL,AL.normalizeTwoToneColors=function(e){if(!e)return[];return Array.isArray(e)?e:[e]},AL.useInsertStyles=AL.svgBaseProps=void 0,AL.warning=function(e,t){(0,qL.default)(e,"[@ant-design/icons] ".concat(t))};var UL=FL(TM),zL=FL(cP),HL=aR,$L=VR,BL=RL,qL=FL(XM),GL=LL(O),VL=FL(fM);function WL(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce(function(t,n){var i,a=e[n];if("class"===n)t.className=a,delete t.class;else delete t[n],t[(i=n,i.replace(/-(.)/g,function(e,t){return t.toUpperCase()}))]=a;return t},{})}AL.svgBaseProps={width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",focusable:"false"};var QL=AL.iconStyles="\n.anticon {\n  display: inline-flex;\n  align-items: center;\n  color: inherit;\n  font-style: normal;\n  line-height: 0;\n  text-align: center;\n  text-transform: none;\n  vertical-align: -0.125em;\n  text-rendering: optimizeLegibility;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n.anticon > * {\n  line-height: 1;\n}\n\n.anticon svg {\n  display: inline-block;\n}\n\n.anticon::before {\n  display: none;\n}\n\n.anticon .anticon-icon {\n  display: block;\n}\n\n.anticon[tabindex] {\n  cursor: pointer;\n}\n\n.anticon-spin::before,\n.anticon-spin {\n  display: inline-block;\n  -webkit-animation: loadingCircle 1s infinite linear;\n  animation: loadingCircle 1s infinite linear;\n}\n\n@-webkit-keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n";AL.useInsertStyles=function(e){var t=(0,GL.useContext)(VL.default),n=t.csp,i=t.prefixCls,a=t.layer,o=QL;i&&(o=o.replace(/anticon/g,i)),a&&(o="@layer ".concat(a," {\n").concat(o,"\n}")),(0,GL.useEffect)(function(){var t=e.current,i=(0,BL.getShadowRoot)(t);(0,$L.updateCSS)(o,"@ant-design-icons",{prepend:!a,csp:n,attachTo:i})},[])};var KL=sP.default,YL=uP.default;Object.defineProperty(ML,"__esModule",{value:!0}),ML.default=void 0;var XL=KL(PL),JL=KL(TM),ZL=YL(O),eF=AL,tF=["icon","className","onClick","style","primaryColor","secondaryColor"],nF={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};var iF=function(e){var t=e.icon,n=e.className,i=e.onClick,a=e.style,o=e.primaryColor,s=e.secondaryColor,r=(0,XL.default)(e,tF),l=ZL.useRef(),c=nF;if(o&&(c={primaryColor:o,secondaryColor:s||(0,eF.getSecondaryColor)(o)}),(0,eF.useInsertStyles)(l),(0,eF.warning)((0,eF.isIconDefinition)(t),"icon should be icon definiton, but got ".concat(t)),!(0,eF.isIconDefinition)(t))return null;var u=t;return u&&"function"==typeof u.icon&&(u=(0,JL.default)((0,JL.default)({},u),{},{icon:u.icon(c.primaryColor,c.secondaryColor)})),(0,eF.generate)(u.icon,"svg-".concat(u.name),(0,JL.default)((0,JL.default)({className:n,onClick:i,style:a,"data-icon":u.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},r),{},{ref:l}))};iF.displayName="IconReact",iF.getTwoToneColors=function(){return(0,JL.default)({},nF)},iF.setTwoToneColors=function(e){var t=e.primaryColor,n=e.secondaryColor;nF.primaryColor=t,nF.secondaryColor=n||(0,eF.getSecondaryColor)(t),nF.calculated=!!n},ML.default=iF;var aF={},oF=sP.default;Object.defineProperty(aF,"__esModule",{value:!0}),aF.getTwoToneColor=function(){var e=rF.default.getTwoToneColors();if(!e.calculated)return e.primaryColor;return[e.primaryColor,e.secondaryColor]},aF.setTwoToneColor=function(e){var t=(0,lF.normalizeTwoToneColors)(e),n=(0,sF.default)(t,2),i=n[0],a=n[1];return rF.default.setTwoToneColors({primaryColor:i,secondaryColor:a})};var sF=oF(CP),rF=oF(ML),lF=AL;var cF=sP.default,uF=uP.default;Object.defineProperty(IL,"__esModule",{value:!0}),IL.default=void 0;var dF=cF(EL),hF=cF(CP),pF=cF(IM),mF=cF(PL),fF=uF(O),gF=cF(ve),vF=aR,yF=cF(fM),bF=cF(ML),xF=aF,wF=AL,SF=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];(0,xF.setTwoToneColor)(vF.blue.primary);var _F=fF.forwardRef(function(e,t){var n=e.className,i=e.icon,a=e.spin,o=e.rotate,s=e.tabIndex,r=e.onClick,l=e.twoToneColor,c=(0,mF.default)(e,SF),u=fF.useContext(yF.default),d=u.prefixCls,h=void 0===d?"anticon":d,p=u.rootClassName,m=(0,gF.default)(p,h,(0,pF.default)((0,pF.default)({},"".concat(h,"-").concat(i.name),!!i.name),"".concat(h,"-spin"),!!a||"loading"===i.name),n),f=s;void 0===f&&r&&(f=-1);var g=o?{msTransform:"rotate(".concat(o,"deg)"),transform:"rotate(".concat(o,"deg)")}:void 0,v=(0,wF.normalizeTwoToneColors)(l),y=(0,hF.default)(v,2),b=y[0],x=y[1];return fF.createElement("span",(0,dF.default)({role:"img","aria-label":i.name},c,{ref:t,tabIndex:f,onClick:r,className:m}),fF.createElement(bF.default,{icon:i,primaryColor:b,secondaryColor:x,style:g}))});_F.displayName="AntdIcon",_F.getTwoToneColor=xF.getTwoToneColor,_F.setTwoToneColor=xF.setTwoToneColor,IL.default=_F;var CF=uP.default,EF=sP.default;Object.defineProperty(_L,"__esModule",{value:!0}),_L.default=void 0;var kF=EF(EL),IF=CF(O),TF=EF(kL),jF=EF(IL),NF=function(e,t){return IF.createElement(jF.default,(0,kF.default)({},e,{ref:t,icon:TF.default}))},PF=IF.forwardRef(NF);_L.default=PF,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n;const i=(n=_L)&&n.__esModule?n:{default:n};t.default=i,e.exports=i}(SL,SL.exports);var MF=SL.exports,AF={},RF=sP.default;Object.defineProperty(AF,"__esModule",{value:!0}),AF.default=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t=!1===n?{aria:!0,data:!0,attr:!0}:!0===n?{aria:!0}:(0,OF.default)({},n);var i={};return Object.keys(e).forEach(function(n){(t.aria&&("role"===n||UF(n,LF))||t.data&&UF(n,FF)||t.attr&&DF.includes(n))&&(i[n]=e[n])}),i};var OF=RF(TM),DF="".concat("accept acceptCharset accessKey action allowFullScreen allowTransparency\n    alt async autoComplete autoFocus autoPlay capture cellPadding cellSpacing challenge\n    charSet checked classID className colSpan cols content contentEditable contextMenu\n    controls coords crossOrigin data dateTime default defer dir disabled download draggable\n    encType form formAction formEncType formMethod formNoValidate formTarget frameBorder\n    headers height hidden high href hrefLang htmlFor httpEquiv icon id inputMode integrity\n    is keyParams keyType kind label lang list loop low manifest marginHeight marginWidth max maxLength media\n    mediaGroup method min minLength multiple muted name noValidate nonce open\n    optimum pattern placeholder poster preload radioGroup readOnly rel required\n    reversed role rowSpan rows sandbox scope scoped scrolling seamless selected\n    shape size sizes span spellCheck src srcDoc srcLang srcSet start step style\n    summary tabIndex target title type useMap value width wmode wrap"," ").concat("onCopy onCut onPaste onCompositionEnd onCompositionStart onCompositionUpdate onKeyDown\n    onKeyPress onKeyUp onFocus onBlur onChange onInput onSubmit onClick onContextMenu onDoubleClick\n    onDrag onDragEnd onDragEnter onDragExit onDragLeave onDragOver onDragStart onDrop onMouseDown\n    onMouseEnter onMouseLeave onMouseMove onMouseOut onMouseOver onMouseUp onSelect onTouchCancel\n    onTouchEnd onTouchMove onTouchStart onScroll onWheel onAbort onCanPlay onCanPlayThrough\n    onDurationChange onEmptied onEncrypted onEnded onError onLoadedData onLoadedMetadata\n    onLoadStart onPause onPlay onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend onTimeUpdate onVolumeChange onWaiting onLoad onError").split(/[\s\n]+/),LF="aria-",FF="data-";function UF(e,t){return 0===e.indexOf(t)}var zF={};Object.defineProperty(zF,"__esModule",{value:!0}),zF.default=void 0,zF.default=function(...e){const t={};return e.forEach(e=>{e&&Object.keys(e).forEach(n=>{void 0!==e[n]&&(t[n]=e[n])})}),t};var HF=sP.default;Object.defineProperty(wL,"__esModule",{value:!0}),wL.pickClosable=function(e){if(!e)return;const{closable:t,closeIcon:n}=e;return{closable:t,closeIcon:n}},wL.useClosable=void 0;var $F=HF(O),BF=HF(MF),qF=HF(AF),GF=pA,VF=HF(fA),WF=HF(zF);function QF(e){const{closable:t,closeIcon:n}=e||{};return $F.default.useMemo(()=>{if(!t&&(!1===t||!1===n||null===n))return!1;if(void 0===t&&void 0===n)return null;let e={closeIcon:"boolean"!=typeof n&&null!==n?n:void 0};return t&&"object"==typeof t&&(e=Object.assign(Object.assign({},e),t)),e},[t,n])}const KF={};wL.useClosable=(e,t,n=KF)=>{const i=QF(e),a=QF(t),[o]=(0,GF.useLocale)("global",VF.default.global),s="boolean"!=typeof i&&!!(null==i?void 0:i.disabled),r=$F.default.useMemo(()=>Object.assign({closeIcon:$F.default.createElement(BF.default,null)},n),[n]),l=$F.default.useMemo(()=>!1!==i&&(i?(0,WF.default)(r,a,i):!1!==a&&(a?(0,WF.default)(r,a):!!r.closable&&r)),[i,a,r]);return $F.default.useMemo(()=>{var e,t;if(!1===l)return[!1,null,s,{}];const{closeIconRender:n}=r,{closeIcon:i}=l;let a=i;const c=(0,qF.default)(l,!0);return null!=a&&(n&&(a=n(i)),a=$F.default.isValidElement(a)?$F.default.cloneElement(a,Object.assign(Object.assign(Object.assign({},a.props),{"aria-label":null!==(t=null===(e=a.props)||void 0===e?void 0:e["aria-label"])&&void 0!==t?t:o.close}),c)):$F.default.createElement("span",Object.assign({"aria-label":o.close},c),a)),[!0,a,s,c]},[s,o.close,l,r])};var YF={},XF=sP.default;Object.defineProperty(YF,"__esModule",{value:!0}),YF.useForceUpdate=void 0;var JF=XF(O);YF.useForceUpdate=()=>JF.default.useReducer(e=>e+1,0);var ZF={},eU=uP.default,tU=sP.default;Object.defineProperty(ZF,"__esModule",{value:!0}),ZF.mergeClassNames=oU,ZF.useMergeSemantic=void 0;var nU=tU(DM),iU=eU(O),aU=tU(ve);function oU(e,...t){const n=e||{};return t.reduce((e,t)=>(Object.keys(t||{}).forEach(i=>{const a=n[i],o=t[i];if(a&&"object"==typeof a)if(o&&"object"==typeof o)e[i]=oU(a,e[i],o);else{const{_default:t}=a;t&&(e[i]=e[i]||{},e[i][t]=(0,aU.default)(e[i][t],o))}else e[i]=(0,aU.default)(e[i],o)}),e),{})}function sU(e,...t){return iU.useMemo(()=>oU.apply(void 0,[e].concat(t)),[t,e])}function rU(...e){return iU.useMemo(()=>e.reduce((e,t={})=>(Object.keys(t).forEach(n=>{e[n]=Object.assign(Object.assign({},e[n]),t[n])}),e),{}),[e])}function lU(e,t){const n=Object.assign({},e);return Object.keys(t).forEach(e=>{if("_default"!==e){const i=t[e],a=n[e]||{};n[e]=i?lU(a,i):a}}),n}ZF.useMergeSemantic=(e,t,n)=>{const i=sU.apply(void 0,[n].concat((0,nU.default)(e))),a=rU.apply(void 0,(0,nU.default)(t));return iU.useMemo(()=>[lU(i,n),lU(a,n)],[i,a,n])};var cU={};Object.defineProperty(cU,"__esModule",{value:!0}),cU.useMultipleSelect=void 0;var uU=O;cU.useMultipleSelect=e=>{const[t,n]=(0,uU.useState)(null);return[(0,uU.useCallback)((i,a,o)=>{const s=null!=t?t:i,r=Math.min(s||0,i),l=Math.max(s||0,i),c=a.slice(r,l+1).map(e),u=c.some(e=>!o.has(e)),d=[];return c.forEach(e=>{u?(o.has(e)||d.push(e),o.add(e)):(o.delete(e),d.push(e))}),n(u?l:null),d},[t]),n]};var dU={},hU=uP.default,pU=sP.default;Object.defineProperty(dU,"__esModule",{value:!0}),dU.usePatchElement=void 0;var mU=pU(DM),fU=hU(O);dU.usePatchElement=()=>{const[e,t]=fU.useState([]);return[e,fU.useCallback(e=>(t(t=>[].concat((0,mU.default)(t),[e])),()=>{t(t=>t.filter(t=>t!==e))}),[])]};var gU={};Object.defineProperty(gU,"__esModule",{value:!0}),gU.useProxyImperativeHandle=void 0;var vU=O;gU.useProxyImperativeHandle=(e,t)=>(0,vU.useImperativeHandle)(e,()=>{const e=t(),{nativeElement:n}=e;return"undefined"!=typeof Proxy?new Proxy(n,{get:(t,n)=>e[n]?e[n]:Reflect.get(t,n)}):(a=e,(i=n)._antProxy=i._antProxy||{},Object.keys(a).forEach(e=>{if(!(e in i._antProxy)){const t=i[e];i._antProxy[e]=t,i[e]=a[e]}}),i);var i,a});var yU={},bU=uP.default;Object.defineProperty(yU,"__esModule",{value:!0}),yU.useSyncState=void 0;var xU=bU(O),wU=YF;yU.useSyncState=e=>{const t=xU.useRef(e),[,n]=(0,wU.useForceUpdate)();return[()=>t.current,e=>{t.current=e,n()}]};var SU={},_U={},CU=sP.default;Object.defineProperty(_U,"__esModule",{value:!0}),_U.default=void 0;const EU=CU(O).default.createContext(void 0);_U.default=EU;var kU=sP.default;Object.defineProperty(SU,"__esModule",{value:!0}),SU.useZIndex=SU.containerBaseZIndexOffset=SU.consumerBaseZIndexOffset=SU.CONTAINER_MAX_OFFSET=void 0;var IU=kU(O),TU=kU(DO),jU=kU(_U);const NU=100;SU.CONTAINER_MAX_OFFSET=1e3;const PU=SU.containerBaseZIndexOffset={Modal:NU,Drawer:NU,Popover:NU,Popconfirm:NU,Tooltip:NU,Tour:NU,FloatButton:NU},MU=SU.consumerBaseZIndexOffset={SelectLike:50,Dropdown:50,DatePicker:50,Menu:50,ImagePreview:1};SU.useZIndex=(e,t)=>{const[,n]=(0,TU.default)(),i=IU.default.useContext(jU.default),a=e in PU;let o;if(void 0!==t)o=[t,t];else{let s=null!=i?i:0;s+=a?(i?0:n.zIndexPopupBase)+PU[e]:MU[e],o=[void 0===i?t:s,s]}return o},function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=wL;Object.keys(t).forEach(function(n){"default"!==n&&"__esModule"!==n&&(n in e&&e[n]===t[n]||Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[n]}}))});var n=YF;Object.keys(n).forEach(function(t){"default"!==t&&"__esModule"!==t&&(t in e&&e[t]===n[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return n[t]}}))});var i=ZF;Object.keys(i).forEach(function(t){"default"!==t&&"__esModule"!==t&&(t in e&&e[t]===i[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return i[t]}}))});var a=cU;Object.keys(a).forEach(function(t){"default"!==t&&"__esModule"!==t&&(t in e&&e[t]===a[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return a[t]}}))});var o=dU;Object.keys(o).forEach(function(t){"default"!==t&&"__esModule"!==t&&(t in e&&e[t]===o[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return o[t]}}))});var s=gU;Object.keys(s).forEach(function(t){"default"!==t&&"__esModule"!==t&&(t in e&&e[t]===s[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return s[t]}}))});var r=yU;Object.keys(r).forEach(function(t){"default"!==t&&"__esModule"!==t&&(t in e&&e[t]===r[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return r[t]}}))});var l=SU;Object.keys(l).forEach(function(t){"default"!==t&&"__esModule"!==t&&(t in e&&e[t]===l[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return l[t]}}))})}(xL);var AU={};Object.defineProperty(AU,"__esModule",{value:!0}),AU.getTransitionName=AU.default=void 0;var RU=pM;const OU=()=>({height:0,opacity:0}),DU=e=>{const{scrollHeight:t}=e;return{height:t,opacity:1}},LU=e=>({height:e?e.offsetHeight:0}),FU=(e,t)=>!0===(null==t?void 0:t.deadline)||"height"===t.propertyName;AU.getTransitionName=(e,t,n)=>void 0!==n?n:`${e}-${t}`,AU.default=(e=RU.defaultPrefixCls)=>({motionName:`${e}-motion-collapse`,onAppearStart:OU,onEnterStart:OU,onAppearActive:DU,onEnterActive:DU,onLeaveStart:LU,onLeaveActive:OU,onAppearEnd:FU,onEnterEnd:FU,onLeaveEnd:FU,motionDeadline:500});var UU={},zU={},HU={};Object.defineProperty(HU,"__esModule",{value:!0}),HU.genRoundedArrow=void 0,HU.getArrowToken=function(e){const{sizePopupArrow:t,borderRadiusXS:n,borderRadiusOuter:i}=e,a=t/2,o=a,s=1*i/Math.sqrt(2),r=a-i*(1-1/Math.sqrt(2)),l=a-n*(1/Math.sqrt(2)),c=i*(Math.sqrt(2)-1)+n*(1/Math.sqrt(2)),u=2*a-l,d=c,h=2*a-s,p=r,m=2*a-0,f=o,g=a*Math.sqrt(2)+i*(Math.sqrt(2)-2),v=i*(Math.sqrt(2)-1);return{arrowShadowWidth:g,arrowPath:`path('M 0 ${o} A ${i} ${i} 0 0 0 ${s} ${r} L ${l} ${c} A ${n} ${n} 0 0 1 ${u} ${d} L ${h} ${p} A ${i} ${i} 0 0 0 ${m} ${f} Z')`,arrowPolygon:`polygon(${v}px 100%, 50% ${v}px, ${2*a-v}px 100%, ${v}px 100%)`}};var $U=mM;HU.genRoundedArrow=(e,t,n)=>{const{sizePopupArrow:i,arrowPolygon:a,arrowPath:o,arrowShadowWidth:s,borderRadiusXS:r,calc:l}=e;return{pointerEvents:"none",width:i,height:i,overflow:"hidden","&::before":{position:"absolute",bottom:0,insetInlineStart:0,width:i,height:l(i).div(2).equal(),background:t,clipPath:{_multi_value_:!0,value:[a,o]},content:'""'},"&::after":{content:'""',position:"absolute",width:s,height:s,bottom:0,insetInline:0,margin:"auto",borderRadius:{_skip_check_:!0,value:`0 0 ${(0,$U.unit)(r)} 0`},transform:"translateY(50%) rotate(-135deg)",boxShadow:n,zIndex:0,background:"transparent"}}},Object.defineProperty(zU,"__esModule",{value:!0}),zU.MAX_VERTICAL_CONTENT_RADIUS=void 0,zU.default=function(e,t,n){const{componentCls:i,boxShadowPopoverArrow:a,arrowOffsetVertical:o,arrowOffsetHorizontal:s}=e,{arrowDistance:r=0,arrowPlacement:l={left:!0,right:!0,top:!0,bottom:!0}}=n||{};return{[i]:Object.assign(Object.assign(Object.assign(Object.assign({[`${i}-arrow`]:[Object.assign(Object.assign({position:"absolute",zIndex:1,display:"block"},(0,qU.genRoundedArrow)(e,t,a)),{"&:before":{background:t}})]},VU(!!l.top,{[[`&-placement-top > ${i}-arrow`,`&-placement-topLeft > ${i}-arrow`,`&-placement-topRight > ${i}-arrow`].join(",")]:{bottom:r,transform:"translateY(100%) rotate(180deg)"},[`&-placement-top > ${i}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(100%) rotate(180deg)"},"&-placement-topLeft":{"--arrow-offset-horizontal":s,[`> ${i}-arrow`]:{left:{_skip_check_:!0,value:s}}},"&-placement-topRight":{"--arrow-offset-horizontal":`calc(100% - ${(0,BU.unit)(s)})`,[`> ${i}-arrow`]:{right:{_skip_check_:!0,value:s}}}})),VU(!!l.bottom,{[[`&-placement-bottom > ${i}-arrow`,`&-placement-bottomLeft > ${i}-arrow`,`&-placement-bottomRight > ${i}-arrow`].join(",")]:{top:r,transform:"translateY(-100%)"},[`&-placement-bottom > ${i}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(-100%)"},"&-placement-bottomLeft":{"--arrow-offset-horizontal":s,[`> ${i}-arrow`]:{left:{_skip_check_:!0,value:s}}},"&-placement-bottomRight":{"--arrow-offset-horizontal":`calc(100% - ${(0,BU.unit)(s)})`,[`> ${i}-arrow`]:{right:{_skip_check_:!0,value:s}}}})),VU(!!l.left,{[[`&-placement-left > ${i}-arrow`,`&-placement-leftTop > ${i}-arrow`,`&-placement-leftBottom > ${i}-arrow`].join(",")]:{right:{_skip_check_:!0,value:r},transform:"translateX(100%) rotate(90deg)"},[`&-placement-left > ${i}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(100%) rotate(90deg)"},[`&-placement-leftTop > ${i}-arrow`]:{top:o},[`&-placement-leftBottom > ${i}-arrow`]:{bottom:o}})),VU(!!l.right,{[[`&-placement-right > ${i}-arrow`,`&-placement-rightTop > ${i}-arrow`,`&-placement-rightBottom > ${i}-arrow`].join(",")]:{left:{_skip_check_:!0,value:r},transform:"translateX(-100%) rotate(-90deg)"},[`&-placement-right > ${i}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(-100%) rotate(-90deg)"},[`&-placement-rightTop > ${i}-arrow`]:{top:o},[`&-placement-rightBottom > ${i}-arrow`]:{bottom:o}}))}},zU.getArrowOffsetToken=function(e){const{contentRadius:t,limitVerticalRadius:n}=e,i=t>12?t+2:12;return{arrowOffsetHorizontal:i,arrowOffsetVertical:n?GU:i}};var BU=mM,qU=HU;const GU=zU.MAX_VERTICAL_CONTENT_RADIUS=8;function VU(e,t){return e?t:{}}Object.defineProperty(UU,"__esModule",{value:!0}),UU.default=function(e){const{arrowWidth:t,autoAdjustOverflow:n,arrowPointAtCenter:i,offset:a,borderRadius:o,visibleFirst:s}=e,r=t/2,l={},c=(0,WU.getArrowOffsetToken)({contentRadius:o,limitVerticalRadius:!0});return Object.keys(KU).forEach(e=>{const o=i&&YU[e]||KU[e],u=Object.assign(Object.assign({},o),{offset:[0,0],dynamicInset:!0});switch(l[e]=u,XU.has(e)&&(u.autoArrow=!1),e){case"top":case"topLeft":case"topRight":u.offset[1]=-r-a;break;case"bottom":case"bottomLeft":case"bottomRight":u.offset[1]=r+a;break;case"left":case"leftTop":case"leftBottom":u.offset[0]=-r-a;break;case"right":case"rightTop":case"rightBottom":u.offset[0]=r+a}if(i)switch(e){case"topLeft":case"bottomLeft":u.offset[0]=-c.arrowOffsetHorizontal-r;break;case"topRight":case"bottomRight":u.offset[0]=c.arrowOffsetHorizontal+r;break;case"leftTop":case"rightTop":u.offset[1]=2*-c.arrowOffsetHorizontal+r;break;case"leftBottom":case"rightBottom":u.offset[1]=2*c.arrowOffsetHorizontal-r}u.overflow=QU(e,c,t,n),s&&(u.htmlRegion="visibleFirst")}),l},UU.getOverflowOptions=QU;var WU=zU;function QU(e,t,n,i){if(!1===i)return{adjustX:!1,adjustY:!1};const a=i&&"object"==typeof i?i:{},o={};switch(e){case"top":case"bottom":o.shiftX=2*t.arrowOffsetHorizontal+n,o.shiftY=!0,o.adjustY=!0;break;case"left":case"right":o.shiftY=2*t.arrowOffsetVertical+n,o.shiftX=!0,o.adjustX=!0}const s=Object.assign(Object.assign({},o),a);return s.shiftX||(s.adjustX=!0),s.shiftY||(s.adjustY=!0),s}const KU={left:{points:["cr","cl"]},right:{points:["cl","cr"]},top:{points:["bc","tc"]},bottom:{points:["tc","bc"]},topLeft:{points:["bl","tl"]},leftTop:{points:["tr","tl"]},topRight:{points:["br","tr"]},rightTop:{points:["tl","tr"]},bottomRight:{points:["tr","br"]},rightBottom:{points:["bl","br"]},bottomLeft:{points:["tl","bl"]},leftBottom:{points:["br","bl"]}},YU={topLeft:{points:["bl","tc"]},leftTop:{points:["tr","cl"]},topRight:{points:["br","tc"]},rightTop:{points:["tl","cr"]},bottomRight:{points:["tr","bc"]},rightBottom:{points:["bl","cr"]},bottomLeft:{points:["tl","bc"]},leftBottom:{points:["br","cl"]}},XU=new Set(["topLeft","topRight","bottomLeft","bottomRight","leftTop","leftBottom","rightTop","rightBottom"]);var JU={},ZU=sP.default;Object.defineProperty(JU,"__esModule",{value:!0}),JU.cloneElement=function(e,t){return tz(e,e,t)},JU.isFragment=function(e){return e&&ez.default.isValidElement(e)&&e.type===ez.default.Fragment},JU.replaceElement=void 0;var ez=ZU(O);const tz=(e,t,n)=>ez.default.isValidElement(e)?ez.default.cloneElement(e,"function"==typeof n?n(e.props||{}):n):t;JU.replaceElement=tz;var nz={},iz={},az={},oz={};Object.defineProperty(oz,"__esModule",{value:!0}),oz.default=void 0;oz.default=e=>({[e.componentCls]:{[`${e.antCls}-motion-collapse-legacy`]:{overflow:"hidden","&-active":{transition:`height ${e.motionDurationMid} ${e.motionEaseInOut},\n        opacity ${e.motionDurationMid} ${e.motionEaseInOut} !important`}},[`${e.antCls}-motion-collapse`]:{overflow:"hidden",transition:`height ${e.motionDurationMid} ${e.motionEaseInOut},\n        opacity ${e.motionDurationMid} ${e.motionEaseInOut} !important`}}});var sz={},rz={};Object.defineProperty(rz,"__esModule",{value:!0}),rz.initMotion=void 0;const lz=e=>({animationDuration:e,animationFillMode:"both"}),cz=e=>({animationDuration:e,animationFillMode:"both"});rz.initMotion=(e,t,n,i,a=!1)=>{const o=a?"&":"";return{[`\n      ${o}${e}-enter,\n      ${o}${e}-appear\n    `]:Object.assign(Object.assign({},lz(i)),{animationPlayState:"paused"}),[`${o}${e}-leave`]:Object.assign(Object.assign({},cz(i)),{animationPlayState:"paused"}),[`\n      ${o}${e}-enter${e}-enter-active,\n      ${o}${e}-appear${e}-appear-active\n    `]:{animationName:t,animationPlayState:"running"},[`${o}${e}-leave${e}-leave-active`]:{animationName:n,animationPlayState:"running",pointerEvents:"none"}}},Object.defineProperty(sz,"__esModule",{value:!0}),sz.initFadeMotion=sz.fadeOut=sz.fadeIn=void 0;var uz=mM,dz=rz;const hz=sz.fadeIn=new uz.Keyframes("antFadeIn",{"0%":{opacity:0},"100%":{opacity:1}}),pz=sz.fadeOut=new uz.Keyframes("antFadeOut",{"0%":{opacity:1},"100%":{opacity:0}});sz.initFadeMotion=(e,t=!1)=>{const{antCls:n}=e,i=`${n}-fade`,a=t?"&":"";return[(0,dz.initMotion)(i,hz,pz,e.motionDurationMid,t),{[`\n        ${a}${i}-enter,\n        ${a}${i}-appear\n      `]:{opacity:0,animationTimingFunction:"linear"},[`${a}${i}-leave`]:{animationTimingFunction:"linear"}}]};var mz={};Object.defineProperty(mz,"__esModule",{value:!0}),mz.moveUpOut=mz.moveUpIn=mz.moveRightOut=mz.moveRightIn=mz.moveLeftOut=mz.moveLeftIn=mz.moveDownOut=mz.moveDownIn=mz.initMoveMotion=void 0;var fz=mM,gz=rz;const vz=mz.moveDownIn=new fz.Keyframes("antMoveDownIn",{"0%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),yz=mz.moveDownOut=new fz.Keyframes("antMoveDownOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0}}),bz=mz.moveLeftIn=new fz.Keyframes("antMoveLeftIn",{"0%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),xz=mz.moveLeftOut=new fz.Keyframes("antMoveLeftOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),wz=mz.moveRightIn=new fz.Keyframes("antMoveRightIn",{"0%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),Sz=mz.moveRightOut=new fz.Keyframes("antMoveRightOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),_z={"move-up":{inKeyframes:mz.moveUpIn=new fz.Keyframes("antMoveUpIn",{"0%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),outKeyframes:mz.moveUpOut=new fz.Keyframes("antMoveUpOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0}})},"move-down":{inKeyframes:vz,outKeyframes:yz},"move-left":{inKeyframes:bz,outKeyframes:xz},"move-right":{inKeyframes:wz,outKeyframes:Sz}};mz.initMoveMotion=(e,t)=>{const{antCls:n}=e,i=`${n}-${t}`,{inKeyframes:a,outKeyframes:o}=_z[t];return[(0,gz.initMotion)(i,a,o,e.motionDurationMid),{[`\n        ${i}-enter,\n        ${i}-appear\n      `]:{opacity:0,animationTimingFunction:e.motionEaseOutCirc},[`${i}-leave`]:{animationTimingFunction:e.motionEaseInOutCirc}}]};var Cz={};Object.defineProperty(Cz,"__esModule",{value:!0}),Cz.slideUpOut=Cz.slideUpIn=Cz.slideRightOut=Cz.slideRightIn=Cz.slideLeftOut=Cz.slideLeftIn=Cz.slideDownOut=Cz.slideDownIn=Cz.initSlideMotion=void 0;var Ez=mM,kz=rz;const Iz={"slide-up":{inKeyframes:Cz.slideUpIn=new Ez.Keyframes("antSlideUpIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1}}),outKeyframes:Cz.slideUpOut=new Ez.Keyframes("antSlideUpOut",{"0%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0}})},"slide-down":{inKeyframes:Cz.slideDownIn=new Ez.Keyframes("antSlideDownIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1}}),outKeyframes:Cz.slideDownOut=new Ez.Keyframes("antSlideDownOut",{"0%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0}})},"slide-left":{inKeyframes:Cz.slideLeftIn=new Ez.Keyframes("antSlideLeftIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1}}),outKeyframes:Cz.slideLeftOut=new Ez.Keyframes("antSlideLeftOut",{"0%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0}})},"slide-right":{inKeyframes:Cz.slideRightIn=new Ez.Keyframes("antSlideRightIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1}}),outKeyframes:Cz.slideRightOut=new Ez.Keyframes("antSlideRightOut",{"0%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0}})}};Cz.initSlideMotion=(e,t)=>{const{antCls:n}=e,i=`${n}-${t}`,{inKeyframes:a,outKeyframes:o}=Iz[t];return[(0,kz.initMotion)(i,a,o,e.motionDurationMid),{[`\n      ${i}-enter,\n      ${i}-appear\n    `]:{transform:"scale(0)",transformOrigin:"0% 0%",opacity:0,animationTimingFunction:e.motionEaseOutQuint,"&-prepare":{transform:"scale(1)"}},[`${i}-leave`]:{animationTimingFunction:e.motionEaseInQuint}}]};var Tz={};Object.defineProperty(Tz,"__esModule",{value:!0}),Tz.zoomUpOut=Tz.zoomUpIn=Tz.zoomRightOut=Tz.zoomRightIn=Tz.zoomOut=Tz.zoomLeftOut=Tz.zoomLeftIn=Tz.zoomIn=Tz.zoomDownOut=Tz.zoomDownIn=Tz.zoomBigOut=Tz.zoomBigIn=Tz.initZoomMotion=void 0;var jz=mM,Nz=rz;const Pz=Tz.zoomIn=new jz.Keyframes("antZoomIn",{"0%":{transform:"scale(0.2)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),Mz=Tz.zoomOut=new jz.Keyframes("antZoomOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.2)",opacity:0}}),Az=Tz.zoomBigIn=new jz.Keyframes("antZoomBigIn",{"0%":{transform:"scale(0.8)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),Rz=Tz.zoomBigOut=new jz.Keyframes("antZoomBigOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.8)",opacity:0}}),Oz=Tz.zoomUpIn=new jz.Keyframes("antZoomUpIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 0%"}}),Dz=Tz.zoomUpOut=new jz.Keyframes("antZoomUpOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 0%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0}}),Lz={zoom:{inKeyframes:Pz,outKeyframes:Mz},"zoom-big":{inKeyframes:Az,outKeyframes:Rz},"zoom-big-fast":{inKeyframes:Az,outKeyframes:Rz},"zoom-left":{inKeyframes:Tz.zoomLeftIn=new jz.Keyframes("antZoomLeftIn",{"0%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"0% 50%"}}),outKeyframes:Tz.zoomLeftOut=new jz.Keyframes("antZoomLeftOut",{"0%":{transform:"scale(1)",transformOrigin:"0% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0}})},"zoom-right":{inKeyframes:Tz.zoomRightIn=new jz.Keyframes("antZoomRightIn",{"0%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"100% 50%"}}),outKeyframes:Tz.zoomRightOut=new jz.Keyframes("antZoomRightOut",{"0%":{transform:"scale(1)",transformOrigin:"100% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0}})},"zoom-up":{inKeyframes:Oz,outKeyframes:Dz},"zoom-down":{inKeyframes:Tz.zoomDownIn=new jz.Keyframes("antZoomDownIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 100%"}}),outKeyframes:Tz.zoomDownOut=new jz.Keyframes("antZoomDownOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 100%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0}})}};Tz.initZoomMotion=(e,t)=>{const{antCls:n}=e,i=`${n}-${t}`,{inKeyframes:a,outKeyframes:o}=Lz[t];return[(0,Nz.initMotion)(i,a,o,"zoom-big-fast"===t?e.motionDurationFast:e.motionDurationMid),{[`\n        ${i}-enter,\n        ${i}-appear\n      `]:{transform:"scale(0)",opacity:0,animationTimingFunction:e.motionEaseOutCirc,"&-prepare":{transform:"none"}},[`${i}-leave`]:{animationTimingFunction:e.motionEaseInOutCirc}}]},function(e){var t=sP.default;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"fadeIn",{enumerable:!0,get:function(){return i.fadeIn}}),Object.defineProperty(e,"fadeOut",{enumerable:!0,get:function(){return i.fadeOut}}),Object.defineProperty(e,"genCollapseMotion",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"initFadeMotion",{enumerable:!0,get:function(){return i.initFadeMotion}}),Object.defineProperty(e,"initMoveMotion",{enumerable:!0,get:function(){return a.initMoveMotion}}),Object.defineProperty(e,"initSlideMotion",{enumerable:!0,get:function(){return o.initSlideMotion}}),Object.defineProperty(e,"initZoomMotion",{enumerable:!0,get:function(){return s.initZoomMotion}}),Object.defineProperty(e,"moveDownIn",{enumerable:!0,get:function(){return a.moveDownIn}}),Object.defineProperty(e,"moveDownOut",{enumerable:!0,get:function(){return a.moveDownOut}}),Object.defineProperty(e,"moveLeftIn",{enumerable:!0,get:function(){return a.moveLeftIn}}),Object.defineProperty(e,"moveLeftOut",{enumerable:!0,get:function(){return a.moveLeftOut}}),Object.defineProperty(e,"moveRightIn",{enumerable:!0,get:function(){return a.moveRightIn}}),Object.defineProperty(e,"moveRightOut",{enumerable:!0,get:function(){return a.moveRightOut}}),Object.defineProperty(e,"moveUpIn",{enumerable:!0,get:function(){return a.moveUpIn}}),Object.defineProperty(e,"moveUpOut",{enumerable:!0,get:function(){return a.moveUpOut}}),Object.defineProperty(e,"slideDownIn",{enumerable:!0,get:function(){return o.slideDownIn}}),Object.defineProperty(e,"slideDownOut",{enumerable:!0,get:function(){return o.slideDownOut}}),Object.defineProperty(e,"slideLeftIn",{enumerable:!0,get:function(){return o.slideLeftIn}}),Object.defineProperty(e,"slideLeftOut",{enumerable:!0,get:function(){return o.slideLeftOut}}),Object.defineProperty(e,"slideRightIn",{enumerable:!0,get:function(){return o.slideRightIn}}),Object.defineProperty(e,"slideRightOut",{enumerable:!0,get:function(){return o.slideRightOut}}),Object.defineProperty(e,"slideUpIn",{enumerable:!0,get:function(){return o.slideUpIn}}),Object.defineProperty(e,"slideUpOut",{enumerable:!0,get:function(){return o.slideUpOut}}),Object.defineProperty(e,"zoomBigIn",{enumerable:!0,get:function(){return s.zoomBigIn}}),Object.defineProperty(e,"zoomBigOut",{enumerable:!0,get:function(){return s.zoomBigOut}}),Object.defineProperty(e,"zoomDownIn",{enumerable:!0,get:function(){return s.zoomDownIn}}),Object.defineProperty(e,"zoomDownOut",{enumerable:!0,get:function(){return s.zoomDownOut}}),Object.defineProperty(e,"zoomIn",{enumerable:!0,get:function(){return s.zoomIn}}),Object.defineProperty(e,"zoomLeftIn",{enumerable:!0,get:function(){return s.zoomLeftIn}}),Object.defineProperty(e,"zoomLeftOut",{enumerable:!0,get:function(){return s.zoomLeftOut}}),Object.defineProperty(e,"zoomOut",{enumerable:!0,get:function(){return s.zoomOut}}),Object.defineProperty(e,"zoomRightIn",{enumerable:!0,get:function(){return s.zoomRightIn}}),Object.defineProperty(e,"zoomRightOut",{enumerable:!0,get:function(){return s.zoomRightOut}}),Object.defineProperty(e,"zoomUpIn",{enumerable:!0,get:function(){return s.zoomUpIn}}),Object.defineProperty(e,"zoomUpOut",{enumerable:!0,get:function(){return s.zoomUpOut}});var n=t(oz),i=sz,a=mz,o=Cz,s=Tz}(az);var Fz=uP.default;Object.defineProperty(iz,"__esModule",{value:!0}),iz.prepareComponentToken=iz.default=void 0;var Uz=mM,zz=cD,Hz=az,$z=Fz(zU),Bz=HU,qz=MO;const Gz=e=>{const{calc:t,componentCls:n,tooltipMaxWidth:i,tooltipColor:a,tooltipBg:o,tooltipBorderRadius:s,zIndexPopup:r,controlHeight:l,boxShadowSecondary:c,paddingSM:u,paddingXS:d,arrowOffsetHorizontal:h,sizePopupArrow:p}=e,m=t(s).add(p).add(h).equal(),f=t(s).mul(2).add(p).equal();return[{[n]:Object.assign(Object.assign(Object.assign(Object.assign({},(0,zz.resetComponent)(e)),{position:"absolute",zIndex:r,display:"block",width:"max-content",maxWidth:i,visibility:"visible","--valid-offset-x":"var(--arrow-offset-horizontal, var(--arrow-x))",transformOrigin:["var(--valid-offset-x, 50%)","var(--arrow-y, 50%)"].join(" "),"&-hidden":{display:"none"},"--antd-arrow-background-color":o,[`${n}-inner`]:{minWidth:f,minHeight:l,padding:`${(0,Uz.unit)(e.calc(u).div(2).equal())} ${(0,Uz.unit)(d)}`,color:`var(--ant-tooltip-color, ${a})`,textAlign:"start",textDecoration:"none",wordWrap:"break-word",backgroundColor:o,borderRadius:s,boxShadow:c,boxSizing:"border-box"},[["&-placement-topLeft","&-placement-topRight","&-placement-bottomLeft","&-placement-bottomRight"].join(",")]:{minWidth:m},[["&-placement-left","&-placement-leftTop","&-placement-leftBottom","&-placement-right","&-placement-rightTop","&-placement-rightBottom"].join(",")]:{[`${n}-inner`]:{borderRadius:e.min(s,$z.MAX_VERTICAL_CONTENT_RADIUS)}},[`${n}-content`]:{position:"relative"}}),(0,qz.genPresetColor)(e,(e,{darkColor:t})=>({[`&${n}-${e}`]:{[`${n}-inner`]:{backgroundColor:t},[`${n}-arrow`]:{"--antd-arrow-background-color":t}}}))),{"&-rtl":{direction:"rtl"}})},(0,$z.default)(e,"var(--antd-arrow-background-color)"),{[`${n}-pure`]:{position:"relative",maxWidth:"none",margin:e.sizePopupArrow}}]},Vz=e=>Object.assign(Object.assign({zIndexPopup:e.zIndexPopupBase+70},(0,$z.getArrowOffsetToken)({contentRadius:e.borderRadius,limitVerticalRadius:!0})),(0,Bz.getArrowToken)((0,qz.mergeToken)(e,{borderRadiusOuter:Math.min(e.borderRadiusOuter,4)})));iz.prepareComponentToken=Vz;iz.default=(e,t=!0)=>(0,qz.genStyleHooks)("Tooltip",e=>{const{borderRadius:t,colorTextLightSolid:n,colorBgSpotlight:i}=e,a=(0,qz.mergeToken)(e,{tooltipMaxWidth:250,tooltipColor:n,tooltipBorderRadius:t,tooltipBg:i});return[Gz(a),(0,Hz.initZoomMotion)(e,"zoom-big-fast")]},Vz,{resetStyle:!1,injectStyle:t})(e);var Wz={},Qz={},Kz=sP.default;Object.defineProperty(Qz,"__esModule",{value:!0}),Qz.PresetStatusColorTypes=void 0,Qz.isPresetColor=function(e,t=!0){if(t)return[].concat((0,Yz.default)(Jz),(0,Yz.default)(Xz.PresetColors)).includes(e);return Xz.PresetColors.includes(e)},Qz.isPresetStatusColor=function(e){return Zz.includes(e)};var Yz=Kz(DM),Xz=RO;const Jz=Xz.PresetColors.map(e=>`${e}-inverse`),Zz=Qz.PresetStatusColorTypes=["success","processing","error","default","warning"];var eH={};const tH=W(ye);var nH={},iH={exports:{}};!function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports}(iH);var aH=iH.exports,oH={exports:{}};!function(e){var t=kM;function n(e,n){for(var i=0;i<n.length;i++){var a=n[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,t(a.key),a)}}e.exports=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports}(oH);var sH=oH.exports,rH=sP.default;Object.defineProperty(nH,"__esModule",{value:!0}),nH.toHexFormat=nH.getHex=nH.AggregationColor=void 0;var lH=rH(aH),cH=rH(sH),uH=tH;const dH=(e,t)=>(null==e?void 0:e.replace(/[^\w/]/g,"").slice(0,t?8:6))||"";nH.toHexFormat=dH;const hH=(e,t)=>e?dH(e,t):"";nH.getHex=hH,nH.AggregationColor=function(){return(0,cH.default)(function e(t){var n;if((0,lH.default)(this,e),this.cleared=!1,t instanceof e)return this.metaColor=t.metaColor.clone(),this.colors=null===(n=t.colors)||void 0===n?void 0:n.map(t=>({color:new e(t.color),percent:t.percent})),void(this.cleared=t.cleared);const i=Array.isArray(t);i&&t.length?(this.colors=t.map(({color:t,percent:n})=>({color:new e(t),percent:n})),this.metaColor=new uH.Color(this.colors[0].color.metaColor)):this.metaColor=new uH.Color(i?"":t),(!t||i&&!this.colors)&&(this.metaColor=this.metaColor.setA(0),this.cleared=!0)},[{key:"toHsb",value:function(){return this.metaColor.toHsb()}},{key:"toHsbString",value:function(){return this.metaColor.toHsbString()}},{key:"toHex",value:function(){return hH(this.toHexString(),this.metaColor.a<1)}},{key:"toHexString",value:function(){return this.metaColor.toHexString()}},{key:"toRgb",value:function(){return this.metaColor.toRgb()}},{key:"toRgbString",value:function(){return this.metaColor.toRgbString()}},{key:"isGradient",value:function(){return!!this.colors&&!this.cleared}},{key:"getColors",value:function(){return this.colors||[{color:this,percent:0}]}},{key:"toCssString",value:function(){const{colors:e}=this;if(e){return`linear-gradient(90deg, ${e.map(e=>`${e.color.toRgbString()} ${e.percent}%`).join(", ")})`}return this.metaColor.toRgbString()}},{key:"equals",value:function(e){return!(!e||this.isGradient()!==e.isGradient())&&(this.isGradient()?this.colors.length===e.colors.length&&this.colors.every((t,n)=>{const i=e.colors[n];return t.percent===i.percent&&t.color.equals(i.color)}):this.toHexString()===e.toHexString())}}])}();var pH=sP.default;Object.defineProperty(eH,"__esModule",{value:!0}),eH.getRoundNumber=eH.getGradientPercentColor=eH.getColorAlpha=eH.generateColor=eH.genAlphaColor=void 0;var mH=pH(DM),fH=tH,gH=nH;const vH=e=>e instanceof gH.AggregationColor?e:new gH.AggregationColor(e);eH.generateColor=vH;const yH=e=>Math.round(Number(e||0));eH.getRoundNumber=yH;eH.getColorAlpha=e=>yH(100*e.toHsb().a);eH.genAlphaColor=(e,t)=>{const n=e.toRgb();if(!n.r&&!n.g&&!n.b){const n=e.toHsb();return n.a=t||1,vH(n)}return n.a=t||1,vH(n)};eH.getGradientPercentColor=(e,t)=>{const n=[{percent:0,color:e[0].color}].concat((0,mH.default)(e),[{percent:100,color:e[e.length-1].color}]);for(let i=0;i<n.length-1;i+=1){const e=n[i].percent,a=n[i+1].percent,o=n[i].color,s=n[i+1].color;if(e<=t&&t<=a){const n=a-e;if(0===n)return o;const i=(t-e)/n*100,r=new fH.Color(o),l=new fH.Color(s);return r.mix(l,i).toRgbString()}}return""};var bH=sP.default;Object.defineProperty(Wz,"__esModule",{value:!0}),Wz.parseColor=function(e,t){const n=(0,wH.isPresetColor)(t),i=(0,xH.default)({[`${e}-${t}`]:t&&n}),a={},o={},s=(0,SH.generateColor)(t).toRgb(),r=(.299*s.r+.587*s.g+.114*s.b)/255<.5?"#FFF":"#000";t&&!n&&(a.background=t,a["--ant-tooltip-color"]=r,o["--antd-arrow-background-color"]=t);return{className:i,overlayStyle:a,arrowStyle:o}};var xH=bH(ve),wH=Qz,SH=eH;var _H=sP.default,CH=uP.default;Object.defineProperty(nz,"__esModule",{value:!0}),nz.default=void 0;var EH=CH(O),kH=_H(ve),IH=dP,TH=pM,jH=_H(iz),NH=Wz;nz.default=e=>{const{prefixCls:t,className:n,placement:i="top",title:a,color:o,overlayInnerStyle:s}=e,{getPrefixCls:r}=EH.useContext(TH.ConfigContext),l=r("tooltip",t),[c,u,d]=(0,jH.default)(l),h=(0,NH.parseColor)(l,o),p=h.arrowStyle,m=Object.assign(Object.assign({},s),h.overlayStyle),f=(0,kH.default)(u,d,l,`${l}-pure`,`${l}-placement-${i}`,n,h.className);return c(EH.createElement("div",{className:f,style:p},EH.createElement("div",{className:`${l}-arrow`}),EH.createElement(IH.Popup,Object.assign({},e,{className:u,prefixCls:l,overlayInnerStyle:m}),a)))};var PH=sP.default,MH=uP.default;Object.defineProperty(aP,"__esModule",{value:!0});var AH=aP.default=void 0,RH=MH(O),OH=PH(ve),DH=PH(dP),LH=PH(hP),FH=PH(VP),UH=xL,zH=AU,HH=PH(UU),$H=JU,BH=YM,qH=PH(_U),GH=LR,VH=MO,WH=PH(nz),QH=PH(iz),KH=Wz;const YH=RH.forwardRef((e,t)=>{var n,i;const{prefixCls:a,openClassName:o,getTooltipContainer:s,color:r,overlayInnerStyle:l,children:c,afterOpenChange:u,afterVisibleChange:d,destroyTooltipOnHide:h,destroyOnHidden:p,arrow:m=!0,title:f,overlay:g,builtinPlacements:v,arrowPointAtCenter:y=!1,autoAdjustOverflow:b=!0,motion:x,getPopupContainer:w,placement:S="top",mouseEnterDelay:_=.1,mouseLeaveDelay:C=.1,overlayStyle:E,rootClassName:k,overlayClassName:I,styles:T,classNames:j}=e,N=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(n[i[a]]=e[i[a]])}return n}(e,["prefixCls","openClassName","getTooltipContainer","color","overlayInnerStyle","children","afterOpenChange","afterVisibleChange","destroyTooltipOnHide","destroyOnHidden","arrow","title","overlay","builtinPlacements","arrowPointAtCenter","autoAdjustOverflow","motion","getPopupContainer","placement","mouseEnterDelay","mouseLeaveDelay","overlayStyle","rootClassName","overlayClassName","styles","classNames"]),P=!!m,[,M]=(0,VH.useToken)(),{getPopupContainer:A,getPrefixCls:R,direction:O,className:D,style:L,classNames:F,styles:U}=(0,GH.useComponentConfig)("tooltip"),z=(0,BH.devUseWarning)("Tooltip"),H=RH.useRef(null),$=()=>{var e;null===(e=H.current)||void 0===e||e.forceAlign()};RH.useImperativeHandle(t,()=>{var e,t;return{forceAlign:$,forcePopupAlign:()=>{z.deprecated(!1,"forcePopupAlign","forceAlign"),$()},nativeElement:null===(e=H.current)||void 0===e?void 0:e.nativeElement,popupElement:null===(t=H.current)||void 0===t?void 0:t.popupElement}});const[B,q]=(0,LH.default)(!1,{value:null!==(n=e.open)&&void 0!==n?n:e.visible,defaultValue:null!==(i=e.defaultOpen)&&void 0!==i?i:e.defaultVisible}),G=!f&&!g&&0!==f,V=RH.useMemo(()=>{var e,t;let n=y;return"object"==typeof m&&(n=null!==(t=null!==(e=m.pointAtCenter)&&void 0!==e?e:m.arrowPointAtCenter)&&void 0!==t?t:y),v||(0,HH.default)({arrowPointAtCenter:n,autoAdjustOverflow:b,arrowWidth:P?M.sizePopupArrow:0,borderRadius:M.borderRadius,offset:M.marginXXS,visibleFirst:!0})},[y,m,v,M]),W=RH.useMemo(()=>0===f?f:g||f||"",[g,f]),Q=RH.createElement(FH.default,{space:!0},"function"==typeof W?W():W),K=R("tooltip",a),Y=R(),X=e["data-popover-inject"];let J=B;"open"in e||"visible"in e||!G||(J=!1);const Z=RH.isValidElement(c)&&!(0,$H.isFragment)(c)?c:RH.createElement("span",null,c),ee=Z.props,te=ee.className&&"string"!=typeof ee.className?ee.className:(0,OH.default)(ee.className,o||`${K}-open`),[ne,ie,ae]=(0,QH.default)(K,!X),oe=(0,KH.parseColor)(K,r),se=oe.arrowStyle,re=(0,OH.default)(I,{[`${K}-rtl`]:"rtl"===O},oe.className,k,ie,ae,D,F.root,null==j?void 0:j.root),le=(0,OH.default)(F.body,null==j?void 0:j.body),[ce,ue]=(0,UH.useZIndex)("Tooltip",N.zIndex),de=RH.createElement(DH.default,Object.assign({},N,{zIndex:ce,showArrow:P,placement:S,mouseEnterDelay:_,mouseLeaveDelay:C,prefixCls:K,classNames:{root:re,body:le},styles:{root:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},se),U.root),L),E),null==T?void 0:T.root),body:Object.assign(Object.assign(Object.assign(Object.assign({},U.body),l),null==T?void 0:T.body),oe.overlayStyle)},getTooltipContainer:w||s||A,ref:H,builtinPlacements:V,overlay:Q,visible:J,onVisibleChange:t=>{var n,i;q(!G&&t),G||(null===(n=e.onOpenChange)||void 0===n||n.call(e,t),null===(i=e.onVisibleChange)||void 0===i||i.call(e,t))},afterVisibleChange:null!=u?u:d,arrowContent:RH.createElement("span",{className:`${K}-arrow-content`}),motion:{motionName:(0,zH.getTransitionName)(Y,"zoom-big-fast",e.transitionName),motionDeadline:1e3},destroyTooltipOnHide:null!=p?p:!!h}),J?(0,$H.cloneElement)(Z,{className:te}):Z);return ne(RH.createElement(qH.default.Provider,{value:ue},de))}),XH=YH;XH._InternalPanelDoNotUseOrYouWillBeFired=WH.default,AH=aP.default=XH;const JH=({buttonDisabled:e,status:t,onClick:n,chatId:i,disabledStatusCallbackEnabled:a})=>{const{i18n:o}=G(),s=rT(e=>e.messageType);return tn.jsx("div",{className:"chat-prompt-send-button",children:"stop"===t?tn.jsx(AH,{title:e?null:o.t("Stop"),children:tn.jsx("button",{className:"stop-button "+(e?"disabled":""),disabled:e,onClick:e=>{e.preventDefault(),e.stopPropagation(),n("stop")},children:tn.jsx(dt,{type:"icon-fill-stop-011",className:"icon-stop"})})}):"recording"===t?tn.jsx("button",{className:"send-button "+(e?"disabled":""),disabled:e,onClick:e=>{e.preventDefault(),e.stopPropagation(),n("recording")},children:"om"}):tn.jsx("button",{className:`send-button ${e?"disabled":""} ${(null==a?void 0:a.includes("send"))?"disabled-pointer":""}`,disabled:e&&!(null==a?void 0:a.includes("send")),onClick:e=>{e.preventDefault(),e.stopPropagation(),n("send"),qE("click",i,s)},children:tn.jsx(dt,{type:"icon-line-arrow-up",className:"icon-send"})})})},ZH=e=>{const{filesManager:t,messageInputMode:n,isDeepResearchRounds:i,placeHolder:a="",handleSend:o=()=>{},onUpdateSeparationNeeds:s=()=>{}}=e,r=O.useRef(null),l=O.useRef(!1),c=O.useRef(0),u=O.useRef(null),d=O.useRef(!1),h=tx(e=>e.mobile),p=Zb(e=>e.taskRunning),m=Zb(e=>e.visionGenerating),f=rT(e=>e.files),g=rT(e=>e.inputValue),v=rT(e=>e.isFocus),y=rT(e=>e.setIsFocus),b=rT(e=>e.setInputValue),[x,w]=(e=>{const[t,n]=O.useState(!1),[i,a]=O.useState(window.innerHeight),o=O.useRef(0),s=O.useRef(null),r=!1!==(null==e?void 0:e.preventScroll),l=(null==e?void 0:e.isFocus)||!1,c=()=>{const e=navigator.userAgent;return!!/iPhone|iPad|iPod/i.test(e)&&!/CriOS/i.test(e)&&!/EdgiOS/i.test(e)&&!/FxiOS/i.test(e)&&/Safari/i.test(e)&&!/Chrome/i.test(e)};return O.useEffect(()=>{if(!c()||!l)return;a(window.innerHeight);const e=()=>{const e=window.visualViewport?window.visualViewport.height:window.innerHeight,i=screen.height;e<Math.max(.7*i,i-300)?t||(n(!0),r&&(o.current=window.pageYOffset,document.body.style.position="fixed",document.body.style.top=`-${o.current}px`,document.body.style.width="100%",document.body.style.overflow="hidden"),s.current&&setTimeout(()=>{var e;null==(e=s.current)||e.scrollIntoView({behavior:"smooth",block:"center"})},300)):t&&(n(!1),r&&(document.body.style.position="",document.body.style.top="",document.body.style.width="",document.body.style.overflow="",window.scrollTo(0,o.current)))};return window.visualViewport?window.visualViewport.addEventListener("resize",e):window.addEventListener("resize",e),setTimeout(e,100),()=>{window.visualViewport?window.visualViewport.removeEventListener("resize",e):window.removeEventListener("resize",e),r&&(document.body.style.position="",document.body.style.top="",document.body.style.width="",document.body.style.overflow="")}},[t,r]),O.useEffect(()=>{if(!c()||!l)return;const e=e=>{t&&r&&e.preventDefault()},n={passive:!1};return document.addEventListener("touchmove",e,n),()=>{document.removeEventListener("touchmove",e,n)}},[t,r]),[t,e=>{e&&(s.current=e)}]})({isFocus:v}),S=O.useCallback(e=>{const t=i&&(""!==(null==g?void 0:g.trim())||f.length>0);l.current||h||(t||!p&&!m)&&("Enter"!==e.key||e.shiftKey||(e.preventDefault(),o("send"),qE("enter")))},[f.length,o,g,i,h,p,m]),_=O.useCallback(e=>{e.preventDefault(),((e,t)=>{var n,i,a;const o=e.clipboardData||window.clipboardData;let s=!1;if(o&&o.items){const l=cT.getState().settings;for(const c of o.items)if("text/html"!==c.type&&"text/rtf"!==c.type){if(-1!==c.type.indexOf("image")){const e=c.getAsFile();e&&t.addFile(e,Ag.IMAGE),s=!0}else if("text/plain"===c.type){const r=o.getData("text/plain");if((null==(i=null==(n=null==l?void 0:l.ui)?void 0:n.largeTextAsFile)||i)&&r.length>sg){const n=new Blob([r],{type:"text/plain"}),i=new File([n],`Pasted_Text_${Date.now()}.txt`,{type:"text/plain"});t.addFile(i,Ag.DEFAULT),e.preventDefault(),s=!0}else{const t=ME(r);if(t.length>1||(null==(a=null==t?void 0:t[0])?void 0:a.type)===ag.url){const n=e.target;let i=rT.getState().inputValue;const a=AE(t),o=null==n?void 0:n.selectionStart,r=null==n?void 0:n.selectionEnd;i=i.slice(0,o)+a+i.slice(r),rT.getState().setInputValue(i),setTimeout(()=>{n.selectionStart=n.selectionEnd=o+a.length},0),n.style.height="auto",n.style.height=n.scrollHeight+"px",s=!0}}}if(!s)try{const t=o.getData(c.type);if(t){const n=e.target,i=null==n?void 0:n.selectionStart,a=null==n?void 0:n.selectionEnd;let o=rT.getState().inputValue;o=o.slice(0,i)+t+o.slice(a),rT.getState().setInputValue(o),setTimeout(()=>{n.selectionStart=n.selectionEnd=i+t.length},0),s=!0}}catch(r){}}}})(e,t)},[t]),C=O.useCallback(()=>{const e=r.current;if(!e)return;e.style.height="auto";const t=e.scrollHeight,n=h?4.9:8.5,i=window.getComputedStyle(e),a=parseFloat(i.lineHeight),o=a*n;let s=t;a&&s<a&&(s=a),o&&s>o?(s=o,e.style.overflowY="auto"):e.style.overflowY="hidden",e.style.height=`${s}px`},[h]),E=O.useCallback(e=>{if(c.current){const t=(e=>{const t=document.createElement("span"),n=window.getComputedStyle(e);t.style.fontFamily=n.fontFamily,t.style.fontSize=n.fontSize,t.style.fontWeight=n.fontWeight,t.style.letterSpacing=n.letterSpacing,t.style.visibility="hidden",t.style.position="absolute",t.style.whiteSpace="nowrap",t.textContent=e.value,document.body.appendChild(t);const i=t.offsetWidth;return document.body.removeChild(t),i})(r.current)>c.current||e.includes("\n");s({textLengthEnough:t})}},[s]),k=O.useCallback(()=>{if(h)return;const e=r.current;if(e){e.focus();const t=e.value.length;e.setSelectionRange(t,t),e.scrollTop=e.scrollHeight}},[h]);return O.useEffect(()=>{if("combination"===n){const e=!!(null==g?void 0:g.trim());d.current===e&&c.current||(requestAnimationFrame(()=>{const e=r.current;e&&(c.current=e.clientWidth-parseFloat(window.getComputedStyle(e).paddingLeft)-parseFloat(window.getComputedStyle(e).paddingRight))}),d.current=e)}},[n,g]),O.useEffect(()=>{E(g),C()},[g,n]),O.useEffect(()=>(k(),oT.firstOn(YC.MESSAGE_INPUT_TRIGGER_FOCUS,k),()=>{oT.off(YC.MESSAGE_INPUT_TRIGGER_FOCUS,k),clearTimeout(u.current)}),[]),tn.jsx("textarea",{ref:r,value:g,rows:1,className:J("message-input-textarea",{"message-input-textarea-separation":"separation"===n}),placeholder:a,onChange:e=>{b(e.target.value)},onFocus:()=>{w(r.current),y(!0),h&&s({mobileFocus:!0})},onBlur:()=>{y(!1),h&&(s({mobileFocus:!1}),u.current=setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)},0))},onKeyDown:S,onPaste:_,onCompositionStart:()=>{l.current=!0},onCompositionEnd:()=>{l.current=!1}})},e$=({type:e="image",fileType:t="",item:n,status:i,src:a="",alt:o,name:s="",size:r,handleClose:l,handlePreview:c,onReUpload:u})=>{const{mobile:d}=tx(),{i18n:h}=G();let p="",m="";if(s){const e=s.lastIndexOf(".");-1===e?(p=s,m=""):(p=s.slice(0,e),m=s.slice(e+1))}const f=Dg[t]||Dg.others,g=vx()||fx()&&lx(),v=d&&(vx()||fx()&&lx()),y=O.useRef(null),b=O.useMemo(()=>"uploaded"===i||!!a,[a,i]),x=O.useMemo(()=>"green_error"===n.greenNet,[n,n.greenNet]);return O.useEffect(()=>{const t=y.current,n=e=>()=>{e.currentTime=.1,(e=>{if(!cx())return;const t=document.createElement("canvas");t.width=e.videoWidth,t.height=e.videoHeight;const n=t.getContext("2d");n&&(n.drawImage(e,0,0,t.width,t.height),e.setAttribute("poster",t.toDataURL("image/png")))})(e)};if("video"===e&&t){const e=()=>t.pause(),i=n(t);return t.addEventListener("play",e),t.addEventListener("loadedmetadata",i),()=>{t.removeEventListener("play",e),t.removeEventListener("loadedmetadata",i)}}},[e,a]),tn.jsx(tn.Fragment,{children:b?tn.jsxs("div",{className:"vision-item-container",children:[tn.jsx("div",{className:"media",children:tn.jsxs("div",{className:"vision-item-content",children:["image"===e&&tn.jsx("img",{src:a,alt:o,className:"vision-item-image"}),"video"===e&&tn.jsxs(tn.Fragment,{children:[tn.jsx("video",{ref:y,className:"vision-item-video",preload:"auto",controls:!1,autoPlay:v,muted:!0,playsInline:!0,children:g?tn.jsx("source",{src:a,type:t}):tn.jsx("source",{src:a})}),tn.jsx("div",{className:"vision-item-video-play-button",children:tn.jsx("button",{onClick:e=>{e.stopPropagation(),e.preventDefault(),c&&c("video",a)},children:tn.jsx(dt,{type:"iconbigPauseMore",className:"iconbig-pause-more"})})})]})]})}),tn.jsx("button",{className:"close-button",type:"button",onClick:l,children:tn.jsx(dt,{type:"icon-close",className:"icon-close"})})]}):tn.jsxs("div",{className:J("fileitem-btn",{"fileitem-btn-greening":x}),children:[tn.jsxs("div",{className:"file-content-icon",style:x?{}:{backgroundColor:null==f?void 0:f.bg},children:["uploading"===i&&tn.jsx(ij,{className:"vision-spinner"}),"upload_error"===i&&!x&&tn.jsx("button",{className:"fileitem-error-icon-wrapper",onClick:e=>{e.preventDefault(),e.stopPropagation(),u&&u()},children:tn.jsx(dt,{type:"icon-fill",className:"fileitem-error-icon"})}),x&&tn.jsx("div",{className:"fileitem-icon-wrapper",children:tn.jsx(dt,{type:"icon-line-file-none",className:"fileitem-icon"})})]}),tn.jsxs("div",{className:"file-content-info",children:[tn.jsxs("div",{className:"fileitem-file-name",children:[tn.jsx("div",{className:"fileitem-file-name-text",children:p}),tn.jsx("div",{className:"fileitem-file-name-ext",children:m?`.${m}`:""})]}),tn.jsxs("div",{className:"fileitem-file-size",children:[r&&!x&&tn.jsx("span",{style:{margin:0},children:A_(r)}),x&&tn.jsx("span",{className:"fileitem-file-error",children:h.t("Invalid File")})]})]}),tn.jsx("div",{className:"close-button",onClick:l,children:tn.jsx(dt,{type:"icon-close",className:"icon-close"})})]})})},t$=({className:e="",url:t=null,dismissible:n=!1,item:i=null,fileType:a="others",name:o="",size:s,role:r="user",onClick:l,handleClose:c,onReUpload:u,showClose:d=!0,isQuote:h=!1})=>{var p,m,f,g,v,y,b,x,w;const{i18n:S}=G(),[_,C]=O.useState(!1),{fileName:E,fileExt:k}=O.useMemo(()=>{let e="",t="";const n=(null==o?void 0:o.lastIndexOf("."))||-1;return-1===n?(e=o,t=""):(e=o.slice(0,n),t=o.slice(n+1)),{fileName:e,fileExt:t}},[o]),I=O.useMemo(()=>Tg.includes(k)||Sg.includes(a)?{icon:"icon-playground",bg:"#3F3F47"}:Dg[a]||Dg.others,[a,i,k]),T=O.useMemo(()=>{var e,t,n,a,o,s;if(null==(n=null==(t=null==(e=null==i?void 0:i.file)?void 0:e.meta)?void 0:t.parse_meta)?void 0:n.parse_status)switch(null==(s=null==(o=null==(a=null==i?void 0:i.file)?void 0:a.meta)?void 0:o.parse_meta)?void 0:s.parse_status){case"success":return"parsed";case"failed":return"parsed_error";case"running":return"parsing";default:return""}return(null==i?void 0:i.status)||""},[null==i?void 0:i.status,null==(f=null==(m=null==(p=null==i?void 0:i.file)?void 0:p.meta)?void 0:m.parse_meta)?void 0:f.parse_status]),j=O.useMemo(()=>"green_error"===i.greenNet,[i.greenNet]);return tn.jsxs(tn.Fragment,{children:[h&&tn.jsxs("div",{className:"quote-fileitem-btn",children:[tn.jsx(dt,{type:"icon-line-arrow-curve-left-right",className:"quote-icon"}),tn.jsx("img",{src:"https://img.alicdn.com/imgextra/i4/O1CN01bzNurk1Ry24T88pdJ_!!6000000002179-55-tps-20-20.svg",alt:"",className:"quote-pdf-img"}),tn.jsxs("div",{className:"fileitem-file-name",children:[tn.jsx("div",{className:"fileitem-file-name-text",children:E}),tn.jsx("div",{className:"fileitem-file-name-ext",children:k?`.${k}`:`${N=a,{"application/pdf":".pdf","image/jpeg":".jpg","image/png":".png","image/gif":".gif","image/webp":".webp","image/bmp":".bmp","image/tiff":".tiff","text/plain":".txt","text/html":".html","text/css":".css","application/json":".json","application/javascript":".js","application/xml":".xml","application/zip":".zip","application/x-zip-compressed":".zip","application/octet-stream":".bin","video/mp4":".mp4","video/quicktime":".mov","video/x-msvideo":".avi","audio/mpeg":".mp3","audio/wav":".wav","audio/ogg":".ogg","font/woff":".woff","font/woff2":".woff2","application/vnd.ms-excel":".xls","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":".xlsx","application/msword":".doc","application/vnd.openxmlformats-officedocument.wordprocessingml.document":".docx","application/vnd.ms-powerpoint":".ppt","application/vnd.openxmlformats-officedocument.presentationml.presentation":".pptx"}[N]||""}`})]})]}),!h&&tn.jsxs("div",{className:J(`fileitem-btn ${e}`,{"fileitem-btn-greening":j}),onClick:e=>P(void 0,null,function*(){var e,n;(null==(n=null==(e=null==i?void 0:i.file)?void 0:e.data)?void 0:n.content)?C(!_):t&&K_({role:r,url:t,isFile:!0}),l&&l()}),children:[tn.jsxs("div",{className:"file-content-icon",style:j?{}:{backgroundColor:null==I?void 0:I.bg},children:[(["parsed","uploaded","success"].includes(T)||!T||"parsed_error"===T&&!(null==(y=null==(v=null==(g=null==i?void 0:i.file)?void 0:g.meta)?void 0:v.parse_meta)?void 0:y.retry))&&tn.jsx("div",{className:"fileitem-icon-wrapper",children:tn.jsx(dt,{type:null==I?void 0:I.icon,className:"fileitem-icon"})}),j&&tn.jsx("div",{className:"fileitem-icon-wrapper",children:tn.jsx(dt,{type:"icon-line-file-none",className:"fileitem-icon"})}),["parsing","uploading"].includes(T)&&tn.jsx(ij,{className:"vision-spinner"}),("upload_error"===T||"parsed_error"===T&&(null==(w=null==(x=null==(b=null==i?void 0:i.file)?void 0:b.meta)?void 0:x.parse_meta)?void 0:w.retry))&&!j&&tn.jsx("button",{className:"fileitem-error-icon-wrapper",style:{backgroundColor:null==I?void 0:I.bg},onClick:e=>{e.preventDefault(),e.stopPropagation(),u&&u()},children:tn.jsx(dt,{type:"icon-fill",className:"fileitem-error-icon"})})]}),tn.jsxs("div",{className:"file-content-info",children:[tn.jsxs("div",{className:"fileitem-file-name",children:[tn.jsx("div",{className:"fileitem-file-name-text",children:E}),tn.jsx("div",{className:"fileitem-file-name-ext",children:k?`.${k}`:""})]}),tn.jsxs("div",{className:"fileitem-file-size",children:[!["parsed_error","upload_error"].includes(T)&&s&&tn.jsx("span",{style:{margin:0},children:A_(s)}),"parsing"===T&&tn.jsx("span",{children:S.t("Parsing...")}),"parsed_error"===T&&!j&&tn.jsx("span",{className:"fileitem-file-error",children:S.t("Parsing failed")}),"upload_error"===T&&!j&&tn.jsx("span",{className:"fileitem-file-error",children:S.t("Upload failed")}),j&&tn.jsx("span",{className:"fileitem-file-error",children:S.t("Invalid File")})]})]}),d&&tn.jsx("div",{className:"close-button",type:"button",onClick:c,children:tn.jsx(dt,{type:"icon-close",className:"icon-close"})})]})]});var N},n$=({files:e,onClose:t,onReUpload:n,role:i})=>{const[a,o]=O.useState(),[s,r]=O.useState(""),l=O.useRef(null),[c,u]=O.useState(!1),d=(e,t)=>P(void 0,null,function*(){o(e),r(t),"video"===e&&u(!0)}),h=O.useMemo(()=>e.filter(e=>!e.isQuote),[e]);return h&&0!==h.length?tn.jsxs(tn.Fragment,{children:[tn.jsx("div",{className:"file-card-list",children:h.map((e,i)=>{const a=`${e.itemId||i}-${e.status}`;return["video","image"].includes(e.showType)||["video","image"].includes(e.type||"")?tn.jsx(e$,{src:e.url,item:e,type:e.showType,fileType:e.file_type,alt:`${e.name}`,status:e.status,handleClose:()=>{null==t||t(i)},onReUpload:()=>{null==n||n(i)},name:e.name,size:e.size,handlePreview:d},a):tn.jsx(t$,{className:"w-[17rem]",item:e,name:e.name,fileType:e.file_type,size:(null==e?void 0:e.size)||0,dismissible:!0,handleClose:()=>{null==t||t(i)},onReUpload:()=>{null==n||n(i)}},a)})}),"video"===a&&s&&tn.jsx(Ee,{videoPlayerRef:l,url:s,open:c,setOpen:u})]}):null},i$=({children:e})=>{const t=G(),n=yE(e=>e.realTheme);return tn.jsxs("div",{className:"add-files-placeholder",children:[tn.jsx("div",{className:"emoji",children:tn.jsx("img",{src:"dark"===n?"https://img.alicdn.com/imgextra/i2/O1CN01JckncR1mS4QaTKy33_!!6000000004952-55-tps-88-88.svg":"https://img.alicdn.com/imgextra/i4/O1CN01It1jQq1IsgycW9wjk_!!6000000000949-55-tps-88-88.svg",alt:""})}),tn.jsx("div",{className:"title",children:t.t("Drop any files here to add to the conversation")}),e||tn.jsx("div",{className:"description",children:t.t("Add file, image, video or audio to the conversation")})]})},a$=({show:e=!1})=>{const t=O.useRef(null),n=O.useMemo(()=>(t.current||(t.current=document.createElement("div")),t.current),[]);if(O.useEffect(()=>{const t=n;if(e){document.body.appendChild(t);const e=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{try{document.body.removeChild(t)}catch(n){}document.body.style.overflow=e||"unset"}}try{t.parentElement&&document.body.removeChild(t)}catch(i){}},[e,n]),!e)return null;const i=tn.jsx("div",{className:"dropzone-overlay",id:"dropzone",role:"region","aria-label":"Drag and Drop Container",children:tn.jsx("div",{className:"dropzone-overlay-content",children:tn.jsx("div",{className:"dropzone-overlay-content-wrapper",children:tn.jsx("div",{className:"dropzone-overlay-inner",children:tn.jsx("div",{className:"max-w-md",children:tn.jsx(i$,{})})})})})});return be.createPortal(i,n)},o$=({textLength:e})=>{const{i18n:t}=G(),n=tx(e=>e.mobile);return e<=sg?null:tn.jsx("div",{className:"pasted-limit-info",children:tn.jsxs("span",{children:[!n&&t.t("If you need to input more than {{value}} characters, please convert it into a txt document and upload the file, or enable the function in `Settings-Interface-Paste large text as file` and then paste the text.",{value:sg}),n&&t.t("If you need to input more than {{value}} characters, please convert it into a txt document and upload the file, or just copy the text to the clipboard, and then paste it into the input box.",{value:sg})]})})},s$=({currentI18nRecommend:e={},onChange:t})=>{const{i18n:n}=G(),i=rT(e=>e.inputValue),a=O.useMemo(()=>""!==i&&(null==e?void 0:e.t2t)?DE(null==e?void 0:e.t2t.filter(e=>e.includes(i)),5):[],[null==e?void 0:e.t2t,i]);return a.length?tn.jsx("ul",{className:"chat-prompt-recommend-detail-inner",children:!jt(a)&&a.map(e=>tn.jsx("li",{onClick:()=>{return n=e,P(void 0,null,function*(){t({inputText:n})});var n},children:tn.jsx(xe.Text,{ellipsis:!0,children:tn.jsx("span",{dangerouslySetInnerHTML:{__html:OE(e,i,n.language)}})})},e))}):null},r$=({type:e,iconType:t,showType:n="default"})=>{var i;const{i18n:a}=G(),o=tx(e=>e.config),s=O.useCallback(()=>{oT.openWindow(`/community?tab=${e}`)},[e]);return!(null==(i=null==o?void 0:o.function_entry)?void 0:i.community)||bT()?null:"default"===n?tn.jsx("div",{className:"explore-more",children:tn.jsxs("div",{className:"explore-more-content",onClick:s,children:[tn.jsx("span",{children:a.t("Explore more")}),tn.jsx(dt,{type:"icon-line-chevron-right",className:"explore-more-icon"})]})}):"line"===n?tn.jsxs("div",{className:"recommend-dp-item-wrap",onClick:s,children:[t&&tn.jsx(dt,{type:t,className:"recommend-dp-item-wrap-icon"}),tn.jsxs("div",{className:"recommend-dp-item-wrap-text",children:[" ",a.t("Explore more")]}),tn.jsx(dt,{type:"icon-line-chevron-right",className:"recommend-dp-item-wrap-icon recommend-dp-item-wrap-more-icon"})]}):"card"===n?tn.jsx("div",{className:"explore-more-card",onClick:s,children:tn.jsxs("div",{className:"explore-more-card-content",children:[tn.jsx(dt,{type:"icon-line-community",className:"explore-more-card-icon"}),tn.jsx("div",{className:"explore-more-card-text",children:tn.jsx("span",{children:a.t("More")})})]})}):void 0},l$=({onChange:e,currentI18nRecommend:t,type:n})=>{const{i18n:i}=G(),a=tx(e=>e.mobile),o=yE(e=>e.realTheme),s=DE(n===Zf.WebDev?(null==t?void 0:t.webdev)||[]:(null==t?void 0:t.artifacts)||[],4),r=O.useMemo(()=>"dark"===o?"https://img.alicdn.com/imgextra/i4/O1CN014rPKuM2AEpkO3CBOd_!!6000000008172-55-tps-276-276.svg":"https://img.alicdn.com/imgextra/i4/O1CN01KTkLVK1SSif2GxIkw_!!6000000002246-55-tps-276-276.svg",[o]);return tn.jsx("div",{className:"recommend-web-container",children:tn.jsxs("div",{className:"recommend-web-list",children:[s.map((t,s)=>tn.jsxs("div",{className:"recommend-web-item-wrap",children:[tn.jsxs("div",{className:"recommend-web-item-wrap-content",style:{backgroundImage:a?"none":`url(${r})`},children:[!a&&tn.jsx("div",{className:"recommend-web-item-title",children:t.query||t.title}),tn.jsx("img",{className:J("recommend-web-item-image",{"recommend-web-item-image-artifact":n===Zf.Artifacts}),src:"light"===o?t.src:t.darkSrc||t.src,alt:""})]}),tn.jsx("button",{className:"recommend-web-item-image-button",onClick:()=>{e({inputText:t.query||t.title})},children:i.t("Use Prompt")})]},s)),a&&tn.jsx(r$,{type:"web_dev",showType:"card"})]})})},c$=[Zf.DeepResearch,Zf.Travel],u$=({onChange:e,type:t,currentI18nRecommend:n={}})=>{const i=tx(e=>e.mobile),a=O.useMemo(()=>t===Zf.DeepResearch?(null==n?void 0:n.deepResearch)||[]:t===Zf.Travel?(null==n?void 0:n.travel)||[]:t===Zf.WebSearch?(null==n?void 0:n.webSearch)||[]:t===Zf.LEARN&&(null==n?void 0:n.learn)||[],[null==n?void 0:n.deepResearch,null==n?void 0:n.learn,null==n?void 0:n.travel,null==n?void 0:n.webSearch,t]),o=O.useMemo(()=>t===Zf.DeepResearch?"icon-line-deepresearch-02":t===Zf.Travel?"icon-line-Travel":t===Zf.WebSearch?"icon-line-search-01":"",[t]),s=DE(a,i?3:5);return tn.jsx("div",{className:"recommend-dp-container",children:tn.jsxs("div",{className:"recommend-dp-list",children:[s.map((t,n)=>tn.jsxs("div",{className:"recommend-dp-item-wrap",onClick:()=>e({inputText:t.query||t.title}),children:[(o||t.image)&&tn.jsx(dt,{type:o||t.image,className:"recommend-dp-item-wrap-icon"}),tn.jsxs("div",{className:"recommend-dp-item-wrap-text",children:[" ",t.query||t.title]})]},n)),c$.includes(t)&&i&&tn.jsx(r$,{iconType:o,type:"pdf",showType:"line"})]})})},d$=({video:e,onChange:t,videoRefs:n,index:i})=>{const{i18n:a}=G();return tn.jsxs("div",{className:"chat-recommend-video-list-item-mobile",children:[tn.jsx("div",{className:"chat-recommend-video-list-item-container aspect-ratio",children:tn.jsx(ke,{videoSrc:e.src||"",errorMessage:a.t("Your browser does not support the video tag.")||"",onLoad:e=>{e&&n.current&&(n.current[i]=e)}})}),tn.jsx("button",{className:"recommend-use-prompt-btn",onClick:()=>{return n=e.description,i=e.image,P(void 0,null,function*(){t({inputText:n,image:i})});var n,i},children:a.t("Use Prompt")})]})},h$=({data:e,onChange:t})=>{const n=O.useMemo(()=>DE(e,2),[e]),i=navigator.userAgent.toLowerCase(),a=["VivoBrowser"].some(e=>new RegExp(e,"i").test(i)),o=O.useRef([]),s=tx(e=>e.mobile);return O.useEffect(()=>{if(a)return;const e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting?e.target.play():e.target.pause()})},{threshold:.8,rootMargin:"0px"});return o.current.forEach(t=>{t&&(t.setAttribute("playsinline","true"),t.setAttribute("webkit-playsinline","true"),t.muted=!0,e.observe(t))}),()=>{e.disconnect()}},[a]),O.useEffect(()=>{o.current.length===n.length&&setTimeout(()=>{const e=document.getElementById("chat-prompt-recommend-detail-container");e&&s&&(e.scrollLeft=e.scrollWidth)},100)},[o.current.length,n.length,s]),tn.jsx("div",{className:"chat-recommend-video-mobile",children:tn.jsxs("div",{className:"chat-recommend-video-list",children:[n.map((e,n)=>tn.jsx(d$,{index:n,video:e,onChange:t,videoRefs:o},e.src)),tn.jsx(r$,{type:"video",showType:"card"})]})})},p$=({video:e,onChange:t})=>{const n=O.useRef(null),{i18n:i}=G();return tn.jsxs("div",{className:"chat-recommend-video-list-item",onMouseEnter:()=>{var e;return null==(e=n.current)?void 0:e.play()},onMouseLeave:()=>{var e;null==(e=n.current)||e.pause(),n.current.currentTime=0},children:[tn.jsx("div",{className:"chat-recommend-video-list-item-video-container aspect-ratio",children:tn.jsxs("video",{className:"chat-recommend-video-list-item-video",muted:!0,loop:!0,ref:n,children:[tn.jsx("source",{src:e.src,type:"video/mp4"}),i.t("Your browser does not support the video tag.")]})}),tn.jsxs("div",{className:"chat-recommend-video-list-item-text-box",children:[tn.jsx("div",{className:"chat-recommend-video-list-item-text-box-text",children:e.description}),tn.jsx("button",{className:"chat-recommend-video-list-item-text-box-use-btn",onClick:()=>{return n=e.description,i=e.image,P(void 0,null,function*(){t({inputText:n,image:i})});var n,i},children:i.t("Use Prompt")})]})]})},m$=({data:e,onChange:t})=>{const n=O.useMemo(()=>DE(e,2),[e]);return tn.jsx("div",{className:"chat-recommend-video",children:tn.jsx("div",{className:"chat-recommend-video-list",children:n.map(e=>tn.jsx(p$,{video:e,onChange:t},e.src))})})},f$=({currentI18nRecommend:e,onChange:t})=>{const n=tx(e=>e.mobile);rT(e=>e.inputValue),rT(e=>e.files);const i=rT(e=>e.updateFeatureType),a=rT(e=>e.setFiles),o=({inputText:e,image:n})=>{i({chatType:Zf.VideoGeneration,subChatType:Zf.VideoGeneration}),n&&a([{type:"image",name:"example.png",file_type:"image/png",showType:"image",status:"uploaded",file_class:"vision",url:n}]),t({inputText:e})};return n?tn.jsx(h$,{data:(null==e?void 0:e.video)||[],onChange:o}):tn.jsx(m$,{data:(null==e?void 0:e.video)||[],onChange:o})},g$=()=>window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",v$=({data:e,onChange:t})=>{const{i18n:n}=G(),i=rT(e=>e.setFiles),a=O.useCallback(e=>e&&(null==e?void 0:e.length)?tn.jsxs("div",{className:"recommend-source-image-item",children:[e.length>1&&tn.jsx("div",{className:"recommend-source-image-item-back"}),tn.jsx("img",{className:"recommend-source-image-item-img",src:e[0],alt:""})]}):null,[]);return tn.jsx("div",{className:"recommend-image-mobile",children:tn.jsxs("div",{className:"recommend-image-list",children:[e.map((e,o)=>tn.jsxs("div",{className:"recommend-image-item-wrap",children:[a(e.sourceImageList),tn.jsx("img",{className:"recommend-image-item",src:"light"===g$()?e.src:e.darkSrc||e.src,alt:""}),tn.jsx("button",{className:"recommend-use-prompt-btn",onClick:()=>{var n,a;(null==(n=e.sourceImageList)?void 0:n.length)&&i(e.sourceImageList.map(e=>({type:"image",name:"example.png",file_type:"image/png",showType:"image",status:"uploaded",file_class:"vision",url:e}))),a=e.description,t({inputText:a})},children:n.t("Use Prompt")})]},o)),tn.jsx(r$,{type:"image",showType:"card"})]})})},y$=({onChange:e,data:t})=>{const n=G(),i=rT(e=>e.setFiles),a=[];for(let o=0;o<t.length;o+=4)a.push(t.slice(o,o+4));return tn.jsx("div",{className:"image-grid",children:a.map((t,a)=>tn.jsx("div",{className:"image-group",children:t.map((t,o)=>{var s;return tn.jsxs("div",{className:"image-container",children:[tn.jsx("img",{src:t.src,alt:t.src,className:"image"}),tn.jsxs("div",{className:"chat-recommend-image-list-item-text-box",children:[(null==(s=t.sourceImageList)?void 0:s.length)&&tn.jsx("div",{className:"chat-recommend-image-list-item-text-box-source",children:t.sourceImageList.map(e=>tn.jsx("img",{src:e,alt:""},e))}),tn.jsx("div",{className:"chat-recommend-image-list-item-text-box-text",children:t.description}),tn.jsx("button",{className:"chat-recommend-image-list-item-text-box-use-btn",onClick:()=>{var n;(null==(n=t.sourceImageList)?void 0:n.length)&&i(t.sourceImageList.map(e=>({type:"image",name:"example.png",file_type:"image/png",showType:"image",status:"uploaded",file_class:"vision",url:e}))),e({inputText:t.description})},children:n.t("Use Prompt")})]})]},`${a}-${o}`)})},a))})},b$=({data:e,onChange:t})=>tn.jsx("div",{className:"chat-recommend-image",children:tn.jsx(y$,{onChange:t,data:e})}),x$=px(),w$=({currentI18nRecommend:e,onChange:t})=>{const n=DE((null==e?void 0:e.image)||[],4);return O.useEffect(()=>{},[]),x$?tn.jsx(v$,{data:n,onChange:t}):tn.jsx(b$,{data:n,onChange:t})},S$=({onChange:e})=>{const{i18n:t}=G(),n=yE(e=>e.realTheme),[i,a]=O.useState({}),[o,s]=O.useState([]),r=rT(e=>e.setFiles);O.useEffect(()=>{try{P(void 0,null,function*(){return yield Ox("/configs/?code=query-suggestion-slides")}).then(e=>{(null==e?void 0:e.success)&&a(e.data)})}catch(e){}},[]);O.useEffect(()=>{var e;i&&s(null==(e=null==i?void 0:i[t.language])?void 0:e.slides)},[i,t.language]);const l=DE(o||[],3),c=O.useMemo(()=>"dark"===n?"https://img.alicdn.com/imgextra/i4/O1CN01jRh4L41R4cDu9WAAW_!!6000000002058-55-tps-265-200.svg":"https://img.alicdn.com/imgextra/i1/O1CN01HjVxaK1q7hHaF5ZDh_!!6000000005449-55-tps-265-200.svg",[n]);return tn.jsx("div",{className:"recommend-ai-ppt-container",children:tn.jsx("div",{className:"recommend-ai-ppt-list",children:l.map(n=>tn.jsxs("div",{className:"recommend-ai-ppt-item-wrap",style:{backgroundImage:`url(${c})`},children:[tn.jsx("div",{className:"recommend-ai-ppt-item-title",children:n.prompt}),tn.jsx("img",{className:"recommend-ai-ppt-item-image",src:n.src,alt:""}),tn.jsx("button",{className:"recommend-ai-ppt-item-image-button",onClick:()=>{(t=>{const{inputText:n,file:i,filename:a}=t;i&&r([{type:"file",file:{filename:null!=a?a:"2601.15621v1.pdf",meta:{name:null!=a?a:"2601.15621v1.pdf",content_type:"application/pdf",parse_meta:{parse_status:"success"}}},url:i,name:null!=a?a:"2601.15621v1.pdf",status:"uploaded",greenNet:"success",file_type:"application/pdf",showType:"file",file_class:"document"}]),e({inputText:n})})({inputText:n.prompt,file:null==n?void 0:n.fileUrl,filename:null==n?void 0:n.filename})},children:t.t("Use Prompt")})]},n.prompt))})})},_$=H.memo(({currentI18nRecommend:e,messageType:t,onChange:n})=>{const i=tx(e=>e.mobile);switch(t){case Zf.Travel:case Zf.WebSearch:case Zf.DeepResearch:case Zf.LEARN:return tn.jsx(u$,{currentI18nRecommend:e,onChange:n,type:t});case Zf.VideoGeneration:return tn.jsx(f$,{currentI18nRecommend:e,onChange:n});case Zf.WebDev:case Zf.Artifacts:return tn.jsx(l$,{currentI18nRecommend:e,type:t,onChange:n});case Zf.Slides:return tn.jsx(S$,{onChange:n});case Zf.ImageGeneration:return tn.jsx(w$,{currentI18nRecommend:e,onChange:n});case Zf.Txt2Txt:return i?tn.jsx(s$,{currentI18nRecommend:e,onChange:n}):null;default:return null}},(e,t)=>e.messageType===t.messageType),C$=[{ratio:"1:1",originImageUrl:"https://img.alicdn.com/imgextra/i4/O1CN01D1as1J1L65nt2fHdQ_!!6000000001249-2-tps-1328-1328.png",newImageUrl:"https://img.alicdn.com/imgextra/i2/O1CN01Zz1Vkw1wqThW3tPiv_!!6000000006359-2-tps-1328-1328.png",prompt:"Ultra-detailed 3D graphite pencil sketch of a person actively drawing, rendered on textured white notebook paper. The subjects hand is holding a pencil, mid-stroke, as the sketch dynamically emerges from the page. Surrounding the drawing area: realistic pencil shavings, a pink eraser, and a metal pencil sharpener resting naturally on the paper. Emphasize high-fidelity paper texturevisible grain, subtle fibers, and minor imperfections like slight creases or soft folds. Include authentic graphite effects: soft smudges, fine residue, and nuanced tonal gradients. Cast realistic ambient shadows under objects and around the hand to enhance depth and tactile presence. Style: photorealistic hand-drawn aesthetic, monochrome graphite tones, macro-level detail."},{ratio:"1:1",originImageUrl:"https://img.alicdn.com/imgextra/i4/O1CN01D1as1J1L65nt2fHdQ_!!6000000001249-2-tps-1328-1328.png",newImageUrl:"https://img.alicdn.com/imgextra/i4/O1CN01V0MSlo1UNLGJxq8Tp_!!6000000002505-2-tps-1328-1328.png",prompt:"Create a high-quality 3D avatar of the person in the uploaded image with a cheerful, expressive face. The character should have a warm smile, bright eyes, and soft facial features that feel friendly and approachable. Render in a Pixar-style aesthetic with smooth textures, subtle skin shading, and slightly exaggerated proportions for a cute, animated look. Lighting should be soft and even, creating a clean studio look with gentle shadows for depth."},{ratio:"1:1",originImageUrl:"https://img.alicdn.com/imgextra/i4/O1CN01D1as1J1L65nt2fHdQ_!!6000000001249-2-tps-1328-1328.png",newImageUrl:"https://img.alicdn.com/imgextra/i1/O1CN01934VZ31nXr3QuT52K_!!6000000005100-2-tps-1328-1328.png",prompt:"A close-up, professionally composed photograph of a hand-crocheted yarn doll gently cradled in two hands. The doll has a soft, rounded chibi form, faithfully reimagining the character from the uploaded image with vivid contrasting colors and intricate, tactile details. The hands are natural and expressivefingers relaxed yet clearly defined, with realistic skin texture, subtle veins, and gentle light-to-shadow transitions that convey warmth and human presence. The background is softly blurred, revealing a cozy indoor setting: a warm-toned wooden tabletop bathed in diffused daylight streaming through a nearby window. The overall atmosphere is intimate, serene, and tender, celebrating both the artistry of handmade craft and the quiet affection of holding something cherished."},{ratio:"1:1",originImageUrl:"https://img.alicdn.com/imgextra/i4/O1CN01D1as1J1L65nt2fHdQ_!!6000000001249-2-tps-1328-1328.png",newImageUrl:"https://img.alicdn.com/imgextra/i1/O1CN01jODjPc1MpGU6MJ166_!!6000000001483-2-tps-1328-1328.png",prompt:"Create a stylized 3D chibi character based on the attached photo, faithfully preserving the subjects distinctive facial features and key clothing details. The character strikes a playful posesitting on the edge of a giant Instagram-style frame with both legs dangling outsideand forms a finger heart with their left hand, topped by a glowing red heart icon. The frames top edge displays the username Beauty in clean, modern typography. Floating around the scene are subtle, semi-transparent social media UI elements: like, comment, and share icons, rendered in a cohesive, non-distracting style. The overall aesthetic is vibrant, cute, and digitally nativeblending kawaii chibi charm with contemporary social media visual language."}],E$=({onClose:e,leftContent:t,rightContent:n,topContent:i,bottomContent:a,variant:o="pc"})=>{const s="h5"===o,r=s?"guidance-h5-card":"guidance-pc-card",l=s?"guidance-h5-close-btn":"guidance-pc-close-btn",c=s?"guidance-h5-inner":"guidance-pc-inner",u=s?"guidance-h5-left":"guidance-pc-left",d=s?"guidance-h5-right":"guidance-pc-right",h=s?"guidance-h5-top":"guidance-pc-top",p=s?"guidance-h5-bottom":"guidance-pc-bottom",[m,f]=O.useState(()=>"undefined"!=typeof window&&window.innerWidth<700);return O.useEffect(()=>{const e=()=>{f(window.innerWidth<700)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),tn.jsxs("div",{className:r,children:[tn.jsx("button",{className:l,onClick:()=>{null==e||e()},children:tn.jsx(dt,{type:"icon-close"})}),tn.jsx("div",{className:"guidance-pc-gradient-bg"}),tn.jsx("div",{className:c,children:m&&i&&a?tn.jsxs(tn.Fragment,{children:[tn.jsx("div",{className:h,children:i}),tn.jsx("div",{className:p,children:a})]}):tn.jsxs(tn.Fragment,{children:[tn.jsx("div",{className:u,children:t}),tn.jsx("div",{className:d,children:n})]})})]})},k$=({onGetStarted:e,onClose:t,RecommendPrompt:n})=>{const{i18n:i}=G(),a=O.useMemo(()=>DE(n),[]),[,o]=O.useState(0),[s,r]=O.useState(()=>a[0]),[l,c]=O.useState(!1),[u,d]=O.useState(!1),h=tn.jsx(tn.Fragment,{children:tn.jsx("div",{className:"guidance-edit-pc-text",children:i.t("Transform yourself into a 3D character.")})}),p=tn.jsx(tn.Fragment,{children:tn.jsxs("div",{className:"guidance-pc-buttons",children:[tn.jsx(pt,{type:"brandprimary",size:"small",rounded:"circle",className:"guidance-pc-get-started-btn",onClick:()=>e(!1,s),children:i.t("Get Started")}),tn.jsx(pt,{type:"ghost",size:"small",rounded:"circle",className:"guidance-pc-shuffle-btn",onClick:()=>{c(!0),setTimeout(()=>{d(!0),o(e=>{const t=(e+1)%a.length;return r(a[t]),t}),c(!1),requestAnimationFrame(()=>{setTimeout(()=>{d(!1)},300)})},300)},children:tn.jsx(dt,{type:"icon-line-Shuffle",className:"guidance-pc-shuffle-btn-icon"})})]})}),m=tn.jsx("div",{className:"guidance-edit-pc-right-content",children:s&&tn.jsxs("div",{className:"guidance-edit-pc-image-comparison",children:[tn.jsxs("div",{className:`guidance-edit-pc-image-before ${l?"guidance-edit-pc-shuffle-out":""} ${u?"guidance-edit-pc-shuffle-in":""}`,children:[tn.jsx("img",{src:s.originImageUrl,alt:"Before",className:"guidance-edit-pc-image-before-img"}),tn.jsxs("div",{className:"guidance-edit-pc-image-upload-placeholder",onClick:()=>e(!0,s),children:[tn.jsx(dt,{type:"icon-line-plus-02",className:"guidance-edit-pc-image-upload-icon"}),tn.jsx("span",{className:"guidance-edit-pc-image-upload-text",children:i.t("Upload image")})]})]},`before-${s.prompt}`),tn.jsx("div",{className:"guidance-edit-pc-image-arrow",children:tn.jsx("img",{src:"https://img.alicdn.com/imgextra/i3/O1CN01T2wxFm1tFQod0lYfk_!!6000000005872-2-tps-216-144.png",alt:"Arrow"})}),tn.jsx("div",{className:`guidance-edit-pc-image-after ${l?"guidance-edit-pc-shuffle-out":""} ${u?"guidance-edit-pc-shuffle-in":""}`,children:tn.jsx("img",{src:s.newImageUrl,alt:"After"})},`after-${s.prompt}`)]})}),f=tn.jsxs(tn.Fragment,{children:[h,p]}),g=tn.jsx(tn.Fragment,{children:m}),v=tn.jsx(tn.Fragment,{children:h}),y=tn.jsxs(tn.Fragment,{children:[p,m]});return tn.jsx(E$,{onClose:t,topContent:v,bottomContent:y,leftContent:f,rightContent:g})},I$=({onImageClick:e,onClose:t,RecommendPrompt:n})=>{const[i,a]=O.useState(()=>DE(n,1)[0]||C$[0]),[o,s]=O.useState(!1),[r,l]=O.useState(!1),c=O.useRef(null),{i18n:u}=G();O.useEffect(()=>()=>{c.current&&clearTimeout(c.current)},[]);const d=tn.jsxs(tn.Fragment,{children:[tn.jsxs("div",{className:"guidance-edit-h5-text",children:[tn.jsx("div",{className:"guidance-edit-h5-text-title",children:u.t("Try this! Turn photos into 3D style.")}),tn.jsx("div",{className:"guidance-edit-h5-text-subtitle",children:u.t("Select one from the sample on the right.")})]}),tn.jsx(pt,{type:"ghost",size:"small",rounded:"circle",className:"guidance-edit-h5-shuffle-btn",onClick:()=>{o||r||(s(!0),c.current=setTimeout(()=>{let e,t=0;do{if(e=DE(C$,1)[0]||C$[0],t++,t>10)break}while(e.prompt===i.prompt&&C$.length>1);a(e),s(!1),requestAnimationFrame(()=>{l(!0),setTimeout(()=>{l(!1)},300)})},300))},children:tn.jsx(dt,{type:"icon-line-Shuffle",className:"guidance-edit-h5-shuffle-btn-icon"})})]}),h=tn.jsx("div",{className:"guidance-edit-h5-right-content",onClick:()=>{e(!1,i)},children:i&&tn.jsxs("div",{className:"guidance-edit-h5-image-comparison",children:[tn.jsx("div",{className:`guidance-edit-h5-image-before ${o?"guidance-edit-h5-before-shuffle-out":""} ${r?"guidance-edit-h5-before-shuffle-in":""}`,children:tn.jsx("img",{src:i.originImageUrl,alt:"Before",className:"guidance-edit-h5-image-before-img"})},`before-${i.prompt}`),tn.jsx("div",{className:"guidance-edit-h5-image-arrow",children:tn.jsx("img",{src:"https://img.alicdn.com/imgextra/i3/O1CN01z7PRcK1TITR9FpcFV_!!6000000002359-2-tps-144-108.png",alt:"Arrow"})}),tn.jsx("div",{className:`guidance-edit-h5-image-after ${o?"guidance-edit-h5-after-shuffle-out":""} ${r?"guidance-edit-h5-after-shuffle-in":""}`,children:tn.jsx("img",{src:i.newImageUrl,alt:"After"})},`after-${i.prompt}`)]})});return tn.jsx(E$,{variant:"h5",onClose:t,leftContent:d,rightContent:h})},T$=({onImageClick:e,onClose:t,RecommendPrompt:n})=>{const[i,a]=O.useState([0,1,2,3]),[o,s]=O.useState(!1),r=O.useRef(null),l=O.useRef(0),{i18n:c}=G(),u=H.useMemo(()=>DE(n),[]),d=H.useCallback(e=>{const t=i[0],n=i[1],a=i[2],s=i[3];return e===t?"pos-1":e===n?"pos-2":e===a?"pos-3":e===s&&o?"pos-4":"hidden"},[i,o]),h=H.useCallback(()=>{o||(s(!0),l.current+=1,r.current=setTimeout(()=>{a(e=>e.map(e=>(e+1)%u.length)),requestAnimationFrame(()=>{s(!1)})},300))},[u.length,o]);O.useEffect(()=>()=>{r.current&&clearTimeout(r.current)},[]);const p=tn.jsxs(tn.Fragment,{children:[tn.jsxs("div",{className:"guidance-h5-text",children:[tn.jsx("div",{className:"guidance-h5-text-title",children:c.t("Create your first image")}),tn.jsx("div",{className:"guidance-h5-text-subtitle",children:c.t("Select one from the sample on the right.")})]}),tn.jsx(pt,{type:"ghost",size:"small",rounded:"circle",className:"guidance-h5-shuffle-btn",onClick:()=>{h()},children:tn.jsx(dt,{type:"icon-line-Shuffle",className:"guidance-h5-shuffle-btn-icon"})})]}),m=tn.jsx(tn.Fragment,{children:u.map((t,n)=>{const i=d(n),a="hidden"===i;let s="guidance-h5-image-card";return"pos-1"===i?(s+=" guidance-h5-card-pos-1",o&&(s+=" guidance-h5-shuffle-out-1")):"pos-2"===i?(s+=" guidance-h5-card-pos-2",o&&(s+=" guidance-h5-shuffle-move-1")):"pos-3"===i?(s+=" guidance-h5-card-pos-3",o&&(s+=" guidance-h5-shuffle-move-2")):"pos-4"===i?(s+=" guidance-h5-card-pos-4",o&&(s+=" guidance-h5-shuffle-in-3")):a&&(s+=" guidance-h5-hidden"),tn.jsx("div",{className:s,onClick:()=>{a||e(t.prompt)},children:tn.jsx("img",{src:t.imageUrl,alt:t.tag})},`image-${n}`)})});return tn.jsx(E$,{variant:"h5",onClose:t,leftContent:p,rightContent:m})},j$=({onGetStarted:e,onClose:t,RecommendPrompt:n})=>{const[i,a]=O.useState(()=>DE(n,3)),[o,s]=O.useState(!1),[r,l]=O.useState(!1),[c,u]=O.useState(0),{i18n:d}=G(),h=tn.jsx(tn.Fragment,{children:tn.jsx("div",{className:"guidance-pc-text",children:d.t("Choose a style to create your first image.")})}),p=tn.jsx(tn.Fragment,{children:tn.jsxs("div",{className:"guidance-pc-buttons",children:[tn.jsx(pt,{type:"brandprimary",size:"small",rounded:"circle",className:"guidance-pc-get-started-btn",onClick:()=>{e(i[1].prompt)},children:d.t("Get started")}),tn.jsx(pt,{type:"ghost",size:"small",rounded:"circle",className:"guidance-pc-shuffle-btn",onClick:()=>{s(!0),setTimeout(()=>{l(!0),a(DE(n,3)),u(e=>e+1),s(!1),requestAnimationFrame(()=>{setTimeout(()=>{l(!1)},350)})},350)},children:tn.jsx(dt,{type:"icon-line-Shuffle",className:"guidance-pc-shuffle-btn-icon"})})]})}),m=tn.jsx("div",{className:"guidance-pc-images",children:i.map((t,n)=>tn.jsx("div",{className:`guidance-pc-image-card ${o?"guidance-pc-shuffle-out":""} ${r?"guidance-pc-shuffle-in":""}`,"data-card-index":n,onClick:()=>{return n=t.prompt,void e(n);var n},children:tn.jsx("img",{src:t.imageUrl,alt:t.tag})},`${t.prompt}-${n}-${c}`))}),f=tn.jsxs(tn.Fragment,{children:[h,p]}),g=tn.jsx(tn.Fragment,{children:m}),v=tn.jsx(tn.Fragment,{children:h}),y=tn.jsxs(tn.Fragment,{children:[p,m]});return tn.jsx(E$,{onClose:t,topContent:v,bottomContent:y,leftContent:f,rightContent:g})},N$="guidance_card_type",P$=({onClose:e,onAutoFillPrompt:t,RecommendData:n})=>{const i=tx(e=>e.mobile),a=rT(e=>e.setInputValue),o=rT(e=>e.setFiles),s=rT(e=>e.setVisionSize),r=H.useMemo(()=>{const e=localStorage.getItem(N$);return e===Zf.ImageGeneration?Zf.ImageEdit:(Zf.ImageEdit,Zf.ImageGeneration)},[]);O.useEffect(()=>{localStorage.setItem(N$,r)},[r]);const l=()=>{null==e||e()},c=(e,n)=>{oT.emit(YC.MESSAGE_INPUT_RECOMMEND_WORDS_CLICK,{suggestItem:{chatType:Zf.ImageGeneration,subChatType:Zf.ImageGeneration,uploadType:e?[Ag.IMAGE]:[]},active:!0}),s(n.ratio),e?a(n.prompt):(a(n.prompt),o([{type:"image",name:"example.png",file_type:"image/png",showType:"image",status:"uploaded",file_class:"vision",url:n.originImageUrl}])),t()},u=e=>{oT.emit(YC.MESSAGE_INPUT_RECOMMEND_WORDS_CLICK,{suggestItem:{chatType:Zf.ImageGeneration,subChatType:Zf.ImageGeneration},active:!0}),s("16:9"),a(e),t()};return i?r===Zf.ImageGeneration?tn.jsx(T$,{onImageClick:u,onClose:l,RecommendPrompt:n.imageGeneration||[]}):tn.jsx(I$,{onImageClick:c,onClose:l,RecommendPrompt:n.imageEdit||[]}):r===Zf.ImageGeneration?tn.jsx(j$,{onGetStarted:u,onClose:l,RecommendPrompt:n.imageGeneration||[]}):tn.jsx(k$,{onGetStarted:c,onClose:l,RecommendPrompt:n.imageEdit||[]})},M$=H.memo(({currentI18nRecommend:e,resetInputHandler:t})=>{const n=tx(e=>e.mobile),i=rT(e=>e.messageType),a=Wb(e=>e.currentInputFeature),o=rT(e=>e.files),s=xE(e=>e.user),[r,l]=O.useState(!1),[c,u]=O.useState(!1),d=()=>{u(!0)},h=O.useMemo(()=>!s&&(!r&&(!(a!==Zf.ImageGeneration||!c)||a===Zf.Txt2Txt&&0===o.length)),[s,r,a,o.length,c]),p=O.useMemo(()=>{switch(i){case Zf.ImageGeneration:return"image";case Zf.Travel:case Zf.DeepResearch:return"pdf";case Zf.WebDev:case Zf.Artifacts:return"web_dev";case Zf.VideoGeneration:return"video";default:return null}},[i]);return n?tn.jsx("div",{className:"chat-prompt-recommend-detail-container",children:h?tn.jsx(P$,{onClose:()=>l(!0),onAutoFillPrompt:d,RecommendData:null==e?void 0:e.guidance}):tn.jsx(_$,{currentI18nRecommend:e,messageType:i,onChange:e=>{t(e.inputText,"send")}})}):tn.jsx("div",{className:J("chat-prompt-recommend-container"),children:h?tn.jsx(P$,{onClose:()=>l(!0),onAutoFillPrompt:d,RecommendData:null==e?void 0:e.guidance}):tn.jsxs("div",{className:"chat-prompt-recommend-detail-container",children:[tn.jsx(_$,{currentI18nRecommend:e,messageType:i,onChange:e=>{t(e.inputText,"send")}}),p&&tn.jsx(r$,{type:p})]})})}),A$=()=>{const e=G(),t="footer-link "+("dark"===yE(e=>e.realTheme)?"footer-link-dark":"footer-link-light");return bT()?tn.jsx("div",{className:"chat-footer",children:tn.jsx(V,{i18nKey:"By using Qwen Chat, you agree to our {{Terms}} and {{Privacy}}.",values:{Terms:"<a/>",Privacy:"<b/>"},components:{a:tn.jsx("a",{className:t,onClick:e=>{var t;(null==(t=window.electronAPI)?void 0:t.open_external_link)?(e.preventDefault(),window.electronAPI.open_external_link(`${window.location.origin}/legal-agreement/terms-of-service`)):window.open(`${window.location.origin}/legal-agreement/terms-of-service`)},children:e.t("Terms of Service")},"terms-of-service"),b:tn.jsx("a",{className:t,onClick:e=>{var t;(null==(t=window.electronAPI)?void 0:t.open_external_link)?(e.preventDefault(),window.electronAPI.open_external_link(`${window.location.origin}/legal-agreement/privacy-policy`)):window.open(`${window.location.origin}/legal-agreement/privacy-policy`)},children:e.t("Privacy Policy")},"privacy-policy")}})}):null},R$=()=>{var e,t,n;const i=Zb(e=>e.selectedText),a=Zb(e=>e.setSelectedText),o=rT(e=>e.files),s=rT(e=>e.setFiles),r=Wb(e=>e.chatId),{id:l}=oy(),c=O.useCallback(()=>{s([]),a("")},[s,a]);O.useEffect(()=>{r!==l&&a("")},[r,l,a]);const u=O.useMemo(()=>{const e=o.filter(e=>e.isQuote),t={};return e.length&&(t.quoteFiles=e),i&&(t.quoteText=i),t},[o,i]);return jt(u)?null:tn.jsxs("div",{className:"quote",children:[tn.jsx(dt,{type:"icon-line-arrow-curve-left-right",className:"quote-icon"}),!!(null==(e=null==u?void 0:u.quoteFiles)?void 0:e.length)&&tn.jsx("div",{className:"quote-imgs",children:null==(t=null==u?void 0:u.quoteFiles)?void 0:t.map(e=>tn.jsxs(tn.Fragment,{children:["image"===e.type&&tn.jsx("img",{src:e.url,alt:"",className:"quote-imgs-img"},e.url),"file"===e.type&&tn.jsxs("div",{className:"quote-pdf",children:[tn.jsx("img",{src:"https://img.alicdn.com/imgextra/i4/O1CN01bzNurk1Ry24T88pdJ_!!6000000002179-55-tps-20-20.svg",alt:"",className:"quote-pdf-img"}),tn.jsx("div",{className:"quote-pdf-name",children:null==e?void 0:e.name})]})]}))}),!!(null==(n=null==u?void 0:u.quoteText)?void 0:n.length)&&tn.jsx("div",{className:"quote-imgs",children:tn.jsx("div",{className:"quote-text",children:null==u?void 0:u.quoteText})}),tn.jsx(dt,{type:"icon-line-x-03",className:"quote-icon",onClick:c})]})};class O${constructor(e,t,n){var i;this.length_=e,this.scaleFactor_=(e-1)/t,this.interpolate=this.cubic,"point"===n.method?this.interpolate=this.point:"linear"===n.method?this.interpolate=this.linear:"sinc"===n.method&&(this.interpolate=this.sinc),this.tangentFactor_=1-Math.max(0,Math.min(1,n.tension||0)),this.sincFilterSize_=n.sincFilterSize||1,this.kernel_=(i=n.sincWindow||D$,function(e){return function(e){return 0===e?1:Math.sin(Math.PI*e)/(Math.PI*e)}(e)*i(e)})}point(e,t){return this.getClippedInput_(Math.round(this.scaleFactor_*e),t)}linear(e,t){e=this.scaleFactor_*e;let n=Math.floor(e);return(1-(e-=n))*this.getClippedInput_(n,t)+e*this.getClippedInput_(n+1,t)}cubic(e,t){e=this.scaleFactor_*e;let n=Math.floor(e),i=[this.getTangent_(n,t),this.getTangent_(n+1,t)],a=[this.getClippedInput_(n,t),this.getClippedInput_(n+1,t)],o=(e-=n)*e,s=e*o;return(2*s-3*o+1)*a[0]+(s-2*o+e)*i[0]+(-2*s+3*o)*a[1]+(s-o)*i[1]}sinc(e,t){e=this.scaleFactor_*e;let n=Math.floor(e),i=n-this.sincFilterSize_+1,a=n+this.sincFilterSize_,o=0;for(let s=i;s<=a;s++)o+=this.kernel_(e-s)*this.getClippedInput_(s,t);return o}getTangent_(e,t){return this.tangentFactor_*(this.getClippedInput_(e+1,t)-this.getClippedInput_(e-1,t))/2}getClippedInput_(e,t){return 0<=e&&e<this.length_?t[e]:0}}function D$(e){return Math.exp(-e/2*e/2)}const L$={point:!1,linear:!1,cubic:!0,sinc:!0},F$={IIR:16,FIR:71},U$={IIR:class{constructor(e,t,n){let i=[];for(let a=0;a<e;a++)i.push(this.getCoeffs_({Fs:t,Fc:n,Q:.5/Math.sin(Math.PI/(2*e)*(a+.5))}));this.stages=[];for(let a=0;a<i.length;a++)this.stages[a]={b0:i[a].b[0],b1:i[a].b[1],b2:i[a].b[2],a1:i[a].a[0],a2:i[a].a[1],k:i[a].k,z:[0,0]}}filter(e){let t=e;for(let n=0,i=this.stages.length;n<i;n++)t=this.runStage_(n,t);return t}getCoeffs_(e){let t={z:[0,0],a:[],b:[]},n=this.preCalc_(e,t);return t.k=1,t.b.push((1-n.cw)/(2*n.a0)),t.b.push(2*t.b[0]),t.b.push(t.b[0]),t}preCalc_(e,t){let n={},i=2*Math.PI*e.Fc/e.Fs;return n.alpha=Math.sin(i)/(2*e.Q),n.cw=Math.cos(i),n.a0=1+n.alpha,t.a0=n.a0,t.a.push(-2*n.cw/n.a0),t.k=1,t.a.push((1-n.alpha)/n.a0),n}runStage_(e,t){let n=t*this.stages[e].k-this.stages[e].a1*this.stages[e].z[0]-this.stages[e].a2*this.stages[e].z[1],i=this.stages[e].b0*n+this.stages[e].b1*this.stages[e].z[0]+this.stages[e].b2*this.stages[e].z[1];return this.stages[e].z[1]=this.stages[e].z[0],this.stages[e].z[0]=n,i}reset(){for(let e=0;e<this.stages.length;e++)this.stages[e].z=[0,0]}},FIR:class{constructor(e,t,n){let i=2*Math.PI*n/t,a=0;this.filters=[];for(let o=0;o<=e;o++)o-e/2==0?this.filters[o]=i:(this.filters[o]=Math.sin(i*(o-e/2))/(o-e/2),this.filters[o]*=.54-.46*Math.cos(2*Math.PI*o/e)),a+=this.filters[o];for(let o=0;o<=e;o++)this.filters[o]/=a;this.z=this.initZ_()}filter(e){this.z.buf[this.z.pointer]=e;let t=0;for(let n=0,i=this.z.buf.length;n<i;n++)t+=this.filters[n]*this.z.buf[(this.z.pointer+n)%this.z.buf.length];return this.z.pointer=(this.z.pointer+1)%this.z.buf.length,t}reset(){this.z=this.initZ_()}initZ_(){let e=[];for(let t=0;t<this.filters.length-1;t++)e.push(0);return{buf:e,pointer:0}}}};function z$(e,t,n,i={}){let a=(n-t)/t+1,o=new Float64Array(e.length*a);i.method=i.method||"cubic";let s=new O$(e.length,o.length,{method:i.method,tension:i.tension||0,sincFilterSize:i.sincFilterSize||6,sincWindow:i.sincWindow||void 0});if(void 0===i.LPF&&(i.LPF=L$[i.method]),i.LPF){i.LPFType=i.LPFType||"IIR";const a=U$[i.LPFType];if(n>t){!function(e,t,n,i){for(let a=0,o=t.length;a<o;a++)t[a]=i.filter(n.interpolate(a,e));i.reset();for(let a=t.length-1;a>=0;a--)t[a]=i.filter(t[a])}(e,o,s,new a(i.LPFOrder||F$[i.LPFType],n,t/2))}else{!function(e,t,n,i){for(let a=0,o=e.length;a<o;a++)e[a]=i.filter(e[a]);i.reset();for(let a=e.length-1;a>=0;a--)e[a]=i.filter(e[a]);H$(e,t,n)}(e,o,s,new a(i.LPFOrder||F$[i.LPFType],t,n/2))}}else H$(e,o,s);return o}function H$(e,t,n){for(let i=0,a=t.length;i<a;i++)t[i]=n.interpolate(i,e)}function $$(e,t,n){for(let i=0;i<n.length;i++)e.setUint8(t+i,n.charCodeAt(i))}const B$=class{constructor(){k(this,"audioContext"),k(this,"mediaStream",null),k(this,"mediaSourceNode",null),k(this,"scriptNode",null),k(this,"_state",2),k(this,"isCollectingData",!1),k(this,"frameData",[]),k(this,"frameLength",50),k(this,"audioDataBuffers",[]),k(this,"start",()=>P(this,null,function*(){var e;try{if(0===this.state)return;if(2===this.state&&(this.audioDataBuffers=[],this.frameData=[]),this.mediaStream&&1===this.state)return this.isCollectingData=!0,void this.setRecordState(0);"closed"===this.audioContext.state&&(this.audioContext=new(window.AudioContext||window.webkitAudioContext)),"running"!==this.audioContext.state&&(yield this.audioContext.resume()),this.mediaStream=yield navigator.mediaDevices.getUserMedia({audio:{channelCount:1,noiseSuppression:!1,echoCancellation:!1}}),this.scriptProcessorNodeRecord(),this.isCollectingData=!0,this.setRecordState(0)}catch(t){null==(e=this.onError)||e.call(this,t)}})),k(this,"pause",()=>{0===this.state&&(this.isCollectingData=!1,this.setRecordState(1))}),k(this,"resume",()=>{1===this.state&&(this.isCollectingData=!0,this.setRecordState(0))}),k(this,"stop",()=>{var e,t,n,i,a,o,s,r;this.mediaStream&&(this.isCollectingData=!1,null==(n=null==(t=null==(e=this.mediaStream)?void 0:e.getTracks())?void 0:t.forEach)||n.call(t,e=>{e.stop()}),null==(a=null==(i=this.scriptNode)?void 0:i.disconnect)||a.call(i),null==(s=null==(o=this.mediaSourceNode)?void 0:o.disconnect)||s.call(o),this.mediaStream=null,this.mediaSourceNode=null,this.scriptNode=null,this.setRecordState(2),null==(r=this.onStop)||r.call(this))}),k(this,"destroy",()=>{this.stop(),this.audioContext&&"closed"!==this.audioContext.state&&this.audioContext.close().catch(e=>{})}),k(this,"analyzeAudio",e=>{if(!this.mediaSourceNode)return;const{frameLength:t=50}=e||{};if(this.frameLength=t,!this.mediaStream)return;const n=this.audioContext.createAnalyser();n.fftSize=512,this.mediaSourceNode.connect(n);const i=new Uint8Array(n.frequencyBinCount);this.calculateAudioFrame(n,i)}),k(this,"onRecorderStateChange",null),k(this,"onStop",null),k(this,"onError",null),k(this,"onAudioFrame",null),k(this,"onDataAvailable",null),!window.AudioContext&&window.webkitAudioContext,this.audioContext=new(window.AudioContext||window.webkitAudioContext)}scriptProcessorNodeRecord(){this.mediaStream&&(this.mediaSourceNode=this.audioContext.createMediaStreamSource(this.mediaStream),this.scriptNode=this.audioContext.createScriptProcessor(2048,1,1),this.scriptNode.onaudioprocess=e=>{var t;if(!this.isCollectingData)return;const n=z$(e.inputBuffer.getChannelData(0).slice(0),this.audioContext.sampleRate,16e3),i=new Int16Array(n.length);for(let a=0;a<n.length;++a)i[a]=32767*Math.max(-1,Math.min(1,n[a]));this.audioDataBuffers.push(e.inputBuffer.getChannelData(0).slice()),null==(t=this.onDataAvailable)||t.call(this,i.buffer)},this.mediaSourceNode.connect(this.scriptNode),this.scriptNode.connect(this.audioContext.destination))}calculateAudioFrame(e,t){var n;if(0!==this.state)return;e.getByteFrequencyData(t);const i=[...new Set(t.map(e=>e/2).sort((e,t)=>t-e))],a=i[Math.round(i.length/3)];this.frameData.push(a);const o=this.frameData.length-this.frameLength;o>0?this.frameData.splice(0,o):o<0&&this.frameData.unshift(...Array(-o).fill(0)),null==(n=this.onAudioFrame)||n.call(this,{data:this.frameData}),window.requestAnimationFrame(()=>{this.calculateAudioFrame(e,t)})}setRecordState(e){var t;this._state=e,null==(t=this.onRecorderStateChange)||t.call(this,e)}get state(){return this._state}getAudioFile(){if(this.audioDataBuffers.length){const e=(e=>{if(0===e.length)return;const t=e.reduce((e,t)=>e+t.length,0),n=new Float32Array(t);let i=0;for(let a=0;a<e.length;a++){const t=e[a];n.set(t,i),i+=t.length}return n})(this.audioDataBuffers);if(e){const t=((e,t,n=16,i=1)=>{const{length:a}=e,o=new ArrayBuffer(44+2*a),s=new DataView(o);$$(s,0,"RIFF"),s.setUint32(4,44+2*a,!0),$$(s,8,"WAVE"),$$(s,12,"fmt "),s.setUint32(16,16,!0),s.setUint16(20,1,!0),s.setUint16(22,i,!0),s.setUint32(24,t,!0),s.setUint32(28,t*i*(n/8),!0),s.setUint16(32,i*(n/8),!0),s.setUint16(34,n,!0),$$(s,36,"data"),s.setUint32(40,2*a,!0);let r=44;for(let l=0;l<a;l++)s.setInt16(r,32767*e[l],!0),r+=2;return o})(e,this.audioContext.sampleRate,16,1),n=new Blob([t],{type:"audio/wav"});return new File([n],"audio.wav",{type:"audio/wav"})}}}};k(B$,"isPermissionEnabled",()=>P(B$,null,function*(){var e;let t=!1;try{if(fx()&&window.QwenChat){const n=window.QwenChat,i=cx()?"RECORD_AUDIO":"MICROPHONE";if(null==n?void 0:n.requestPermissions){const a=yield n.requestPermissions({permissions:[i]});t="allow"===(null==(e=null==a?void 0:a.result)?void 0:e[i])}}else{const e=yield navigator.mediaDevices.getUserMedia({audio:!0});e&&(setTimeout(()=>{e.getTracks().forEach(e=>e.stop())}),t=!0)}}catch(n){}return t}));let q$=B$;const G$=({setRecording:e,visible:t=!0})=>{const n=G(),i=()=>P(void 0,null,function*(){(yield q$.isPermissionEnabled())?e(!0):AC.open({type:"error",content:n.t("Permission denied when accessing microphone")})});return t?tn.jsx("div",{className:"record-btn-container",children:tn.jsx(ft,{title:n.t("Record voice"),children:tn.jsx("button",{id:"voice-input-button",className:"record-btn",type:"button",onTouchStart:Sx()?i:void 0,onClick:Sx()?void 0:i,"aria-label":"Voice Input",children:tn.jsx(dt,{type:"icon-line-microphone-02",className:"microphone-icon"})})})}):null};var V$=function(e,t){return(V$=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function W$(e,t){function n(){this.constructor=e}V$(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var Q$=function(){return function(e,t){this.target=t,this.type=e}}(),K$=function(e){function t(t,n){var i=e.call(this,"error",n)||this;return i.message=t.message,i.error=t,i}return W$(t,e),t}(Q$),Y$=function(e){function t(t,n,i){void 0===t&&(t=1e3),void 0===n&&(n="");var a=e.call(this,"close",i)||this;return a.wasClean=!0,a.code=t,a.reason=n,a}return W$(t,e),t}(Q$),X$={maxReconnectionDelay:1e4,minReconnectionDelay:1e3+4e3*Math.random(),minUptime:5e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,maxEnqueuedMessages:1/0},J$=function(){function e(e,t,n){var i=this;void 0===n&&(n={}),this._listeners={error:[],message:[],open:[],close:[]},this._retryCount=-1,this._shouldReconnect=!0,this._connectLock=!1,this._binaryType="blob",this._closeCalled=!1,this._messageQueue=[],this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this._handleOpen=function(e){i._debug("open event");var t=i._options.minUptime,n=void 0===t?X$.minUptime:t;clearTimeout(i._connectTimeout),i._uptimeTimeout=setTimeout(function(){return i._acceptOpen()},n),i._ws.binaryType=i._binaryType,i._messageQueue.forEach(function(e){return i._ws.send(e)}),i._messageQueue=[],i.onopen&&i.onopen(e),i._listeners.open.forEach(function(t){return i._callEventListener(e,t)})},this._handleMessage=function(e){i._debug("message event"),i.onmessage&&i.onmessage(e),i._listeners.message.forEach(function(t){return i._callEventListener(e,t)})},this._handleError=function(e){i._debug("error event",e.message),i._disconnect(void 0,"TIMEOUT"===e.message?"timeout":void 0),i.onerror&&i.onerror(e),i._debug("exec error listeners"),i._listeners.error.forEach(function(t){return i._callEventListener(e,t)}),i._connect()},this._handleClose=function(e){i._debug("close event"),i._clearTimeouts(),i._shouldReconnect&&i._connect(),i.onclose&&i.onclose(e),i._listeners.close.forEach(function(t){return i._callEventListener(e,t)})},this._url=e,this._protocols=t,this._options=n,this._options.startClosed&&(this._shouldReconnect=!1),this._connect()}return Object.defineProperty(e,"CONNECTING",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OPEN",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CLOSING",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CLOSED",{get:function(){return 3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CONNECTING",{get:function(){return e.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OPEN",{get:function(){return e.OPEN},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CLOSING",{get:function(){return e.CLOSING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CLOSED",{get:function(){return e.CLOSED},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binaryType",{get:function(){return this._ws?this._ws.binaryType:this._binaryType},set:function(e){this._binaryType=e,this._ws&&(this._ws.binaryType=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"retryCount",{get:function(){return Math.max(this._retryCount,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferedAmount",{get:function(){return this._messageQueue.reduce(function(e,t){return"string"==typeof t?e+=t.length:t instanceof Blob?e+=t.size:e+=t.byteLength,e},0)+(this._ws?this._ws.bufferedAmount:0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extensions",{get:function(){return this._ws?this._ws.extensions:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"protocol",{get:function(){return this._ws?this._ws.protocol:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){return this._ws?this._ws.readyState:this._options.startClosed?e.CLOSED:e.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._ws?this._ws.url:""},enumerable:!0,configurable:!0}),e.prototype.close=function(e,t){void 0===e&&(e=1e3),this._closeCalled=!0,this._shouldReconnect=!1,this._clearTimeouts(),this._ws?this._ws.readyState!==this.CLOSED?this._ws.close(e,t):this._debug("close: already closed"):this._debug("close enqueued: no ws instance")},e.prototype.reconnect=function(e,t){this._shouldReconnect=!0,this._closeCalled=!1,this._retryCount=-1,this._ws&&this._ws.readyState!==this.CLOSED?(this._disconnect(e,t),this._connect()):this._connect()},e.prototype.send=function(e){if(this._ws&&this._ws.readyState===this.OPEN)this._debug("send",e),this._ws.send(e);else{var t=this._options.maxEnqueuedMessages,n=void 0===t?X$.maxEnqueuedMessages:t;this._messageQueue.length<n&&(this._debug("enqueue",e),this._messageQueue.push(e))}},e.prototype.addEventListener=function(e,t){this._listeners[e]&&this._listeners[e].push(t)},e.prototype.dispatchEvent=function(e){var t,n,i=this._listeners[e.type];if(i)try{for(var a=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}(i),o=a.next();!o.done;o=a.next()){var s=o.value;this._callEventListener(e,s)}}catch(r){t={error:r}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return!0},e.prototype.removeEventListener=function(e,t){this._listeners[e]&&(this._listeners[e]=this._listeners[e].filter(function(e){return e!==t}))},e.prototype._debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._options.debug},e.prototype._getNextDelay=function(){var e=this._options,t=e.reconnectionDelayGrowFactor,n=void 0===t?X$.reconnectionDelayGrowFactor:t,i=e.minReconnectionDelay,a=void 0===i?X$.minReconnectionDelay:i,o=e.maxReconnectionDelay,s=void 0===o?X$.maxReconnectionDelay:o,r=0;return this._retryCount>0&&(r=a*Math.pow(n,this._retryCount-1))>s&&(r=s),this._debug("next delay",r),r},e.prototype._wait=function(){var e=this;return new Promise(function(t){setTimeout(t,e._getNextDelay())})},e.prototype._getNextUrl=function(e){if("string"==typeof e)return Promise.resolve(e);if("function"==typeof e){var t=e();if("string"==typeof t)return Promise.resolve(t);if(t.then)return t}throw Error("Invalid URL")},e.prototype._connect=function(){var e=this;if(!this._connectLock&&this._shouldReconnect){this._connectLock=!0;var t=this._options,n=t.maxRetries,i=void 0===n?X$.maxRetries:n,a=t.connectionTimeout,o=void 0===a?X$.connectionTimeout:a,s=t.WebSocket,r=void 0===s?function(){if("undefined"!=typeof WebSocket)return WebSocket}():s;if(this._retryCount>=i)this._debug("max retries reached",this._retryCount,">=",i);else{if(this._retryCount++,this._debug("connect",this._retryCount),this._removeListeners(),void 0===(l=r)||!l||2!==l.CLOSING)throw Error("No valid WebSocket class provided");var l;this._wait().then(function(){return e._getNextUrl(e._url)}).then(function(t){e._closeCalled||(e._debug("connect",{url:t,protocols:e._protocols}),e._ws=e._protocols?new r(t,e._protocols):new r(t),e._ws.binaryType=e._binaryType,e._connectLock=!1,e._addListeners(),e._connectTimeout=setTimeout(function(){return e._handleTimeout()},o))})}}},e.prototype._handleTimeout=function(){this._debug("timeout event"),this._handleError(new K$(Error("TIMEOUT"),this))},e.prototype._disconnect=function(e,t){if(void 0===e&&(e=1e3),this._clearTimeouts(),this._ws){this._removeListeners();try{this._ws.close(e,t),this._handleClose(new Y$(e,t,this))}catch(n){}}},e.prototype._acceptOpen=function(){this._debug("accept open"),this._retryCount=0},e.prototype._callEventListener=function(e,t){"handleEvent"in t?t.handleEvent(e):t(e)},e.prototype._removeListeners=function(){this._ws&&(this._debug("removeListeners"),this._ws.removeEventListener("open",this._handleOpen),this._ws.removeEventListener("close",this._handleClose),this._ws.removeEventListener("message",this._handleMessage),this._ws.removeEventListener("error",this._handleError))},e.prototype._addListeners=function(){this._ws&&(this._debug("addListeners"),this._ws.addEventListener("open",this._handleOpen),this._ws.addEventListener("close",this._handleClose),this._ws.addEventListener("message",this._handleMessage),this._ws.addEventListener("error",this._handleError))},e.prototype._clearTimeouts=function(){clearTimeout(this._connectTimeout),clearTimeout(this._uptimeTimeout)},e}();const Z$={1003:[{reason:"request too fast",message:"Voice input has been used too frequently. Please try again later."}]};class eB{constructor(){k(this,"state","Stop"),k(this,"audioData",[]),k(this,"rws",null),k(this,"taskId",""),k(this,"asrResults",[]),k(this,"sentenceIndex",-1),k(this,"start",e=>{this.rws=new J$(e,"",{connectionTimeout:6e4,maxReconnectionDelay:3e3,minReconnectionDelay:1e3,maxRetries:10}),this.rws.onopen=()=>{if(!this.rws)return;this.taskId=ot().replaceAll("-",""),this.sentenceIndex=-1;const e=(e=>{const t={header:{message_id:ot().replaceAll("-",""),task_id:e,namespace:"SpeechTranscriber",name:"StartTranscription"},context:{},payload:{sample_rate:16e3,format:"pcm",enable_intermediate_result:!0,enable_inverse_text_normalization:!0,enable_punctuation_prediction:!0,language:Q.language}};return JSON.stringify(t)})(this.taskId);this.rws.send(e)},this.rws.onclose=e=>{var t,n,i,a;this.state="Stop";const{code:o,reason:s}=e,r=null==(t=Z$[o])?void 0:t.find(e=>e.reason===s),l=!!r||!1;if([1e3].includes(o)&&(null==e?void 0:e.isTrusted)||l)return null==(n=this.rws)||n.close(),this.rws=null,null==(i=this.onClose)||i.call(this),void(l&&(null==(a=this.onError)||a.call(this,new Error((null==r?void 0:r.message)||"")),this.state="Error"));this.state="Reconnecting"},this.rws.onerror=e=>{var t,n;"Started"===this.state&&(null==(t=this.rws)||t.close(),this.rws=null,null==(n=this.onError)||n.call(this,new Error(e.message)),this.state="Error")},this.rws.onmessage=e=>{var t,n;this.handleAsrData(JSON.parse(e.data))&&(null==(t=this.onEnd)||t.call(this),null==(n=this.rws)||n.close())}}),k(this,"stop",()=>{this.rws&&"Started"===this.state&&(this.rws.send((e=>{const t={header:{message_id:ot().replaceAll("-",""),task_id:e,namespace:"SpeechTranscriber",name:"StopTranscription"}};return JSON.stringify(t)})(this.taskId)),this.state="Stopping")}),k(this,"sendAudioData",e=>{"Started"===this.state&&this.rws?(this.audioData.forEach(e=>{var t;null==(t=this.rws)||t.send(e)}),this.audioData=[],this.rws.send(e)):this.audioData.push(e)}),k(this,"handleAsrData",e=>{var t,n,i,a,o;const{name:s=""}=(null==e?void 0:e.header)||{},{result:r=""}=(null==e?void 0:e.payload)||{};switch(s){case"TranscriptionStarted":this.state="Started";break;case"SentenceBegin":this.asrResults.push("");break;case"TranscriptionResultChanged":case"SentenceEnd":this.asrResults[this.asrResults.length-1]=r,null==(t=this.onMessage)||t.call(this,{result:this.asrResults.join("")});break;case"TranscriptionCompleted":this.state="Stop";break;case"TaskFailed":null==(n=this.onError)||n.call(this,new Error(s)),this.state="Error";break;case"TranscriptionResult":(null==(i=null==e?void 0:e.payload)?void 0:i.index)!==this.sentenceIndex&&(this.sentenceIndex=null==(a=null==e?void 0:e.payload)?void 0:a.index,this.asrResults.push("")),this.asrResults[this.asrResults.length-1]=r,null==(o=this.onMessage)||o.call(this,{result:this.asrResults.join("")})}return["TranscriptionCompleted","TaskFailed"].includes(s)}),k(this,"onError",null),k(this,"onEnd",null),k(this,"onClose",null),k(this,"onMessage",null)}}const tB=class e{constructor(){k(this,"speechRecognition",null),k(this,"start",()=>{if(!e.isSupport)return;this.speechRecognition.continuous=!0,this.speechRecognition.interimResults=!0;let t=!0;this.speechRecognition.onresult=e=>P(this,null,function*(){var n;const{results:i}=e,a=i[i.length-1],{transcript:o}=a[0],{isFinal:s}=a;null==(n=this.onMessage)||n.call(this,{result:o,begin:t}),t=s}),this.speechRecognition.onend=()=>{var e;null==(e=this.onEnd)||e.call(this)},this.speechRecognition.onerror=e=>{var t;null==(t=this.onError)||t.call(this,new Error(null==e?void 0:e.error))},this.speechRecognition.start()}),k(this,"stop",()=>{e.isSupport&&this.speechRecognition.stop()}),k(this,"onMessage",null),k(this,"onEnd",null),k(this,"onError",null),e.isSupport&&(this.speechRecognition=new(window.SpeechRecognition||window.webkitSpeechRecognition))}};k(tB,"isSupport","SpeechRecognition"in window||"webkitSpeechRecognition"in window);let nB=tB;class iB{constructor(){k(this,"currentTime",0),k(this,"intervalTimeout",null),k(this,"pausedElapsedTime",0),k(this,"isPaused",!1),k(this,"start",e=>{this.stop(),this.isPaused=!1,this.pausedElapsedTime=0;const t=e||0;this.currentTime=Date.now()-1e3*t,this.intervalTimeout=setInterval(()=>{var e;const t=Math.round((Date.now()-this.currentTime)/1e3);null==(e=this.onTimeChange)||e.call(this,{time:t,formatTime:this.format(t)})},1e3)}),k(this,"stop",()=>{this.intervalTimeout&&(clearInterval(this.intervalTimeout),this.intervalTimeout=null),this.isPaused=!1,this.pausedElapsedTime=0,this.currentTime=0}),k(this,"pause",()=>{!this.isPaused&&this.intervalTimeout&&(this.pausedElapsedTime=Math.round((Date.now()-this.currentTime)/1e3),this.intervalTimeout&&(clearInterval(this.intervalTimeout),this.intervalTimeout=null),this.isPaused=!0)}),k(this,"resume",()=>{this.isPaused&&this.start(this.pausedElapsedTime)}),k(this,"format",e=>(""+e%60).padStart(2,"0")),k(this,"onTimeChange",null)}}const aB=ox()?43:150,oB=new q$,sB=({className:e="",onUpdateRecording:t,onCallbackAsrResult:n})=>{const i=G(),a=tx(e=>e.mobile),[o,s]=O.useState(Array(aB).fill(0)),r=O.useRef(!1),l=O.useRef(new eB),c=O.useRef(new nB),u=O.useRef(oB),d=O.useRef(new iB),h=O.useCallback(()=>{d.current.stop(),l.current.stop(),c.current.stop(),u.current.stop()},[]),p=O.useCallback(()=>{h(),null==t||t(!1),null==n||n("")},[n,t,h]),m=O.useCallback(()=>{r.current=!0,h(),null==t||t(!1)},[t,h]),f=O.useCallback(()=>{u.current.onAudioFrame=({data:e})=>{s([...e])},u.current.start().then(()=>{d.current.onTimeChange=({time:e})=>{e>=60&&m()},d.current.start(),u.current.analyzeAudio({frameLength:aB})});const e=e=>{const{result:t}=e;null==n||n(t)},t=()=>{},a=e=>{const t=e.message?i.t(e.message):i.t("Network error");AC.open({type:"error",content:t}),p()};try{u.current.onDataAvailable=e=>{l.current.sendAudioData(e)},l.current.onMessage=e,l.current.onClose=t,l.current.onError=a;let n="wss://chat.qwen.ai";if("prod"!==qg){let e=location.hostname;"localhost"===e&&(e="pre-chat.qwen.ai"),n=`wss://${e}`}l.current.start(`${n}/api/v1/asr/wsgu_asr?token=${localStorage.token}`)}catch(o){AC.open({type:"error",content:(null==o?void 0:o.message)||i.t("Network error")}),p()}},[p,m,i,n]);return O.useEffect(()=>{f()},[]),a?tn.jsx("div",{className:`voice-recording-root ${e}`,children:tn.jsxs("div",{className:"controls-row",children:[tn.jsx("button",{type:"button",className:"button",onClick:p,children:tn.jsx(dt,{type:"icon-line-x-02"})}),tn.jsx("div",{className:"audio-bar",children:o.map(e=>tn.jsx("div",{className:"audio-bar-item",style:{height:`${Math.min(100,Math.max(12,e))}%`}},ot()))}),tn.jsx("button",{type:"button",className:"button button-confirm",onClick:m,children:tn.jsx(dt,{type:"icon-line-check-02"})})]})}):tn.jsx("div",{className:`pc-voice-recording ${e}`,children:tn.jsxs("div",{className:"pc-voice-recording-controls",children:[tn.jsx("button",{type:"button",className:"button-cancel",onClick:p,children:tn.jsx(dt,{type:"icon-line-x-02"})}),tn.jsx("div",{className:"audio-bar",children:o.map(e=>tn.jsx("div",{className:"audio-bar-item",style:{height:`${Math.min(100,Math.max(12,e))}%`}},ot()))}),tn.jsx("button",{type:"button",className:"button-confirm",onClick:m,children:tn.jsx(dt,{type:"icon-line-check-02"})})]})})},rB=(e,t,n,i,a)=>{const[o,s]=O.useState(!1);return O.useEffect(()=>{if("/"!==window.location.pathname||1!==(null==i?void 0:i.length))return;const o=((e,t,n,i,a)=>BE(e,t,n,i,a,3))(e,t,n,i,a);s(o)},[n,a,i,t,e]),o},lB=({projectId:e,inDetail:t=!1,scrollDownBtnVisible:n=!1,onScrollDown:i=()=>{},onScrollTop:a})=>{const{i18n:o}=G(),{id:s}=oy(),r=Zb(e=>e.selectedText),l=Zb(e=>e.setSelectedText),c=Wb(e=>e.setEmitSendPromptType),u=Zb(e=>e.selectedTextPosition),d=Zb(e=>e.selectedTextId),h=Zb(e=>e.selectedTextIndex),p=Zb(e=>e.setThinkingEnabled),m=tx(e=>e.mobile),f=tx(e=>e.config),g=Zb(e=>e.taskRunning),v=Zb(e=>e.visionGenerating),y=rT(e=>e.files),b=rT(e=>e.inputValue),x=Wb(e=>e.currentInputFeature),w=Wb(e=>e.currentInputSubType),S=Wb(e=>e.isStopDisabled),_=Wb(e=>e.history.messages),C=Wb(e=>e.history.currentId),E=aI(e=>e.selectedModels),{messageInputMode:k,featureSwitchList:I,isShowOmniButton:T,currentI18nRecommend:j,onUpdateSeparationNeeds:N}=WN({inDetail:t,chatId:s,projectId:e}),{isPlanning:M,isDeepResearchRounds:A,isDrAnswerPhase:R,prevDrDone:D}=(()=>{const e=Wb(e=>e.history),t=Zb(e=>e.taskRunning),n=Wb(e=>e.currentInputFeature),i=Wb(e=>e.currentInputSubType),a=Wb(e=>e.history.messages),o=Wb(e=>e.history.currentId),s=O.useMemo(()=>n===Zf.DeepResearch&&i===Zf.DeepResearch||n===Zf.DeepResearch&&i===Zf.INTERRUPT||n!==Zf.DeepResearch,[n,i]);return{isDeepResearchRounds:O.useMemo(()=>{var t,n;if(s&&o){const i=(null==(n=null==(t=e.messages[o])?void 0:t.content_list)?void 0:n[0])||"";return!i||!(!i||"answer"===i.phase)}return!1},[s,o,e.messages]),isPlanning:O.useMemo(()=>{const e=n===Zf.DeepResearch&&i===Zf.DeepResearch,a=n===Zf.DeepResearch&&i===Zf.INTERRUPT;return(e||a)&&t},[n,i,t]),isDrAnswerPhase:O.useMemo(()=>{var e,t;return!!(null==(t=null==(e=a[o||""])?void 0:e.content_list)?void 0:t.some(e=>"answer"===e.phase))},[o,a]),prevDrDone:O.useMemo(()=>{const e=VE(a,o||"");return(null==e?void 0:e.done)||!1},[o,a])}})(),{filesManager:L,uploadInfo:F,fileDragging:U,uploadHandler:z,handleCloseFileCard:H}=qN({featureSwitchList:I}),{sendingNotAllowed:$,sendButtonStatus:B,handleSend:q,resetInputHandler:V,onInputCallback:W}=(e=>{const{chatId:t,projectId:n,isDrAnswerPhase:i,prevDrDone:a,onScrollDown:o}=e,{i18n:s}=G(),r=tx(e=>e.mobile),l=rT(e=>e.setInputValue),c=rT(e=>e.messageType),u=rT(e=>e.files),d=rT(e=>e.inputValue),h=rT(e=>e.onPromptSend),p=rT(e=>e.setMobileRecommendDetailVisible),m=Wb(e=>e.setEmitSendPromptType),f=Wb(e=>e.currentInputFeature),g=Wb(e=>e.currentInputSubType),v=Zb(e=>e.taskRunning),y=Zb(e=>e.visionGenerating),b=Zb(e=>e.setWelcomeModalShow),x=tx(e=>e.isDisableGuestAccess),w=fT(e=>e.chatProjectId),S=fT(e=>e.setChatProjectId),_=Wb(e=>e.history.messages),C=Wb(e=>e.history.currentId),E=O.useMemo(()=>{var e;return!!(null==(e=_[C||""])?void 0:e.done)},[_,C]),k=O.useMemo(()=>{const e=""!==(null==d?void 0:d.trim())||!!u.length;switch(g){case Zf.INTERRUPT:return!e&&(v||y)||i&&!a?"stop":"send";case Zf.DeepResearch:return!e&&(v||y)||i&&!E?"stop":"send";default:return v||y?"stop":"send"}},[g,v,y,i,a,d,u.length,E]),I=O.useMemo(()=>g===Zf.INTERRUPT&&!E,[g,E]),T=O.useCallback(e=>P(void 0,null,function*(){if(m(Qf.CHAT),bT()&&x)b(!0);else{if((null==e?void 0:e.projectId)&&S(e.projectId),f===Zf.ImageGeneration){let t="";const n=(null==e?void 0:e.inputText)||rT.getState().inputValue||"",i=u.filter(e=>"image"===e.showType);if(""===n.trim()&&i.length&&(t=s.t("Please enter a prompt describing how you'd like to edit your image.")),t)return void ut.openOnce({type:"caution",content:t})}h(e)}}),[f,u,s,x,h,S,m,b]),j=O.useCallback((e,t)=>{switch(e){case"stop":oT.stopResponse();break;case"send":if(I||"stop"===k)return;if(C){const e=It(_),t=_[C];(null==t?void 0:t.isMultiResponse)&&t.parentId&&(_[t.parentId].childrenIds.forEach(t=>{e[t].isMultiResponse=!1}),oT.updateChatHistory({messages:e,currentId:C}))}oT.closeShowControls(),T({inputText:null!=t?t:d,projectId:n||w}),f===Zf.Travel&&r&&p(!1),setTimeout(()=>{null==o||o()},0)}},[T,w,C,f,d,_,r,n,k,o,I,p]),N=O.useCallback((e,n)=>{l(e),"send"===n&&(T({inputText:e}),qE("suggest",t,c))},[T,t,c,l]),M=O.useCallback(e=>{l(e),j("send",e)},[j,l]);return{sendingNotAllowed:I,sendButtonStatus:k,resetInputHandler:N,beforePromptSend:T,handleSend:j,onInputCallback:M}})({chatId:s,projectId:e,isDrAnswerPhase:R,prevDrDone:D,onScrollDown:i}),{recording:Q,onUpdateRecording:K,onCallbackAsrResult:Y}=(e=>{const{onUpdateSeparationNeeds:t=()=>{}}=e||{},[n,i]=O.useState(!1),a=rT(e=>e.setInputValue);return{recording:n,onUpdateRecording:O.useCallback(e=>{i(e),t({recording:e})},[t]),onCallbackAsrResult:O.useCallback(e=>{a(e)},[a])}})({onUpdateSeparationNeeds:N});GN({uploadInfo:F,featureSwitchList:I});const{renderTipsModels:X}=YT({filesManager:L}),Z=rB(Zf.Thinking,o.t("Thinking Btn"),f,E,y);O.useEffect(()=>{Z&&p(!0)},[Z]);const ee=O.useMemo(()=>Q?o.t("I'm listening"):M?o.t("Provide additional details..."):((e,t)=>{const n=Uf();switch(e){case Zf.Artifacts:return t===Zf.WebDev?n.t("Describe the web page you want to generate."):n.t("Describe the artifacts you want to generate.");case Zf.DeepResearch:return n.t("Describe the themes you want to research.");case Zf.ImageGeneration:return n.t("Describe the image you want to generate.");case Zf.VideoGeneration:return n.t("Describe the video you want to generate.");default:return n.t("How can I help you today?")}})(x,w),[x,w,o,M,Q]),te=O.useMemo(()=>tn.jsx("div",{className:"chat-message-input-fixed",style:n?void 0:{opacity:0,pointerEvents:"none"},children:tn.jsx("div",{className:"chat-message-input-fixed-container",id:"message-input-container",children:tn.jsx("div",{className:"scroll-down-button",onClick:n?i:a,children:tn.jsx(dt,{type:"icon-line-arrow-down",className:"scroll-down-button-icon "+(n?"":"up-button-icon")})})})}),[n,i,a]),ne=O.useCallback(()=>{const e={type:"ask",messageId:_[C||""].id||void 0,inputText:b,content:{text:r},extra:{meta:{position:u,quoteId:d,quoteIndex:h}}};c(Qf.ASK),oT.seleteOperation(e),l("")},[C,b,_,r,d,h,u,c,l]),ie=O.useMemo(()=>{const e=_[C||""];return[Zf.ImageGeneration,Zf.VideoGeneration].includes(null==e?void 0:e.chat_type)||S||v},[C,S,_,v]),ae=O.useMemo(()=>{if(T&&!g&&!v)return tn.jsx(iP,{});const e=(""===b||""===(null==b?void 0:b.trim()))&&!y.length,t=g||v?ie:e;return tn.jsx(JH,{buttonDisabled:t||$,status:B,onClick:r?ne:q,disabledStatusCallbackEnabled:x===Zf.ImageEdit?["send"]:[]})},[T,g,v,b,y.length,x,ie,$,B,r,ne,q]),oe=O.useMemo(()=>Q?null:tn.jsxs("div",{className:"message-input-right-button",children:[m?tn.jsx(G$,{setRecording:K,visible:m&&!b&&!bT()}):tn.jsxs(tn.Fragment,{children:[tn.jsx(nP,{}),tn.jsx(G$,{setRecording:K,visible:!b&&!bT()})]}),tn.jsx("div",{className:"message-input-right-button-send",children:ae})]}),[Q,m,K,b,ae]),se=O.useMemo(()=>Q?null:tn.jsx(JN,{messageInputMode:k,uploadInfo:F,isPlanning:!!M,uploadHandler:z,onUpdateSeparationNeeds:N,onInputCallback:W}),[Q,k,F,M,z,N,W]),re=O.useMemo(()=>{if(x===Zf.Txt2Txt&&!t&&!e)return tn.jsx(s$,{currentI18nRecommend:j||{},onChange:e=>{V(e.inputText,"send")}})},[x,j,t,e,V]),le=O.useMemo(()=>tn.jsxs(tn.Fragment,{children:[tn.jsx(R$,{}),!!y.length&&tn.jsx("div",{className:"message-input-column-file",children:tn.jsx(n$,{role:"user",files:y,onClose:H,onReUpload:e=>P(void 0,null,function*(){var t,n,i;const a=y[e];a&&"failed"===(null==(i=null==(n=null==(t=a.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)?L.startParse(a,!0):a&&(a.uploadTaskId?yield dE.resumeUpload(a.uploadTaskId):L.retryFile(a))})})})]}),[y,L,r,H,k]),ce=O.useMemo(()=>tn.jsxs("div",{className:"message-input-container-area",children:["combination"===k&&se,tn.jsx(ZH,{inDetail:t,chatId:s,filesManager:L,handleSend:r?ne:q,messageInputMode:k,onUpdateSeparationNeeds:N,isDeepResearchRounds:A,placeHolder:ee}),"combination"===k&&oe]}),[k,se,t,s,L,r,ne,q,N,A,ee,oe]),{containerRef:ue,contentRef:de}=(e=>{const{upadteDependences:t=[]}=e,n=O.useRef(null),i=O.useRef(null);return O.useEffect(()=>{if(n.current&&i.current){const e=i.current.scrollHeight;n.current.style.height=`${e}px`}},[...t]),{containerRef:n,contentRef:i}})({upadteDependences:[k,b,re,le]}),he=O.useMemo(()=>m?null:tn.jsx("div",{ref:ue,className:"message-input-container",children:tn.jsxs("div",{ref:de,children:[le,ce,"separation"===k?tn.jsxs("div",{className:"message-input-column-footer",children:[se,oe,Q&&tn.jsx(sB,{onUpdateRecording:K,onCallbackAsrResult:Y})]}):re]})}),[m,Q,ue,de,le,ce,k,se,oe,K,Y,re]),pe=O.useMemo(()=>m?tn.jsx("div",{ref:ue,className:J("message-input-container",{"message-input-container-separation":"separation"===k||y.length}),children:tn.jsxs("div",{ref:de,children:[le,ce,"separation"===k?tn.jsx("div",{className:"message-input-column-footer",children:Q?tn.jsx(sB,{onUpdateRecording:K,onCallbackAsrResult:Y}):tn.jsxs(tn.Fragment,{children:[se,oe]})}):null]})}):null,[ue,de,y.length,k,m,Y,K,Q,ce,le,se,oe]),me=O.useMemo(()=>t||e||jt(j)?null:tn.jsx(M$,{currentI18nRecommend:j,resetInputHandler:V}),[j,t,e,V]),fe=O.useMemo(()=>!m&&!t&&!e,[m,t,e]);return tn.jsx("div",{className:J({"message-input":fe}),children:tn.jsxs("div",{className:J("message-input-wrapper",{"message-input-wrapper-expand":"separation"===k,"message-input-wrapper-position":fe}),children:[te,m&&me,he,pe,!m&&tn.jsx(o$,{textLength:(null==b?void 0:b.length)||0}),!m&&me,m&&tn.jsx(A$,{}),X,tn.jsx(a$,{show:U})]})})},cB=()=>{const e=mx(),t=bx(),n="mobile"===ux(),i=Zb(e=>e.temporaryChatEnabled),a=tx(e=>e.mobile),o=Zb(e=>e.setTaskRunning),s=Zb(e=>e.setVisionGenerating),r=rT(e=>e.setShowDetail),l=xE(e=>e.user),{i18n:c}=G(),u=O.useCallback(()=>{o(!1),s(!1),r(!1),oT.createChat(),oT.initSelectedModels()},[r,o,s]);O.useEffect(()=>{u()},[u]),O.useEffect(()=>{const e=new URLSearchParams(window.location.search).get("shareId");Wb.getState().history.currentId&&!e&&(oT.resetChatState(),oT.closeShowControls())},[]);const d=O.useMemo(()=>((e,t=!1)=>{const n=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][(new Date).getDay()],i=q(),a=[()=>i.t("Whats on your mind today?"),()=>i.t("What can I do for you?"),()=>i.t("Whats on the agenda today?"),()=>i.t("Ready when you are."),()=>i.t("What are you working on?"),()=>i.t("Where should we begin?"),e=>e&&!t?i.t("How can I help, {{name}}?",{name:e}):i.t("How can I help?"),()=>i.t("Ready to get started?"),()=>i.t("How can I help you right now?"),()=>i.t("What can I help you with today?"),e=>e&&!t?i.t("Let's get started, {{name}}.",{name:e}):i.t("Let's get started."),()=>i.t("What's the plan for today?"),()=>i.t("What brings you here today?"),()=>i.t("Where do you want to start?"),()=>i.t("Ready to create something?"),()=>i.t("Ready when you are."),e=>e&&!t?i.t("Where to begin, {{name}}?",{name:e}):i.t("Where to begin?"),()=>i.t("What would you like to explore?"),e=>e&&!t?i.t("What's your focus today, {{name}}?",{name:e}):i.t("What's your focus today."),e=>e&&!t?i.t("What do you want to know, {{name}}?",{name:e}):i.t("What do you want to know.")];return(0,a[Math.floor(Math.random()*a.length)])(e,n)})(null==l?void 0:l.name,a),[null==l?void 0:l.name,a]);return t?tn.jsx("div",{className:"main-layout native-layout",children:tn.jsx("div",{className:"placeholder-container",id:"dropzone-container",children:tn.jsx("div",{className:"placeholder-text-container",children:tn.jsx(RN,{greetingText:d})})})}):tn.jsxs("div",{className:"home-page-layout-main "+(i&&!a?"home-page-layout-main-temporary":""),children:[e?tn.jsx(IN,{}):null,tn.jsx("main",{className:"main-content",children:tn.jsxs("div",{className:"placeholder-container",id:"dropzone-container",children:[tn.jsx("div",{className:"placeholder-text-container",children:tn.jsx(RN,{greetingText:d})}),tn.jsx(lB,{})]})}),n?null:tn.jsx(A$,{})]})},uB=O.createContext(null);uB.displayName="PanelGroupContext";const dB="data-panel-group",hB="data-panel-group-direction",pB="data-panel-group-id",mB="data-panel",fB="data-panel-collapsible",gB="data-panel-id",vB="data-panel-size",yB="data-panel-resize-handle-id",bB=O.useLayoutEffect,xB=z["useId".toString()],wB="function"==typeof xB?xB:()=>null;let SB=0;function _B(e=null){const t=wB(),n=O.useRef(e||t||null);return null===n.current&&(n.current=""+SB++),null!=e?e:n.current}function CB(e){var t=e,{children:n,className:i="",collapsedSize:a,collapsible:o,defaultSize:s,forwardedRef:r,id:l,maxSize:c,minSize:u,onCollapse:d,onExpand:h,onResize:p,order:m,style:f,tagName:g="div"}=t,v=E(t,["children","className","collapsedSize","collapsible","defaultSize","forwardedRef","id","maxSize","minSize","onCollapse","onExpand","onResize","order","style","tagName"]);const y=O.useContext(uB);if(null===y)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:b,expandPanel:x,getPanelSize:w,getPanelStyle:S,groupId:k,isPanelCollapsed:I,reevaluatePanelConstraints:T,registerPanel:j,resizePanel:N,unregisterPanel:P}=y,M=_B(l),A=O.useRef({callbacks:{onCollapse:d,onExpand:h,onResize:p},constraints:{collapsedSize:a,collapsible:o,defaultSize:s,maxSize:c,minSize:u},id:M,idIsFromProps:void 0!==l,order:m});O.useRef({didLogMissingDefaultSizeWarning:!1}),bB(()=>{const{callbacks:e,constraints:t}=A.current,n=_({},t);A.current.id=M,A.current.idIsFromProps=void 0!==l,A.current.order=m,e.onCollapse=d,e.onExpand=h,e.onResize=p,t.collapsedSize=a,t.collapsible=o,t.defaultSize=s,t.maxSize=c,t.minSize=u,n.collapsedSize===t.collapsedSize&&n.collapsible===t.collapsible&&n.maxSize===t.maxSize&&n.minSize===t.minSize||T(A.current,n)}),bB(()=>{const e=A.current;return j(e),()=>{P(e)}},[m,M,j,P]),O.useImperativeHandle(r,()=>({collapse:()=>{b(A.current)},expand:e=>{x(A.current,e)},getId:()=>M,getSize:()=>w(A.current),isCollapsed:()=>I(A.current),isExpanded:()=>!I(A.current),resize:e=>{N(A.current,e)}}),[b,x,w,I,M,N]);const R=S(A.current,s);return O.createElement(g,C(_({},v),{children:n,className:i,id:M,style:_(_({},R),f),[pB]:k,[mB]:"",[fB]:o||void 0,[gB]:M,[vB]:parseFloat(""+R.flexGrow).toFixed(1)}))}const EB=O.forwardRef((e,t)=>O.createElement(CB,C(_({},e),{forwardedRef:t})));function kB(e){return"keydown"===e.type}function IB(e){return e.type.startsWith("pointer")}function TB(e){return e.type.startsWith("mouse")}CB.displayName="Panel",EB.displayName="forwardRef(Panel)";!function(){if("function"==typeof matchMedia)matchMedia("(pointer:coarse)").matches}();let jB=new Map;function NB(e,t){jB.set(e,t)}function PB(e,t){if(!e)throw Error(t)}function MB(e,t,n=10){return e.toFixed(n)===t.toFixed(n)?0:e>t?1:-1}function AB(e,t,n=10){return 0===MB(e,t,n)}function RB(e,t,n){return 0===MB(e,t,n)}function OB({panelConstraints:e,panelIndex:t,size:n}){const i=e[t];PB(null!=i,`Panel constraints not found for index ${t}`);let{collapsedSize:a=0,collapsible:o,maxSize:s=100,minSize:r=0}=i;if(MB(n,r)<0)if(o){n=MB(n,(a+r)/2)<0?a:r}else n=r;return n=Math.min(s,n),n=parseFloat(n.toFixed(10))}function DB({delta:e,initialLayout:t,panelConstraints:n,pivotIndices:i,prevLayout:a,trigger:o}){if(RB(e,0))return t;const s=[...t],[r,l]=i;PB(null!=r,"Invalid first pivot index"),PB(null!=l,"Invalid second pivot index");let c=0;if("keyboard"===o){{const i=e<0?l:r,a=n[i];PB(a,`Panel constraints not found for index ${i}`);const{collapsedSize:o=0,collapsible:s,minSize:c=0}=a;if(s){const n=t[i];if(PB(null!=n,`Previous layout not found for panel index ${i}`),RB(n,o)){const t=c-n;MB(t,Math.abs(e))>0&&(e=e<0?0-t:t)}}}{const i=e<0?r:l,a=n[i];PB(a,`No panel constraints found for index ${i}`);const{collapsedSize:o=0,collapsible:s,minSize:c=0}=a;if(s){const n=t[i];if(PB(null!=n,`Previous layout not found for panel index ${i}`),RB(n,c)){const t=n-o;MB(t,Math.abs(e))>0&&(e=e<0?0-t:t)}}}}{const i=e<0?1:-1;let a=e<0?l:r,o=0;for(;;){const e=t[a];PB(null!=e,`Previous layout not found for panel index ${a}`);if(o+=OB({panelConstraints:n,panelIndex:a,size:100})-e,a+=i,a<0||a>=n.length)break}const s=Math.min(Math.abs(e),Math.abs(o));e=e<0?0-s:s}{let i=e<0?r:l;for(;i>=0&&i<n.length;){const a=Math.abs(e)-Math.abs(c),o=t[i];PB(null!=o,`Previous layout not found for panel index ${i}`);const r=OB({panelConstraints:n,panelIndex:i,size:o-a});if(!RB(o,r)&&(c+=o-r,s[i]=r,c.toFixed(3).localeCompare(Math.abs(e).toFixed(3),void 0,{numeric:!0})>=0))break;e<0?i--:i++}}if(function(e,t,n){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!RB(e[i],t[i],n))return!1;return!0}(a,s))return a;{const i=e<0?l:r,a=t[i];PB(null!=a,`Previous layout not found for panel index ${i}`);const o=a+c,u=OB({panelConstraints:n,panelIndex:i,size:o});if(s[i]=u,!RB(u,o)){let t=o-u;let i=e<0?l:r;for(;i>=0&&i<n.length;){const a=s[i];PB(null!=a,`Previous layout not found for panel index ${i}`);const o=OB({panelConstraints:n,panelIndex:i,size:a+t});if(RB(a,o)||(t-=o-a,s[i]=o),RB(t,0))break;e>0?i--:i++}}}return RB(s.reduce((e,t)=>t+e,0),100)?s:a}function LB({layout:e,panelsArray:t,pivotIndices:n}){let i=0,a=100,o=0,s=0;const r=n[0];PB(null!=r,"No pivot index found"),t.forEach((e,t)=>{const{constraints:n}=e,{maxSize:l=100,minSize:c=0}=n;t===r?(i=c,a=l):(o+=c,s+=l)});return{valueMax:Math.min(a,100-o),valueMin:Math.max(i,100-s),valueNow:e[r]}}function FB(e,t=document){return Array.from(t.querySelectorAll(`[${yB}][data-panel-group-id="${e}"]`))}function UB(e,t,n){const i=function(e,t,n=document){const i=FB(e,n).findIndex(e=>e.getAttribute(yB)===t);return null!=i?i:null}(e,t,n);return null!=i?[i,i+1]:[-1,-1]}function zB(e,t=document){if(((n=t)instanceof HTMLElement||"object"==typeof n&&null!==n&&"tagName"in n&&"getAttribute"in n)&&t.dataset.panelGroupId==e)return t;var n;const i=t.querySelector(`[data-panel-group][data-panel-group-id="${e}"]`);return i||null}function HB(e,t=document){const n=t.querySelector(`[${yB}="${e}"]`);return n||null}function $B({committedValuesRef:e,eagerValuesRef:t,groupId:n,layout:i,panelDataArray:a,panelGroupElement:o,setLayout:s}){O.useRef({didWarnAboutMissingResizeHandle:!1}),bB(()=>{if(!o)return;const e=FB(n,o);for(let t=0;t<a.length-1;t++){const{valueMax:n,valueMin:o,valueNow:s}=LB({layout:i,panelsArray:a,pivotIndices:[t,t+1]}),r=e[t];if(null==r);else{const e=a[t];PB(e,`No panel data found for index "${t}"`),r.setAttribute("aria-controls",e.id),r.setAttribute("aria-valuemax",""+Math.round(n)),r.setAttribute("aria-valuemin",""+Math.round(o)),r.setAttribute("aria-valuenow",null!=s?""+Math.round(s):"")}}return()=>{e.forEach((e,t)=>{e.removeAttribute("aria-controls"),e.removeAttribute("aria-valuemax"),e.removeAttribute("aria-valuemin"),e.removeAttribute("aria-valuenow")})}},[n,i,a,o]),O.useEffect(()=>{if(!o)return;const e=t.current;PB(e,"Eager values not found");const{panelDataArray:a}=e;PB(null!=zB(n,o),`No group found for id "${n}"`);const r=FB(n,o);PB(r,`No resize handles found for group id "${n}"`);const l=r.map(e=>{const t=e.getAttribute(yB);PB(t,"Resize handle element has no handle id attribute");const[r,l]=function(e,t,n,i=document){var a,o,s,r;const l=HB(t,i),c=FB(e,i),u=l?c.indexOf(l):-1;return[null!==(a=null===(o=n[u])||void 0===o?void 0:o.id)&&void 0!==a?a:null,null!==(s=null===(r=n[u+1])||void 0===r?void 0:r.id)&&void 0!==s?s:null]}(n,t,a,o);if(null==r||null==l)return()=>{};const c=e=>{if(!e.defaultPrevented)switch(e.key){case"Enter":{e.preventDefault();const l=a.findIndex(e=>e.id===r);if(l>=0){const e=a[l];PB(e,`No panel data found for index ${l}`);const r=i[l],{collapsedSize:c=0,collapsible:u,minSize:d=0}=e.constraints;if(null!=r&&u){const e=DB({delta:RB(r,c)?d-c:c-r,initialLayout:i,panelConstraints:a.map(e=>e.constraints),pivotIndices:UB(n,t,o),prevLayout:i,trigger:"keyboard"});i!==e&&s(e)}}break}}};return e.addEventListener("keydown",c),()=>{e.removeEventListener("keydown",c)}});return()=>{l.forEach(e=>e())}},[o,e,t,n,i,a,s])}function BB(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function qB(e,t){const n="horizontal"===e,{x:i,y:a}=function(e){if(IB(e)){if(e.isPrimary)return{x:e.clientX,y:e.clientY}}else if(TB(e))return{x:e.clientX,y:e.clientY};return{x:1/0,y:1/0}}(t);return n?i:a}function GB(e,t,n,i,a,o){if(kB(e)){const t="horizontal"===n;let i=0;i=e.shiftKey?100:null!=a?a:10;let o=0;switch(e.key){case"ArrowDown":o=t?0:i;break;case"ArrowLeft":o=t?-i:0;break;case"ArrowRight":o=t?i:0;break;case"ArrowUp":o=t?0:-i;break;case"End":o=100;break;case"Home":o=-100}return o}return null==i?0:function(e,t,n,i,a){const o="horizontal"===n,s=HB(t,a);PB(s,`No resize handle element found for id "${t}"`);const r=s.getAttribute(pB);PB(r,"Resize handle element has no group id attribute");let{initialCursorPosition:l}=i;const c=qB(n,e),u=zB(r,a);PB(u,`No group element found for id "${r}"`);const d=u.getBoundingClientRect();return(c-l)/(o?d.width:d.height)*100}(e,t,n,i,o)}function VB(e,t,n){t.forEach((t,i)=>{const a=e[i];PB(a,`Panel data not found for index ${i}`);const{callbacks:o,constraints:s,id:r}=a,{collapsedSize:l=0,collapsible:c}=s,u=n[r];if(null==u||t!==u){n[r]=t;const{onCollapse:e,onExpand:i,onResize:a}=o;a&&a(t,u),c&&(e||i)&&(!i||null!=u&&!AB(u,l)||AB(t,l)||i(),!e||null!=u&&AB(u,l)||!AB(t,l)||e())}})}function WB(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function QB(e){try{if("undefined"==typeof localStorage)throw new Error("localStorage not supported in this environment");e.getItem=e=>localStorage.getItem(e),e.setItem=(e,t)=>{localStorage.setItem(e,t)}}catch(t){e.getItem=()=>null,e.setItem=()=>{}}}function KB(e){return`react-resizable-panels:${e}`}function YB(e){return e.map(e=>{const{constraints:t,id:n,idIsFromProps:i,order:a}=e;return i?n:a?`${a}:${JSON.stringify(t)}`:JSON.stringify(t)}).sort((e,t)=>e.localeCompare(t)).join(",")}function XB(e,t){try{const n=KB(e),i=t.getItem(n);if(i){const e=JSON.parse(i);if("object"==typeof e&&null!=e)return e}}catch(n){}return null}function JB(e,t,n,i,a){var o;const s=KB(e),r=YB(t),l=null!==(o=XB(e,a))&&void 0!==o?o:{};l[r]={expandToSizes:Object.fromEntries(n.entries()),layout:i};try{a.setItem(s,JSON.stringify(l))}catch(c){}}function ZB({layout:e,panelConstraints:t}){const n=[...e],i=n.reduce((e,t)=>e+t,0);if(n.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${n.map(e=>`${e}%`).join(", ")}`);if(!RB(i,100)&&n.length>0)for(let o=0;o<t.length;o++){const e=n[o];PB(null!=e,`No layout data found for index ${o}`);const t=100/i*e;n[o]=t}let a=0;for(let o=0;o<t.length;o++){const e=n[o];PB(null!=e,`No layout data found for index ${o}`);const i=OB({panelConstraints:t,panelIndex:o,size:e});e!=i&&(a+=e-i,n[o]=i)}if(!RB(a,0))for(let o=0;o<t.length;o++){const e=n[o];PB(null!=e,`No layout data found for index ${o}`);const i=OB({panelConstraints:t,panelIndex:o,size:e+a});if(e!==i&&(a-=i-e,n[o]=i,RB(a,0)))break}return n}const eq={getItem:e=>(QB(eq),eq.getItem(e)),setItem:(e,t)=>{QB(eq),eq.setItem(e,t)}},tq={};function nq(e){var t=e,{autoSaveId:n=null,children:i,className:a="",direction:o,forwardedRef:s,id:r=null,onLayout:l=null,keyboardResizeBy:c=null,storage:u=eq,style:d,tagName:h="div"}=t,p=E(t,["autoSaveId","children","className","direction","forwardedRef","id","onLayout","keyboardResizeBy","storage","style","tagName"]);const m=_B(r),f=O.useRef(null),[g,v]=O.useState(null),[y,b]=O.useState([]),x=function(){const[e,t]=O.useState(0);return O.useCallback(()=>t(e=>e+1),[])}(),w=O.useRef({}),S=O.useRef(new Map),k=O.useRef(0),I=O.useRef({autoSaveId:n,direction:o,dragState:g,id:m,keyboardResizeBy:c,onLayout:l,storage:u}),T=O.useRef({layout:y,panelDataArray:[],panelDataArrayChanged:!1});O.useRef({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),O.useImperativeHandle(s,()=>({getId:()=>I.current.id,getLayout:()=>{const{layout:e}=T.current;return e},setLayout:e=>{const{onLayout:t}=I.current,{layout:n,panelDataArray:i}=T.current,a=ZB({layout:e,panelConstraints:i.map(e=>e.constraints)});BB(n,a)||(b(a),T.current.layout=a,t&&t(a),VB(i,a,w.current))}}),[]),bB(()=>{I.current.autoSaveId=n,I.current.direction=o,I.current.dragState=g,I.current.id=m,I.current.onLayout=l,I.current.storage=u}),$B({committedValuesRef:I,eagerValuesRef:T,groupId:m,layout:y,panelDataArray:T.current.panelDataArray,setLayout:b,panelGroupElement:f.current}),O.useEffect(()=>{const{panelDataArray:e}=T.current;if(n){if(0===y.length||y.length!==e.length)return;let t=tq[n];null==t&&(t=function(e,t=10){let n=null;return(...i)=>{null!==n&&clearTimeout(n),n=setTimeout(()=>{e(...i)},t)}}(JB,100),tq[n]=t);const i=[...e],a=new Map(S.current);t(n,i,a,y,u)}},[n,y,u]),O.useEffect(()=>{});const j=O.useCallback(e=>{const{onLayout:t}=I.current,{layout:n,panelDataArray:i}=T.current;if(e.constraints.collapsible){const a=i.map(e=>e.constraints),{collapsedSize:o=0,panelSize:s,pivotIndices:r}=oq(i,e,n);if(PB(null!=s,`Panel size not found for panel "${e.id}"`),!AB(s,o)){S.current.set(e.id,s);const l=DB({delta:aq(i,e)===i.length-1?s-o:o-s,initialLayout:n,panelConstraints:a,pivotIndices:r,prevLayout:n,trigger:"imperative-api"});WB(n,l)||(b(l),T.current.layout=l,t&&t(l),VB(i,l,w.current))}}},[]),N=O.useCallback((e,t)=>{const{onLayout:n}=I.current,{layout:i,panelDataArray:a}=T.current;if(e.constraints.collapsible){const o=a.map(e=>e.constraints),{collapsedSize:s=0,panelSize:r=0,minSize:l=0,pivotIndices:c}=oq(a,e,i),u=null!=t?t:l;if(AB(r,s)){const t=S.current.get(e.id),s=null!=t&&t>=u?t:u,l=DB({delta:aq(a,e)===a.length-1?r-s:s-r,initialLayout:i,panelConstraints:o,pivotIndices:c,prevLayout:i,trigger:"imperative-api"});WB(i,l)||(b(l),T.current.layout=l,n&&n(l),VB(a,l,w.current))}}},[]),P=O.useCallback(e=>{const{layout:t,panelDataArray:n}=T.current,{panelSize:i}=oq(n,e,t);return PB(null!=i,`Panel size not found for panel "${e.id}"`),i},[]),M=O.useCallback((e,t)=>{const{panelDataArray:n}=T.current,i=aq(n,e);return function({defaultSize:e,dragState:t,layout:n,panelData:i,panelIndex:a,precision:o=3}){const s=n[a];let r;return r=null==s?null!=e?e.toFixed(o):"1":1===i.length?"1":s.toFixed(o),{flexBasis:0,flexGrow:r,flexShrink:1,overflow:"hidden",pointerEvents:null!==t?"none":void 0}}({defaultSize:t,dragState:g,layout:y,panelData:n,panelIndex:i})},[g,y]),A=O.useCallback(e=>{const{layout:t,panelDataArray:n}=T.current,{collapsedSize:i=0,collapsible:a,panelSize:o}=oq(n,e,t);return PB(null!=o,`Panel size not found for panel "${e.id}"`),!0===a&&AB(o,i)},[]),R=O.useCallback(e=>{const{layout:t,panelDataArray:n}=T.current,{collapsedSize:i=0,collapsible:a,panelSize:o}=oq(n,e,t);return PB(null!=o,`Panel size not found for panel "${e.id}"`),!a||MB(o,i)>0},[]),D=O.useCallback(e=>{const{panelDataArray:t}=T.current;t.push(e),t.sort((e,t)=>{const n=e.order,i=t.order;return null==n&&null==i?0:null==n?-1:null==i?1:n-i}),T.current.panelDataArrayChanged=!0,x()},[x]);bB(()=>{if(T.current.panelDataArrayChanged){T.current.panelDataArrayChanged=!1;const{autoSaveId:e,onLayout:t,storage:n}=I.current,{layout:i,panelDataArray:a}=T.current;let o=null;if(e){const t=function(e,t,n){var i,a;return null!==(a=(null!==(i=XB(e,n))&&void 0!==i?i:{})[YB(t)])&&void 0!==a?a:null}(e,a,n);t&&(S.current=new Map(Object.entries(t.expandToSizes)),o=t.layout)}null==o&&(o=function({panelDataArray:e}){const t=Array(e.length),n=e.map(e=>e.constraints);let i=0,a=100;for(let o=0;o<e.length;o++){const e=n[o];PB(e,`Panel constraints not found for index ${o}`);const{defaultSize:s}=e;null!=s&&(i++,t[o]=s,a-=s)}for(let o=0;o<e.length;o++){const s=n[o];PB(s,`Panel constraints not found for index ${o}`);const{defaultSize:r}=s;if(null!=r)continue;const l=a/(e.length-i);i++,t[o]=l,a-=l}return t}({panelDataArray:a}));const s=ZB({layout:o,panelConstraints:a.map(e=>e.constraints)});BB(i,s)||(b(s),T.current.layout=s,t&&t(s),VB(a,s,w.current))}}),bB(()=>{const e=T.current;return()=>{e.layout=[]}},[]);const L=O.useCallback(e=>{let t=!1;const n=f.current;if(n){"rtl"===window.getComputedStyle(n,null).getPropertyValue("direction")&&(t=!0)}return function(n){n.preventDefault();const i=f.current;if(!i)return()=>null;const{direction:a,dragState:o,id:s,keyboardResizeBy:r,onLayout:l}=I.current,{layout:c,panelDataArray:u}=T.current,{initialLayout:d}=null!=o?o:{},h=UB(s,e,i);let p=GB(n,e,a,o,r,i);const m="horizontal"===a;m&&t&&(p=-p);const g=DB({delta:p,initialLayout:null!=d?d:c,panelConstraints:u.map(e=>e.constraints),pivotIndices:h,prevLayout:c,trigger:kB(n)?"keyboard":"mouse-or-touch"}),v=!WB(c,g);(IB(n)||TB(n))&&k.current!=p&&(k.current=p,NB(e,v||0===p?0:m?p<0?1:2:p<0?4:8)),v&&(b(g),T.current.layout=g,l&&l(g),VB(u,g,w.current))}},[]),F=O.useCallback((e,t)=>{const{onLayout:n}=I.current,{layout:i,panelDataArray:a}=T.current,o=a.map(e=>e.constraints),{panelSize:s,pivotIndices:r}=oq(a,e,i);PB(null!=s,`Panel size not found for panel "${e.id}"`);const l=DB({delta:aq(a,e)===a.length-1?s-t:t-s,initialLayout:i,panelConstraints:o,pivotIndices:r,prevLayout:i,trigger:"imperative-api"});WB(i,l)||(b(l),T.current.layout=l,n&&n(l),VB(a,l,w.current))},[]),U=O.useCallback((e,t)=>{const{layout:n,panelDataArray:i}=T.current,{collapsedSize:a=0,collapsible:o}=t,{collapsedSize:s=0,collapsible:r,maxSize:l=100,minSize:c=0}=e.constraints,{panelSize:u}=oq(i,e,n);null!=u&&(o&&r&&AB(u,a)?AB(a,s)||F(e,s):u<c?F(e,c):u>l&&F(e,l))},[F]),z=O.useCallback((e,t)=>{const{direction:n}=I.current,{layout:i}=T.current;if(!f.current)return;const a=HB(e,f.current);PB(a,`Drag handle element not found for id "${e}"`);const o=qB(n,t);v({dragHandleId:e,dragHandleRect:a.getBoundingClientRect(),initialCursorPosition:o,initialLayout:i})},[]),H=O.useCallback(()=>{v(null)},[]),$=O.useCallback(e=>{const{panelDataArray:t}=T.current,n=aq(t,e);n>=0&&(t.splice(n,1),delete w.current[e.id],T.current.panelDataArrayChanged=!0,x())},[x]),B=O.useMemo(()=>({collapsePanel:j,direction:o,dragState:g,expandPanel:N,getPanelSize:P,getPanelStyle:M,groupId:m,isPanelCollapsed:A,isPanelExpanded:R,reevaluatePanelConstraints:U,registerPanel:D,registerResizeHandle:L,resizePanel:F,startDragging:z,stopDragging:H,unregisterPanel:$,panelGroupElement:f.current}),[j,g,o,N,P,M,m,A,R,U,D,L,F,z,H,$]),q={display:"flex",flexDirection:"horizontal"===o?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return O.createElement(uB.Provider,{value:B},O.createElement(h,C(_({},p),{children:i,className:a,id:r,ref:f,style:_(_({},q),d),[dB]:"",[hB]:o,[pB]:m})))}const iq=O.forwardRef((e,t)=>O.createElement(nq,C(_({},e),{forwardedRef:t})));function aq(e,t){return e.findIndex(e=>e===t||e.id===t.id)}function oq(e,t,n){const i=aq(e,t),a=i===e.length-1?[i-1,i]:[i,i+1],o=n[i];return C(_({},t.constraints),{panelSize:o,pivotIndices:a})}nq.displayName="PanelGroup",iq.displayName="forwardRef(PanelGroup)";const sq=()=>{const e=tx(e=>e.mobile),t=yE(e=>e.theme);return e?tn.jsx("img",{crossOrigin:"anonymous",src:`//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.2.8/static/share/${"dark"===t?"app-dark":"app"}.png`,style:{width:"100%"},alt:"logo"}):tn.jsx("img",{crossOrigin:"anonymous",src:`//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.2.8/static/share/${"dark"===t?"web-dark":"web"}.png`,style:{width:320,height:460},alt:"logo"})},rq=({type:e="",className:t=""})=>{const n=yE(e=>e.theme);return tn.jsx("div",{className:`share-qr-code ${t}`,children:"ios"===e?tn.jsx("img",{crossOrigin:"anonymous",src:`//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.2.8/static/share/${"dark"===n?"ios-dark":"ios"}.png`,alt:"logo"}):tn.jsx("img",{crossOrigin:"anonymous",src:`//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.2.8/static/share/${"dark"===n?"android-dark":"android"}.png`,alt:"logo"})})},lq=({show:e,onClose:t})=>{const n=G();return tn.jsx(ht,{visible:e,className:"get-app-modal",header:!1,footer:!1,children:tn.jsxs("div",{className:"get-app-modal-main",children:[tn.jsx("div",{className:"get-app-modal-close",style:{backgroundColor:rE("rgba(0, 0, 0, 0.5)","rgba(255, 255, 255, 0.2)")},onClick:t,children:tn.jsx(dt,{type:"icon-line-x-01",className:"get-app-modal-close-icon"})}),tn.jsxs("div",{className:"get-app-modal-main-content",children:[tn.jsxs("div",{className:"get-app-modal-main-content-box",style:{color:rE("#2C2C36","#FAFAFC")},children:[tn.jsxs("div",{className:"get-app-modal-header",children:[tn.jsx("div",{className:"header-title",children:n.t("Download App")}),tn.jsx("div",{className:"header-content",children:n.t("Designed for mobile devices, offering better experience and more features")})]}),tn.jsxs("div",{className:"get-app-modal-footer",children:[tn.jsxs("div",{className:"footer-top",children:[tn.jsx(rq,{type:"ios",className:"footer-top-code"}),tn.jsxs("div",{className:"footer-top-content",onClick:()=>{window.open("https://apps.apple.com/app/id6743778442")},children:[n.t("Download for iOS"),tn.jsx(dt,{type:"icon-line-arrow-down-right-sm",className:"footer-top-content-icon"})]})]}),tn.jsxs("div",{className:"footer-top",children:[tn.jsx(rq,{type:"android",className:"footer-top-code"}),tn.jsxs("div",{className:"footer-top-content",onClick:()=>{window.open("https://play.google.com/store/apps/details?id=ai.qwenlm.chat.android")},children:[n.t("Download for Android"),tn.jsx(dt,{type:"icon-line-arrow-down-right-sm",className:"footer-top-content-icon"})]})]})]})]}),tn.jsx("div",{className:"get-app-modal-main-content-view",children:tn.jsx(sq,{})})]})]})})},cq="setting",uq="email",dq="subscription",hq="archive",pq="download",mq="logout",fq=({icon:e,text:t,warningType:n,type:i})=>tn.jsxs(Z,{className:"user-menu-dropdown-item",gap:8,children:[e&&tn.jsx(dt,{className:"user-menu-dropdown-item-icon "+("email"===i?"setting-panel-email-icon":""),type:e}),tn.jsx("div",{className:"user-menu-dropdown-item-text",children:t}),n&&tn.jsx(dt,{className:`user-menu-dropdown-item-icon-${n}`,type:"icon-line-alert-circle"})]}),gq=({children:e,placement:t})=>{const{i18n:n}=G(),i=yE(e=>e.setUserMenuDropdownOpen),a=iy(),o=xE(e=>e.setUser),s=xE(e=>e.user),r=yE(e=>e.setShowSidebar),l=CE(e=>e.subscriptionPlus),c=CE(e=>e.setShowSubscriptionDetail),{isShowGetTheApp:u,setShowArchivedChats:d,setTaskRunning:h}=Zb(nj(e=>({isShowGetTheApp:e.isShowGetTheApp,setShowArchivedChats:e.setShowArchivedChats,setTaskRunning:e.setTaskRunning}))),p=tx(e=>{var t,n;return null==(n=null==(t=e.config)?void 0:t.features)?void 0:n.enable_app_download}),m=tx(e=>e.mobile),f=tx(e=>{var t,n,i,a;return(null==(n=null==(t=null==e?void 0:e.config)?void 0:t.features)?void 0:n.enable_payment)&&(null==(a=null==(i=null==e?void 0:e.config)?void 0:i.features)?void 0:a.enable_payment_and_quota)}),[g,v]=O.useState(!1),y=CE(e=>e.paymentExpiredNotification),b=CE(e=>e.paymentIssueNotification),x=dT(e=>e.setEntrySettingsRouter),w=O.useMemo(()=>{const e=p&&!m&&u;return[{label:tn.jsx(fq,{icon:"icon-line-user-profile-circle",type:"email",text:tn.jsx("span",{className:"setting-panel-email",children:null==s?void 0:s.email}),warningType:y?"warning":b?"caution":void 0}),key:uq,disabled:!0,className:"setting-panel-email-menu"},{label:tn.jsx(fq,{icon:"icon-line-settings",text:n.t("Settings"),warningType:y?"warning":b?"caution":void 0}),key:cq},f&&!l?{label:tn.jsx(fq,{icon:"icon-line-star-02",text:n.t("Upgrade Plan")}),key:dq}:null,m?null:{label:tn.jsx(fq,{icon:"icon-line-archive-02",text:n.t("Archived Chats")}),key:hq},e?{type:"divider"}:null,e?{label:tn.jsx(fq,{icon:"icon-line-app-download-01",text:n.t("Download the App")}),key:pq}:null,{type:"divider"},{label:tn.jsx(fq,{icon:"icon-line-logout-03",text:n.t("Log out")}),key:mq}]},[f,p,n.language,m,u,y,b,l]);return tn.jsxs(tn.Fragment,{children:[tn.jsx(yt,{placement:t,overlayClassName:"user-menu-dropdown",menu:{items:w,onClick:e=>P(void 0,[e],function*({key:e}){switch(e){case cq:location.pathname.includes("/p/")&&x(location.pathname),a("/settings/general"),m&&r(!1);break;case dq:return void c(!0);case hq:d(!0),m&&r(!1);break;case pq:v(!0);break;case mq:h(!1),yield iS(),gT("token"),gT("settings"),sessionStorage.removeItem("Auth_Source"),fx()&&oT.adapter.clearCookie(Kf.SETAPP),o(),a("/",{replace:!0})}})},onOpenChange:e=>{null==i||i(e)},children:e}),tn.jsx(lq,{show:g,onClose:()=>{v(!1)}})]})},vq=O.memo(({user:e,menu:t=!0})=>{const n=()=>{var t;return(null==e?void 0:e.profile_image_url)?tn.jsx("img",{src:e.profile_image_url,alt:e.name||"User"}):tn.jsx("span",{className:"user-avatar-placeholder",children:(null==(t=null==e?void 0:e.name)?void 0:t.charAt(0))||"U"})};return e?t?tn.jsx(gq,{placement:"bottomRight",children:tn.jsx("div",{className:"user-avatar",children:n()})}):tn.jsx("div",{className:"user-avatar",children:n()}):null}),yq="index-module__audio-card___lUXFC",bq="index-module__audio-card-content___IEXg-",xq="index-module__audio-card-content-left___ictRc",wq="index-module__qwen-left-icon___LKDGi",Sq="index-module__qwen-left-info___8Q9fA",_q="index-module__qwen-left-info-name___gbVSI",Cq="index-module__qwen-left-info-name-text___eX1Ys",Eq="index-module__qwen-left-info-name-ext___H5xGW",kq="index-module__qwen-left-info-time___eotBv",Iq="index-module__audio-card-content-right___gmh3w",Tq="index-module__audio-card-content-right-disabled___MlkD8",jq=({url:e,id:t,name:n})=>{const[i,a]=O.useState(""),[o,s]=O.useState(""),[r,l]=O.useState(!1),[c,u]=O.useState(!0),[d,h]=O.useState({currTime:"00:00",duration:"00:00"}),p=O.useRef(null),m=O.useCallback(e=>{h(e)},[]);return O.useEffect(()=>{const e=(null==n?void 0:n.lastIndexOf("."))||-1;a(-1===e?n:n.slice(0,n.lastIndexOf("."))),s(-1===e?"":n.slice(e+1))},[n]),e?tn.jsxs("div",{className:yq,children:[tn.jsxs("div",{className:bq,children:[tn.jsxs("div",{className:xq,children:[tn.jsx(Z,{className:wq,justify:"center",align:"center",children:tn.jsx(dt,{type:"iconaudio"})}),tn.jsxs(Z,{className:Sq,vertical:!0,justify:"space-between",flex:1,children:[tn.jsxs(Z,{className:_q,align:"center",children:[tn.jsx("div",{className:Cq,children:i}),tn.jsx("div",{className:Eq,children:o?`.${o}`:""})]}),tn.jsxs(Z,{className:kq,align:"center",gap:4,children:[tn.jsx("span",{children:d.currTime}),tn.jsx("span",{children:"/"}),tn.jsx("span",{children:d.duration})]})]})]}),tn.jsx("div",{className:J(Iq,{[Tq]:!r}),onClick:()=>P(void 0,null,function*(){var e;null==(e=p.current)||e.toggle()}),children:tn.jsx(dt,{type:c?"icon-pause":"icon-play"})})]}),tn.jsx(_t,{ref:p,url:e,id:t,showHandler:!1,onLoaded:l,onPause:u,onPlay:u,getPlayingDuration:m,getFileNewUrlWhenLoadError:e=>P(void 0,null,function*(){var t;const n=yield VS({fileUrl:e});if(n.success)return null==(t=n.data)?void 0:t.fileUrl})})]}):null},Nq={publishToCommunityModal:"index-h5-module__publish-to-community-modal___i-q--",content:"index-h5-module__content___ahaeV",messageContent:"index-h5-module__message-content___Amkbp",messageContentGoCheck:"index-h5-module__message-content-go-check___KO8rp",messageContentGoCheckText:"index-h5-module__message-content-go-check-text___Bx9NM",messageContentGoCheckIcon:"index-h5-module__message-content-go-check-icon___K7EoM"},Pq={publishToCommunityModal:"index-module__publish-to-community-modal___KVynA",content:"index-module__content___rD7ew",publishModalFooter:"index-module__publish-modal-footer___bBfJ7",publishModalButton:"index-module__publish-modal-button___zScqE",qwenModalFooter:"index-module__qwen-modal-footer___07Xz1",messageContentGoCheck:"index-module__message-content-go-check___S94Vu",messageContentGoCheckText:"index-module__message-content-go-check-text___bX-F0",messageContentGoCheckIcon:"index-module__message-content-go-check-icon___YaQNP"},Mq=({open:e,onCancel:t,messageId:n})=>{const i=G(),a=tx(e=>e.mobile),[o,s]=O.useState(!1),r=O.useMemo(()=>a?Nq:Pq,[a]),l=()=>{window.open(`${location.origin}/community/collections`,"_self")},c=()=>tn.jsxs(Z,{align:"center",gap:a?20:158,className:r.messageContent,children:[tn.jsx("div",{children:i.t("Published successfully")}),tn.jsxs(Z,{align:"center",onClick:l,className:r.messageContentGoCheck,children:[tn.jsx("div",{className:r.messageContentGoCheckText,children:i.t("Go check")}),tn.jsx(dt,{className:r.messageContentGoCheckIcon,type:"icon-line-chevron-right"})]})]});return tn.jsx(ht,{title:i.t("Publish Work"),headerBorderNone:!0,visible:e,className:r.publishToCommunityModal,closable:!a,zIndex:1e7,onCancel:t,size:"small",type:"confirm",actions:[{text:i.t("Cancel"),type:"tertiary",disabled:o,onClick:e=>{e.stopPropagation(),t()},rounded:"circle"},{text:i.t("Confirm"),disabled:o,type:"brandprimary",onClick:e=>{e.stopPropagation(),P(void 0,null,function*(){try{s(!0),(yield IC(n,c)).success&&t()}finally{t(),s(!1)}})},rounded:"circle"}],children:tn.jsx("span",{className:r.content,children:i.t("Are you sure you want to publish your work?")})})},Aq=({mediaType:e,messageId:t,preview:n})=>{const{i18n:i}=G(),a=tx(e=>e.mobile),o=Wb(e=>e.chatId),s=Wb(e=>{var t;return null==(t=e.branchInfo)?void 0:t.isTemp}),r=Zb(e=>e.setWelcomeModalShow),[l,c]=O.useState(!1),[u,d]=O.useState(!1),[h,p]=O.useState(""),m=O.useCallback((l,h)=>{const{image:p,video:m}=h,f=("image"===e?null==p?void 0:p.url:null==m?void 0:m.url)||"";let g=(null==n?void 0:n.actions)||["download"];return s&&(g=[]),tn.jsx("div",{className:`qwen-image-preview-operations-wrapper ${!a&&(null==n?void 0:n.tip)?"qwen-image-preview-operations-wrapper-tip":""} ${1===g.length?"single-button":""}`,children:tn.jsxs("div",{className:"qwen-media-preview-toolbar",children:[!a&&(null==n?void 0:n.tip)&&tn.jsxs("div",{className:"qwen-media-preview-toolbar-info",children:[tn.jsx(dt,{type:"icon-line-alert-circle"}),null==n?void 0:n.tip]}),tn.jsx("div",{className:"qwen-media-preview-toolbar-btn",children:g.map(e=>{switch(e){case"download":return tn.jsxs("div",{className:"qwen-media-preview-toolbar-item",onClick:e=>P(void 0,null,function*(){e.stopPropagation(),BS("clkdownloadBtn",{params:{et:"CLK",c5:"preview",c6:f},paramsExtend:{chat_id:o,msg_id:t||""}}),["img.alicdn.com","image.qwenlm.ai/public_source"].find(e=>f.includes(e))?yield W_(f):yield K_({role:"assistant",url:f})}),children:[tn.jsx(dt,{type:"icon-line-download-02"}),a?null:tn.jsx("div",{children:i.t("Download")})]},e);case"share":return tn.jsxs("div",{className:"qwen-media-preview-toolbar-item",onClick:e=>P(void 0,null,function*(){e.stopPropagation(),BS("clkShareBtn",{params:{et:"CLK",c5:"preview",c6:f},paramsExtend:{chat_id:o,msg_id:t||""}});const n=yield G_("assistant",f);(yield C_(n))&&ut.open({type:"success",content:i.t("Copying to clipboard was successful!")})}),children:[tn.jsx(dt,{type:"icon-line-share-01"}),a?null:tn.jsx("div",{children:i.t("Share")})]},e);case"publish":return tn.jsxs(tn.Fragment,{children:[tn.jsxs("div",{className:"qwen-media-preview-toolbar-item",onClick:e=>{e.stopPropagation(),bx()?oT.adapter.invoke({method:"openPublishingRightsWindow",params:{from:"chat",chatId:o,msgId:t||""}}):d(!0)},children:[tn.jsx(dt,{type:"icon-line-Publish"}),a?null:tn.jsx("div",{children:i.t("Publish")})]},e),tn.jsx(Mq,{open:u,onCancel:()=>{d(!1)},messageId:t})]});case"edit":return tn.jsxs("div",{className:"qwen-media-preview-toolbar-item qwen-media-preview-toolbar-item-pd-8-12",onClick:()=>P(void 0,null,function*(){const e=[{type:"image",name:"example.png",file_type:"image/png",showType:"image",file_class:"vision",status:"uploaded",url:f}];yield oT.makeVideoOrImageByImageGen({chatType:Zf.ImageGeneration,subChatType:Zf.ImageGeneration,files:e}),c(!1)}),children:[tn.jsx(dt,{type:"icon-line-edit-contained"}),tn.jsx("div",{className:"qwen-media-preview-toolbar-item-text",children:i.t("Edit")})]},e);case"video":return tn.jsxs("div",{className:"qwen-media-preview-toolbar-item qwen-media-preview-toolbar-item-pd-8-12",onClick:()=>P(void 0,null,function*(){bT()?bx()?yield oT.adapter.invoke({method:"showAlert",params:{type:"login"}}):r(!0):(yield oT.makeVideoOrImageByImageGen({chatType:Zf.VideoGeneration,files:[{type:"image",name:"example.png",file_type:"image/png",showType:"image",file_class:"vision",status:"uploaded",url:f}]}),c(!1))}),children:[tn.jsx(dt,{type:"icon-line-video-generation-01"}),tn.jsx("div",{className:"qwen-media-preview-toolbar-item-text",children:i.t("Create video")})]},e)}})})]})})},[e,null==n?void 0:n.actions,null==n?void 0:n.tip,s,a,i,u,t,o,r]),f=O.useCallback(t=>{a&&(null==n?void 0:n.tip)&&t&&"image"===e&&ut.openOnce({type:"caution",content:null==n?void 0:n.tip,closable:!1}),bx()||c(t)},[e,a,null==n?void 0:n.tip]),g=O.useCallback(i=>{if(bx()){const{chatId:a,currentInputFeature:o}=Wb.getState();oT.adapter.invoke({method:"openMediaPreview",params:{type:e,urls:[null==i?void 0:i.url],chatId:a,msgId:t,msgType:o,tips:(null==n?void 0:n.tip)?[n.tip]:[]}})}else p(i.url)},[e,t,null==n?void 0:n.tip]);return{preview:O.useMemo(()=>bx()?void 0:{maskClosable:!0,toolbarRender:m,onVisibleChange:f,visible:l,onStateChange:e=>{}},[m,l,f]),currentPreviewUrl:h,onClick:g}},Rq=e=>{const t="x-oss-process=image/resize,m_mfit,w_320,h_320";return e.includes("qwen-webui")||"ico"===P_(e)?e:e.includes("?")?`${e}&${t}`:`${e}?${t}`},Oq=({url:e,generation:t,error:n,mediaProps:i,ratio:a,containerWidth:o,onError:s,customScope:r,messageType:l})=>{const{i18n:c}=G(),u=tx(e=>e.mobile),d=Wb(e=>e.chatId),h=O.useRef(0),p=O.useRef(0),m=O.useMemo(()=>r||(u?{width:[114,300],height:[126,380]}:[133,400]),[u,r]);O.useEffect(()=>{h.current=S_()});const f=O.useMemo(()=>{if(a){const[e,t]=a.split(":");return{width:Number(e),height:Number(t)}}return{width:0,height:0}},[a]),g=O.useMemo(()=>{const{width:e,height:t}=u?((e,t=0)=>{const n=[375,667],i=[307,380],a=window.screen.width,o=window.screen.height,s=Math.min(a/n[0],o/n[1]);let r=s*i[0],l=s*i[1];a-t<r&&(r=a-t);const[c,u]=e.split(":"),[d,h]=[parseInt(c),parseInt(u)];return d>h?l=Math.round(r/d*h):d<h?r=Math.round(l/h*d):d===h&&(l=r),{width:r,height:l}})(a,68):((e,t,n=448)=>{const i=.825*(window.innerWidth||document.documentElement.clientWidth),a=.4*(window.innerHeight||document.documentElement.clientHeight);let o=Math.min(n,i),s=Math.min(n,a);if(o=s=Math.min(o,s),o<t&&(o=s=t),e){const[t,n]=e.split(":"),[i,a]=[parseInt(t),parseInt(n)];i>a&&(s=Math.round(o/i*a)),i<a&&(o=Math.round(s/a*i))}return{width:o,height:s}})(a,133,400);let n=e,i=t;if(e>=t&&u&&o){const a=.9*o;n=a,i=a/e*t}return{width:n,height:i}},[u,a,o]);return tn.jsx(Ie,C(_({url:e,poster:(v=e,v.includes("cdn.qwenlm.ai")?`${v}${v.includes("?")?"&":"?"}x-oss-process=video/snapshot,t_0,w_0,h_500,f_jpg`:""),defaultWidth:f.width||16,defaultHeight:f.height||9,controls:!1,width:null==g?void 0:g.width,height:null==g?void 0:g.height,sizeScope:m,generation:t,firstFramePoster:!0,unSupportMessage:c.t("Your browser does not support the video tag."),error:n,onError:s},i),{autoPlay:!0,onLoad:()=>{p.current=S_(),BS("messageVideoOnLoadTime",{params:{et:"OTHER",c4:d||"",c5:l,c6:e,c7:Math.round(h.current),c8:Math.round(p.current),c9:Math.round(p.current-h.current)}})},style:u?{maxWidth:"11.25rem",maxHeight:"12rem"}:{}}));var v},Dq={greenNetError:"index-module__green-net-error___xxZRT",qwenVideoViewerContentOperations:"index-module__qwen-video-viewer-content-operations___47tr9"},Lq={greenNetError:"index-h5-module__green-net-error___AKDlS",greenNetErrorIcon:"index-h5-module__green-net-error-icon___9s-Sn",qwenVideoViewerContentOperations:"index-h5-module__qwen-video-viewer-content-operations___sdzKj",qwenImagePreviewOperationsWrapper:"index-h5-module__qwen-image-preview-operations-wrapper___Tdm5X"},Fq={actions:["download"]},Uq=O.memo(({url:e,isImage:t,isVideo:n,isMobile:i,greenNet:a,messageId:o})=>{const s="green_error"===a,[r,l]=O.useState(0),c=Wb(e=>e.chatId),u=O.useRef(0),d=O.useRef(0),[h,p]=O.useState(e),m=O.useMemo(()=>i?Lq:Dq,[i]),f=Aq({mediaType:t?"image":"video",messageId:o,preview:Fq}),g=O.useMemo(()=>i?[96,180]:[112,112],[i]),v=O.useMemo(()=>i?{height:[96,192],width:[96,192]}:[320,320],[i]),y=O.useCallback(()=>P(void 0,null,function*(){if(q_(h)){const{success:e,data:t}=yield VS({fileUrl:h});e&&(null==t?void 0:t.fileUrl)&&p(t.fileUrl)}}),[h]);O.useEffect(()=>{const e=document.getElementById("chat-message-container");e&&l(null==e?void 0:e.getBoundingClientRect().width),u.current=S_()},[]);const b=O.useCallback((e,t,n)=>{BS("messageImgOnLoadTime",{params:{et:"OTHER",c4:c||"",c5:"query",c6:n,c7:Math.round(e),c8:Math.round(t),c9:Math.round(t-e)}})},[c]);return s?tn.jsx(Z,{className:m.greenNetError,justify:"center",align:"center",children:tn.jsx(dt,{className:m.greenNetErrorIcon,type:"icon-line-image-x-2"})}):t?tn.jsx(Te,C(_({url:h,defaultWidth:1,defaultHeight:1,thumbnailUrl:Rq(h),sizeScope:g,onError:()=>{y()},id:o},f),{onLoad:()=>{d.current=S_(),b(u.current,d.current,h)}})):n?tn.jsx(Oq,{url:h,generation:void 0,error:!1,onError:()=>{y()},ratio:"1:1",containerWidth:r>192?192:r,customScope:v,mediaProps:f,messageType:"query"}):null}),zq={fileMessage:"index-module__file-message___SeOoR",fileMessageImage:"index-module__file-message-image___eDmks",fileMessageAudio:"index-module__file-message-audio___clhPw",fileMessageDocument:"index-module__file-message-document___OjWnc"},Hq={fileMessage:"index-h5-module__file-message___gacd4",fileMessageImage:"index-h5-module__file-message-image___1smH3",fileMessageVideo:"index-h5-module__file-message-video___PZ8v0",fileMessageDocument:"index-h5-module__file-message-document___etdmB"},$q=({fileList:e,isMobile:t,messageId:n})=>{const i=e.length<4?[e]:[e.slice(0,Math.ceil(e.length/2)),e.slice(Math.ceil(e.length/2),e.length)];return tn.jsx("div",{className:"user-image-list",children:i.map((e,i)=>0===e.length?null:tn.jsx("div",{className:J("user-image-list-row",{"user-image-item-margin-top":i>0}),children:e.map((e,i)=>tn.jsxs("div",{className:J("user-image-item",{"user-image-item-margin-left":i>0}),children:[(null==e?void 0:e.isQuote)&&tn.jsxs("div",{className:"quote-image-item-btn",children:[tn.jsx(dt,{type:"icon-line-arrow-curve-left-right",className:"quote-icon"}),tn.jsx("div",{className:"imageItem-file-name",children:tn.jsx("div",{className:"image-item-file-name-text",children:tn.jsx(Uq,{isImage:!0,isMobile:t,greenNet:e.greenNet,url:e.url.startsWith("/api")?`${e.url}/content`:e.url,messageId:n})})})]}),!(null==e?void 0:e.isQuote)&&tn.jsx(Uq,{isImage:!0,isMobile:t,greenNet:e.greenNet,url:e.url.startsWith("/api")?`${e.url}/content`:e.url,messageId:n})]},e.id))},i))})},Bq=({messageId:e,files:t,isBubbleMode:n})=>{const i=tx(e=>e.mobile),a=O.useMemo(()=>i?Hq:zq,[i]),o=O.useMemo(()=>(null==t?void 0:t.length)?i?t:(e=>{const t=[];let n=[];for(const i of e)"image"===i.type&&"image"===i.showType?n.push(i):(n.length>0&&(t.push(n),n=[]),t.push(i));return n.length>0&&t.push(n),t})(t):[],[t,i]);if(!Array.isArray(t)||0===t.length)return null;const s=()=>{Jk.getInstance().stopAllPlayer()};return tn.jsx(Z,{className:a.fileMessage,vertical:!0,wrap:!0,gap:i?16:8,align:n?"flex-end":"flex-start",children:o.map(t=>{var n;return Array.isArray(t)?tn.jsx("div",{className:a.fileMessageImage,onClick:()=>{s()},children:tn.jsx($q,{fileList:t,isMobile:i,messageId:e})},t[0].id):"image"!==t.type||"image"!==t.showType&&t.showType?"video"===t.type&&"video"===t.showType?tn.jsx("div",{className:a.fileMessageVideo,onClick:()=>{s()},children:tn.jsx(Uq,{isVideo:!0,isMobile:i,greenNet:t.greenNet,url:t.url,messageId:e})},t.id):"audio"===t.type&&"audio"===t.showType?tn.jsx("div",{className:a.fileMessageAudio,onClick:()=>{s()},children:tn.jsx(jq,{url:t.url,id:t.id,name:t.name},t.id)},t.id):"url"!==t.file_class?tn.jsx(t$,{className:a.fileMessageDocument,item:t,url:t.url,name:t.name,fileType:t.file_type,size:null==t?void 0:t.size,role:"user",showClose:!1,isQuote:t.isQuote},t.id):null:tn.jsx("div",{className:a.fileMessageImage,onClick:()=>{s()},children:tn.jsx(Uq,{isImage:!0,isMobile:i,greenNet:t.greenNet,url:(null==(n=null==t?void 0:t.url)?void 0:n.startsWith("/api"))?`${t.url}/content`:(null==t?void 0:t.url)||"",messageId:e})},t.id)})})},qq={userMessageHeader:"index-module__user-message-header___s556a",userMessageHeaderUsername:"index-module__user-message-header-username___0ZP-x",userMessageHeaderTimestamp:"index-module__user-message-header-timestamp___Ii7Bs",userMessageHeaderTimecost:"index-module__user-message-header-timecost___gEDh7",userMessageHeaderTimecostIcon:"index-module__user-message-header-timecost-icon___wkz3L"},Gq={userMessageHeaderTimecost:"index-h5-module__user-message-header-timecost___dbbwK",userMessageHeaderTimecostIcon:"index-h5-module__user-message-header-timecost-icon___ktBGX"},Vq=O.memo(({username:e,timestamp:t,timeClassName:n,isBubbleMode:i,timecost:a})=>{const o=G();cT(e=>{var t,n;return null==(n=null==(t=e.settings)?void 0:t.ui)?void 0:n.showUsername});const s=tx(e=>e.mobile),r=_(_({},qq),s?Gq:{});return i?"string"==typeof a?tn.jsxs("div",{className:r.userMessageHeaderTimecost,children:[tn.jsx(dt,{type:"icon-line-microphone-02",className:r.userMessageHeaderTimecostIcon}),a]}):null:tn.jsxs("div",{className:r.userMessageHeader,children:[tn.jsx("span",{className:r.userMessageHeaderUsername,children:e}),tn.jsx("span",{className:J(r.userMessageHeaderTimestamp,n),children:Y(1e3*t).format(o.t("h:mm a"))})]})}),Wq={disable:[],disable_GREEN_ERROR:[],error_ALL_N:["regenerate"],error_ALL_G:["regenerate"],error_ALL_S:[],normal_TW_N:["copy","voice","edit","branch_new","good","bad","share","regenerate"],normal_TW_G:["copy","voice","regenerate"],normal_TW_S:["copy"],normal_A_N:["artifacts","copy","edit","branch_new","publish","good","bad","share","regenerate"],normal_A_G:["artifacts","copy","regenerate"],normal_A_S:["artifacts","copy"],normal_D_N:["copy","branch_new","publish","good","bad","share","regenerate"],normal_D_G:["copy","regenerate"],normal_D_S:["copy"],normal_DP_N:["download","good","bad","share","regenerate","publish"],normal_DP_G:["download","regenerate"],normal_DP_S:["download"],normal_RUPT_N:["copy","good","bad","share","branch_new"],normal_RUPT_G:["copy"],normal_RUPT_S:["copy"],normal_T2I_N:["create_video","image_edit","branch_new","publish","download","good","bad","share","regenerate"],normal_T2I_G:["create_video","image_edit","download","regenerate"],normal_T2I_S:["download"],normal_IE_N:["image_edit","create_video","branch_new","publish","download","good","bad","share","regenerate"],normal_IE_G:["image_edit","create_video","download","regenerate"],normal_IE_S:["download"],normal_VLO_N:["create_video","image_edit","branch_new","publish","download","good","bad","share","regenerate"],normal_VLO_G:["create_video","image_edit","download","regenerate"],normal_VLO_S:["download"],normal_VLO_N_STOP:["regenerate"],normal_VLO_G_STOP:["regenerate"],normal_T2V_N:["download","publish","branch_new","good","bad","share","regenerate"],normal_T2V_G:["download","regenerate"],normal_T2V_S:["download"],normal_OMNI_N:["copy","good","bad","share","branch_new","replay"],normal_OMNI_S:["copy"]},Qq={normal_TW:["select","translation"],normal_A:["select","translation"],normal_D:["select"]},Kq={normal:"N",guest:"G",local:"G",share:"S"},Yq={t2t:"TW",search:"TW",artifacts:"A",web_dev:"A",deep_research:"D",podcast:"DP",t2i:"T2I",image_edit:"IE",t2v:"T2V",travel:"D"},Xq=e=>{const t=/```html[\s\S]*?```/g,n=/```jsx[\s\S]*?```/g;try{const i=e.match(t),a=e.match(n);return null!==i&&i.length>0||null!==a&&a.length>0}catch(i){return!1}},Jq=new RegExp("^<think>(.*?)<\\/think>","is"),Zq=new RegExp("^<think>(?!.*<\\/think>)","is"),eG=e=>{var t;if(Zq.test(e)){let t=e.replace(/^<think>/i,"");return t=t.replace(/^\n/,""),{status:"THINKING",content:"",thinkingQuoteText:t}}if(Jq.test(e)){let n=e.replace(Jq,"");n=n.replace(/^\n{0,2}/,"");let i=(null==(t=e.match(Jq)||[])?void 0:t[1])||"";return i=i.replace(/^\n+|\n+$/g,""),{status:"THOUGHT_COMPLETED",content:n,thinkingQuoteText:i}}return{status:"NONE_THINKING",content:e,thinkingQuoteText:""}},tG=e=>{var t,n,i;return(null==e?void 0:e.content_list)&&(null==(t=null==e?void 0:e.content_list)?void 0:t.length)&&(null==(i=null==(n=null==e?void 0:e.content_list)?void 0:n.findLast(e=>(null==e?void 0:e.phase)===ng.ANSWER))?void 0:i.content)||""},nG=e=>{var t,n;if((null==e?void 0:e.content_list)&&(null==(t=null==e?void 0:e.content_list)?void 0:t.length))return null==(n=null==e?void 0:e.content_list)?void 0:n.filter(e=>(null==e?void 0:e.phase)===ng.ANSWER||(null==e?void 0:e.phase)===ng.DEEPTHINKING).map(e=>e.content||"").join("\n");const{content:i}=eG((null==e?void 0:e.content)||"");return i},iG=e=>e.every(e=>{var t,n,i,a;return e.phase===ng.THINKING_SUMMARY?0===(null==(n=null==(t=null==e?void 0:e.extra)?void 0:t.summary_title)?void 0:n.length)&&0===(null==(a=null==(i=null==e?void 0:e.extra)?void 0:i.summary_content)?void 0:a.length):![ng.IMAGE_GEN_TOOL,ng.IMAGE_EDIT_TOOL].includes(e.phase)&&""===e.content});function aG(e){return O.forwardRef((t,n)=>{const i=t,{mode:a}=i,o=E(i,["mode"]),s=yE(e=>e.isSharePage);return tn.jsx("div",{className:"message-hoc-container",children:tn.jsx(e,C(_({ref:n},o),{mode:s?"read":null!=a?a:"edit"}))})})}const oG=H.memo(e=>{const t=e,{errorImage:n,src:i}=t,a=E(t,["errorImage","src"]),[o,s]=O.useState(i||n||""),[r,l]=O.useState(!!i);O.useEffect(()=>{l(!!i)},[i]);const c=O.useCallback(()=>{n?s(n):l(!1)},[n]);return tn.jsx(Z,C(_({justify:"center",align:"center",className:"qwen-chat-search-card-logo"},a),{children:r?tn.jsx("img",{src:o,alt:"",className:"qwen-chat-search-card-logo-image",onError:c}):tn.jsx(dt,{className:"qwen-chat-search-card-logo-icon",type:"icon-line-globe-01"})}))}),sG=H.memo(e=>{const{sources:t=[],maxShowNum:n=4,onClick:i=()=>{}}=e;return Array.isArray(t)&&0!==t.length?tn.jsxs(Z,{justify:"center",align:"center",gap:8,onClick:i,className:"qwen-chat-search-card",children:[tn.jsx(Z,{justify:"center",align:"center",children:t.slice(0,n).map(({hostlogo:e},t)=>{const n=t+"-"+e+"-sources-icon";return tn.jsx("div",{style:{width:12},children:tn.jsx(oG,{src:e||""})},n)})}),tn.jsxs("div",{className:"qwen-chat-fold-source-count",children:["+",t.length]})]}):null}),rG=({sourceListLogos:e,sourceListMaxShowNumber:t=4,sourceListCallback:n,sourceListName:i,className:a})=>{const o=tx(e=>e.mobile);return tn.jsx("div",{className:`qwen-chat-package-comp-source-list ${a||""}`,onClick:n,children:o?tn.jsxs(tn.Fragment,{children:[tn.jsx(je,{sources:(null==e?void 0:e.map(e=>e.hostlogo||""))||[],showNum:t}),tn.jsxs("div",{className:"qwen-chat-package-comp-source-list-text",children:[tn.jsx("span",{children:null==e?void 0:e.length}),tn.jsx("span",{children:i})]})]}):tn.jsx(sG,{maxShowNum:t,sources:e||[]})})},lG="icon-line-copy-right",cG="icon-line-edit-contained",uG="icon-line-edit-contained",dG="icon-line-thumb-up-02",hG="icon-line-thumb-down-02",pG="icon-line-arrow-rotate-right-02",mG="icon-line-text-selection",fG="icon-line-share-01",gG="icon-line-download-02",vG="icon-line-trash-01",yG="icon-pause",bG="icon-line-Volume",xG="icon-line-Publish",wG="icon-line-video-generation-01",SG="icon-line-Branch",_G="icon-line-Volume";var CG=(e=>(e.LOADING_DARK="https://img.alicdn.com/imgextra/i2/O1CN01J8AmJN1cZGSJ5xFjV_!!6000000003614-54-tps-60-60.apng",e.LOADING_LIGHT="https://img.alicdn.com/imgextra/i4/O1CN01Jwyf191eaIa5xowFe_!!6000000003887-54-tps-60-60.apng",e.VOICE_ACTIVE_DARK="https://img.alicdn.com/imgextra/i1/O1CN01lSOiPA1VfwvV2cZw6_!!6000000002681-54-tps-60-60.apng",e.VOICE_ACTIVE_LIGHT="https://img.alicdn.com/imgextra/i1/O1CN01pNHavt1CykU9z9sPI_!!6000000000150-54-tps-60-60.apng",e))(CG||{});const EG=[{key:"copy",controlType:"only-icon",icon:lG},{key:"edit",controlType:"only-icon",icon:cG},{key:"publish",controlType:"only-icon",icon:xG},{key:"regenerate",controlType:"only-icon",icon:pG},{key:"select",controlType:"only-icon",icon:mG},{key:"share",controlType:"only-icon",icon:fG},{key:"download",controlType:"only-icon",icon:gG},{key:"image_edit",controlType:"label-icon-primary",icon:uG},{key:"delete",controlType:"only-icon",icon:vG},{key:"good",controlType:"only-icon",icon:dG},{key:"bad",controlType:"only-icon",icon:hG},{key:"artifacts",controlType:"label-icon-secondary",icon:yG},{key:"create_video",controlType:"label-icon-primary",icon:wG},{key:"voice",icon:bG,activeImgs:["https://img.alicdn.com/imgextra/i1/O1CN01pNHavt1CykU9z9sPI_!!6000000000150-54-tps-60-60.apng","https://img.alicdn.com/imgextra/i1/O1CN01lSOiPA1VfwvV2cZw6_!!6000000002681-54-tps-60-60.apng"],loadingImgs:["https://img.alicdn.com/imgextra/i4/O1CN01Jwyf191eaIa5xowFe_!!6000000003887-54-tps-60-60.apng","https://img.alicdn.com/imgextra/i2/O1CN01J8AmJN1cZGSJ5xFjV_!!6000000003614-54-tps-60-60.apng"]},{key:"branch_new",controlType:"only-icon",icon:SG},{key:"replay",controlType:"only-icon",icon:_G}],kG=({className:e,type:t="normal",editedData:n,siblingsData:i,controlData:a,sourceListData:o,maxShowButtonCount:s=6,moreText:r="More actions",fullShowControl:l=!0})=>{const c=yE(e=>e.realTheme),u=tx(e=>e.mobile),[d,h]=O.useState(null),[p,m]=O.useState(!1),[f,g]=O.useState(!1),v=O.useRef(null),y=O.useMemo(()=>((null==a?void 0:a.list)||[]).map(e=>{const t=EG.find(t=>t.key===e.key)||{};return _(_({},t),e)}),[null==a?void 0:a.list]),{displayButtons:b,moreButtons:x}=O.useMemo(()=>{const e=(null==a?void 0:a.controls)||[],t=e.filter(e=>["image_edit","artifacts","create_video"].includes(e)).slice(0,1),n=e.filter(e=>["good","bad","share","regenerate"].includes(e)),i=e.filter(e=>![...t,...n].includes(e));let o=i.length+n.length>s?i.slice(-(i.length+n.length-s+1)):[],r=[...t,...i.slice(0,i.length-o.length),...n];if(u&&f){const e=["good","bad"].filter(e=>r.includes(e));e.length>0&&(o=[...o,"divider",...e],o.length<3&&(o=o.filter(e=>"divider"!==e)),r=r.filter(e=>!["good","bad"].includes(e)))}return{displayButtons:r||[],moreButtons:o}},[null==a?void 0:a.controls,s,u,f]),w=O.useMemo(()=>{var e;let t=b.map(e=>{const t=y.find(t=>t.key===e);return!1===(null==t?void 0:t.visible)?null:t}).filter(e=>null!==e);const n=null==(e=null==t?void 0:t[0])?void 0:e.controlType;return n&&["label-icon-primary","label-icon-secondary"].includes(n)&&(t=t.map((e,t)=>0===t?e:C(_({},e),{controlType:["label-icon-primary","label-icon-secondary"].includes(e.controlType)?"only-icon":e.controlType}))),t},[b,y]),S=O.useMemo(()=>x.map(e=>{const t=y.find(t=>t.key===e);return!1===(null==t?void 0:t.visible)?null:t}).filter(e=>null!==e),[x,y]),E=O.useMemo(()=>[...w,...S],[w,S]),k=O.useMemo(()=>(null==n?void 0:n.visible)||(null==i?void 0:i.visible),[null==n?void 0:n.visible,null==i?void 0:i.visible]),I=O.useMemo(()=>["good","bad","publish","download"].filter(e=>E.find(({key:t})=>t===e)),[E]),T=O.useMemo(()=>["create_video","image_edit"].filter(e=>E.find(({key:t})=>t===e)),[E]);O.useLayoutEffect(()=>{if(u&&v.current){const e=v.current,t=e.querySelector(".qwen-chat-package-comp-new-action-control-container");if(t){const n=t.offsetHeight;e.offsetHeight>2*n?g(!0):g(!1)}}},[u,v]);const j=O.useMemo(()=>I.map(e=>{const t=y.find(t=>t.key===e);return!1===(null==t?void 0:t.visible)?null:t}).filter(e=>!!e),[y,I]),N=O.useMemo(()=>T.map(e=>{const t=y.find(t=>t.key===e);return!1===(null==t?void 0:t.visible)?null:t}).filter(e=>!!e),[y,T]),P=O.useMemo(()=>w.filter(({key:e})=>![...I,...T].includes(e))||[],[w,T,I]),M=O.useMemo(()=>S.filter(({key:e})=>![...I,...T].includes(e))||[],[S,T,I]),A=O.useCallback(e=>tn.jsxs(pt,{type:"brandsecondary",size:"small",rounded:"circle",className:J("qwen-chat-package-comp-new-action-control-btn",{"qwen-chat-package-comp-action-base-control-btn-visible":e.visible}),onClick:e.callback,children:[tn.jsx("div",{className:"qwen-chat-package-comp-new-action-control-icon-container",children:tn.jsx(dt,{className:"qwen-chat-package-comp-new-action-control-icon",type:e.icon||""})}),tn.jsx("div",{className:"qwen-chat-package-comp-new-action-control-text",children:e.label})]},`renderLabelIconSecondary_${e.key}`),[]),R=O.useCallback(e=>tn.jsx(pt,{buttonClass:J("qwen-chat-package-comp-action-base-control-btn","qwen-chat-package-comp-action-base-control-btn-primary",{"qwen-chat-package-comp-action-base-control-btn-visible":e.visible}),type:u?"brandprimary":"brandsecondary",size:"small",rounded:"circle",iconFontType:e.icon||"",onClick:e.callback,children:e.label},`renderLabelIconPrimary_${e.key}`),[u]),D=O.useCallback(e=>tn.jsxs("div",{className:"qwen-chat-package-comp-new-action-control-guide-content",onClick:e=>e.stopPropagation(),children:[tn.jsxs("div",{className:"qwen-chat-package-comp-new-action-control-guide-top",children:[tn.jsx("div",{className:"qwen-chat-package-comp-new-action-control-guide-title",children:e.title}),tn.jsx("div",{className:"qwen-chat-package-comp-new-action-control-guide-close-btn",onClick:()=>{e.onCloseClick&&e.onCloseClick()},children:tn.jsx(dt,{type:"icon-close-4",className:"qwen-chat-package-comp-new-action-control-guide-close"})})]}),tn.jsx("div",{className:"qwen-chat-package-comp-new-action-control-guide-content-text",children:e.content}),e.buttonVisible&&tn.jsx(pt,{type:"brandtertiary",rounded:"circle",size:"small",onClick:e.onButtonClick,children:e.buttonText})]}),[]),L=O.useCallback((e,t)=>{var n,i,o,s,r,l,p,m,f,g,v;const y=null==(n=null==a?void 0:a.disableControls)?void 0:n.some(t=>t===e.key),b=null==(i=null==a?void 0:a.activeControls)?void 0:i.some(t=>t===e.key),x="light"===c?null==(o=e.activeImgs)?void 0:o[0]:(null==(s=e.activeImgs)?void 0:s[1])||(null==(r=e.activeImgs)?void 0:r[0]),w=null==(l=null==a?void 0:a.loadingControls)?void 0:l.some(t=>t===e.key),S="light"===c?null==(p=e.loadingImgs)?void 0:p[0]:(null==(m=e.loadingImgs)?void 0:m[1])||(null==(f=e.loadingImgs)?void 0:f[0]);let _=e.defaultToolTip||null;y?_=e.disabledTooltip||null:b&&(_=e.activeTooltip||null);const C=!t&&(null==(g=e.guideInfo)?void 0:g.visible)||!1;return _||d!==e.key||h(null),["good","bad"].includes(e.key)&&b&&(e.icon="good"===e.key?"icon-fill-thumb-up-01":"icon-fill-thumb-down-01"),tn.jsx(ft,{open:d===e.key,title:u||t?null:_,placement:"bottom",onOpenChange:t=>{h(t?e.key:null)},children:tn.jsx(ae,{arrow:!1,classNames:{root:"qwen-chat-package-comp-new-action-control-guide "+(C?"":"qwen-chat-package-comp-new-action-control-guide-none")},content:D(e.guideInfo||{}),trigger:C?"click":[],getPopupContainer:()=>document.body,placement:u?"top":"right",onOpenChange:null==(v=e.guideInfo)?void 0:v.onOpenChange,children:tn.jsx("div",{className:`qwen-chat-package-comp-new-action-control-container qwen-chat-package-comp-new-action-control-container-${e.key} ${y?"qwen-chat-package-comp-new-action-control-container-disabled":""} ${u||t?"":"qwen-chat-package-comp-new-action-control-container-enable-hover"}`,onClick:n=>{y||!e.callback||t||e.callback()},children:w||b&&x?tn.jsx("img",{alt:"",className:"qwen-chat-package-comp-new-action-control-icon-img",src:w?S:x}):tn.jsx(dt,{type:e.icon||"",className:"qwen-chat-package-comp-new-action-control-icon\n            "+(b&&!t?"qwen-chat-package-comp-new-action-control-icon-active":"")})})})},`renderOnlyIcon_${e.key}`)},[null==a?void 0:a.activeControls,null==a?void 0:a.disableControls,null==a?void 0:a.loadingControls,u,D,c,d]),F=O.useCallback((e,t)=>{var n,i,o,s,r,l,p,m,f,g,v;const y=null==(n=null==a?void 0:a.disableControls)?void 0:n.some(t=>t===e.key),b=null==(i=null==a?void 0:a.activeControls)?void 0:i.some(t=>t===e.key),x="light"===c?null==(o=e.activeImgs)?void 0:o[0]:(null==(s=e.activeImgs)?void 0:s[1])||(null==(r=e.activeImgs)?void 0:r[0]),w=null==(l=null==a?void 0:a.loadingControls)?void 0:l.some(t=>t===e.key),S="light"===c?null==(p=e.loadingImgs)?void 0:p[0]:(null==(m=e.loadingImgs)?void 0:m[1])||(null==(f=e.loadingImgs)?void 0:f[0]);let _=e.defaultToolTip||null;y?_=e.disabledTooltip||null:b&&(_=e.activeTooltip||null);const C=!t&&(null==(g=e.guideInfo)?void 0:g.visible)||!1;return _||d!==e.key||h(null),["good","bad"].includes(e.key)&&b&&(e.icon="good"===e.key?"icon-fill-thumb-up-01":"icon-fill-thumb-down-01"),tn.jsx(ft,{open:d===e.key,title:u||t?null:_,placement:"bottom",onOpenChange:t=>{h(t?e.key:null)},children:tn.jsx(ae,{arrow:!1,classNames:{root:"qwen-chat-package-comp-new-action-control-guide "+(C?"":"qwen-chat-package-comp-new-action-control-guide-none")},content:D(e.guideInfo||{}),trigger:C?"click":[],getPopupContainer:()=>document.body,placement:"top",onOpenChange:null==(v=e.guideInfo)?void 0:v.onOpenChange,children:tn.jsx("div",{className:`upper-right-corner-item qwen-chat-package-comp-new-action-control-container qwen-chat-package-comp-new-action-control-container-${e.key} ${y?"qwen-chat-package-comp-new-action-control-container-disabled":""} ${u||t?"":"qwen-chat-package-comp-new-action-control-container-enable-hover"}`,onClick:()=>{y||!e.callback||t||e.callback()},children:w||b&&x?tn.jsx("img",{alt:"",className:"qwen-chat-package-comp-new-action-control-icon-img",src:w?S:x}):tn.jsx(dt,{type:e.icon||"",className:"qwen-chat-package-comp-new-action-control-icon\n            "+(b&&!t?"qwen-chat-package-comp-new-action-control-icon-active":"")})})})},`renderOnlyIcon_${e.key}`)},[null==a?void 0:a.activeControls,null==a?void 0:a.disableControls,null==a?void 0:a.loadingControls,u,D,c,d]),U=O.useCallback(e=>{switch(null==e?void 0:e.controlType){case"only-icon":return L(e);case"label-icon-primary":return R(e);case"label-icon-secondary":return A(e);default:return(null==e?void 0:e.iconRender)?e.iconRender:e?L(e):null}},[R,A,L]),z=O.useMemo(()=>["upper-right-corner","lower-center"].includes(t)?null:(null==n?void 0:n.visible)||(null==i?void 0:i.visible)?tn.jsxs("div",{className:"qwen-chat-package-comp-new-action-control-edited-container",children:[(null==n?void 0:n.visible)&&tn.jsx("div",{className:"qwen-chat-package-comp-new-action-control-is-edited",children:n.text}),(null==i?void 0:i.visible)&&tn.jsx(Ne,{onPreviousClick:i.onPreviousClick,onNextClick:i.onNextClick,curSiblingsIndex:i.curSiblingsIndex,maxSiblings:i.maxSiblings})]}):null,[null==n?void 0:n.text,null==n?void 0:n.visible,null==i?void 0:i.curSiblingsIndex,null==i?void 0:i.maxSiblings,null==i?void 0:i.onNextClick,null==i?void 0:i.onPreviousClick,null==i?void 0:i.visible,t]),H=O.useCallback(e=>e?tn.jsx("div",{className:"qwen-chat-package-comp-new-action-more-operation-text",children:e.label||e.defaultToolTip||""}):null,[]),$=O.useCallback(e=>{var t,n,i;const o=null==(t=null==a?void 0:a.disableControls)?void 0:t.some(t=>t===e),s=y.find(t=>t.key===e);if(!s||!1===s.visible)return null;const r=(null==(n=s.guideInfo)?void 0:n.visible)||!1;return tn.jsx(ae,{classNames:{root:"qwen-chat-package-comp-new-action-control-guide "+(r?"":"qwen-chat-package-comp-new-action-control-guide-none")},getPopupContainer:e=>document.body,content:D(s.guideInfo||{}),trigger:r?"click":[],placement:u?"top":"right",arrow:!u,autoAdjustOverflow:!0,onOpenChange:null==(i=s.guideInfo)?void 0:i.onOpenChange,children:tn.jsxs("div",{className:"qwen-chat-package-comp-new-action-more-operation-items",onClick:()=>{!o&&s.callback&&(s.callback(),r||m(!1))},children:[L(s,!0),H(s)]},e)})},[y,null==a?void 0:a.disableControls,L,H,D,u]),B=O.useMemo(()=>{const e="simplify"===t?x.filter(e=>![...I,...T].includes(e))||[]:x;return tn.jsx("div",{className:"qwen-chat-package-comp-new-action-more-operation-content",children:e.map(e=>"divider"===e?tn.jsx("div",{className:"qwen-chat-package-comp-new-action-more-operation-divider"},e):$(e))})},[T,x,$,t,I]),q=O.useMemo(()=>{switch(t){case"upper-right-corner":return tn.jsx(Z,{gap:12,children:j.map(e=>F(e))});case"lower-center":return tn.jsx(Z,{justify:"center",align:"center",gap:8,className:"lower-center-container",children:N.map(({key:e,defaultToolTip:t,label:n,icon:i,callback:a},o)=>{const s=tn.jsx(ft,{title:t,children:tn.jsxs(Z,{gap:4,align:"center",onClick:a,className:"lower-center-item",children:[tn.jsx(dt,{type:i||""}),l?tn.jsx("div",{className:"lower-center-item-label",children:n}):null]})},e);return o?s:tn.jsxs(tn.Fragment,{children:[s,tn.jsx("div",{className:"lower-center-item-divider"})]})})});case"simplify":return tn.jsxs("div",{ref:v,className:"qwen-chat-package-comp-new-action-control-icons",children:[(null==P?void 0:P.length)?null==P?void 0:P.map(e=>U(e)):null,(null==M?void 0:M.length)>0&&tn.jsx(ae,{arrow:!1,open:p,onOpenChange:m,classNames:{root:"qwen-chat-package-comp-new-action-more-popover"},trigger:"click",placement:"bottomLeft",autoAdjustOverflow:!0,destroyOnHidden:!0,content:B,children:tn.jsx(ft,{title:r,placement:"top",children:tn.jsx("div",{className:"qwen-chat-package-comp-new-action-control-container",children:tn.jsx(dt,{type:"icon-line-more-01",className:"qwen-chat-package-comp-new-action-control-icon"})})},"more-button-tooltip")})]});default:return tn.jsxs("div",{ref:v,className:"qwen-chat-package-comp-new-action-control-icons",children:[(null==w?void 0:w.length)?null==w?void 0:w.map(e=>U(e)):null,(null==S?void 0:S.length)>0&&tn.jsx(ae,{arrow:!1,open:p,onOpenChange:m,classNames:{root:"qwen-chat-package-comp-new-action-more-popover"},trigger:"click",placement:"bottomLeft",autoAdjustOverflow:!0,destroyTooltipOnHide:!0,content:B,children:tn.jsx(ft,{title:r,placement:"top",children:tn.jsx("div",{className:"qwen-chat-package-comp-new-action-control-container",children:tn.jsx(dt,{type:"icon-line-more-01",className:"qwen-chat-package-comp-new-action-control-icon"})})},"more-button-tooltip")})]})}},[t,j,F,N,l,P,null==M?void 0:M.length,p,B,r,U,w,null==S?void 0:S.length]);return u?tn.jsxs("div",{className:`qwen-chat-package-comp-new-action-control ${e}`,children:[(null==o?void 0:o.visible)&&tn.jsx(rG,_({},{sourceListLogos:o.sourceListLogos,sourceListName:o.sourceListName,sourceListCallback:o.sourceListCallback})),!!w.length&&tn.jsxs("div",{className:"qwen-chat-package-comp-new-action-control-mobile-container",children:[q,z]})]}):tn.jsxs("div",{className:`qwen-chat-package-comp-new-action-control ${e}`,style:"upper-right-corner"===t?{justifyContent:"flex-end"}:{},children:[k&&("left"===(null==i?void 0:i.position)||!(null==i?void 0:i.position))&&z,q,k&&"right"===(null==i?void 0:i.position)&&z,(null==o?void 0:o.visible)&&tn.jsx(rG,_({},{sourceListLogos:o.sourceListLogos,sourceListName:o.sourceListName,sourceListCallback:o.sourceListCallback}))]})},IG=[{key:"copy",controlType:"icon-label",icon:lG},{key:"edit",controlType:"icon-label",icon:cG},{key:"publish",controlType:"icon-label",icon:xG},{key:"regenerate",controlType:"icon-label",icon:pG},{key:"select",controlType:"icon-label",icon:mG},{key:"share",controlType:"icon-label",icon:fG},{key:"download",controlType:"icon-label",icon:gG},{key:"image_edit",controlType:"icon-label",icon:uG},{key:"delete",controlType:"icon-label-error",icon:vG},{key:"good",controlType:"icon-label",icon:dG},{key:"bad",controlType:"icon-label",icon:hG},{key:"artifacts",controlType:"icon-label",icon:yG},{key:"translation",controlType:"icon-label-select",icon:mG},{key:"branch_new",controlType:"icon-label",icon:SG},{key:"voice",controlType:"icon-label",icon:bG,activeImgs:[CG.VOICE_ACTIVE_LIGHT,CG.VOICE_ACTIVE_DARK],loadingImgs:[CG.LOADING_LIGHT,CG.LOADING_DARK]}],TG=({className:e,controlData:t})=>{const n=yE(e=>e.realTheme),i=O.useMemo(()=>((null==t?void 0:t.list)||[]).map(e=>{const t=IG.find(t=>t.key===e.key)||{};return _(_({},t),e)}),[null==t?void 0:t.list]),a=O.useCallback(e=>{var t,n,i;return tn.jsx(Pe,{languageCode:(null==(t=e.dropdown)?void 0:t.value)||"",popover:{getPopupContainer:()=>{var e;return(null==(e=document.getElementsByClassName("chat-messages"))?void 0:e[0])||document.body}},languages:((null==(n=e.dropdown)?void 0:n.options)||[]).map(e=>({code:e.key,title:e.label,translate:e.value})),onTranslate:null==(i=e.dropdown)?void 0:i.onChange})},[]),o=O.useCallback(e=>e.loading||e.active&&e.activeImg?tn.jsx("img",{className:"qwen-chat-package-comp-action-control-vertical-group-base-item-img",src:e.loading?e.loadingImg:e.activeImg,alt:""}):tn.jsx(dt,{type:e.icon||"",className:`qwen-chat-package-comp-action-control-vertical-group-base-item-icon\n          ${e.active?"qwen-chat-package-comp-action-control-vertical-group-base-item-icon-active":""}\n          ${e.disabled?"qwen-chat-package-comp-action-control-vertical-group-base-item-icon-disable":""}\n          `}),[]),s=O.useCallback((e,i="normal",s=!1)=>{var r,l,c,u,d,h,p,m,f;const g=null==(r=null==t?void 0:t.disableControls)?void 0:r.some(t=>t===e.key),v=null==(l=null==t?void 0:t.activeControls)?void 0:l.some(t=>t===e.key),y="light"===n?null==(c=e.activeImgs)?void 0:c[0]:(null==(u=e.activeImgs)?void 0:u[1])||(null==(d=e.activeImgs)?void 0:d[0]),b=null==(h=null==t?void 0:t.loadingControls)?void 0:h.some(t=>t===e.key),x="light"===n?null==(p=e.loadingImgs)?void 0:p[0]:(null==(m=e.loadingImgs)?void 0:m[1])||(null==(f=e.loadingImgs)?void 0:f[0]);return tn.jsxs("div",{className:`qwen-chat-package-comp-action-control-vertical-group-base-item qwen-chat-package-comp-action-control-vertical-group-base-item-${i} qwen-chat-package-comp-action-control-vertical-group-base-item-${e.key}`,onClick:()=>!b&&e.callback&&e.callback(),children:[tn.jsx("div",{className:"qwen-chat-package-comp-action-control-vertical-group-base-item-icon-label",children:e.label}),s?a(e):o({loading:b,active:v,disabled:g,activeImg:y,loadingImg:x,icon:e.icon})]})},[null==t?void 0:t.activeControls,null==t?void 0:t.disableControls,null==t?void 0:t.loadingControls,o,a,n]),r=O.useCallback(e=>{const t=i.find(t=>t.key===e);switch(null==t?void 0:t.controlType){case"icon-label":return s(t);case"icon-label-error":return s(t,"error");case"icon-label-select":return s(t,"normal",!0);default:return null}},[i,s]),l=O.useMemo(()=>{var e;return(null==(e=null==t?void 0:t.controls)?void 0:e.length)?t.controls:[]},[null==t?void 0:t.controls]);return tn.jsx("div",{className:`qwen-chat-package-comp-action-control-vertical ${e||""}`,children:l.map((e,t)=>tn.jsx("div",{className:"qwen-chat-package-comp-action-control-vertical-group",children:r(e)},`action-control-vertical-${t}`))})},jG=aG(e=>{const{i18n:t}=G(),n=xE(e=>e.user),i=Wb(e=>e.isChat),a=Zb(e=>e.temporaryChatEnabled),[o,s]=O.useState(!1),r=Wb(e=>e.currentInputFeature),l=Zb(e=>e.visionGenerating),c=Zb(e=>e.taskRunning),u=tx(e=>e.mobile),d="read"===e.mode;yE(e=>e.isSharePage);const{message:h,isChatIntercept:p,isFirstMessage:m,isOmni:f,handleEditMessage:g,handleDeleteMessage:v,showActionControl:y=!0,isOldMessageInNewBranch:b}=e,x=O.useMemo(()=>h.siblings||CC(h.id||h.fid),[h]),w=O.useMemo(()=>!!f&&!(null==h?void 0:h.content),[f,null==h?void 0:h.content]),S=O.useMemo(()=>!p&&!d&&!f&&h.id&&!b&&h.sub_chat_type!==Zf.INTERRUPT,[p,d,f,h.id,h.sub_chat_type,b]),_=O.useMemo(()=>!m&&!d&&!p&&!a&&!i&&!l&&!c&&!bT()&&!b&&h.id,[m,d,p,a,i,l,c,b,h.id]),C=O.useMemo(()=>{if(h.isShare)return[];let e=["copy"];return S&&e.push("edit"),_&&e.push("delete"),w&&(e=e.filter(e=>!["copy","edit"].includes(e))),e},[_,S,w,h.isShare]),E=O.useMemo(()=>{let e=["copy"];return S&&e.push("edit"),e.push("select"),_&&e.push("delete"),w&&(e=e.filter(e=>!["copy","edit","select"].includes(e))),e},[_,S,w]),k=O.useMemo(()=>(null==x?void 0:x.indexOf(h.id||h.fid))+1,[h.fid,h.id,x]),I=O.useCallback(e=>{const t=e||h.content;E_(t)},[h.content]),T=O.useCallback(()=>{v()},[v]),j=O.useCallback(()=>{bx()?oT.adapter.invoke({method:"openHalfWindow",params:{type:"selectText",content:r===Zf.WebSearch?ev(nG(h)):nG(h),ext:`{"disable_translate": ${(null==h?void 0:h.chat_type)===Zf.DeepResearch||h.chat_type===Zf.Travel}}`,windowSize:100}}):s(!0)},[r,h]),N=O.useMemo(()=>({visible:x.length>1,curSiblingsIndex:k,maxSiblings:x.length,position:n&&"left",onPreviousClick:()=>{oT.navigateToSiblingMessage(h,x,"previous")},onNextClick:()=>{oT.navigateToSiblingMessage(h,x,"next")}}),[k,h,x,n]),P=O.useMemo(()=>({controls:C,list:[{key:"edit",defaultToolTip:t.t("Edit"),callback:g,visible:!b&&!!h.id},{key:"copy",defaultToolTip:t.t("Copy"),callback:I},{key:"delete",defaultToolTip:t.t("Delete"),callback:T,visible:!b&&!!h.id}]}),[C,I,T,g,t,b,h.id]),M=O.useMemo(()=>({controls:E,list:[{key:"edit",label:t.t("Edit"),callback:g},{key:"copy",label:t.t("Copy"),callback:I},{key:"delete",label:t.t("Delete"),callback:T},{key:"select",label:t.t("Select text"),callback:j}]}),[I,T,g,t,j,E]);return tn.jsxs(Z,{className:"user-message-footer "+(u&&!N.visible?"user-message-footer-none":""),vertical:!0,justify:"center",align:"flex-end",children:[y?!(u&&!N.visible)&&tn.jsx(kG,{className:"user-message-footer-horizontal",siblingsData:N,controlData:P,moreText:t.t("More actions")}):tn.jsx("div",{}),u&&tn.jsx(TG,{className:"user-message-footer-vertical",controlData:M}),o&&tn.jsx(Me,{contentText:r===Zf.WebSearch?ev(nG(h)):nG(h),useSystemSelect:!0,title:t.t("Select text"),show:o,onClose:()=>s(!1)})]})}),NG=({children:e,onLongPress:t})=>{const[n,i]=O.useState(!1),a=O.useRef(null),o=O.useRef(null),[s,r]=O.useState(null),l=O.useRef(null),c=O.useRef(!1),u=px();let d=null;const h=O.useCallback(()=>{i(!1),c.current=!1,document.querySelectorAll(".user-message-footer-vertical").forEach(e=>{e.style.left="0",e.style.top="0",e.style.visibility="hidden",e.style.position="absolute",e.style.zIndex=-1}),document.querySelectorAll(".qwen-chat-package-comp-action-control-vertical").forEach(e=>{e.style.left="0",e.style.top="0",e.style.visibility="hidden",e.style.position="absolute",e.style.zIndex=-1})},[]),p=(e,t,n,i,o)=>{try{const s=document.querySelector(`#${gg}`);d&&clearTimeout(d),d=setTimeout(()=>{n||p(e,s,a,i,o);const r=null==s?void 0:s.getBoundingClientRect(),l=null==t?void 0:t.getBoundingClientRect(),c=null==n?void 0:n.getBoundingClientRect();if(c&&r&&l){const{height:t,width:n}=c,{x:a,width:s,y:u,height:d}=r,{x:h,y:p}=l;let m=i+h;m+n>a+s&&(m=a+s-n-10,i=m-h);o+t>u+d&&(o=o-t);const f=e.target.closest(".chat-user-message-container").querySelector(".user-message-footer").querySelector(".user-message-footer-vertical");f&&(f.style.left=i+"px",f.style.top=o+"px",f.style.display="block",f.style.visibility="visible",f.style.position="fixed",f.style.zIndex=9)}},100)}catch(s){}},m=O.useCallback((e,n,a)=>{i(!0),c.current=!0;const o=document.querySelector(`#${gg}`),s=e.target.closest(".qwen-chat-message"),r=e.target.closest(".chat-user-message-container").querySelector(".user-message-footer").querySelector(".user-message-footer-vertical");r.style.display="block";const l=a;let d=n;d=(null==r?void 0:r.offsetWidth)+d+50>(null==o?void 0:o.offsetWidth)?Math.max(0,n-(null==r?void 0:r.offsetWidth)-50):n+50,u&&r&&p(e,s,r,d,l),u&&(setTimeout(()=>{window.addEventListener("click",h)},500),null==t||t())},[h,u,t]);return O.useEffect(()=>{if(!u||!n)return;const e=e=>{a.current&&!a.current.contains(e.target)&&h()},t=setTimeout(()=>{document.addEventListener("click",e)},300);window.addEventListener("click",h),window.addEventListener("touchStart",h),window.addEventListener("touchmove",h);return document.querySelectorAll(".chat-response-message-right").forEach(e=>{e.addEventListener("click",h)}),()=>{clearTimeout(t),document.removeEventListener("click",e),window.removeEventListener("click",h),window.removeEventListener("touchStart",h),window.removeEventListener("touchmove",h);document.querySelectorAll(".chat-response-message-right").forEach(e=>{e.removeEventListener("click",h)})}},[n,h,u]),tn.jsx("div",{ref:o,className:u?"chat-user-message-right":"",onTouchStart:e=>{h(),document.querySelectorAll(".ant-popover").forEach(e=>{e.style.left="0",e.style.top="0",e.style.visibility="hidden",e.style.position="absolute",e.style.zIndex=-1}),c.current&&(e.preventDefault(),e.stopPropagation());const t=e.touches[0],n=t.clientX,i=t.clientY;r({x:n,y:i}),l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{e.target&&m(e,n,i)},500)},onTouchMove:e=>{if(!s)return;const t=e.touches[0],n=t.clientX,i=t.clientY,a=n-s.x,o=i-s.y;Math.sqrt(w(a,2)+w(o,2))>5&&(h(),l.current&&(clearTimeout(l.current),l.current=null),r(null))},onTouchEnd:()=>{l.current&&(window.clearTimeout(l.current),l.current=null),r(null)},style:{position:"relative",width:"100%"},children:e})},PG=({content:e,isMobile:t=!1,isIos:n=!1,className:i="",style:a={},hasQuoteText:o=!1})=>{const s=O.useRef(null),[r,l]=O.useState(!1),c=O.useRef(""),u=e=>{if(!s.current)return;l(!0);let t=0;const i=n?1e3:2e3,a=n?3:5,o=document.createDocumentFragment(),r=()=>{for(let n=0;n<a&&t<e.length;n++){const n=Math.min(e.length,t+i),a=e.slice(t,n);o.appendChild(document.createTextNode(a)),t=n}var c;t<e.length?(c=r,"requestIdleCallback"in window?window.requestIdleCallback(c):requestAnimationFrame(c)):(performance.now(),setTimeout(()=>{s.current&&(n&&(s.current.style.transform="translateZ(0)",s.current.style.willChange="transform"),s.current.textContent="",s.current.appendChild(o),d()),performance.now(),l(!1)},0))};"fonts"in document?document.fonts.ready.then(r):r()},d=()=>P(void 0,null,function*(){const e=document.getElementById("messages-container");e&&(e.scrollTop=e.scrollHeight)});O.useEffect(()=>{s.current&&e!==c.current&&(t?u(e):(e=>{let t=e;if(o&&e){const n=new RegExp("```[\\s\\S]*?"+o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")+"[\\s\\S]*?```");t=e.replace(n,"").trim()}if(!s.current)return;l(!0);const n=document.createElement("p");let i=0;const a=()=>{const e=i,o=Math.min(t.length,i+5e3),r=t.slice(e,o),c=document.createElement("span");c.textContent=r,n.appendChild(c),i=o,i<t.length?requestAnimationFrame(a):requestAnimationFrame(()=>{s.current&&(s.current.textContent="",s.current.append(...n.childNodes),d()),l(!1)})};a()})(e),c.current=e)},[e,t,n]);const h=_({lineHeight:t?"24px":"28px"},a),p="whitespace-pre-wrap user-message-content "+(t?"":"fade-in");return tn.jsx("p",{ref:s,className:`${p} ${i}`,style:h})},MG=({message:e,handleDeleteMessage:t,isOldMessageInNewBranch:n})=>{var i,a,o,s,r;const l=G(),{content:c,files:u,extra:d}=e,h=xE(e=>e.user),p=Wb(e=>e.chatId),m=Wb(e=>e.isChat),f=Wb(e=>e.history),g=Wb(e=>e.setEmitSendPromptType),v=dT(e=>e.voicePlayingMessageId),[y,b]=O.useState(""),[x,w]=O.useState(!1),[S,E]=O.useState(!1),k=O.useRef(!1),[I,T]=O.useState(!1),j=tx(e=>e.mobile),N=rx(),M=yE(e=>e.isSharePage),A=aI(e=>e.models),R=O.useMemo(()=>!0,[j,M]),D=t=>{var n,i;const a=k_(JSON.stringify(t),{}),o=A.filter(t=>e.models.includes(t.id));if(!(o.some(e=>{var t,n,i;return 2===(null==(i=null==(n=null==(t=e.info)?void 0:t.meta)?void 0:n.abilities)?void 0:i.parse_url)})||o.some(e=>{var t,n,i;return 3===(null==(i=null==(n=null==(t=e.info)?void 0:t.meta)?void 0:n.abilities)?void 0:i.parse_url)})&&(null==(n=e.feature_config)?void 0:n.thinking_enabled))&&(s=a.content,RE(s).length>0)){T(!0);const e=ME(a.content,null==(i=a.extra)?void 0:i.url_parse_result);return C(_({},a),{parseResult:e})}return T(!1),a;var s},L=e=>e===og.SUCCESS||e===og.PARSING,F=O.useMemo(()=>D(e),[e.id]),U=O.useMemo(()=>!(!e.sub_chat_type||![eg.OmniAudio,eg.OmniVideo].includes(e.sub_chat_type)),[e.sub_chat_type]),z=O.useMemo(()=>Array.isArray(c)?"":U?c?`${c}`:l.t("Transcript not available"):c,[c,l,U]),H=O.useMemo(()=>{var t;let n=f.messages[f.currentId||""];for(;n&&(null==n?void 0:n.parentId)!==(e.id||e.fid);)n=f.messages[n.parentId||""];return["RateLimited","ParallelLimited","data_inspection_failed"].includes((null==(t=null==n?void 0:n.error)?void 0:t.errorCode)||"")},[f.currentId,f.messages,e.fid,e.id]),$=O.useMemo(()=>{var t;return U&&(e=>{const t=Math.floor(e/1e3),n=Math.floor(t/60),i=t%60;return`${String(n).padStart(2,"0")}:${String(i).padStart(2,"0")}`})(null==(t=null==e?void 0:e.extra)?void 0:t.timecost)},[U,null==(i=null==e?void 0:e.extra)?void 0:i.timecost]),B=(t,n=!0)=>P(void 0,null,function*(){if(bx()&&!k.current)return;E(!1),g(Qf.EDIT);const i=t.replace(/\s+/g,"");if((null==t?void 0:t.trim())&&0!==i.length)if(t.length>sg)ut.open({type:"error",content:l.t("Prompt cannot exceed {{value}} characters.",{value:sg})});else{if(!n){const n=nG(e),{success:i,data:a}=yield IS({origin_content:n,new_content:t});if(!i&&"data_inspection_passed"!==a.code)return}((e,t,n=!0)=>{P(void 0,null,function*(){const i=Wb.getState().history;oT.editMessage({messageId:e,content:t,history:i,submit:n})})})(e.id,t,n),w(!1),b(""),e.childrenIds.includes(v)&&Jk.getInstance().stopAllPlayer()}else ut.open({type:"error",content:l.t("The content cannot be empty!")})});O.useEffect(()=>{k.current=S},[S]);let q=null;return tn.jsxs(Z,{gap:10,className:"chat-user-message-container-wrapper",children:[!R&&tn.jsx(vq,{user:h,menu:!1}),tn.jsxs("div",{className:J("chat-user-message-container",{"chat-user-message-container-nobubble":!R}),children:[tn.jsx(Vq,{timeClassName:"chat-user-message-header-timestamp",username:null==h?void 0:h.name,timestamp:e.timestamp,isBubbleMode:R,timecost:$}),tn.jsx(Bq,{messageId:e.id,files:u,isBubbleMode:R}),(null==(a=null==d?void 0:d.meta)?void 0:a.quoteText)&&tn.jsxs("div",{className:"quote-text-item-btn",onClick:()=>{var t,n,i,a,o,s;q&&(clearTimeout(q),q=null);const r=e.extra,l=document.getElementById(`qwen-chat-message-user-${null==(t=null==r?void 0:r.meta)?void 0:t.quoteId}`)||document.getElementById(`qwen-chat-message-assistant-${null==(n=null==r?void 0:r.meta)?void 0:n.quoteId}`),c=document.getElementById("chat-messages-scroll-container"),u=document.getElementById("chat-message-container");if(u&&l){const e=l.getBoundingClientRect(),t=u.getBoundingClientRect(),n={top:e.top-t.top,left:e.left-t.left,bottom:e.bottom-t.bottom,right:e.right-t.right};c.scrollTo({top:(null==(i=null==r?void 0:r.meta)?void 0:i.position)+n.top+40,behavior:"smooth"});const d=document.createRange(),h=null==(a=null==l?void 0:l.querySelector(".response-message-content"))?void 0:a.querySelector(".qwen-markdown");if(!h||!(null==(o=null==r?void 0:r.meta)?void 0:o.quoteIndex))return;try{const e=(null==(s=h.textContent)?void 0:s.length)||0,t=Math.min(r.meta.quoteIndex,e),n=Math.min(r.meta.quoteIndex+1,e);d.setStart(h,t),d.setEnd(h,n);const i=window.getSelection();i.removeAllRanges(),i.addRange(d),q=setTimeout(()=>{i.removeAllRanges(),q=null},3e3)}catch(qY){}}},children:[tn.jsx(dt,{type:"icon-line-arrow-curve-left-right",className:"quote-icon"}),tn.jsx("div",{className:"fileitem-file-name",children:tn.jsx("div",{className:"fileitem-text-name-text",children:null==(o=null==d?void 0:d.meta)?void 0:o.quoteText})})]}),x?tn.jsx(Ae,{value:y,open:!0,onOk:e=>{B(e||"",!0)},onCancel:()=>{b(""),w(!1)},okText:l.t("Send"),cancelText:l.t("Cancel"),showExtra:!1}):tn.jsxs(tn.Fragment,{children:[!!z&&tn.jsx(NG,{children:tn.jsx(Z,{className:"chat-user-message-wrapper",justify:R?"flex-end":"flex-start",children:(null==(s=null==F?void 0:F.parseResult)?void 0:s.length)?tn.jsx("p",{className:"chat-user-message",children:F.parseResult.map(e=>"url"===e.type?tn.jsx(ft,{style:{display:"inline-block"},className:"tooltip-box",title:e.title,children:tn.jsx("a",{className:`url-analyze url-analyze-${e.status}`,href:L(e.status)?e.content:void 0,target:"_blank",onClick:()=>{var t;if(j&&!L(e.status)&&ut.open({type:"warning",content:null!=(t=e.title)?t:""}),bx()&&L(e.status)){const t=`qwen://web?url=${encodeURIComponent(e.content)}`;oT.adapter.invoke({method:"openWindow",params:{uri:t}})}},children:tn.jsx("span",{style:{whiteSpace:"pre"},children:e.content.trim()})})},e.content):tn.jsx("span",{children:e.content},e.content))}):tn.jsx("div",{className:"chat-user-message",children:tn.jsx(PG,{hasQuoteText:null==(r=null==d?void 0:d.meta)?void 0:r.quoteText,content:z,isMobile:j,isIos:N,className:J({"chat-user-message-text-renderer-omni":U,"chat-user-message-text-renderer-omni-available":U&&!c})})})})}),tn.jsx(jG,{showActionControl:!!z,message:e,isFirstMessage:null===e.parentId,isChatIntercept:H,isOmni:U,handleEditMessage:()=>{if(BS("clkReviseMsg",{params:{et:"CLK",c4:"query"},aesParams:{c5:p,c6:`${null==e?void 0:e.id}`},paramsExtend:{chat_id:p,msg_id:`${null==e?void 0:e.id}`}}),m||Zb.getState().visionGenerating)return void ut.open({type:"warning",content:l.t("In the conversation, please wait a moment.")});oT.closeShowControls();const t=e.content;bx()?(E(!0),oT.firstOn(qC.MESSAGE_EDIT_SAVE,e=>B(e)),oT.adapter.invoke({method:"openHalfWindow",params:{type:"edit",content:t,ext:""}})):(b(t),w(!0))},isOldMessageInNewBranch:n,handleDeleteMessage:()=>{t(e.id)}})]})]})]})};aG(MG);const AG=e=>{var t,n,i;const{message:a,children:o,phase:s,boxId:r}=e,l=tx(e=>e.config),c=Wb(e=>e.isChat),u=Wb(e=>e.setEmitSendPromptType),d=yE(e=>e.isSharePage),h=aI(e=>e.selectedModelIds),p=Wb(e=>e.branchInfo),m=Zb(e=>e.setSelectedText),f=Zb(e=>e.setSelectedTextPosition),g=Zb(e=>e.setSelectedTextId),v=Zb(e=>e.setSelectedTextIndex),{i18n:y}=G(),[b,x]=O.useState(""),w=O.useCallback(e=>{oT.setSelectLocalLanguageCode(e),x(e)},[]),S=O.useCallback(()=>P(void 0,null,function*(){if(null==l?void 0:l.language){const e=yield oT.getSelectLocalLanguageCode(l,y.language);w(e)}}),[l,y,w]),_=O.useMemo(()=>{var e,t,n,i,o;return a.chat_type===Zf.DeepResearch&&(null==(t=null==(e=a.extra)?void 0:e.meta)?void 0:t.subChatType)===Zf.DeepThinking||a.chat_type===Zf.Travel&&(null==(i=null==(n=a.extra)?void 0:n.meta)?void 0:i.subChatType)===Zf.TRAVEL_FEEDBACK||a.isMultiResponse?[{key:Re.copy,text:y.t("Copy")}]:(null==(o=null==l?void 0:l.language)?void 0:o.length)&&"deep_research"!==a.chat_type&&"travel"!==a.chat_type?[{key:Re.copy,text:y.t("Copy")},{key:Re.ask,text:y.t("Ask Qwen")},{key:Re.explain,text:y.t("Explain")},{key:Re.translate,text:y.t("Translate")}]:[{key:Re.copy,text:y.t("Copy")},{key:Re.ask,text:y.t("Ask Qwen")},{key:Re.explain,text:y.t("Explain")}]},[a.chat_type,null==(n=null==(t=a.extra)?void 0:t.meta)?void 0:n.subChatType,a.isMultiResponse,null==(i=null==l?void 0:l.language)?void 0:i.length,y]),C=O.useMemo(()=>c||d||(null==p?void 0:p.isTemp),[c,p,d]);O.useEffect(()=>{(null==l?void 0:l.language)&&S()},[l,S]);const E=O.useCallback(e=>{E_((e=>(Wb.getState().currentInputFeature===Zf.WebSearch?ev(e,"numberAndEntry"):e)||"")(e))},[]),k=O.useCallback((e,t,n,i,a)=>{m(e),u(Qf.ASK),f(i),g(n),v(a)},[a.id]),I=O.useCallback(e=>{const t={type:"explain",messageId:a.id||void 0,content:{text:e}};u(Qf.EXPLAIN),oT.seleteOperation(t)},[a.id]),T=O.useCallback((e,t)=>{var n,i;if(w(e),!l)return;const o=l.language,s={type:"translate",messageId:a.id,extra:ZE(e),content:{text:ek(y.t("Translate the following text into {{lang}}.",{lang:null!=(i=null==(n=o.find(t=>t.code===e))?void 0:n.title)?i:""}),`${y.t("TextTranslate")}${t}`,o.find(t=>t.code===e))}};u(Qf.TRANSLATE),oT.seleteOperation(s)},[w,l,a.id,y,u]);return tn.jsx(Oe,{className:`response-message-content ${a.sub_chat_type} phase-${s}`,id:`chat-response-message-${a.id||""}`,menuId:a.id||"",disabledContainer:C,offset:h.length>1?28:10,boxId:r,menuList:_,languageCode:b,languages:(null==l?void 0:l.language)||[],onAskHandler:k,onCopyHandler:E,onExplainHandler:I,onTranslateHandler:T,askInputPlaceholder:y.t("Ask a question"),children:o})},RG=e=>{const{message:t}=e,n=Zb(e=>e.taskRunning),i=O.useRef(null),a=O.useRef(t),o=O.useCallback(()=>{var e,t;return(null==(e=a.current)?void 0:e.error)?"error":(null==(t=a.current)?void 0:t.done)?"done":n?"loading":"pause"},[n]),s=O.useCallback(e=>P(void 0,null,function*(){var t,n,r,l,c;if(!a.current)return;const{type:u,contentIndex:d}=e,h=o(),p=!!(null==(n=null==(t=a.current)?void 0:t.feature_config)?void 0:n.thinking_enabled);let m=[];if(void 0!==d&&u===tg.WebSearch)m=(null==(c=null==(l=null==(r=a.current.content_list)?void 0:r[d])?void 0:l.extra)?void 0:c.web_search_info)||[];else{const e=oT.collectAllSearchAndThinList([a.current],!1);m=u===tg.WebSearch?e[a.current.id||""].webSearchInfo||[]:e[a.current.id||""].contentList||[]}rI(tg.Artifacts),oT.adapter.invoke({method:"storeInfo",params:{key:rI([tg.ThinkingAndSearch,tg.Thinking].includes(u)?tg.Thinking:tg.WebSearch),value:JSON.stringify({originsList:m,type:u,currentId:a.current.id,status:h})}}),clearTimeout(i.current),"loading"===h&&p&&(i.current=setTimeout(()=>{s(e)},1e3))}),[o]),r=O.useCallback(e=>{const{type:t,currentTab:n,citationIndex:i}=e;s(e),oT.adapter.invoke({method:"openHalfWindow",params:{type:"openUrl",content:`${lI(t)}?tab=${n}&citation_index=${i}`}})},[s]);return O.useEffect(()=>()=>{clearTimeout(i.current)},[]),O.useEffect(()=>{a.current=t},[t]),{openNativePopup:r}},OG=e=>{switch(e.toLowerCase()){case"javascript":return".js";case"typescript":return".ts";case"java":return".java";case"python":return".py";case"c":return".c";case"c++":case"cpp":return".cpp";case"c#":case"csharp":return".cs";case"go":return".go";case"rust":return".rs";case"php":return".php";case"ruby":return".rb";case"swift":return".swift";case"kotlin":return".kt";case"scala":return".scala";case"html":return".html";case"css":return".css";case"less":return".less";case"scss":return".scss";case"json":return".json";case"markdown":case"md":return".md";case"xml":return".xml";case"yaml":return".yaml";case"sql":return".sql";case"bash":case"sh":return".sh";case"perl":return".pl";case"r":return".r";case"matlab":case"objective-c":case"objc":return".m";case"dart":return".dart";case"lua":return".lua";case"groovy":return".groovy";case"typescript-definition":case"d.ts":return".d.ts";case"vue":return".vue";case"svelte":return".svelte";case"jsx":return".jsx";case"tsx":return".tsx";case"dockerfile":return"Dockerfile";case"makefile":return"Makefile";case"gitignore":return".gitignore";case"editorconfig":return".editorconfig";case"eslintconfig":case"eslintrc":return".eslintrc";case"prettierconfig":case"prettierrc":return".prettierrc";case"babelconfig":case"babelrc":return".babelrc";case"webpackconfig":return"webpack.config.js";case"jestconfig":return"jest.config.js";case"viteconfig":return"vite.config.js";case"nextconfig":return"next.config.js";case"angularconfig":case"angularconfigts":return"angular.json";case"reactconfig":return"react.config.js";case"vueconfig":return"vue.config.js";case"svelteconfig":return"svelte.config.js";case"gulpfile":return"gulpfile.js";case"gruntfile":return"Gruntfile.js";case"npmconfig":case"package.json":return"package.json";case"yarnconfig":case"yarn.lock":return"yarn.lock";case"bowerconfig":case"bower.json":return"bower.json";case"webpackconfigts":return"webpack.config.ts";case"jestconfigts":return"jest.config.ts";case"viteconfigts":return"vite.config.ts";case"nextconfigts":return"next.config.ts";case"reactconfigts":return"react.config.ts";case"vueconfigts":return"vue.config.ts";case"svelteconfigts":return"svelte.config.ts";case"gulpfilets":return"gulpfile.ts";case"gruntfilets":return"Gruntfile.ts";default:return".txt"}},DG=(e,t,n)=>{const i=Y().format("YYYYMMDD"),a=Math.random().toString(36).substr(2,9),o=OG(n)||".txt",s=`${t}_${n}_${i}_${a}${o}`,r=new Blob([e],{type:`text/${o.replace(/^\./,"")}`}),l=window.URL.createObjectURL(r),c=document.createElement("a");c.href=l,c.download=s,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(l)},LG=H.memo(e=>{var t;const{className:n="",hostList:i=[],onClick:a=()=>{},onHostNameClick:o=()=>{}}=e,s=tx(e=>e.mobile),[r,l]=O.useState(!1),c=O.useRef(null),u=O.useMemo(()=>(null==i?void 0:i.length)>1,[i]),[d,h]=O.useState(0),p=O.useCallback(e=>new URL((e||"").trim()).hostname||"",[]),m=O.useMemo(()=>{const e=i[d];return C(_({},e),{hostOriginName:p((null==e?void 0:e.url)||"")})},[d,p,i]),f=O.useCallback(e=>{let t="prev"===e?d-1:d+1;t<0&&(t=0),t>=i.length&&(t=i.length-1),h(t)},[d,i.length]),g=O.useMemo(()=>[{icon:"icon-line-chevron-left",disabled:0===d,onClick:()=>{f("prev")}},{icon:"icon-line-chevron-right",disabled:d===i.length-1,onClick:()=>{f("next")}}],[d,i.length,f]),v=O.useMemo(()=>{var e,t;return tn.jsxs("div",{className:J("qwen-chat-markdown-tokens",n),onClick:o,children:[tn.jsx("div",{className:"qwen-chat-markdown-tokens-hostname ",children:(null==(e=i[0])?void 0:e.hostname)||p(null==(t=i[0])?void 0:t.url)}),u&&tn.jsxs("div",{className:"qwen-chat-markdown-tokens-hostname-more",children:["+",i.length-1]})]})},[n,p,i,o,u]),y=O.useCallback(e=>{try{return decodeURIComponent(e)}catch(qY){return e}},[]);return O.useEffect(()=>{if(!r)return;const e=requestAnimationFrame(()=>{setTimeout(()=>{const e=c.current.popupElement;if(e){const t=20,n=((e,t=1)=>{if(!(e instanceof HTMLElement))return"none";const n=e.getBoundingClientRect(),i=n.left<=t,a=window.innerWidth-n.right<=t;return i?"left":a?"right":"none"})(e,t);if("none"===n)return;e.style.inset=e.style.inset.replace(/(\d+)px$/,(e,i)=>`${parseInt(i,10)+t*("right"===n?-1:1)}px`)}},0)});return()=>cancelAnimationFrame(e)},[r]),s?v:tn.jsx(ae,{trigger:"hover",open:r,ref:c,onOpenChange:l,rootClassName:"qwen-chat-comp-markdown-tokens-container",content:tn.jsxs("div",{children:[tn.jsxs(Z,{vertical:!0,gap:8,onClick:()=>a(m.url),className:"qwen-chat-markdown-tokens-popover-content",children:[tn.jsxs(Z,{align:"center",justify:"space-between",children:[tn.jsxs(Z,{align:"center",justify:"center",gap:4,children:[tn.jsx(oG,{src:(null==(t=i[d])?void 0:t.icon)||""}),tn.jsx("div",{className:"qwen-chat-markdown-tokens-container-hostname",children:m.hostname?m.hostname:y(m.url)})]}),tn.jsx(dt,{className:"qwen-chat-markdown-tokens-container-icon",type:"icon-line-arrow-up-right"})]}),tn.jsx("div",{className:"qwen-chat-markdown-tokens-container-title",children:m.title}),tn.jsx("div",{className:"qwen-chat-markdown-tokens-container-detail",children:m.description})]}),u&&tn.jsxs("div",{className:"markdown-tokens-container-switch",children:[tn.jsx("div",{className:"markdown-tokens-container-switch-left",children:g.map(e=>tn.jsx("div",{className:J("markdown-tokens-container-switch-container",{"markdown-tokens-container-switch-container-disabled":e.disabled}),onClick:e.onClick,children:tn.jsx(dt,{className:"markdown-tokens-container-switch-icon",type:e.icon})},e.icon))}),tn.jsxs("div",{className:"markdown-tokens-container-switch-right",children:[d+1,"/",i.length]})]})]}),arrow:!1,classNames:{root:"qwen-chat-markdown-tokens-container"},placement:"bottom",children:v})}),FG=e=>{var t,n;const{message:i,phaseContentIndex:a,content:o}=e,s=(null==(t=i.content_list)?void 0:t[a])||{content:o},{i18n:r}=G(),{openNativePopup:l}=RG({message:i}),c=yE(e=>e.realTheme),u=tx(e=>e.mobile),d=Zb(e=>e.setCurrentShowControl),h=Wb(e=>e.setCurrentCitationInfo),p=yE(e=>e.setShowControls),m=yE(e=>e.setShowSharePanel),f=Wb(e=>e.allSearchAndThinkLists),g=Zb(e=>e.setCurrentActionMessageId),v=O.useMemo(()=>!i.done,[i.done]),y=O.useMemo(()=>{var e,t;if(Array.isArray(null==s?void 0:s.content))return"";let n=(null==s?void 0:s.content)||"";return Array.isArray(null==(e=null==s?void 0:s.extra)?void 0:e.prev_round_image_list)&&(n=(null==(t=null==s?void 0:s.extra)?void 0:t.prev_round_image_list.map(e=>`![](${e})`).join("\n"))+"\n"+n),n},[s]),b=Aq({mediaType:"image",messageId:i.id,preview:{actions:["download"],tip:""}}),x=O.useCallback(e=>P(void 0,null,function*(){(yield C_(e))&&ut.openOnce({type:"success",content:r.t("Copying to clipboard was successful!")})}),[r]),w=O.useCallback((e,t="")=>{const n=new Date,i=`Qwen_${t}_${`${n.getFullYear()}${String(n.getMonth()+1).padStart(2,"0")}${String(n.getDate()).padStart(2,"0")}`}_${Math.random().toString(36).slice(-9)}${OG(t)}`;ax.saveAs(new Blob([e],{type:"text/plain;charset=utf-8"}),i)},[]),S=O.useMemo(()=>{var e;return!!(null==(e=null==i?void 0:i.feature_config)?void 0:e.thinking_enabled)},[null==(n=null==i?void 0:i.feature_config)?void 0:n.thinking_enabled]),E=O.useCallback(e=>{var t,n,a,o,s,r;if(i.chat_type===Zf.DeepResearch){const l=null==(n=null==(t=null==oT?void 0:oT.getChatOptions())?void 0:t.history)?void 0:n.messages[(null==i?void 0:i.id)||""],c=null==(r=null==(s=null==(o=null==(a=null==l?void 0:l.content_list)?void 0:a.find(e=>e.phase===ng.ANSWER))?void 0:o.extra)?void 0:s.deep_research)?void 0:r.references;m(!0),oT.emit(GC.SOURCE_CILCK,{Tab:De.sources,citationIndex:Number(e)||0,list:c})}else{if(bx())return void l({type:S?tg.ThinkingAndSearch:tg.WebSearch,currentTab:De.sources,citationIndex:Number(e)});m(!0),p(!0),d(S?tg.ThinkingAndSearch:tg.WebSearch),h({messageId:i.id||"",citationIndex:Number(e),tab:De.sources})}},[i.chat_type,i.id,l,h,d,p,m,S]),k=O.useCallback((e=0)=>{if(bx())return void l({type:tg.WebSearch,currentTab:De.sources,citationIndex:e});p(!0);const t=u||i.chat_type===Zf.DeepResearch?tg.WebSearch:tg.ThinkingAndSources;d(t),h({messageId:i.id||"",citationIndex:e,tab:De.sources}),g(null==i?void 0:i.id)},[i.chat_type,i.id,u,l,g,h,d,p]),I=O.useMemo(()=>{var e;return(null==(e=null==f?void 0:f[(null==i?void 0:i.id)||""])?void 0:e.webSearchInfo)||[]},[f,null==i?void 0:i.id]),T=O.useMemo(()=>({code:{headerActionsRender:e=>tn.jsxs(tn.Fragment,{children:[tn.jsx(ft,{title:r.t("Copy"),children:tn.jsx("div",{className:"qwen-markdown-code-header-action-item",onClick:()=>x(e.text),children:tn.jsx(dt,{type:"icon-line-copy-right"})})}),!u&&tn.jsx(ft,{title:r.t("Download"),children:tn.jsx("div",{className:"qwen-markdown-code-header-action-item",onClick:()=>w(e.text,e.lang),children:tn.jsx(dt,{type:"icon-line-download-02"})})})]}),theme:c},codespan:{onClick:e=>P(void 0,[e],function*({text:e}){(yield C_(e))&&ut.openOnce({type:"success",content:r.t("Copying to clipboard was successful!")})})},image:_({onError:()=>({errorMessage:r.t("Image Load Error")}),controls:{download:{onDownload(e){["img.alicdn.com","image.qwenlm.ai/public_source"].find(t=>e.includes(t))?W_(e):K_({role:"assistant",url:e})}}}},b),table:{headerActionsRender:fx()?void 0:e=>tn.jsx(tn.Fragment,{children:tn.jsx(yt,{placement:"bottomRight",menu:{items:[{key:"csv",label:tn.jsx("div",{className:"qwen-markdown-table-header-export-item",onClick:()=>{const t=`table-${i.id||""}.csv`;T_(e,t)},children:r.t("Export to CSV")})},{key:"excel",label:tn.jsx("div",{className:"qwen-markdown-table-header-export-item",onClick:()=>{const t=`table-${i.id||""}.xlsx`;j_(e,t)},children:r.t("Export to Excel")})}]},getPopupContainer:e=>e||document.body,children:tn.jsx("div",{className:"qwen-markdown-table-header-action-item",children:tn.jsx(dt,{type:"icon-line-download-02"})})})})},citation:{visible:!jt(I),onClick:e=>E(e),contentRender:e=>{const t=e.map(e=>{if(!Array.isArray(I)||!I.length)return null;const t=I[Number(e)-1];if(!t)return null;const{snippet:n}=t;return C(_({},t),{description:n,hostIndex:e})}).filter(e=>e);return u?t.map(e=>tn.jsx("div",{className:"qwen-markdown-citation-item",children:tn.jsx(LG,{hostList:[e],onHostNameClick:()=>{k(Number(null==e?void 0:e.hostIndex)||0)}})},null==e?void 0:e.url)):t.length?tn.jsx(LG,{hostList:t,onClick:e=>window.open(e),onHostNameClick:()=>{var e;k(Number(null==(e=t[0])?void 0:e.hostIndex)||0)}}):null}}}),[c,u,b,r,x,w,i.id,E,I,k]);return tn.jsx("div",{className:"custom-qwen-markdown",children:tn.jsx(Le,{content:y,loose:!["ja-JP","ko-KR","zh-CN","zh-TW"].includes(r.language),tokenProps:T,styleProps:{showAnimation:v}})})},UG={"zh-cht":"",zh:"",en:"Research Planning",fr:"Planification de la recherche",de:"Forschungsplanung",it:"Pianificazione della ricerca",ja:"",ko:" ",pt:"Planeamento da Pesquisa",ar:"Planning for research",ru:" ",es:"Planificacin de la investigacin"},zG={"zh-cht":"",zh:"",en:"Summary",fr:"Rsum",de:"Zusammenfassung",it:"Riepilogo",ja:"",ko:"",pt:"Resumo",ar:"",ru:"     ().",es:"Resumen"},HG=(e,t,n)=>n?`${n} \n`:"";function $G(e,t){const n=[];return t.forEach(t=>{Object.prototype.hasOwnProperty.call(e,t)&&n.push(e[t])}),n}function BG(e,t){var n;return(null==(n=null==e?void 0:e.scrape)?void 0:n.map(e=>t[e]))||[]}const qG=["researchGoal","pageContent","codeContent","searchContent","webSites","learnings","learningMap"],GG=(e,t)=>{const n=[...e],i="v4"===t?"researchGoal":"searchContent",a=n.indexOf(i);return-1!==a&&n.splice(a+1,0,"webSites"),n},VG=e=>{var t,n,i,a,o,s;const r=[],l=null!=(n=null==(t=null==e?void 0:e[0])?void 0:t.lang_code)?n:"en",c=null!=(s=null==(o=null==(a=null==(i=null==e?void 0:e[0])?void 0:i.extra)?void 0:a.deep_research)?void 0:o.version)?s:"v1";for(let d=0;d<e.length;d++){const t=e[d],{phase:n,status:i,content:a,extra:o}=t,{deep_research:s,travel_research:u}=o||{},h=s||u;switch(n){case ug.ResearchPlanning:r.push({stage:n,title:(null==h?void 0:h.title)||(null==UG?void 0:UG[l])||n,content:HG(0,null==h||h.id,a),status:"finished"===i?"finish":"process",id:(null==h?void 0:h.id)||n,phase:n});break;case ng.INTERRUPTRECEIVED:r.push({stage:n,title:"Additional context added",content:"",status:"finished"===i?"finish":"process",id:(null==h?void 0:h.id)||n,phase:n});break;case ng.ANSWER:r.push({stage:n,title:(null==zG?void 0:zG[l])||n,content:"",status:"finished"===i?"finish":"process",id:(null==h?void 0:h.id)||n,phase:n});break;default:Array.isArray(h)&&h.forEach(e=>{const{id:t=ot(),query:i,learnings:a="",researchGoal:o="",pageContent:s="",codeContent:l="",searchContent:u="",runningIds:d,learningMap:h,webSites:p,status:m,sortKeys:f}=e;let g=a;if(h&&d){g=BG(d||{scrape:[]},h||{}).join("\n")}const v=$G({researchGoal:HG(0,0,o),pageContent:HG(0,0,s),codeContent:HG(0,0,l),searchContent:HG(0,0,u),webSites:p,learnings:HG(0,0,g),learningMap:HG(0,0,g)},f?GG(f,c):qG);r.push({stage:n,title:i,researchGoal:o,pageContent:s,codeContent:l,learnings:a,webSites:p,status:"finished"===m||"WebResultFinished"===m?"finish":"process",id:t,phase:n,content:v})})}}const u=[];for(const d of r){if("finish"!==d.status){u.push(d);break}u.push(d)}return u},WG={"zh-cht":"",zh:"",en:"Visited URLs",fr:"URL visits",de:"Besuchte URLs",it:"URL visitate",ja:"",ko:" URL",pt:"URLs visitados",ar:"  visited     ()",ru:" URL-",es:"URLs visitados"},QG=O.memo(({contentList:e,timestamp:t,endTime:n,messageId:i,isRenderError:a,subChatType:o,isRunning:s,isMessageStopped:r})=>{const l="pc-research-panel-content",[c,u]=O.useState([]),[d,h]=O.useState(!1),[p,m]=O.useState(!1),[f,g]=O.useState([]),[v,y]=O.useState([]),b=tx(e=>e.mobile),x=Zb(e=>e.setCurrentShowControl),w=Zb(e=>e.currentShowControl),S=Zb(e=>e.isPdfCardVisible),_=Zb(e=>e.setPDFViewInfo),C=Zb(e=>e.setIsSourcesVisible),E=yE(e=>e.setShowControls),k=yE(e=>e.setDeepDetailTitle),I=Wb(e=>e.setCurrentSearchSource),T=Wb(e=>e.setCurrentCitationInfo),j=Wb(e=>e.setCurrentSearchLists),N=Zb(e=>e.setCurrentDPLanguageCode),{i18n:P}=G(),M=Wb(e=>e.chatId),A=yE(e=>e.showControls),R=O.useRef(null),D=O.useRef([]),L=O.useRef([]),F=O.useRef(!1),U=O.useRef(null),z=O.useCallback(e=>VG(e).map(t=>{var n,i;return t.title&&(t.title=P.t(t.title),t.lang_code=(null==(n=null==e?void 0:e[0])?void 0:n.lang_code)||"en",t.linkCardTitle=WG[null==(i=null==e?void 0:e[0])?void 0:i.lang_code]||"Visited URLs"),t.phase===ng.INTERRUPTRECEIVED&&(t.icon=tn.jsx(dt,{type:"icon-line-message-circle-02"}),t.content=tn.jsx("div",{style:{height:20}})),t}),[P]),H=O.useCallback(e=>{var t,n,a;j({[i]:z(e)});const o=null==(a=null==(n=null==(t=e.find(e=>e.phase===ng.ANSWER))?void 0:t.extra)?void 0:n.deep_research)?void 0:a.references;y(o);const s=!!e.find(e=>e.phase===ng.ANSWER&&e.content);h(s);const r=z(e);g(r);const l=!r.filter(e=>"process"===e.status);m(l)},[z]);O.useEffect(()=>{Array.isArray(c)&&H(c)},[c,H]);const $=O.useMemo(()=>{const e=oT.getCurrentChatsubChatType(),t=mg(e)||e===Zf.INTERRUPT;return!(!s||!t||a)},[s,a]),B=O.useCallback(({tab:e=De.step,action:t="open",citationIndex:n=0})=>{var s,r;if(!Array.isArray(c))return;u(L.current);const l=(null==(r=null==(s=L.current)?void 0:s[0])?void 0:r.lang_code)||"en";N(Yb[l]||Yb.en);let d=$?"running":"finished";if($||S?(!$&&S&&p||a)&&(d="error"):d="stop",!bx())return;const h={key:rI(tg.DeepResearch),value:JSON.stringify({contentList:L.current,status:d,currentId:i,messageType:o})};oT.adapter.invoke({method:"storeInfo",params:h}),"open"===t&&oT.adapter.invoke({method:"openHalfWindow",params:{type:"openUrl",content:`${lI(tg.DeepResearch)}?id=${M}&tab=${e}&messageId=${i}&citation_index=${n}`}})},[c,$,S,p,a,i,M,oT,o]),q=O.useCallback(e=>{const{list:t,tab:n,citationIndex:a=0}=e||{};if(bx())B({tab:n||De.sources,citationIndex:a});else if(b){oT.closeShowControls(),T({messageId:i,citationIndex:a,tab:De.sources});const e=Array.isArray(t)?t:v;I({[i]:e,type:tg.DeepResearchLinkSource}),E(!0),x(tg.DeepResearchLinkSource)}else{oT.closeShowControls(),T({messageId:i,citationIndex:a,tab:De.sources});const e=Array.isArray(t)?t:v;I({[i]:e,type:tg.DeepResearch}),E(!0),x(tg.DeepResearch)}},[v,i,b,B,T,I,E,x]);O.useEffect(()=>(oT.on(GC.SOURCE_CILCK,q),()=>{oT.off(GC.SOURCE_CILCK,q)}),[oT,q]),O.useEffect(()=>()=>{E(!1),x(tg.None)},[]);const V=e=>{e.deltaY<0&&(U.current&&clearTimeout(U.current),F.current=!0,U.current=setTimeout(()=>{F.current=!1},5e3))},W=O.useCallback(()=>{var e;const t=document.getElementById(l),n="finished"===(null==(e=(L.current||[]).find(e=>e.phase===ng.PdfMdGen))?void 0:e.status);t&&t.addEventListener("wheel",V),n?R.current&&clearInterval(R.current):R.current=setInterval(()=>{const e=JSON.stringify(L.current);e!==D.current&&(D.current=e,B({tab:De.step,action:"update"}),setTimeout(()=>{var e;s&&(e=t,F.current||null==e||e.scrollTo({top:e.scrollHeight,behavior:"smooth"}))},100))},100)},[l,s,B]);O.useEffect(()=>{L.current=e},[e]);const Q=O.useRef(void 0);O.useEffect(()=>{Q.current!==$&&(Q.current=$,$?(R.current&&clearInterval(R.current),W()):(R.current&&clearInterval(R.current),B({tab:De.step,action:"update"})))},[$,B,W]),O.useEffect(()=>()=>{R.current&&clearInterval(R.current),C(!1),_(null)},[]);const K=O.useMemo(()=>!$&&r,[$,r]),Y=O.useMemo(()=>{let e="";return e=$?o===Zf.DeepResearch?`${P.t("Deep Research")}...`:`${P.t("Travel Research")}...`:K?o===Zf.DeepResearch?P.t("Deep Research Stopped"):P.t("Travel Research Stopped"):a?o===Zf.DeepResearch?P.t("Deep Research Failed"):P.t("Travel Research Failed"):o===Zf.DeepResearch?P.t("Deep Research Completed"):P.t("Travel Research Completed"),k(e),e},[$,K,a,P,o]),X=O.useMemo(()=>$?"running":!$&&S?"finished":"stop",[$,S]),[J,Z]=O.useState(!$),ee=(e=!0)=>{e&&oT.closeShowControls(),Z(!0)},te=e=>{(void 0!==e?e:!(A&&w===tg.DeepResearchDetail))?(T({messageId:i,citationIndex:0,tab:De.step}),E(!0),Z(!1),x(tg.DeepResearchDetail),j({[i]:z(c)})):ee()};O.useEffect(()=>{$&&!b&&te(!0)},[$,b]),O.useEffect(()=>{if(oT)return oT.on(qC.MESSAGE_DEEP_RESEARCH_CLOSE_DETAIL,ee),()=>{null==oT||oT.off(qC.MESSAGE_DEEP_RESEARCH_CLOSE_DETAIL,ee)}},[oT]);return tn.jsx(Fe,{texts:{detail:P.t("Details")},loading:$,onStepsChange:(e,t,n)=>{oT.emit(qC.MESSAGE_STOP_SCROLL_TO_BOTTOM);const i=document.getElementById("research-panel-detail-content"),a=document.getElementById(`${Ue.markdown}_deepDetail_${t.id}`);i&&a&&function(e,t,n=0){if(!e||!t)return;const i=t.getBoundingClientRect(),a=e.getBoundingClientRect(),o=i.top-a.top+e.scrollTop-n;null==e||e.scrollTo({top:o,behavior:"smooth"})}(i,a,0)},cardType:"list",sourceList:v,timestamp:t,endTime:n,searchTitle:Y,deepResearchList:f,showAll:J,disableAlls:!d,contentId:l,displayDrawer:!0,cardStatus:X,onSourcesCilck:q,onAllChange:e=>{Z(e)},onLinkCard:e=>{Array.isArray(e)?q({list:e}):window.open(e.url)},onCardClick:()=>{q({tab:De.step}),T({messageId:i,citationIndex:0,tab:De.step})},onDetailClick:()=>{te()},webSourceOption:{noSourceText:P.t("no sources"),headerTitle:P.t("Search Source  {{Number}}",{Number:null==v?void 0:v.length}),onClickItem:()=>{}},className:"research-panel"})}),KG=O.memo(({message:e})=>{var t,n,i,a,o;const s=(null==e?void 0:e.sub_chat_type)||(null==(n=null==(t=null==e?void 0:e.extra)?void 0:t.meta)?void 0:n.subChatType),r=yE(e=>e.realTheme);if(mg(s)){const t=!!(null==e?void 0:e.error),n=!(null==e?void 0:e.done)&&!t,l=(null==(a=null==(i=e.content_list)?void 0:i.find(e=>e.phase===ng.RESEARCHNOTICE))?void 0:a.content)||"";return tn.jsxs("div",{className:"deep-research-panel",children:[tn.jsx(Le,{content:l,tokenProps:{image:{preview:{mask:null}},code:{theme:r}}}),tn.jsx(QG,{messageId:e.id,contentList:e.content_list,timestamp:e.timestamp,subChatType:s,endTime:(null==(o=null==e?void 0:e.extra)?void 0:o.endTime)||window._currentTime_,isRenderError:t,isRunning:n,isMessageStopped:!!e.is_stop})]})}return null}),YG=({src:e,id:t="",audioInitHandle:n=()=>{},audioLoadHandle:i=()=>{},audioPlayHandle:a=()=>{},audioPauseHandle:o=()=>{},audioEndHandle:s=()=>{},audioTimeupdateHandle:r=()=>{},audioErrorHandle:l=()=>{},audioWaitingHandle:c=()=>{},audioCanplayHandle:u=()=>{},audioCanplayThroughHandle:d=()=>{}})=>{const h=O.useRef(null),[p,m]=O.useState(e),[f,g]=O.useState(!1),[v,y]=O.useState(1),b=dT(e=>e.ossUrls),x=dT(e=>e.setOssUrls),w=O.useCallback(()=>{h.current&&i(h.current)},[i]),S=O.useCallback(()=>{if(!h.current)return;document.querySelectorAll("audio").forEach(e=>{e.id!==`qwen-chat-audio-core-${t}`&&e.pause()}),a(h.current)},[a,t]),E=O.useCallback(()=>{h.current&&o(h.current)},[o]),k=O.useCallback(()=>{h.current&&s(h.current)},[s]),I=O.useCallback(()=>{h.current&&r(h.current)},[r]),T=O.useCallback(()=>P(void 0,null,function*(){if(h.current){if(!f){g(!0);try{const{data:{fileUrl:t}}=yield VS({fileUrl:e});return m(t),void x(C(_({},b),{[e]:t}))}catch(GY){}}if(v>0)return y(e=>e-1),void setTimeout(()=>{h.current&&(h.current.src=`${p}&timestamp=${Date.now()}`)},200);l(h.current)}}),[f,v,l,e,x,b,p]),j=O.useCallback(()=>{h.current&&c(h.current)},[c]),N=O.useCallback(()=>{h.current&&u(h.current)},[u]),M=O.useCallback(()=>{h.current&&d(h.current)},[d]);return O.useEffect(()=>{const e=h.current;if(!e)return;return e.addEventListener("loadedmetadata",w),e.addEventListener("loadeddata",w),e.addEventListener("play",S),e.addEventListener("pause",E),e.addEventListener("ended",k),e.addEventListener("timeupdate",I),e.addEventListener("error",T),e.addEventListener("waiting",j),e.addEventListener("canplay",N),e.addEventListener("canplaythrough",M),n(e),()=>{e.removeEventListener("loadedmetadata",w),e.removeEventListener("loadeddata",w),e.removeEventListener("play",S),e.removeEventListener("pause",E),e.removeEventListener("ended",k),e.removeEventListener("timeupdate",I),e.removeEventListener("error",T),e.removeEventListener("waiting",j),e.removeEventListener("canplay",N),e.removeEventListener("canplaythrough",M)}},[w,S,E,k,I,T,j,N,M,n]),O.useEffect(()=>{g(!1),y(1);const t=b[e]||e;m(t)},[e,b]),tn.jsx("audio",{id:"qwen-chat-audio-core"+(t?`-${t}`:""),style:{display:"none"},className:"qwen-chat-comp-audio-core",ref:h,src:p})},XG=({id:e})=>{var t,n;const{i18n:i}=G(),a=cT(e=>e.settings),o=dT(e=>e.ttsAudioTTSSpeakers),s=cT(e=>e.updateQwenChatSettings),r=O.useMemo(()=>o||[],[o]),[l,c]=O.useState({label:hg,value:"",gender:"",description:"",url:""}),[u,d]=O.useState({label:hg,value:"",gender:"",description:"",url:""}),[h,p]=O.useState(!1),[m,f]=O.useState(!1),[g,v]=O.useState(""),y=O.useRef(null);cT(e=>e.setSettings);const b=Zb(e=>e.currentDPLanguageCode),x=O.useMemo(()=>b||i.language||Yb.en,[b,i]),w=O.useRef(null),S=O.useRef(null),_=O.useRef(r),C=e=>{var t,n,a;return{label:"zh-CN"===i.language?e.spk_name:e.speaker,value:e.speaker,gender:e.gender,description:e.description,url:(null==(n=null==(t=e.urls)?void 0:t.find(e=>e.language===x||"en"===e.language))?void 0:n.url)||(null==(a=e.urls)?void 0:a[0].url)||""}};O.useEffect(()=>{var e,t;if(_.current=r,!(null==r?void 0:r.length))return;if((!(null==a?void 0:a.aipodcast)||!(null==(e=a.aipodcast)?void 0:e.host))&&(null==r?void 0:r.length)){const e={hostItem:(t=r).find(e=>e.speaker===hg),guestItem:t.find(e=>"male"===e.gender)};return c(C(e.hostItem)),void d(C(e.guestItem))}const n=r.find(e=>{var t;return e.speaker===(null==(t=null==a?void 0:a.aipodcast)?void 0:t.host)});n&&c(C(n));const i=r.find(e=>{var t;return e.speaker===(null==(t=null==a?void 0:a.aipodcast)?void 0:t.guest)});if((null==i?void 0:i.speaker)===(null==n?void 0:n.speaker)){const e=r.find(e=>"male"===e.gender);if(e)return void d(C(e))}i&&d(C(i))},[a,r]);const E=O.useRef(""),k=O.useMemo(()=>{var e,t;return(null==(t=null==(e=_.current)?void 0:e.find(e=>e.speaker===(null==l?void 0:l.value)))?void 0:t.gender)||"female"},[l]),{hostMenu:I,guestMenu:T}=O.useMemo(()=>{E.current=k;const e=[],t=[];return jt(r)||r.forEach(n=>{e.push(C(n)),n.gender!==k&&t.push(C(n))}),{hostMenu:e,guestMenu:t}},[r,k,x,i.language]),j=O.useCallback(e=>P(void 0,null,function*(){y.current=e}),[]),N=O.useCallback(()=>P(void 0,null,function*(){v(""),p(!1)}),[]),M=O.useCallback(()=>P(void 0,null,function*(){p(!0)}),[]),A=O.useCallback(()=>P(void 0,null,function*(){v(""),p(!1)}),[]),R=O.useCallback(()=>P(void 0,null,function*(){f(!0)}),[]),D=O.useCallback(()=>P(void 0,null,function*(){m&&f(!1)}),[m]),L=O.useMemo(()=>{var e;return(null==(e=null==a?void 0:a.aipodcast)?void 0:e.host)||l.value||hg},[null==(t=null==a?void 0:a.aipodcast)?void 0:t.host,l]),F=O.useMemo(()=>{var e;return(null==(e=null==a?void 0:a.aipodcast)?void 0:e.guest)||u.value||hg},[null==(n=null==a?void 0:a.aipodcast)?void 0:n.guest,u]),U=O.useMemo(()=>tn.jsx(YG,{src:null,id:e||"pdf-tts-audio",audioInitHandle:j,audioPlayHandle:M,audioEndHandle:N,audioPauseHandle:A,audioWaitingHandle:R,audioCanplayHandle:D,audioCanplayThroughHandle:D}),[j,M,N,A,R,D]);return{hostMenu:I,guestMenu:T,hostItem:l,guestValue:F,hostValue:L,setHostItem:e=>{if(c(e),E.current!==e.gender){const t=I.find(e=>e.gender===k);t&&(E.current=e.gender,d(t))}},guestItem:u,setGuestItem:d,languageCode:x,activeItemValue:g,audioWaiting:m,audioPlaying:h,Audio:U,guestSelectRef:w,hostSelectRef:S,updateSetting:()=>P(void 0,null,function*(){const e={host:(null==l?void 0:l.value)||"",guest:(null==u?void 0:u.value)||""};e.host&&e.guest&&(yield s({aipodcast:e}))}),closeSelect:()=>{var e,t;try{(null==(e=w.current)?void 0:e.blur)&&w.current.blur(),(null==(t=S.current)?void 0:t.blur)&&S.current.blur()}catch(n){}},stopCurrentAudio:()=>P(void 0,null,function*(){try{y.current&&h&&(v(""),y.current.pause())}catch(e){}}),setActiveItemValue:e=>{if(y.current&&e.value===g&&h)return v(""),void y.current.pause();v(e.value),f(!0),y.current&&(y.current.src=e.url),setTimeout(()=>{y.current&&(y.current.currentTime=0,y.current.play())},0)},audioEleRef:y}},JG=({list:e,activeItemValue:t,audioWaiting:n,audioPlaying:i,soundPreview:a,type:o,closeSelect:s,onVoiceClickHandle:r,onClickHandle:l})=>{const{i18n:c}=G();return tn.jsx("div",{className:"pdf-speaker-select",children:e.map(e=>tn.jsxs("div",{className:"pdf-speaker-select-item",onClick:()=>{s(),null==l||l(e,o)},children:[e.label,a&&tn.jsx("span",{onClick:t=>{t.stopPropagation(),null==r||r(e)},children:tn.jsx(we,{title:c.t("Preview voice"),placement:"top",children:t===e.value?tn.jsx("img",{src:Xb(n,g$()),alt:"speaking",className:"podcast-selector-dropdown-menu-item-waveform "+(t===e.value&&i?"podcast-selector-dropdown-menu-item-waveform-active":"")}):tn.jsx(dt,{type:"icon-waveform",className:"podcast-selector-dropdown-menu-item-waveform"})})})]},e.value))})},ZG=({placement:e="bottom",className:t="",customContent:n=null})=>{const{i18n:i}=G(),a=yE(e=>e.isSharePage),o=Zb(e=>e.taskRunning),s=Zb(e=>e.visionGenerating),r=tx(e=>e.mobile),l=yE(e=>e.setShowH5PodcastDetail),c=Zb(e=>e.deepResearchVersion),u=Zb(e=>e.podcastCount),{hostMenu:d,guestMenu:h,guestItem:p,hostItem:m,Audio:f,activeItemValue:g,audioPlaying:v,audioWaiting:y,hostSelectRef:b,guestSelectRef:x,guestValue:w,hostValue:S,languageCode:_,closeSelect:C,setHostItem:E,updateSetting:k,setGuestItem:I,stopCurrentAudio:T,setActiveItemValue:j}=XG({id:"button-pdf-tts-audio"}),[N,M]=O.useState(!1),{qDeepResearchAipodcast:A,checkEquityPassByEquity:R}=HN(),[D,L]=O.useState(!1),F=O.useRef(null),U=O.useMemo(()=>s||o,[o,s]),z=O.useMemo(()=>"icon-line-chevron-"+(D?"up":"down"),[D]),H=O.useCallback(()=>P(void 0,null,function*(){o||(oT.closeShowControls(),bT()||(yield k()),M(!1),l(!1),Wb.getState().setEmitSendPromptType(Qf.CHAT),Zb.getState().setThinkingEnabled(!1),oT.beforeSendMessage({inputText:i.t("Create a podcast"),chatType:Zf.DeepResearch,subChatType:Zf.Podcast}),yield TE.getState().updateEquity())}),[o,k,i,l]),$=O.useMemo(()=>{const e=[];"v4"===c&&(e.push({label:i.t("Web Dev"),key:"web dev",icon:tn.jsx(dt,{type:"icon-Cube"}),onClick:()=>{oT.closeShowControls(),Zb.getState().setThinkingEnabled(!1),Wb.getState().setEmitSendPromptType(Qf.CHAT),oT.beforeSendMessage({inputText:i.t("Generate a web page preview"),chatType:Zf.DeepResearch,subChatType:Zf.DeepResearchWebDev})}}),r&&e.push({type:"divider"}));const t=null===(null==A?void 0:A.remains)||-1!==(null==A?void 0:A.remains)?gE({remains:(null==A?void 0:A.remains)||0,unit:null==A?void 0:A.unit,currentI18n:i,capability:"Podcast"}):"",n=null===(null==A?void 0:A.remains)||0===(null==A?void 0:A.remains);return e.push({label:tn.jsx(ft,{title:t?tn.jsx("span",{dangerouslySetInnerHTML:{__html:t}}):"",children:i.t("Podcast")}),className:n?"ant-dropdown-menu-item-disabled":"",disabled:!r&&n,key:"podcast",icon:tn.jsx(dt,{type:"icon-line-Podcast"}),onClick:()=>{if(r){if(!R(A)||n)return;bx()?oT.adapter.invoke({method:"openPodcastWindow",params:{content:{host:S,guest:w},languageCode:_}}):l(!0)}else M(!0)}}),{items:e}},[R,c,w,S,i,_,r,A,l]);O.useEffect(()=>{const e=e=>{const t=e.target;r||!F.current||F.current.contains(t)||t.closest(".ant-select-dropdown")||(M(!1),l(!1))};return N&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[N,r,l]);const B=O.useCallback((e,t)=>{"host"===t?E(e):I(e)},[E,I]),q=O.useMemo(()=>[{list:d,value:null==m?void 0:m.label,type:"host",ref:b,titleKey:"Host"},{list:h,value:null==p?void 0:p.label,type:"guest",ref:x,titleKey:"Guest"}],[d,h,m,p,b,x]);O.useEffect(()=>{N||T()},[N,T]);const V=O.useCallback(()=>N?tn.jsx("div",{className:"podcast-detail-container",ref:F,children:tn.jsxs("div",{className:"podcast-detail",children:[tn.jsx("div",{className:"podcast-detail-title",children:i.t("Select the voice")}),tn.jsx("div",{className:"podcast-detail-content",children:q.map(e=>tn.jsxs("div",{className:"podcast-detail-content-item",children:[tn.jsx("div",{className:"podcast-detail-content-item-title",children:i.t(e.titleKey||"Host")}),tn.jsx(St,{selectAntdRef:e.ref,rounded:"circle",value:e.value,placeholder:"",onOpenChange:e=>{e||T()},popupRender:()=>tn.jsx(JG,{list:e.list,type:e.type,soundPreview:!0,closeSelect:C,activeItemValue:g,audioWaiting:y,audioPlaying:v,onClickHandle:B,onVoiceClickHandle:j})})]},e.type))}),tn.jsx(pt,{rounded:"circle",type:"brandprimary",buttonClass:"podcast-detail-button",buttonStyle:{marginLeft:"0px",height:"40px"},onClick:H,children:i.t("Create a podcast")})]})}):null,[N,i,q,H,T,C,g,y,v,B,j]);return a||0===$.items.length?null:tn.jsxs(tn.Fragment,{children:[V(),f,tn.jsx(yt,{menu:$,overlayClassName:"pdf-create-button-outer",disabled:U||u>=5,trigger:["click"],placement:e,className:"pdf-create-button",onOpenChange:e=>{L(e)},children:n?tn.jsx("div",{className:J("pdf-create-custom",{"pdf-create-custom-disabled":U||u>=5}),children:n}):tn.jsx(pt,{isLeft:!1,iconFontType:z,type:"brandsecondary",rounded:"circle",disabled:U||u>=5,className:t,size:"small",children:i.t("Create")})})]})},eV=O.memo(({info:e,subChatType:t,timestamp:n})=>{var i,a,o,s,r;yE(e=>e.setShowSidebar);const l=tx(e=>e.mobile),c=Zb(e=>e.setCurrentShowControl),u=Zb(e=>e.currentControlsId),d=Zb(e=>e.setCurrentControlsId);Zb(e=>e.currentShowControl);const h=yE(e=>e.setShowControls),p=yE(e=>e.showControls),m=Wb(e=>e.chatId),f=Zb(e=>e.setIsPdfCardVisible),g=Zb(e=>e.setPdfCardType),v=rT(e=>e.setFiles),y=yE(e=>e.isSharePage),b=Wb(e=>e.branchInfo),x=Zb(e=>e.taskRunning),w=Zb(e=>e.deepResearchVersion),S=Zb(e=>e.setDeepResearchVersion),_=Zb(e=>e.pdfCardType),C=CE(e=>e.subscriptionPlus),E=Zb(e=>e.podcastCount),k=Zb(e=>e.visionGenerating),I=Zb(e=>e.temporaryChatEnabled),T=Wb(e=>e.history),j=tx(e=>e.config),{i18n:N}=G(),M=!!(null==e?void 0:e.messageId)&&!!(null==(a=null==(i=T.messages)?void 0:i[null==e?void 0:e.messageId])?void 0:a.isShare),[A,R]=O.useState(!1),[D,L]=O.useState(!1),F=t&&(mg(t)||t===Zf.INTERRUPT);O.useEffect(()=>{if(!bx())return;const t={key:rI(tg.PdfViewer),value:JSON.stringify({PDFViewInfo:e,isSharePage:y,branchInfo:b,taskRunning:x,deepResearchVersion:w,pdfCardType:_,subscriptionPlus:C,podcastCount:E,visionGenerating:k,temporaryChatEnabled:I})};oT.adapter.invoke({method:"storeInfo",params:t})},[e,y,b,x,w,_,C,E,k,I]);const U=()=>{if(bx())try{oT.adapter.invoke({method:"openHalfWindow",params:{type:"openUrl",content:`${lI(tg.PdfViewer)}?id=${m}`}})}catch(n){}else u===(null==e?void 0:e.messageId)&&p?oT.closeShowControls():(c(tg.PdfViewer),h(!0),d((null==e?void 0:e.messageId)||""),g(t||""),S(tk(T,null==e?void 0:e.messageId)))};O.useEffect(()=>(F&&e?(f(!0),oT.collectAllPdfInfo(e,e.messageId)):f(!1),()=>{f(!1)}),[F,t,e]),O.useEffect(()=>{oT.emit(qC.MESSAGE_DEEP_RESEARCH_CLOSE_DETAIL),[Zf.DeepResearch,Zf.TRAVEL_RESEARCH].includes(oT.getCurrentChatsubChatType())&&!l&&(oT.closeShowControls(),y||U(),h(!0))},[y]);const z=O.useMemo(()=>y||M||t===Zf.TRAVEL_RESEARCH?null:tn.jsx("div",{className:"pdf-card-after-extras",children:tn.jsx(ZG,{customContent:tn.jsx("div",{children:tn.jsx(dt,{type:"icon-a-lianji8"})}),placement:l?"topLeft":"top"})}),[y,M,t,l]),H=O.useMemo(()=>{var e;return!y&&!bT()&&(null==(e=null==j?void 0:j.function_entry)?void 0:e.community)&&!(null==b?void 0:b.isTemp)&&!I},[y,null==(o=null==j?void 0:j.function_entry)?void 0:o.community,null==b?void 0:b.isTemp,I]),$=O.useMemo(()=>H?tn.jsx(ae,{arrow:!1,trigger:"click",classNames:{root:"pc-pdf-viewer-more-popover"},open:D,onOpenChange:L,content:tn.jsxs("div",{className:"pc-pdf-viewer-more-content",children:[H?tn.jsxs("div",{onClick:()=>{M||(R(!0),L(!1))},className:J("pc-pdf-viewer-more-content-item",{"pc-pdf-viewer-more-content-item-disabled":M}),children:[tn.jsx(dt,{className:"pc-pdf-viewer-more-content-item-icon",type:"icon-line-Publish"}),N.t("Publish to community")]}):null,tn.jsxs("div",{onClick:()=>{M||(P(void 0,null,function*(){var t,n;const i=[{type:"file",name:null==(t=null==e?void 0:e.pdf)?void 0:t.name,file_type:"application/pdf",showType:"file",file_class:"document",status:"uploaded",url:null==(n=null==e?void 0:e.pdf)?void 0:n.link,isQuote:!0}];v(i)}),L(!1))},className:"pc-pdf-viewer-more-content-item",children:[tn.jsx(dt,{type:"icon-line-arrow-curve-left-right",className:"quote-icon pc-pdf-viewer-more-content-item-icon"}),N.t("Quote")]})]}),placement:"bottomLeft",children:tn.jsx("div",{className:"after-extras-icon",onClick:()=>L(!0),children:tn.jsx(dt,{type:"icon-line-more-01"})})}):tn.jsx(tn.Fragment,{}),[D,N,M,H]);return F&&e?tn.jsxs(tn.Fragment,{children:[tn.jsx(Mq,{open:A,onCancel:()=>R(!1),messageId:e.messageId}),tn.jsx(ze,{className:"pdf-card",onCardClick:U,info:{time:N_(n),name:(null==(s=e.pdf)?void 0:s.name)||"",size:(null==(r=e.pdf)?void 0:r.size)||0,extra:e},type:He.PDF,toolsOption:{afterExtras:$,download:{onDownload:ik},beforeExtras:z}})]}):null}),tV=e=>{var t,n,i;const{message:a,phaseContentIndex:o=-1}=e,{i18n:s}=G(),r=aI(e=>e.models),l=Wb(e=>e.chatPermission);Wb(e=>e.setChatPermission);const c=O.useMemo(()=>a.content_list||[],[a.content_list]),u=O.useMemo(()=>{var e;return null==(e=a.content_list)?void 0:e[o]},[a.content_list,o]),d=O.useMemo(()=>{const e=c.find((e,t)=>e.phase===ng.ANSWER&&t>o);return!a.done&&(null==u?void 0:u.phase)===ng.TOOL&&!e},[a.done,null==u?void 0:u.phase,o,c]),h=O.useMemo(()=>{const e=c.findIndex((e,t)=>e.phase===ng.LOCAL_TOOL&&e.mcp_results&&t>o),t=c.find((t,n)=>t.phase===ng.ANSWER&&n>(e>-1?e:o+2));return!a.done&&(null==u?void 0:u.phase)===ng.LOCAL_TOOL&&!t},[a.done,null==u?void 0:u.phase,o,c]),{mcpName:p,toolName:m,params:f,result:g}=O.useMemo(()=>{var e,t,n,i,a,s,r;const l=c.findIndex((e,t)=>e.phase===ng.LOCAL_TOOL&&e.mcp_results&&t>o),d=l>-1?c[l]:void 0,h=(null==u?void 0:u.mcp_name)||"",p=(null==u?void 0:u.tool_name)||"",m=null==(i=null==(n=null==(t=null==(e=null==u?void 0:u.extra)?void 0:e.local_mcp)?void 0:t[h])?void 0:n.find(({tool_name:e})=>e===p))?void 0:i.params,f=m?JSON.stringify(m):"",g=(null==(r=null==(s=null==(a=null==d?void 0:d.mcp_results)?void 0:a[h])?void 0:s.find(e=>!!(null==e?void 0:e[p])))?void 0:r[p])||"";return{mcpName:h,toolName:p,params:f,result:g}},[null==(t=null==u?void 0:u.extra)?void 0:t.local_mcp,null==u?void 0:u.mcp_name,null==u?void 0:u.tool_name,o,c]),v=O.useMemo(()=>{var e,t,n;const i=c.findIndex((e,t)=>e.phase===ng.LOCAL_TOOL&&e.mcp_results&&t>o),a=null==(t=Object.values((null==(e=c[i])?void 0:e.mcp_results)||{}))?void 0:t[0],s="Tool call failed: User not authorized"===(null==(n=Object.values((null==a?void 0:a[0])||{}))?void 0:n[0]),r=wx()&&h&&"prompt"===(null==l?void 0:l.local_mcp);return s?"denied":r?"prompt":void 0},[null==l?void 0:l.local_mcp,h,o,c]);return-1===o?(null==(i=null==(n=a.extra)?void 0:n.connectFailedMcp)?void 0:i.length)?tn.jsx($e,{failedMcpNames:a.extra.connectFailedMcp,failedText:s.t("connecting failed.")}):null:(null==u?void 0:u.mcp_results)?null:tn.jsxs(tn.Fragment,{children:[tn.jsx(Be,{loading:d||h,mcpName:p,toolName:m,callingText:s.t("Call {{toolName}} from {{MCPName}}",{toolName:m,MCPName:p}),detailParamsTitle:s.t("Start calling tool {{toolName}}",{toolName:m}),detailParamsContent:f,detailResultTitle:s.t("Finished tool calling"),detailResultContent:g}),(null==u?void 0:u.phase)===ng.LOCAL_TOOL&&c[c.length-1].status===ig.FINISHED&&tn.jsx(qe,{type:v,title:s.t("Allow {{toolName}} (local) running?",{toolName:m}),content:s.t("Malicious MCP servers or content may lead Qwen to perform harmful actions through your installed tools. Review all actions carefully before approval."),buttonTextDeny:s.t("Deny"),buttonTextGrantedOnce:s.t("Allow once"),buttonTextGranted:s.t("Allow in this chat"),deniedContent:s.t("Permission request denied, tool execution stopped."),onButtonClick:e=>{const t=ZC.getChat(ZC.currentId||"");t&&t.setLocalMcpPermission(e,{model:r.find(({id:e})=>e===a.model),responseMessageId:(null==a?void 0:a.id)||""})},style:["prompt","denied"].includes(v||"")?{marginTop:"0.75rem"}:void 0})]})},nV=e=>{const{editedContent:t,setEditedContent:n,handleSaveEditMessage:i,setIsEdit:a}=e,o=O.useRef(null),{i18n:s}=G();return O.useEffect(()=>{setTimeout(()=>{o.current&&o.current.scrollIntoView({behavior:"smooth",block:"end"})},100)},[]),tn.jsx("div",{ref:o,children:tn.jsx(Ae,{value:t,open:!0,onOk:e=>{i(e||"")},onCancel:()=>{n(null),a(!1)},onExtra:e=>{i(e||"",!0)},okText:s.t("Save"),cancelText:s.t("Cancel"),extraText:s.t("Save As Copy")})})};var iV=(e=>(e.THINKING="THINKING",e.THINKING_AND_ANALYSING="THINKING_AND_ANALYSING",e.ANALYZING_IMAGE="ANALYZING_IMAGE",e.SEARCHING_WEB_PAGES="SEARCHING_WEB_PAGES",e.CALLING_CODE_INTERPRETER="CALLING_CODE_INTERPRETER",e.SEARCHING_MEMORIES="SEARCHING_MEMORIES",e.UPDATING_MEMORIES="UPDATING_MEMORIES",e.READING_SOURCES="READING_SOURCES",e.THINKING_COMPLETED="THINKING_COMPLETED",e.IMAGE_SEARCH="IMAGE_SEARCH",e.WEB_SEARCH_IMAGE="WEB_SEARCH_IMAGE",e))(iV||{}),aV=(e=>(e.PROCESS_STATE="PROCESS_STATE",e.RESULT_STATE="RESULT_STATE",e))(aV||{});const oV=H.memo(e=>{const{endTime:t,timestamp:n,loading:i}=e,[a,o]=O.useState(""),[s,r]=O.useState(Date.now()/1e3),l=O.useRef(null),c=O.useCallback(()=>{const e=Date.now()/1e3;r(e),window._currentTime=e,l.current=setInterval(()=>{const e=Date.now()/1e3;window._currentTime=e,r(e)},1e3)},[]),u=O.useCallback(()=>{l.current&&(clearInterval(l.current),l.current=null)},[]);O.useEffect(()=>(i?l.current||c():u(),()=>{u()}),[i,c,u]);const d=O.useCallback(e=>{let t=e;const n=Math.floor(t/36e5);t-=36e5*n;const i=Math.floor(t/6e4);t-=6e4*i;const a=Math.floor(t/1e3);return`${n?JSON.stringify(n)+"h":""}${i?JSON.stringify(i)+"m":""}${a?JSON.stringify(a)+"s":""}`},[]);return O.useEffect(()=>{if(i){if(void 0!==n){const e=d(1e3*Math.abs(s-n));o(e)}}else if(void 0!==t&&void 0!==n){const e=d(1e3*Math.abs(t-n));o(e)}},[t,n,i,s,d]),a&&(t||s)?tn.jsx("span",{children:a}):null});var sV=(e=>(e.LOADING="LOADING",e.PAUSE="PAUSE",e.FINISHED="FINISHED",e.ERROR="ERROR",e))(sV||{});const rV=[{label:{process:"Thinking...",completed:"Thinking completed"},key:ng.THINK,icon:"icon-fill-check-contained"},{label:{process:"Analyzing",completed:"Analyzed"},key:ng.THINKING_SUMMARY,icon:"icon-fill-check-contained"},{label:{process:"Searching the web",completed:"Searched the web"},key:ng.WEB_SEARCH,icon:"icon-line-globe-01"},{label:{process:"Running code interpreter",completed:"Code interpreter finished"},key:ng.CODE_INTERPRETER,icon:"icon-line-code-01"},{label:{process:"Searching memory",completed:"Searched memory"},key:ng.HISTORY_RETRIEVER,icon:"icon-line-brain-02"},{label:{process:"Updating memory",completed:"Updated memory"},key:ng.BIO,icon:"icon-line-brain-02"},{label:{process:"Reading sources",completed:"Sources read"},key:ng.WEB_EXTRACTOR,icon:"icon-fill-check-contained"}],lV=e=>{var t,n;const{i18n:i}=G(),[a,o]=O.useState(!0),s=O.useMemo(()=>{var t;return!(!Array.isArray(null==e?void 0:e.content_list)||!(null==e?void 0:e.content_list.length))&&(null==(t=e.content_list)?void 0:t.some(e=>[ng.WEB_SEARCH].includes(e.phase)))},[e]),r=O.useMemo(()=>{var t;if(!Array.isArray(null==e?void 0:e.content_list)||!(null==(t=null==e?void 0:e.content_list)?void 0:t.length))return[];return(null==e?void 0:e.content_list).filter(({phase:e})=>![ng.IMAGE_EDIT_TOOL,ng.IMAGE_GEN_TOOL].includes(e))},[null==e?void 0:e.content_list]),l=O.useMemo(()=>{if(!e)return!1;const{feature_config:t}=e;return!!(null==t?void 0:t.thinking_enabled)},[e]),c=O.useMemo(()=>{if(!e)return"LOADING";const{error:t,is_stop:n}=e,i=(null==r?void 0:r.some(({phase:e})=>e===ng.ANSWER))||(null==r?void 0:r.some(({phase:e})=>e===ng.SLIDES));return t?"ERROR":n?"PAUSE":i&&r&&(null==r?void 0:r.length)>1||e.done?"FINISHED":"LOADING"},[r,e]),u=O.useMemo(()=>{if(!(null==r?void 0:r.length))return null;const e=r.length-1;return r[e]},[r]),d=O.useMemo(()=>(null==u?void 0:u.phase)||"",[null==u?void 0:u.phase]),h=O.useMemo(()=>{var e;if(!(null==r?void 0:r.length))return"";const t=r.length-1;return(null==(e=r[t])?void 0:e.status)||"finished"},[r]),p=O.useMemo(()=>{var e,t,n,i,a,o;const s=rV.find(({key:e})=>e===d);if(!s)return"";const r="finished"===h;if(((null==(t=null==(e=null==u?void 0:u.extra)?void 0:e.summary_title)?void 0:t.content)||[]).length>0){const e=(null==(i=null==(n=null==u?void 0:u.extra)?void 0:n.summary_title)?void 0:i.content)||[],t=e[e.length-1]||s.label.process,a=e[e.length-1]||s.label.completed;return r?a:t}if(d===ng.ANSWER){const e=(null==(o=null==(a=null==u?void 0:u.extra)?void 0:a.summary_title)?void 0:o.content)||[],t=e[e.length-1]||"";return r?t:s.label.process}return r?s.label.completed:s.label.process},[d,h,null==(n=null==(t=null==u?void 0:u.extra)?void 0:t.summary_title)?void 0:n.content]),m=O.useMemo(()=>{var t;let n="",a=c;switch((null==(t=null==e?void 0:e.content_list)?void 0:t.some(e=>e.phase===ng.ANSWER))&&"PAUSE"===c&&(a="FINISHED"),a){case"LOADING":n=p,n||(n=l?"Thinking...":"Searching...");break;case"PAUSE":l&&s?n="Thinking and Searching Stopped":l?n="Thinking stopped":s&&(n="Search web stopped");break;case"FINISHED":l&&s?n="Thinking and Searching Completed":l?n="Thinking completed":s&&(n="Search web Completed");break;case"ERROR":l&&s?n="Thinking and Search Failed":l?n="Thinking Failed":s&&(n="Search web pages failed");break;default:n=""}return i.t(n)},[p,i,e,c,s,l]),f=O.useMemo(()=>{var t,n;let i="";const a=l?"icon-line-lightbulb-031":"icon-line-globe-01";let o=c;return(null==(t=null==e?void 0:e.content_list)?void 0:t.some(e=>e.phase===ng.ANSWER))&&"PAUSE"===c&&(o="FINISHED"),"LOADING"===o&&(i="finished"!==h&&d!==ng.THINKING_SUMMARY?"loading":(null==(n=rV.find(({key:e})=>e===d))?void 0:n.icon)||""),i||a},[d,h,null==e?void 0:e.content_list,c,l]);return O.useEffect(()=>{o("LOADING"!==c)},[c]),{chatStatusTitle:m,isFinished:a,chatStatusIcon:f}};var cV=(e=>(e.LOADING="LOADING",e.THINKING="THINKING",e.CHAT_STOPED="CHAT_STOPED",e.THINKING_STOPED="THINKING_STOPED",e.FINISHED="FINISHED",e.ERROR="ERROR",e))(cV||{});const uV=H.memo(e=>{var t;const{message:n}=e,i=G(),a=tx(e=>e.mobile),o=yE(e=>e.setShowControls),s=Zb(e=>e.currentShowControl),r=Zb(e=>e.setCurrentShowControl),l=Zb(e=>e.setCurrentActionMessageId),c=Zb(e=>e.setLocateTheSearchSource),u=Zb(e=>e.currentActionMessageId),d=Wb(e=>e.setCurrentCitationInfo),h=Zb(e=>e.thinkingMode),{chatStatusTitle:p,isFinished:m}=lV(n),{timestamp:f,content_list:g=[]}=n,v=O.useMemo(()=>{if(!Array.isArray(g)||!g.length)return[];let e=[];return g.forEach(({phase:t,extra:n})=>{t===ng.WEB_SEARCH&&(e=[...e,...(null==n?void 0:n.web_search_info)||[]])}),e},[g]),y=O.useMemo(()=>{if(!Array.isArray(null==n?void 0:n.content_list)||!(null==n?void 0:n.content_list.length))return sV.LOADING;const{error:e,is_stop:t,content_list:i}=n,a=(null==i?void 0:i.some(({phase:e})=>e===ng.ANSWER))||(null==i?void 0:i.some(({phase:e})=>e===ng.SLIDES));return e?sV.ERROR:t?sV.PAUSE:a&&i&&(null==i?void 0:i.length)>1||n.done?sV.FINISHED:sV.LOADING},[n]),b=O.useMemo(()=>{var e;return!!(null==(e=null==n?void 0:n.feature_config)?void 0:e.thinking_enabled)},[null==(t=null==n?void 0:n.feature_config)?void 0:t.thinking_enabled]),x=O.useMemo(()=>{var e,t;return!Array.isArray(null==n?void 0:n.content_list)||!(null==(e=null==n?void 0:n.content_list)?void 0:e.length)||(null==(t=n.content_list)?void 0:t.every(e=>e.phase===ng.ANSWER))},[n.content_list]),w=O.useMemo(()=>s===tg.ThinkingAndSources&&u&&u===n.id,[u,s,n.id]),S=O.useMemo(()=>{var e;return null==(e=n.content_list)?void 0:e.some(e=>[ng.WEB_SEARCH].includes(e.phase))},[n.content_list]),_=O.useMemo(()=>y!==sV.LOADING&&!b&&S,[y,S,b]),C=O.useMemo(()=>{var e,t;const i=aI.getState().models,a=Wb.getState().history,o=i.find(e=>e.id===n.model),s=null==a?void 0:a.messages[(null==n?void 0:n.parentId)||""];if(!o||!s)return!1;const{enable:r=!1,support_files:l=[]}=(null==(t=null==(e=null==o?void 0:o.info)?void 0:e.meta)?void 0:t.think_skip)||{},c=((null==s?void 0:s.files)||[]).map(e=>e.type),u=!(null==n?void 0:n.is_stop_in_thinking_flag);return r&&c.every(e=>l.includes(e))&&u},[null==n?void 0:n.is_stop_in_thinking_flag,n.model,null==n?void 0:n.parentId]),E=O.useCallback(e=>{if(!x){if(e)return o(!0),!b&&a?(r(tg.WebSearch),void d({messageId:n.id||"",citationIndex:0,tab:De.sources})):(r(tg.ThinkingAndSources),d({messageId:n.id||"",citationIndex:0,tab:De.sources}),void l(null==n?void 0:n.id));o(!1),r(tg.None),c(!1),l("")}},[n.id,a,x,l,d,r,c,o,b]);O.useMemo(()=>_||v.length?`${v.length} ${i.t("Sources")}`:null,[i,_,v.length]);const k=O.useRef(void 0);O.useMemo(()=>{var e,t,i;if(!b)return null;if(!f)return null;const a=(null==n?void 0:n.error)||(null==n?void 0:n.done)||(null==n?void 0:n.is_stop);let o;const s=(null==(e=null==n?void 0:n.content_list)?void 0:e.findIndex(({phase:e})=>e===ng.ANSWER))||-1,r=s>0;r&&!k.current&&(o=(null==(i=null==(t=null==n?void 0:n.content_list)?void 0:t[s-1])?void 0:i.timestamp)||Date.now()/1e3,k.current=o),k.current&&(o=k.current);const l=!r&&!a;return l||f&&o?tn.jsx(oV,{timestamp:f,endTime:o,loading:l}):null},[null==n?void 0:n.content_list,null==n?void 0:n.done,null==n?void 0:n.error,null==n?void 0:n.is_stop,b,f]);const I=(e=>O.useMemo(()=>{var t;if(!e)return"LOADING";const{error:n,is_stop:i}=e,a=Array.isArray(null==e?void 0:e.content_list)?null==e?void 0:e.content_list:[],o=(null==a?void 0:a.some(({phase:e})=>e===ng.ANSWER))||(null==a?void 0:a.some(({phase:e})=>e===ng.SLIDES));return n?"ERROR":i?"CHAT_STOPED":o&&a&&(null==a?void 0:a.length)>1||e.done?"FINISHED":e&&(null==e?void 0:e.content_list)&&0!==(null==(t=null==e?void 0:e.content_list)?void 0:t.length)&&!o&&(null==a?void 0:a.length)>0?"THINKING":"LOADING"},[e]))(n),T=O.useCallback(()=>{E(!1),oT.stopThinkingPhase(n.id)},[n.id,E]);return a?tn.jsx("div",{className:"qwen-chat-mobile-chat-status-card",children:tn.jsxs(Z,{align:"center",justify:"space-between",gap:16,className:"qwen-chat-mobile-chat-status-card-top",children:[tn.jsxs(Z,{gap:4,align:"center",className:"qwen-chat-mobile-chat-status-title",onClick:()=>{E(!w)},children:[tn.jsx(dt,{className:"qwen-chat-mobile-chat-status-before-icon",type:"Fast"!==h?"icon-line-lightbulb-031":"icon-line-globe-01"}),tn.jsx("div",{className:J("qwen-chat-mobile-chat-status-label",{"qwen-chat-mobile-chat-status-label-animate":!m}),children:p}),x?null:tn.jsx(dt,{className:"qwen-chat-mobile-chat-status-after-icon",type:"icon-line-chevron-right"})]}),I===cV.THINKING&&C&&b&&tn.jsx("div",{className:"qwen-chat-mobile-chat-status-answer-now",onClick:T,children:i.t("Skip")})]})}):tn.jsxs(Z,{className:"qwen-chat-status-card",align:"center",justify:"space-between",gap:16,children:[tn.jsxs(Z,{align:"center",gap:8,onClick:()=>{E(!w)},style:{maxWidth:"100%"},children:[tn.jsx(dt,{className:"qwen-chat-mobile-chat-status-before-icon",type:"Fast"!==h?"icon-line-lightbulb-031":"icon-line-globe-01"}),tn.jsx("div",{className:J("qwen-chat-status-card-title",{"qwen-chat-status-card-title-animate":!m}),children:p}),x?null:tn.jsx(dt,{className:"qwen-chat-status-card-after",type:"icon-line-chevron-right"})]}),I===cV.THINKING&&C&&b&&tn.jsx("div",{className:"qwen-chat-status-card-answer-now",onClick:T,children:i.t("Skip")})]})}),dV=e=>{var t,n,i,a;const{message:o}=e,s=Zb(e=>e.thinkingMode),r=O.useMemo(()=>{var e,t;const n=[Zf.DeepThinking,Zf.DeepResearch,Zf.DeepResearchWebDev,Zf.TRAVEL_FEEDBACK,Zf.TRAVEL_RESEARCH].includes((null==o?void 0:o.sub_chat_type)||(null==(t=null==(e=null==o?void 0:o.extra)?void 0:e.meta)?void 0:t.subChatType));return"Fast"!==s&&!n},[null==(n=null==(t=null==o?void 0:o.extra)?void 0:t.meta)?void 0:n.subChatType,null==o?void 0:o.sub_chat_type,s]),l=O.useMemo(()=>{var e,t;return!Array.isArray(null==o?void 0:o.content_list)||!(null==(e=null==o?void 0:o.content_list)?void 0:e.length)||(null==(t=o.content_list)?void 0:t.every(e=>e.phase===ng.ANSWER))},[o.content_list]),c=O.useMemo(()=>null==o?void 0:o.is_stop_in_thinking,[null==o?void 0:o.is_stop_in_thinking]),u=O.useMemo(()=>{var e,t,n;return(null==(t=null==(e=null==o?void 0:o.feature_config)?void 0:e.mcp)?void 0:t.length)||(null==(n=null==o?void 0:o.feature_config)?void 0:n.local_mcp)},[null==(i=null==o?void 0:o.feature_config)?void 0:i.local_mcp,null==(a=null==o?void 0:o.feature_config)?void 0:a.mcp]);return!o||!r&&l||c||u?tn.jsx("div",{className:"response-loading",children:tn.jsx("img",{src:"https://img.alicdn.com/imgextra/i2/O1CN01mIooQw1WN06zUoQHt_!!6000000002775-54-tps-100-20.apng",alt:""})}):tn.jsx(uV,{message:o})},hV=()=>tn.jsx("div",{className:J("function-call-loading")}),pV=e=>{var t;const{message:n}=e,i=tx(e=>e.mobile),a=O.useMemo(()=>tn.jsx(dt,{type:i?"icon-line-information-circle":"icon-line-x-circle-contained"}),[i]),{messageRender:o,descriptionRender:s}=O.useMemo(()=>{var e,t,i;const a=null!=(i=null!=(t=null==(e=null==n?void 0:n.error)?void 0:e.content)?t:null==n?void 0:n.content)?i:"",[o,s]=a.split("\n");return{messageRender:o,descriptionRender:s}},[n.content,null==(t=null==n?void 0:n.error)?void 0:t.content]);return tn.jsx(Ge,{icon:a,description:tn.jsxs("div",{children:[tn.jsx("div",{children:o}),tn.jsx("div",{children:s})]})})},mV="The current content is empty, please regenerate.",fV=e=>{const{emptyText:t=mV}=e,n=G();return tn.jsx("div",{className:"response-message-empty",children:n.t(t)})},gV=({children:e,onLongPress:t,menuRef:n,setCanHideMenu:i,canHideMenu:a=!0,setShowMenu:o,message:s})=>{const r=O.useRef(null),[l,c]=O.useState(null),u=O.useRef(null),d=O.useRef(!1),h=px();let p=null;const m=()=>{h&&(i(!1),o(!1),document.querySelectorAll(".user-message-footer-vertical").forEach(e=>{e.style.left="0",e.style.top="0",e.style.visibility="hidden",e.style.position="absolute",e.style.zIndex=-1}),document.querySelectorAll(".qwen-chat-package-comp-action-control-vertical").forEach(e=>{e.style.left="0",e.style.top="0",e.style.visibility="hidden",e.style.position="absolute",e.style.zIndex=-1}))},f=O.useCallback(e=>{var t;(null==(t=null==n?void 0:n.current)?void 0:t.contains(e.target))&&!a||(d.current=!1,m())},[a,n]);O.useEffect(()=>{a&&(d.current=!1,m())},[a]);const g=(e,t,i,a,o)=>{try{const s=document.querySelector(`#${gg}`);p&&clearTimeout(p),p=setTimeout(()=>{i||g(e,s,n,a,o);const r=null==s?void 0:s.getBoundingClientRect(),l=null==t?void 0:t.getBoundingClientRect(),c=null==i?void 0:i.getBoundingClientRect();if(c&&r&&l){const{height:t,width:n}=c,{x:i,width:s,y:u,height:d}=r,{x:h,y:p}=l;let m=a+h;m+n>i+s&&(m=i+s-n-10,a=m-h);o+t>u+d&&(o=o-t-20>0?o-t-20:0);const f=e.target.closest(".chat-response-message-right").querySelector(".response-message-footer").querySelector(".qwen-chat-package-comp-action-control-vertical");f&&(f.style.left=a+"px",f.style.top=o+"px",f.style.display="block",f.style.visibility="visible",f.style.position="fixed",f.style.zIndex=9)}},100)}catch(s){}},v=O.useCallback((e,i,a)=>{d.current=!0,o(!0);const s=document.querySelector(`#${gg}`),r=e.target.closest(".qwen-chat-message"),l=e.target.closest(".chat-response-message-right").querySelector(".response-message-footer").querySelector(".qwen-chat-package-comp-action-control-vertical");l.style.display="block",n.current=l;const c=a;let u=i;u=(null==l?void 0:l.offsetWidth)+u+50>(null==s?void 0:s.offsetWidth)?Math.max(0,i-(null==l?void 0:l.offsetWidth)-50):i+50,h&&l&&g(e,r,l,u,c),h&&(setTimeout(()=>{window.addEventListener("click",f)},500),null==t||t())},[f,h,t]),y=e=>{var t,n,i,a;if(!(null==(n=null==(t=e.target)?void 0:t.closest)?void 0:n.call(t,".chat-response-media-render"))&&!(null==(a=null==(i=e.target)?void 0:i.closest)?void 0:a.call(i,".qwen-image"))&&s.done&&e.touches){const t=e.touches[0],n=t.clientX,i=t.clientY;c({x:n,y:i}),u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{m(),e.target&&v(e,n,i)},500)}};return O.useEffect(()=>{if(!h||!s.done)return;const e=setTimeout(()=>{document.addEventListener("click",f)},300);return window.addEventListener("click",f),window.addEventListener("touchStart",f),window.addEventListener("touchmove",f),()=>{clearTimeout(e),document.removeEventListener("click",f),window.removeEventListener("click",f),window.removeEventListener("touchStart",f),window.removeEventListener("touchmove",f)}},[f,h,s.done]),tn.jsxs(tn.Fragment,{children:[h&&tn.jsx("div",{ref:r,onClick:e=>e.stopPropagation(),className:h?"chat-response-message-right-touch":"",onPointerDownCapture:y,onTouchStartCapture:y,onTouchMoveCapture:e=>{if(!l||!s.done)return;const t=e.touches[0],n=t.clientX,i=t.clientY,a=n-l.x,o=i-l.y;Math.sqrt(w(a,2)+w(o,2))>5&&(f(e),u.current&&(clearTimeout(u.current),u.current=null),c(null))},onTouchEndCapture:()=>{u.current&&(window.clearTimeout(u.current),u.current=null),c(null)},style:{position:"relative"},children:e}),!h&&tn.jsx("div",{children:e})]})},vV="index-module__resp-recommend-prompt___kh4Uy",yV=({message:e})=>{var t;const n=null==(t=null==e?void 0:e.info)?void 0:t.suggest,{onPromptSend:i}=rT();return Array.isArray(n)&&0!==n.length?tn.jsx("div",{className:vV,children:tn.jsx(Ve,{prompts:n,onClick:e=>{i({inputText:e})}})}):null},bV={[ig.TYPING]:"Analyzing image",[ig.FINISHED]:"Analyzing image completed",[ig.PAUSE]:"Analyzing image stopped",[ig.ERROR]:"Analyzing image failed"},xV=O.memo(({className:e=""})=>tn.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",fill:"none",version:"1.1",width:"18",height:"18.000001907348633",viewBox:"0 0 18 18.000001907348633",children:tn.jsx("g",{transform:"matrix(1,0,0,-1,0,36.000003814697266)",children:tn.jsx("path",{d:"M0,35.00000190734863L0,31.000001907348633Q0,25.615231907348633,3.80761,21.807611907348633Q7.61523,18.000001907348633,13,18.000001907348633L17,18.000003218648633C17.5523,18.000003218648633,18,18.447718907348634,18,19.000001907348633C18,19.552291907348632,17.5523,20.000001907348633,17,20.000001907348633L13,20.000001907348633Q8.44365,20.000001907348633,5.22183,23.221831907348633Q2,26.44365190734863,2,31.000001907348633L2,35.00000190734863C2,35.552301907348635,1.55228,36.00000190734863,1,36.00000190734863C0.447715,36.00000190734863,0,35.552301907348635,0,35.00000190734863Z",fillRule:"evenodd",fill:"currentColor",fillOpacity:"0.5"})})})),wV=O.memo(({imageUrl:e,messageId:t})=>{const[n,i]=O.useState(!1),[a,o]=O.useState(0),s=O.useCallback(e=>P(void 0,null,function*(){i(!0);try{const{width:n,height:i}=yield(t=e,new Promise((e,n)=>{const i=new Image;i.crossOrigin="Anonymous",i.src=t,i.onload=function(){const t=i.width,n=i.height,a=i.naturalWidth,o=i.naturalHeight;e({width:t,height:n,naturalWidth:a,naturalHeight:o})},i.onerror=function(e){n(new Error(""+e))}}));n>i?o(264):n<i&&o(66)}catch(n){}var t;i(!1)}),[]),r=Aq({mediaType:"image",messageId:t||"",preview:{actions:["download","share"],tip:""}});return O.useEffect(()=>{e&&s(e)},[e]),e?tn.jsx("div",{className:"card-image-info",style:{background:n?"linear-gradient(90deg, rgba(216, 218, 227, 0.2) 20%, rgba(160, 162, 177, 0.32) 42%, rgba(216, 218, 227, 0.2) 67%)":`url(${e}) no-repeat center center / cover`,animation:n?"gradient-shift 3s ease infinite":"none",backgroundSize:n?"400% 400%":"cover"},children:tn.jsx("div",{className:"card-image-info-wrapper",children:n?null:tn.jsxs(tn.Fragment,{children:[tn.jsx(xV,{className:"card-image-info-icon card-image-info-icon-bl"}),tn.jsx(xV,{className:"card-image-info-icon card-image-info-icon-br"}),tn.jsx(xV,{className:"card-image-info-icon card-image-info-icon-tl"}),tn.jsx(xV,{className:"card-image-info-icon card-image-info-icon-tr"}),tn.jsx("div",{style:{width:`${a}px`,backgroundImage:`url(${e})`},className:"card-image-info-content",children:tn.jsx(Te,_({url:e},r))})]})})}):null}),SV=e=>{var t;const{detail:n,message:i,isStop:a,id:o}=e,s=G(),r=tx(e=>e.mobile),l=Wb(e=>e.setImageReasonData),c=Wb(e=>e.chatId),u=yE(e=>e.setShowControls),d=Zb(e=>e.setCurrentShowControl),h=Zb(e=>e.taskRunning),[p,m]=O.useState(!1),f=O.useMemo(()=>(null==i?void 0:i.error)?"error":(null==i?void 0:i.done)?"done":h?"loading":"pause",[null==i?void 0:i.done,null==i?void 0:i.error,h]),g=O.useMemo(()=>n.status===ig.FINISHED?s.t("Thinking with image completed"):"error"===f||n.status===ig.ERROR?s.t("Thinking with image failed"):a||n.status===ig.PAUSE?s.t("Thinking with image stopped"):n.status===ig.TYPING?s.t("Thinking with image is running"):"",[n.status,s,a,f]),v=O.useMemo(()=>{var e,t,i;return(null==(i=null==(t=null==(e=null==n?void 0:n.extra)?void 0:e.image_zoom_in_tool_info)?void 0:t[0])?void 0:i.image)||""},[null==(t=null==n?void 0:n.extra)?void 0:t.image_zoom_in_tool_info]),y=O.useMemo(()=>[ig.TYPING,ig.FINISHED].includes(null==n?void 0:n.status),[null==n?void 0:n.status]),b=O.useMemo(()=>(null==n?void 0:n.status)===ig.TYPING&&"loading"===f,[null==n?void 0:n.status,f]),x=O.useCallback(e=>{if(e.stopPropagation(),m(!p),bx())return oT.adapter.invoke({method:"storeInfo",params:{key:"chatNativeImageReason",value:JSON.stringify({status:null==n?void 0:n.status,imageUrl:v,messageId:i.id})}}),void oT.adapter.invoke({method:"openHalfWindow",params:{type:"openUrl",windowSize:50,content:`${location.origin}/mobile/chatcontrols/imageReason?id=${c}`}});r&&(u(!0),d(tg.ImageReason),l({status:(null==n?void 0:n.status)||"",imageUrl:v,messageId:i.id}))},[c,null==n?void 0:n.status,v,i.id,r,d,l,u,p]);return O.useEffect(()=>{p&&[ig.TYPING,ig.FINISHED].includes(null==n?void 0:n.status)&&(r&&l({status:(null==n?void 0:n.status)||"",imageUrl:(null==n?void 0:n.imageUrl)||v,messageId:i.id}),bx()&&oT.adapter.invoke({method:"storeInfo",params:{key:"chatNativeImageReason",value:JSON.stringify({status:null==n?void 0:n.status,imageUrl:v})}}))},[n,null==n?void 0:n.status,v,i.id,r,l,p]),tn.jsxs("div",{className:"qwen-chat-comp-chat-mage-reasoning","data-phase-id":o,children:[tn.jsxs("div",{className:"qwen-chat-comp-chat-mage-reasoning-card",onClick:x,children:[!r&&tn.jsx("div",{className:"qwen-chat-comp-chat-mage-reasoning-card-icon",children:tn.jsx(dt,{type:"icon-line-image-reason",style:{color:`var(${y?"--character-brandprimary-text":"--character-tertiary-text"})`}})}),tn.jsx("div",{className:"qwen-chat-comp-chat-mage-reasoning-card-title "+(b?"qwen-chat-comp-chat-mage-reasoning-card-title-animate":""),children:g}),tn.jsx("div",{className:"qwen-chat-comp-chat-mage-reasoning-card-open",children:tn.jsx(dt,{type:p&&!r?"icon-line-chevron-down":"icon-line-chevron-right"})})]}),!r&&p&&tn.jsxs("div",{className:"qwen-chat-comp-chat-mage-reasoning-detail",children:[tn.jsx("div",{className:"qwen-chat-comp-chat-mage-reasoning-detail-status",children:s.t(bV[(null==n?void 0:n.status)||ig.TYPING]||"")}),(null==n?void 0:n.status)===ig.FINISHED&&tn.jsx(wV,{imageUrl:v})]})]})},_V=e=>{const t=null==e?void 0:e.parentElement;if(t){if("chat-message-container"!==t.id)return _V(t);{const t=e.previousElementSibling;if(t){const e=t.querySelectorAll("img"),n=e[e.length-1];if(n)return n}}}return null},CV=e=>{var t,n,i,a;let o=0,s=0,r=!1;const l=null==(t=e.content_list)?void 0:t.find(e=>{var t,n;return e.phase===ng.IMAGE_GEN&&(null==(n=null==(t=null==e?void 0:e.extra)?void 0:t.output_image_hw)?void 0:n[0])});if(l){o=Number((null==(n=l.extra.output_image_hw[0])?void 0:n[1])||0),s=Number((null==(i=l.extra.output_image_hw[0])?void 0:i[0])||0),r=!0}if(!o&&!s&&(null==(a=null==e?void 0:e.info)?void 0:a.size)){const[t,n]=e.info.size.split(":");o=Number(t),s=Number(n)}return{width:o||0,height:s||0,fromServerSize:r}},EV=({children:e,url:t,messageId:n})=>{const{i18n:i}=G(),a=tx(e=>e.mobile),o=Wb(e=>e.chatId),s=Zb(e=>e.setWelcomeModalShow),r=yE(e=>e.isSharePage),[l,c]=O.useState(!1),u=O.useCallback(()=>P(void 0,null,function*(){yield K_({role:"assistant",url:t}),BS("clkdownloadBtn",{params:{et:"CLK",c5:"chat",c6:t},paramsExtend:{chat_id:o,msg_id:n||""}})}),[t,o,n]),d=O.useCallback(()=>P(void 0,null,function*(){bT()?s(!0):yield oT.makeVideoOrImageByImageGen({chatType:Zf.VideoGeneration,files:[{type:"image",name:"example.png",file_type:"image/png",showType:"image",file_class:"vision",url:t,isQuote:!0}]})}),[t,s]),h=O.useCallback(()=>P(void 0,null,function*(){const e=[{type:"image",name:"example.png",file_type:"image/png",showType:"image",file_class:"vision",status:"uploaded",url:t,isQuote:!0}];yield oT.makeVideoOrImageByImageGen({chatType:Zf.ImageGeneration,subChatType:Zf.ImageGeneration,files:e})}),[t,o,n]),p=O.useMemo(()=>r?[]:[{key:"create_video",label:i.t("Create video"),callback:d},{key:"image_edit",label:i.t("Edit"),callback:h,visible:!0}].map(e=>{const t=EG.find(t=>t.key===e.key);return _(_({},t),e)}),[d,h,r]),m=O.useMemo(()=>[{key:"download",label:i.t("Download"),callback:u}].map(e=>{const t=EG.find(t=>t.key===e.key);return _(_({},t),e)}),[o,n,t]);return a?e:tn.jsxs("div",{className:"image-tool-container "+(l?"image-tool-container-hover":""),onMouseEnter:()=>{c(!0)},onMouseLeave:()=>{c(!1)},children:[t&&tn.jsx("div",{className:"control-card-top",children:m.map(e=>tn.jsx(ft,{title:e.label,placement:"bottom",children:tn.jsx("div",{className:`upper-right-corner-item qwen-chat-package-comp-new-action-control-container qwen-chat-package-comp-new-action-control-container-${e.key}`,onClick:e.callback,children:tn.jsx(dt,{type:e.icon||"",className:"qwen-chat-package-comp-new-action-control-icon"})})},`renderOnlyIcon_${e.key}`))}),p.length>0&&t&&tn.jsx(Z,{justify:"center",align:"center",gap:8,className:"lower-center-container control-card-bottom",children:p.map(({key:e,defaultToolTip:t,label:n,icon:i,callback:a},o)=>{const s=tn.jsx(ft,{title:t,children:tn.jsxs(Z,{gap:4,align:"center",onClick:a,className:"lower-center-item",children:[tn.jsx(dt,{type:i||""}),tn.jsx("div",{className:"lower-center-item-label",children:n})]})},e);return o?s:tn.jsxs(tn.Fragment,{children:[s,tn.jsx("div",{className:"lower-center-item-divider"})]})})}),e]})},kV=e=>{var t;const{detail:n,message:i,onMediaError:a}=e,o=Wb(e=>e.chatId),{i18n:s}=G(),r=tx(e=>e.mobile),l=tx(e=>e.config),c=yE(e=>e.realTheme),u=yE(e=>e.isSharePage),d=Zb(e=>e.temporaryChatEnabled),[h,p]=O.useState(!1),[m,f]=O.useState(0),[g,v]=O.useState(0),[y,b]=O.useState(""),x=O.useRef(null),w=O.useRef(!1),S=O.useRef(0),E=O.useRef(0),k=!0,I=O.useMemo(()=>{var e,t,i,a;const o=(null==(e=n.extra)?void 0:e.image_list)||(null==(t=n.extra)?void 0:t.tool_result),s=null==(i=null==o?void 0:o[0])?void 0:i.image;return(e=>/^https?:\/\/.*\.(?:jpg|jpeg|png|gif|bmp|webp|svg)(\?.*)?$/i.test(e))(s)?s:"Tool Execution Failed."===(null==(a=n.extra)?void 0:a.tool_result)?(p(!0),""):""},[n]),T=O.useMemo(()=>{const e=mx()?450:320,t=`x-oss-process=image/resize,m_mfit,w_${e},h_${e}`;return I?I.includes("qwen-webui")?I:`${I}${I.includes("?")?"&":"?"}${t}`:""},[I]),j=O.useMemo(()=>r?{width:[114,300],height:[126,380]}:[133,400],[r]),N=O.useMemo(()=>{if(u)return["download"];if(bT()||d)return["video","edit","download"];return["video","edit","download"]},[null==(t=null==l?void 0:l.function_entry)?void 0:t.community,u,d]),P=Aq({mediaType:"image",messageId:i.id||"",preview:{actions:N,tip:y}}),M=i.is_stop,A=!I,R=M&&!I,D=O.useMemo(()=>{if(!I&&!M)return{iconUrl:"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.2.8/static/images/image-generating-icon.png",skeletonUrl:`//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.2.8/static/images/media-generating-${c}-1.png`}},[k,c,I,M]),L=O.useCallback(()=>{null==a||a();let e="Image Load Error";return h?e="Generate Error":R?e="Image generation has been stopped.":A&&(e="The current content is empty, please regenerate."),{errorMessage:s.t(e)}},[s,A,R,h,k,a]),F=O.useCallback(e=>{if(e.currentTarget){const{naturalWidth:t,naturalHeight:n}=e.currentTarget;f(t),v(n),e.currentTarget.removeEventListener("load",F)}},[]),U=O.useMemo(()=>null==i?void 0:i.is_stop_in_thinking,[null==i?void 0:i.is_stop_in_thinking]);O.useEffect(()=>{const e=_V(x.current);return()=>{null==e||e.removeEventListener("load",F)}},[F]),O.useEffect(()=>(S.current=S_(),()=>{w.current=!0}),[]);const z=O.useCallback((e,t,n)=>{BS("messageImgOnLoadTime",{params:{et:"OTHER",c4:o||"",c5:"answer",c6:n,c7:Math.round(e),c8:Math.round(t),c9:Math.round(t-e)}})},[o]),H=O.useCallback(()=>{E.current=S_(),z(S.current,E.current,I)},[z,I]);return U&&!I||!(null==n?void 0:n.function_id)||h?null:tn.jsx("div",{ref:x,className:"chat-response-media-render",children:tn.jsx(EV,{url:I,messageId:i.id||"",children:tn.jsx(Te,C(_({url:I,thumbnailUrl:T,defaultWidth:16,defaultHeight:9,width:m,height:g,sizeScope:j,generation:D,error:(h||A)&&"typing"!==n.status,isStop:R,onError:L},i.isShare?{}:P),{onLoad:H}))})})},IV=O.memo(({message:e,isDeepResearch:t,isLastMessage:n})=>{var i,a;const o=tx(e=>e.mobile),s=Zb(e=>e.visionGenerating),r=Zb(e=>e.taskRunning),l=G(),c=O.useMemo(()=>s||r,[s,r]),u=O.useRef(e),d=O.useRef(null);O.useEffect(()=>{u.current=e},[e]);const[h,p]=O.useState(We.GEN_PROCESS),m=O.useRef(h),f=O.useMemo(()=>N_(null==e?void 0:e.timestamp),[null==e?void 0:e.timestamp]),g=O.useMemo(()=>{var t,n;let i="";return(null==e?void 0:e.chat_type)===Zf.Artifacts||(null==e?void 0:e.chat_type)===Zf.WebDev?(i=((null==(n=null==(t=null==e?void 0:e.extra)?void 0:t.meta)?void 0:n.subChatType)||e.sub_chat_type)===Zf.WebDev?l.t("Web Dev"):l.t("Artifacts"),i):(Array.isArray(null==e?void 0:e.content_list)&&e.content_list.map(e=>{var t;return e.phase!==ng.ANSWER&&e.phase!==ng.DEEPTHINKING||(i=null==(t=e.extra)?void 0:t.topic),i}),i)},[null==e?void 0:e.content_list,null==e?void 0:e.chat_type,null==(a=null==(i=null==e?void 0:e.extra)?void 0:i.meta)?void 0:a.subChatType,e.sub_chat_type,l]),v=O.useMemo(()=>({loadingText:l.t("Youll be informed immediately upon completion."),errorText:l.t("Generation failed. Please try again.")}),[l]);O.useEffect(()=>{if(e){let t=We.GEN_PROCESS;(null==e?void 0:e.error)?t=We.GEN_ERROR:(!c||(null==e?void 0:e.done)||(null==e?void 0:e.is_stop))&&(t=We.FINISH),p(t)}},[e,c]);const y=t=>{var n;bx()?oT.nativeArtifactsUpdata(u.current,!e.done&&!e.error&&!(null==e?void 0:e.is_stop)):oT.updataArtifacts(null==(n=u.current)?void 0:n.id,t)},b=t=>{d.current=setInterval(()=>{e.done||e.error||(null==e?void 0:e.is_stop)?(y(t),clearInterval(d.current),d.current=null):y(t)},200)},x=({open:t}={})=>{var n,i;if(bx())return Zb.setState({currentShowControl:tg.Artifacts}),oT.nativeArtifactsShow(u.current,void 0,!e.done&&!e.error&&!(null==e?void 0:e.is_stop)),void(e.done||e.error||(null==e?void 0:e.is_stop)?oT.emit(qC.MESSAGE_STOP_ARTIFACTS_LOOP):(clearInterval(d.current),b(!0)));if(oT.getCurrentChatCurrentId()===(null==(n=u.current)?void 0:n.id)||!t){const n=oT.openArtifacts(null==(i=u.current)?void 0:i.id,t);e.done||e.error||(null==e?void 0:e.is_stop)||!n?oT.emit(qC.MESSAGE_STOP_ARTIFACTS_LOOP):(clearInterval(d.current),b(o))}};O.useEffect(()=>{m.current=h,(e.done||e.error||(null==e?void 0:e.is_stop))&&d.current&&(d.current&&y(o),oT.emit(qC.MESSAGE_STOP_ARTIFACTS_LOOP))},[e]);return O.useEffect(()=>{if(!t&&!o&&e.id&&n)return e.done||e.error||(null==e?void 0:e.is_stop)||x({open:!0}),()=>{clearInterval(d.current)}},[]),O.useEffect(()=>{const e=()=>{clearInterval(d.current),d.current=null};return oT.on(qC.MESSAGE_STOP_ARTIFACTS_LOOP,e),()=>{oT.off(qC.MESSAGE_STOP_ARTIFACTS_LOOP,e)}},[]),tn.jsx(ze,{className:"pdf-card",onCardClick:()=>{(t&&h!==We.GEN_PROCESS||!t)&&(oT.emit(qC.MESSAGE_STOP_ARTIFACTS_LOOP),x())},info:{time:f,name:g},tipTexts:v,status:h,type:He.WEBPAGE,toolsOption:{loofOver:{visible:!t,onLookOver:()=>{oT.emit(qC.MESSAGE_STOP_ARTIFACTS_LOOP),x()}}}})}),TV=e=>{const t=q(),n=iy(),i=Wb(e=>e.chatId),a=tx(e=>e.mobile),o=Zb(e=>e.setWelcomeModalShow),s=dT(e=>e.onNativeCalling),r=dT(e=>e.setUnsupportedLanguageVoicePlayMessageIds),l=dT(e=>e.unsupportedLanguageVoicePlayMessageIds),c=dT(e=>e.voicePlayingMessageId),u=dT(e=>e.setVoicePlayingMessageId),d=yE(e=>e.setShowSettingsGeneralAudioList),[h,p]=O.useState(!1),[m,f]=O.useState(!1),[g,v]=O.useState(!localStorage.getItem("ttsGuideVisible")),y=O.useMemo(()=>l.includes(e.id),[e,l]),b=O.useMemo(()=>!bx()||((e,t=!1)=>{const n=yx(),i=e.split(".").map(Number),a=n.split(".").map(Number);for(let o=0;o<3;o++){const e=i[o]||0,t=a[o]||0;if(t<e)return!1;if(t>e)return!0}return t})("1.6.0",!0),[]),x=O.useCallback(()=>{localStorage.getItem("ttsGuideVisible")||(localStorage.setItem("ttsGuideVisible","true"),v(!0))},[]),w=O.useCallback(t=>{switch(t){case Fk.PLAYING:return f(!1),p(!0),void u(e.id);case Fk.READY:case Fk.STOPPED:case Fk.PAUSED:f(!1),p(!1);break;case Fk.UNSUPPORTED_LANGUAGE:r([...new Set([...l,e.id])]),f(!1),p(!1);break;default:f(!0),p(!1)}u("")},[e,r,u,l]),S=O.useCallback(()=>P(void 0,null,function*(){var n;if(y)a&&(ut.open({type:"warning",content:t.t("Currently, only Chinese and English are supported. More languages are coming soon.")}),x());else if(!m)if(h)Jk.getInstance().stopAllPlayer();else{if(bx()){let e=!s;if(e&&(null==window?void 0:window.QwenChat))try{const{result:t}=yield null==(n=null==window?void 0:window.QwenChat)?void 0:n.requestAudioFocus();e=t}catch(o){}if(!e)return ut.openOnce({type:"error",content:t.t("The media audio is in use and playback is not supported.")}),void x()}Jk.getInstance().startTTS(i,e.id,w),x()}}),[w,x,i,t,e,a,s,y,h,m]),_=O.useCallback(()=>{v(!1)},[]),C=O.useCallback(()=>{if(_(),Jk.getInstance().stopAllPlayer(),bT())bx()?oT.adapter.invoke({method:"showAlert",params:{type:"login"}}):o(!0);else if(bx()){const e="qwen://settings/tts-speakers";oT.adapter.invoke({method:"openWindow",params:{uri:e}})}else a?n("/settings/voice"):(d(!0),n("/settings/general"))},[a,n,d,o,_]);return O.useEffect(()=>{c===e.id&&p(!0)},[e.id,c]),{voiceDisabled:y,voiceActive:h,setVoiceActive:p,voiceLoading:m,setVoiceLoading:f,voiceGuideVisible:g,setVoiceGuideVisible:v,voiceCallback:S,voiceGuideCloseClick:_,voiceGuideButtonClick:C,voiceGuideBtnVisible:b}},jV=(e,t)=>{var n,i,a,o,s,r,l,c,u;const d=Wb(e=>e.chatId),h=aI(e=>e.models),p=Wb(e=>e.history.currentId),m=Wb(e=>e.setCallBackInfo),f=Wb(e=>e.callBackInfo),g=Wb(e=>e.badFeedbackVisible),v=Wb(e=>e.setBadFeedbackVisible),y=G(),[b,x]=O.useState("1"===(null!=(i=null==(n=null==e?void 0:e.annotation)?void 0:n.rating)?i:"").toString()),[w,S]=O.useState("-1"===(null!=(o=null==(a=null==e?void 0:e.annotation)?void 0:a.rating)?o:"").toString()),[E,k]=O.useState((null==(r=null==(s=null==e?void 0:e.annotation)?void 0:s.reason)?void 0:r.split(","))||[]),[I,T]=O.useState((null==(l=null==e?void 0:e.annotation)?void 0:l.comment)||""),j=O.useMemo(()=>!(!t||!(null==f?void 0:f.id))||e.id===p,[t,null==f?void 0:f.id,e.id,p]),N=O.useMemo(()=>{var t,n;return(null==(t=null==e?void 0:e.annotation)?void 0:t.comment)||(null==(n=null==e?void 0:e.annotation)?void 0:n.reason)},[null==(c=null==e?void 0:e.annotation)?void 0:c.comment,null==(u=null==e?void 0:e.annotation)?void 0:u.reason]),M=O.useCallback(()=>P(void 0,null,function*(){const t={badFeedbackList:dg,defaultContents:E,inputText:I};oT.adapter.invoke({method:"storeInfo",params:{key:rI(tg.Feedback),value:JSON.stringify(t)}}),oT.adapter.invoke({method:"openHalfWindow",params:{type:"openUrl",content:`${lI(tg.Feedback)}?messageId=${e.id}`}})}),[E,I,e.id]),A=O.useCallback((t=null,n=null)=>P(void 0,null,function*(){var i,a,o,s,r,l,c,u,p,m,f;!n&&1!==t&&j&&(bx()?M():v(!0));const g=yield pS({chat_id:d});if(!g)return;const b=C(_({},e),{annotation:_(_(_({type:"rating",rating:null!=(a=null!=t?t:null==(i=null==e?void 0:e.annotation)?void 0:i.rating)?a:0},null!=(o=null==e?void 0:e.annotation)?o:{}),null!==t?{rating:t}:{}),n||{})});1===t&&((null==(s=b.annotation)?void 0:s.comment)&&delete b.annotation.comment,(null==(r=b.annotation)?void 0:r.reason)&&delete b.annotation.reason);const x=g.data.chat.history,w=sC(e.id,x),S={type:"rating",data:_(C(_({},(null==b?void 0:b.annotation)?b.annotation:{}),{rating:null!=(c=null!=t?t:null==(l=null==e?void 0:e.annotation)?void 0:l.rating)?c:0,model_id:null!=(u=null==e?void 0:e.selectedModelId)?u:e.model}),x.messages[e.parentId].childrenIds.length>1?{sibling_model_ids:x.messages[e.parentId].childrenIds.filter(t=>t!==e.id).map(e=>{var t,n;return null!=(n=null==(t=x.messages[e])?void 0:t.selectedModelId)?n:x.messages[e].model})}:{}),meta:{model_id:e.model,message_id:e.id,message_index:w.length,chat_id:d},snapshot:{chat:g}},E=[S.data.model_id,...null!=(p=S.data.sibling_model_ids)?p:[]].reduce((e,t)=>{var n,i;const a=h.find(e=>e.id===t);return a&&(e[a.id]=null!=(i=null==(n=null==a?void 0:a.info)?void 0:n.base_model_id)?i:null),e},{});S.meta.base_models=E;let k=null;var I;(null==(m=x.messages[e.id])?void 0:m.feedbackId)?k=yield(I={id:null==(f=x.messages[e.id])?void 0:f.feedbackId,feedback:S},P(void 0,null,function*(){return yield Ox(`/evaluations/feedback/${I.id}`,{method:"POST",data:I.feedback})})).catch(e=>{ut.open({type:"error",content:e})}):(k=yield(e=>P(void 0,null,function*(){return yield Ox("/evaluations/feedback",{method:"POST",data:e.feedback})}))({feedback:S}).catch(e=>{ut.open({type:"error",content:e})}),k&&(b.feedbackId=k.id)),yield oT.updateMessage(e.id,b),n&&-1===t&&ut.open({type:"success",content:y.t("Thanks for your feedback!")})}),[d,y,j,e,h,M,v]),R=O.useCallback(()=>P(void 0,null,function*(){x(!0),S(!1),v(!1),k([]),T(""),p===e.id||(null==f?void 0:f.id)||!t?((null==f?void 0:f.id)&&m(null),yield A(1),window.setTimeout(()=>{var t;null==(t=document.getElementById(`message-feedback-${e.id}`))||t.scrollIntoView()},0)):m({name:"goodCallback",id:e.id})}),[A,null==f?void 0:f.id,p,t,e.id,v,m]),D=O.useCallback(()=>P(void 0,null,function*(){var n;if(S(!0),x(!1),p===e.id||(null==f?void 0:f.id)||!t){if(j&&N)return bx()?M():v(!0),window.setTimeout(()=>{var e;null==(e=document.getElementById(`message-feedback-${null==f?void 0:f.id}`))||e.scrollIntoView()},0),void m(null);yield A(-1),window.setTimeout(()=>{var t;null==(t=document.getElementById(`message-feedback-${e.id}`))||t.scrollIntoView()},0);try{HS("clickMessageStep",{params:{et:"CLK",c4:d,c5:e.id,c6:null==e?void 0:e.parentId,c7:null==(n=null==e?void 0:e.content_list[0])?void 0:n.content}})}catch(i){}}else m({name:"badCallback",id:e.id})}),[A,null==f?void 0:f.id,d,N,p,j,t,null==e?void 0:e.content_list,e.id,null==e?void 0:e.parentId,M,v,m]),L=O.useCallback(()=>{v(!1)},[v]),F=O.useCallback((t,n)=>P(void 0,null,function*(){var i,a,o,s,r;k(t),T(n);const l={comment:n,reason:t.join(",")};try{yield A(-1,l),HS("submitMessageFeedback",{params:{et:"CLK",c4:d,c5:e.id,c6:null==e?void 0:e.parentId,c7:(null==(a=null==(i=null==e?void 0:e.content_list)?void 0:i[0])?void 0:a.content)||(null==e?void 0:e.content),c8:l}})}catch(c){HS("submitMessageFeedbackErr",{params:{et:"OTHER",c4:d,c5:e.id,c6:null==e?void 0:e.parentId,c7:(null==(s=null==(o=null==e?void 0:e.content_list)?void 0:o[0])?void 0:s.content)||(null==e?void 0:e.content),c8:l,c9:c||""}})}bx()?null==(r=null==window?void 0:window.QwenChat)||r.closeHalfWindow():v(!1)}),[A,d,null==e?void 0:e.content,null==e?void 0:e.content_list,e.id,null==e?void 0:e.parentId,v]),U=O.useCallback(e=>{F(e.feedbackInfo.detail.content,e.feedbackInfo.detail.text)},[F]);return O.useEffect(()=>{bx()&&oT.firstOn(qC.MESSAGE_FEEDBACK_SUBMIT,U)},[U]),{clickedGood:b,clickedBad:w,badFeedbackVisible:g&&(!!t||j),defaultContents:E,inputText:I,goodCallback:R,badCallback:D,onCloseFeedback:L,onSubmitFeedback:F}},NV=e=>{const{chatId:t,messageId:n,setShow:i,show:a,onClose:o}=e,s=G(),[r,l]=O.useState(null),[c,u]=O.useState(""),[d,h]=O.useState(""),[p,m]=O.useState(!1),f=O.useRef(!1),g=tx(e=>e.mobile),v=Zb(e=>e.taskRunning),y=O.useCallback(()=>P(void 0,null,function*(){let e="";var a;(yield(a={chatId:t,messageId:n},P(void 0,null,function*(){return yield Ox("/share/message/new",{method:"POST",data:{chat_id:a.chatId,message_id:a.messageId}})})).then(t=>{e=t.data.share_url,u(t.data.share_url),h(t.data.share_id)}).catch(e=>{ut.open({type:"error",content:s.t(e.message)})}))||i(!1);const o=yield pS({chat_id:t});return l(o.data),e}),[t,s,n,i,c]),b=O.useCallback(e=>!r||!!e&&((null==r?void 0:r.id)!==e.id||(null==r?void 0:r.share_id)!==e.share_id),[r]),x=O.useCallback(()=>P(void 0,null,function*(){if(f.current)return;f.current=!0;const e=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);try{if(dx()||e||rx())yield navigator.clipboard.write([new ClipboardItem({"text/plain":new Promise((e,n)=>P(void 0,null,function*(){try{let n=yield y();n+=`?${Ck}=${kk()}`,e(new Blob([n],{type:"text/plain"})),BS("clkShareCopyLink",{params:{et:"CLK",c6:n},paramsExtend:{chat_id:t}})}catch(i){n(i)}}))})]);else{let e=yield y();if(!e)return;e+=`?${Ck}=${kk()}`,BS("clkShareCopyLink",{params:{et:"CLK",c6:e},paramsExtend:{chat_id:t}}),setTimeout(()=>{C_(e),f.current=!1},10)}ut.open({type:"success",content:s.t("Copied shared chat URL to clipboard!")}),o()}catch(n){}f.current=!1}),[t,s,o,y,v]),w=O.useRef(!1);return O.useEffect(()=>{a&&!w.current?P(void 0,null,function*(){const e=yield pS({chat_id:t});b(e)&&(l(e.data),w.current=!0)}):a||(l(null),w.current=!1)},[a,t,b]),O.useEffect(()=>{var e,t,i,a,o;if(r&&n&&(null==(e=null==r?void 0:r.chat)?void 0:e.history)&&(null==(i=null==(t=null==r?void 0:r.chat)?void 0:t.history)?void 0:i.messages)){const e=r.chat.history.messages[n],t=null==(o=null==(a=null==e?void 0:e.extra)?void 0:a.meta)?void 0:o.share;t&&t.shareId?(m(!0),u(t.shareUrl),h(t.shareId)):m(!1)}else m(!1)},[r,n]),r?g?tn.jsx(ht,{visible:a,header:!1,footer:!1,closable:!1,size:"small",maskClosable:!0,onCancel:o,children:tn.jsxs("div",{className:"mobile-share-modal",children:[tn.jsx("div",{className:"mobile-share-modal-title",children:s.t("Share Conversation")}),tn.jsxs("div",{className:"mobile-share-modal-content",children:[tn.jsx("div",{className:"mobile-share-modal-content-main",children:p?tn.jsxs(tn.Fragment,{children:[fx()&&!kx("1.0.0")?tn.jsxs(tn.Fragment,{children:[s.t("You have shared this chat"),tn.jsx("span",{children:s.t("before")}),"."]}):tn.jsx(tn.Fragment,{children:tn.jsxs("a",{href:c,target:"_blank",children:[s.t("You have shared this chat"),tn.jsxs("span",{children:[s.t("before"),"."]})]})}),s.t("Click here to"),tn.jsx("button",{onClick:()=>P(void 0,null,function*(){if(yield TS({id:d}).then(()=>{ut.open({type:"success",content:s.t("The shared link has been successfully deleted!")})}).catch(e=>(ut.open({type:"error",content:s.t(e.message)}),o(),null))){const e=yield pS({chat_id:t});l(e.data)}o()}),children:s.t("delete this link")}),s.t("and create a new shared link.")]}):s.t("Messages you send after creating your link won't be shared. Users with the URL will be able to view the shared chat.")}),tn.jsx("div",{className:"mobile-share-modal-content-end",children:tn.jsx("div",{className:"mobile-share-modal-content-end-content",children:tn.jsx("div",{})})})]}),tn.jsxs("div",{className:"mobile-share-modal-footer",children:[tn.jsx(pt,{onClick:x,children:p?s.t("Update and Copy Link"):s.t("Copy Link")}),tn.jsx(pt,{type:"link",onClick:o,children:s.t("Cancel")})]})]})}):tn.jsx(ht,{className:"web-share-modal",size:"small",title:s.t("Share Conversation"),onCancel:o,visible:a,headerBorderNone:!0,onOk:x,okText:p?s.t("Update and Copy Link"):s.t("Copy Link"),cancelButtonProps:{hidden:!0},okButtonProps:{iconFontType:"icon-Link1",iconFontStyle:{fontSize:12},type:"brandprimary",size:"middle",buttonStyle:{height:"36px"},rounded:"circle"},children:tn.jsx("div",{children:tn.jsx("div",{className:"share-modal-main",children:tn.jsx("div",{className:"share-modal-main-content",children:p?tn.jsxs(tn.Fragment,{children:[wx()?tn.jsxs("a",{className:"share-modal-main-conten-link",children:[s.t("You have shared this chat"),tn.jsx("span",{onClick:e=>Tx(e,c),children:s.t("before")}),"."]}):tn.jsxs("a",{href:c,className:"share-modal-main-conten-link",target:"_blank",children:[s.t("You have shared this chat"),tn.jsxs("span",{children:[s.t("before"),"."]})]}),s.t("Click here to"),tn.jsx("button",{onClick:()=>P(void 0,null,function*(){if(yield TS({id:d}).then(()=>{ut.open({type:"success",content:s.t("The shared link has been successfully deleted!")})}).catch(e=>(ut.open({type:"error",content:s.t(e.message)}),o(),null))){const e=yield pS({chat_id:t});l(e.data)}o()}),children:s.t("delete this link")}),s.t("and create a new shared link.")]}):s.t("Messages you send after creating your link won't be shared. Users with the URL will be able to view the shared chat.")})})})}):null},PV=aG(e=>{var t,n,i,a,o,s,r,l,c,u,d;const{message:h,error:p,showMenu:m,setEditedContent:f,setCanHideMenu:g,setNativeEditing:v,editSaveHandler:y,isEdit:b,setIsEdit:x,isOldMessageInNewBranch:w,isMultiChat:S,active:E,type:k="normal",podcastAsyncLoading:I,fullShowControl:T=!0}=e,j=Wb(e=>e.chatMode),N=tx(e=>e.mobile),M=Wb(e=>e.allSearchAndThinkLists),A=Zb(e=>e.setCurrentShowControl),R=Wb(e=>e.setCurrentInputSubType),D=Wb(e=>e.setCurrentCitationInfo),L=yE(e=>e.setShowControls),F=Wb(e=>e.setEmitSendPromptType),{i18n:U}=G(),z=Wb(e=>e.chatId),[H,$]=O.useState(!1),[B,q]=O.useState(!1),V=tx(e=>e.config),W=Zb(e=>e.visionGenerating),Q=Zb(e=>e.taskRunning),K=Wb(e=>e.history.messages);rT(e=>e.setFiles);const Y=Zb(e=>e.setWelcomeModalShow),X=Wb(e=>e.callBackInfo),J=Wb(e=>e.setCallBackInfo),Z=O.useMemo(()=>(!b||b&&N&&z)&&!h.isShare,[b,N,z,h]),ee=Zb(e=>e.setCurrentActionMessageId),{voiceDisabled:te,voiceActive:ne,voiceLoading:ie,voiceGuideVisible:ae,voiceGuideBtnVisible:oe,voiceCallback:se,voiceGuideCloseClick:re,voiceGuideButtonClick:le}=TV(h),{clickedGood:ce,goodCallback:ue,clickedBad:de,badCallback:he,badFeedbackVisible:pe,defaultContents:me,inputText:fe,onCloseFeedback:ge,onSubmitFeedback:ve}=jV(h,S),[ye,be]=O.useState(""),[xe,we]=O.useState(!1),Se=Wb(e=>e.currentInputFeature),_e=Wb(e=>e.branchInfo),Ce=Zb(e=>e.setLocateTheSearchSource),{openNativePopup:Ee}=RG({message:h}),ke=O.useCallback(e=>{oT.setSelectLocalLanguageCode(e),be(e)},[]),Ie=O.useCallback(()=>P(void 0,null,function*(){if(null==V?void 0:V.language){const e=yield oT.getSelectLocalLanguageCode(V,U.language);ke(e)}}),[V,U.language,ke]);O.useEffect(()=>{(null==V?void 0:V.language)&&Ie()},[V,Ie]);const Te=O.useMemo(()=>{var e;return bx()&&!kx("1.4.0",!1)||(null==h?void 0:h.chat_type)===Zf.DeepResearch||!(null==(e=null==V?void 0:V.language)?void 0:e.length)||h.isMultiResponse?[{key:Re.copy,text:U.t("Copy")}]:[{key:Re.copy,text:U.t("Copy")},{key:Re.translate,text:U.t("Translate")}]},[null==h?void 0:h.chat_type,null==(t=null==V?void 0:V.language)?void 0:t.length,U]),je=O.useMemo(()=>(null==V?void 0:V.language)||[],[V]),Ne=O.useMemo(()=>(null==h?void 0:h.siblings)||CC(h.id||h.fid),[h]),Pe=O.useMemo(()=>(null==Ne?void 0:Ne.indexOf((null==h?void 0:h.id)||(null==h?void 0:h.fid)||""))+1,[h.fid,h.id,Ne]),Ae=O.useMemo(()=>null==Ne?void 0:Ne.length,[Ne]),Oe=O.useMemo(()=>dg.map(e=>({title:U.t(e.title),content:e.content.map(e=>C(_({},e),{label:U.t(e.label)}))})),[U]),Le=O.useMemo(()=>{var e;return(null==(e=null==M?void 0:M[(null==h?void 0:h.id)||""])?void 0:e.webSearchInfo)||[]},[M,null==h?void 0:h.id]),Fe=O.useMemo(()=>{var e;return["RateLimited","ParallelLimited","quotaLimited"].includes((null==(e=null==h?void 0:h.error)?void 0:e.errorCode)||"")},[null==(n=null==h?void 0:h.error)?void 0:n.errorCode]),Ue=O.useMemo(()=>{var e;return"NetworkError"===(null==(e=null==h?void 0:h.error)?void 0:e.errorCode)},[null==(i=null==h?void 0:h.error)?void 0:i.errorCode]),ze=O.useMemo(()=>{var e;return"data_inspection_failed"===(null==(e=null==h?void 0:h.error)?void 0:e.errorCode)},[null==(a=null==h?void 0:h.error)?void 0:a.errorCode]),He=O.useMemo(()=>{var e,t;return"Bad_Request"===(null==(e=null==h?void 0:h.error)?void 0:e.errorCode)&&"The chat is in progress!"===(null==(t=null==h?void 0:h.error)?void 0:t.errorMessage)},[null==(o=null==h?void 0:h.error)?void 0:o.errorCode,null==(s=null==h?void 0:h.error)?void 0:s.errorMessage]),$e=O.useMemo(()=>{var e;return h.chat_type===Zf.ImageGeneration&&!(null==(e=null==h?void 0:h.content_list)?void 0:e.find(e=>e.phase===ng.IMAGE_GEN))},[h.chat_type,null==h?void 0:h.content_list]),Be=O.useMemo(()=>{var e;return h.chat_type===Zf.ImageGeneration&&!$e||!!(null==(e=h.content_list)?void 0:e.find(e=>[ng.IMAGE_GEN_THINK,ng.IMAGE_GEN_WEB_SEARCH,ng.IMAGE_GEN].includes(e.phase)))},[$e,h.chat_type,h.content_list]),qe=O.useMemo(()=>h.chat_type===Zf.VideoGeneration,[h.chat_type]),Ge=O.useMemo(()=>$e||Be||qe,[$e,Be,qe]),Ve=O.useMemo(()=>{var e,t,n,i;return((null==h?void 0:h.sub_chat_type)||h.chat_type)===Zf.Txt2Txt&&((null==(n=null==(t=null==(e=null==h?void 0:h.content_list)?void 0:e[0])?void 0:t.content)?void 0:n.includes("```html"))||(null==(i=null==h?void 0:h.content)?void 0:i.includes("```html")))},[h.chat_type,null==h?void 0:h.content,null==h?void 0:h.content_list,null==h?void 0:h.sub_chat_type]),We=O.useMemo(()=>{var e;return h.chat_type===Zf.Artifacts&&!(null==(e=null==h?void 0:h.content_list)?void 0:e.find(e=>{var t,n;return(null==(t=null==e?void 0:e.content)?void 0:t.includes("```html"))||(null==(n=null==e?void 0:e.content)?void 0:n.includes("```jsx"))}))},[h.chat_type,null==h?void 0:h.content_list]),Ke=O.useMemo(()=>{var e,t,n,i,a;if(!(null==(e=null==V?void 0:V.function_entry)?void 0:e.community))return!1;const o=iG((null==h?void 0:h.content_list)||[]);if(h.chat_type===Zf.DeepResearch){if((null==h?void 0:h.sub_chat_type)===Zf.Podcast&&!bx())return!0;if((null==h?void 0:h.sub_chat_type)===Zf.DeepResearch)return!1;if(!(null==(t=null==h?void 0:h.content_list)?void 0:t.some(e=>{var t,n,i;return null==(i=null==(n=null==(t=null==e?void 0:e.extra)?void 0:t.deep_research)?void 0:n.pdf)?void 0:i.link}))&&!Ve&&(null==h?void 0:h.sub_chat_type)!==Zf.DeepResearchWebDev||o)return!1}if(Ve&&!(null==(n=null==h?void 0:h.content_list)?void 0:n.find(e=>Xq(null==e?void 0:e.content)&&e.phase===ng.ANSWER)))return!1;if(h.chat_type===Zf.Travel){if((null==h?void 0:h.sub_chat_type)===Zf.TRAVEL_RESEARCH)return!1;if(!(null==(i=null==h?void 0:h.content_list)?void 0:i.some(e=>{var t,n,i;return null==(i=null==(n=null==(t=null==e?void 0:e.extra)?void 0:t.travel_research)?void 0:n.pdf)?void 0:i.link}))&&!Ve||o)return!1}return!(h.chat_type===Zf.Artifacts&&(h.is_stop||We||!(null==(a=null==h?void 0:h.content_list)?void 0:a.find(e=>Xq(null==e?void 0:e.content)&&e.phase===ng.ANSWER))))&&(![Zf.VideoGeneration,Zf.Image2Video].includes(null==h?void 0:h.chat_type)||!bx())},[null==(r=null==V?void 0:V.function_entry)?void 0:r.community,We,Ve,h.chat_type,null==h?void 0:h.content_list,h.is_stop,null==h?void 0:h.sub_chat_type]),Ye=O.useMemo(()=>{var e,t;return null==(t=null==(e=null==V?void 0:V.permissions)?void 0:e.chat)?void 0:t.tts},[null==(c=null==(l=null==V?void 0:V.permissions)?void 0:l.chat)?void 0:c.tts]),Xe=O.useCallback(e=>P(void 0,null,function*(){S&&(yield oT.updateMultiChatHistory({messageId:h.id})),e()}),[S,h.id]),Je=O.useMemo(()=>!("assistant"!==h.role||!h.parentId)&&EC(h.parentId),[h.parentId,h.role]),Ze=O.useMemo(()=>!h.done||Fe||Ue||ze||He,[h.done,Fe,Ue,ze,He]),et=O.useMemo(()=>!!h.error||Ge&&!!(null==p?void 0:p.media),[h.error,Ge,null==p?void 0:p.media]),tt=O.useMemo(()=>Be&&(null==h?void 0:h.chat_type)!==Zf.ImageEdit,[Be,null==h?void 0:h.chat_type]),nt=O.useMemo(()=>{var e,t;return h.sub_chat_type||(null==(t=null==(e=null==h?void 0:h.extra)?void 0:e.meta)?void 0:t.subChatType)},[null==(d=null==(u=null==h?void 0:h.extra)?void 0:u.meta)?void 0:d.subChatType,h.sub_chat_type]),it=O.useMemo(()=>{var e,t;const n=((e,t,n,i,a,o,s,r)=>{if(e)return Wq.disable;let l=a?"VLO":(null==Yq?void 0:Yq[n])||"TW";switch(s&&(l="A"),r){case Zf.Podcast:l="DP";break;case Zf.INTERRUPT:l="RUPT";break;case eg.OmniAudio:case eg.OmniVideo:l="OMNI"}const c=(null==Kq?void 0:Kq[i])||"N";if(t){l="ALL";const e=`error_${l}_${c}`;if(e in Wq)return Wq[e]}if(a&&o)return Wq[`normal_VLO_${c}_STOP`];const u=`normal_${l}_${c}`;return u in Wq?Wq[u]:Wq.normal_TW_N})(Ze,et,h.chat_type,j,tt,null!=(e=null==h?void 0:h.is_stop)&&e,Ve,nt);let i=It(n);return h.done&&Array.isArray(n)?(w&&(i=n.filter(e=>!(null==_e?void 0:_e.isTemp)&&!["edit","branch_new","regenerate","translation"].includes(e))),Je&&(i=n.filter(e=>"branch_new"!==e))):i=[],"unknown error"===(null==(t=null==h?void 0:h.error)?void 0:t.errorMessage)||nt===Zf.Podcast&&W&&I?[]:i},[Ze,et,h,j,tt,Ve,nt,W,w,Je,null==_e?void 0:_e.isTemp,I]),at=O.useMemo(()=>{const e=[];return te&&e.push("voice"),e},[te]),ot=O.useMemo(()=>{const e=[];return ce&&e.push("good"),de&&e.push("bad"),ne&&e.push("voice"),e},[de,ce,ne]),st=O.useMemo(()=>{const e=[];return ie&&e.push("voice"),e},[ie]),rt=O.useMemo(()=>{const e=((e,t,n,i,a)=>{if(e||t)return[];let o=i?"VLO":(null==Yq?void 0:Yq[n])||"TW";a===Zf.Podcast&&(o="DP");const s=`normal_${o}`;return Qq[s]?Qq[s]:[]})(Ze,et,h.chat_type,tt,nt);let t=It(e);return w&&(t=e.filter(e=>!(null==_e?void 0:_e.isTemp))),t},[Ze,et,h.chat_type,tt,nt,w,null==_e?void 0:_e.isTemp]),lt=O.useMemo(()=>!0===h.edited,[h.edited]),ct=O.useCallback(()=>{var e,t;if(g(!0),Jk.getInstance().stopAllPlayer(),S){if(!(null==X?void 0:X.id))return void J({name:"regenerateCallback",id:h.id});J(null)}let n=null;if("translate"===(null==h?void 0:h.sub_chat_type)&&(n={meta:_({},null==(e=null==h?void 0:h.extra)?void 0:e.meta)}),(null==h?void 0:h.sub_chat_type)===Zf.Podcast){if(W||Q)return void ut.open({type:"warning",content:U.t("In the conversation, please wait a moment.")});if(kC(K)>=5)return void ut.open({type:"warning",content:U.t("Youve reached the limit for podcast requests.")})}[Zf.DeepResearch,Zf.Travel].includes(h.chat_type)&&(R(h.sub_chat_type),n=C(_({},n),{meta:C(_({},null==(t=null==h?void 0:h.extra)?void 0:t.meta),{subChatType:h.sub_chat_type,user_action:"retry"})})),oT.closeShowControls(),oT.regenerateResponse(h,n)},[g,null==X?void 0:X.id,S,J,h,W,Q,K,U]),dt=O.useCallback(e=>{g(!0),BS("clkCopyAnswer",{params:{et:"CLK"},aesParams:{c4:z,c5:null==h?void 0:h.id},paramsExtend:{chat_id:z,msg_id:null==h?void 0:h.id}});const t=e||(e=>{var t,n,i;return(null==e?void 0:e.content_list)&&(null==(t=null==e?void 0:e.content_list)?void 0:t.length)?null==(i=null==(n=null==e?void 0:e.content_list)?void 0:n.filter(e=>[ng.ANSWER,ng.INTERRUPT].includes(null==e?void 0:e.phase)))?void 0:i.map(e=>e.content).join("\n"):(null==e?void 0:e.content)?null==e?void 0:e.content:""})(h);E_(Se===Zf.WebSearch?ev(t):t)},[z,Se,h,g]),pt=O.useCallback(()=>{bx()?oT.adapter.invoke({method:"openHalfWindow",params:{type:"selectText",content:Se===Zf.WebSearch?ev(nG(h)):nG(h),ext:`{"disable_translate": ${(null==h?void 0:h.chat_type)===Zf.DeepResearch||h.chat_type===Zf.Travel||h.isMultiResponse}}`,windowSize:100}}):$(!0)},[Se,h]),ft=O.useCallback(()=>P(void 0,null,function*(){if(S){if(!(null==X?void 0:X.id))return void J({name:"shareCallback",id:h.id});J(null)}q(!0),BS("clkShareBtn",{params:{et:"CLK",c5:"chat"},paramsExtend:{chat_id:z,msg_id:h.id||""}})}),[null==X?void 0:X.id,z,S,h.id,J]),gt=O.useCallback(()=>P(void 0,null,function*(){const e=(null==(i=null==(n=(t=h).content_list)?void 0:n.findLast(e=>e.phase===ng.IMAGE_GEN&&!!e.content))?void 0:i.content)||t.content;var t,n,i;g(!0),yield K_({role:"assistant",url:e}),BS("clkdownloadBtn",{params:{et:"CLK",c5:"chat",c6:e},paramsExtend:{chat_id:z,msg_id:h.id||""}})}),[U,h,g]),vt=O.useCallback(()=>{var e,t,n;if(x(!0),g(!0),S){if(!(null==X?void 0:X.id))return void J({name:"editCallback",id:h.id});J(null)}const i=[h.chat_type,h.sub_chat_type,null==(t=null==(e=null==h?void 0:h.extra)?void 0:e.meta)?void 0:t.subChatType].includes(Zf.WebSearch),a=null==(n=h.content_list)?void 0:n.some(e=>e.phase===ng.IMAGE_ZOOM_IN_TOOL);let o;o=i||a?tG(h):nG(h),bx()?(oT.firstOn(qC.MESSAGE_EDIT_SAVE,y),v(!0),oT.adapter.invoke({method:"openHalfWindow",params:{type:"edit",content:o,ext:""}})):f(o),BS("clkReviseMsg",{params:{et:"CLK",c4:"answer"},aesParams:{c5:z,c6:`${null==h?void 0:h.id}`},paramsExtend:{chat_id:z,msg_id:`${null==h?void 0:h.id}`}})},[null==X?void 0:X.id,z,y,S,h,J,g,f,x,v]),yt=O.useCallback(()=>{if(S){if(!(null==X?void 0:X.id))return void J({name:"voiceCallback",id:h.id});J(null)}se(),N&&g(!0)},[null==X?void 0:X.id,S,h.id,N,J,g,se]),bt=O.useCallback((e=ye,t)=>{var n,i;if(g(!0),ke(e),$(!1),!V)return;const a=t||nG(h),o=V.language,s={type:"translate",messageId:h.id,extra:ZE(e),content:{text:ek(U.t("Translate the following text into {{lang}}.",{lang:null!=(i=null==(n=o.find(t=>t.code===e))?void 0:n.title)?i:""}),`${U.t("TextTranslate")}${a}`,o.find(t=>t.code===e))}};F(Qf.TRANSLATE),oT.seleteOperation(s)},[ye,g,ke,V,h,U,F]),xt=O.useCallback(()=>{oT.openArtifacts(h.id),bx()&&oT.nativeArtifactsShow(h)},[h]),wt=O.useCallback(()=>P(void 0,null,function*(){var e,t;if(bT())return void(bx()?yield oT.adapter.invoke({method:"showAlert",params:{type:"login"}}):Y(!0));const n=null==(t=null==(e=h.content_list)?void 0:e.findLast(e=>e.phase===ng.IMAGE_GEN&&!!e.content))?void 0:t.content;bx()?(yield oT.openNewChat(),yield oT.adapter.invoke({method:"openMainChat",params:{inputText:"",modelId:h.model,actionScene:{type:Zf.VideoGeneration,ext:{size:"16:9"}},imageList:[{imageUrl:n}]}})):yield oT.makeVideoOrImageByImageGen({chatType:Zf.VideoGeneration,files:[{type:"image",name:"example.png",file_type:"image/png",showType:"image",file_class:"vision",url:n,isQuote:!0}]})}),[h.content_list,h.model,Y]),St=O.useCallback(()=>P(void 0,null,function*(){var e,t;const n=(null==(t=null==(e=h.content_list)?void 0:e.find(e=>e.phase===ng.IMAGE_GEN&&!!e.content))?void 0:t.content)||"",i=[{type:"image",name:"example.png",file_type:"image/png",showType:"image",file_class:"vision",status:"uploaded",url:n,isQuote:!0}];[Zf.ImageGeneration,Zf.ImageEdit].includes(h.chat_type)&&(bx()?h.chat_type===Zf.ImageGeneration?(yield oT.openNewChat(),yield oT.adapter.invoke({method:"openMainChat",params:{inputText:"",modelId:h.model,actionScene:{type:Zf.ImageEdit},imageList:[{imageUrl:n}]}}),oT.adapter.invoke({method:"setSendButtonEnabled",params:{value:!0}})):yield oT.adapter.invoke({method:"editImage",params:{url:n}}):yield oT.makeVideoOrImageByImageGen({chatType:Zf.ImageGeneration,subChatType:Zf.ImageGeneration,files:i}))}),[h.chat_type,h.content_list,h.model]),_t=O.useCallback(()=>{bx()?oT.adapter.invoke({method:"openPublishingRightsWindow",params:{from:"chat",chatId:z,msgId:h.id||""}}):we(!0)},[z,h.id]),Ct=O.useCallback(()=>{Q?ut.openOnce({type:"error",content:U.t("The current chat is not yet complete, please wait for a while and retry.")}):(Jk.getInstance().stopAllPlayer(),oT.newChatBranch(h.id))},[U,h.id,Q]),Et=O.useCallback(()=>{if(bx())Ee({type:tg.WebSearch,currentTab:De.sources});else{if(L(!0),N||h.chat_type===Zf.DeepResearch)return A(tg.WebSearch),void D({messageId:h.id||"",citationIndex:0,tab:De.sources});D({messageId:h.id||"",citationIndex:0,tab:De.sources}),Ce(!0),A(tg.ThinkingAndSources),ee(null==h?void 0:h.id),oT.scrollToWebSearch()}},[h.chat_type,h.id,N,Ee,ee,D,A,Ce,L]),kt=O.useMemo(()=>({visible:lt,text:U.t("Edited")}),[U,lt]),Tt=O.useMemo(()=>({visible:(null==Ne?void 0:Ne.length)>1,curSiblingsIndex:Pe,maxSiblings:Ae,onPreviousClick:e=>{e.stopPropagation(),oT.navigateToSiblingMessage(h,Ne,"previous")},onNextClick:e=>{e.stopPropagation(),oT.navigateToSiblingMessage(h,Ne,"next")}}),[Pe,Ae,h,Ne]);O.useEffect(()=>{!E&&S&&(ge(),x(!1),f(null))},[E,S,ge,h.id,f,x]),O.useEffect(()=>{S&&(null==X?void 0:X.id)&&h.id===(null==X?void 0:X.id)&&("badCallback"===(null==X?void 0:X.name)&&he(),"goodCallback"===(null==X?void 0:X.name)&&ue(),"editCallback"===(null==X?void 0:X.name)&&vt(),"shareCallback"===(null==X?void 0:X.name)&&ft(),"voiceCallback"===(null==X?void 0:X.name)&&yt(),"regenerateCallback"===(null==X?void 0:X.name)&&ct())},[null==X?void 0:X.id]);const jt=O.useMemo(()=>({visible:h.done&&!!Le.length&&!h.error,sourceListLogos:Le,sourceListName:U.t("Sources"),sourceListCallback:Et}),[U,h.done,h.error,Et,Le]),Nt=O.useMemo(()=>({controls:it,disableControls:at,activeControls:ot,loadingControls:st,list:[{key:"artifacts",label:U.t("Preview"),controlType:N?"label-icon-primary":"label-icon-secondary",callback:xt,visible:!0},{key:"image_edit",label:U.t("Edit"),callback:St,controlType:N?"only-icon":"label-icon-primary",visible:!0},{key:"publish",label:U.t("Publish to community"),defaultToolTip:U.t("Publish to community"),callback:_t,visible:Ke},{key:"good",defaultToolTip:U.t("Good Response"),callback:()=>{Xe(ue)}},{key:"bad",defaultToolTip:U.t("Bad Response"),callback:()=>{Xe(he)}},{key:"regenerate",defaultToolTip:U.t("Regenerate"),callback:()=>{Xe(ct)}},{key:"copy",defaultToolTip:U.t("Copy"),callback:()=>{Xe(dt)}},{key:"edit",defaultToolTip:U.t("Edit"),callback:()=>{Xe(vt)}},{key:"share",defaultToolTip:U.t("Share"),callback:()=>{Xe(ft)}},{key:"download",defaultToolTip:U.t("Download"),callback:gt},{key:"create_video",label:U.t("Create video"),controlType:N?"only-icon":"label-icon-primary",callback:wt},{key:"branch_new",label:U.t("Branch in new chat"),defaultToolTip:U.t("Branch in new chat"),callback:Ct},{key:"replay",label:U.t("Replay"),defaultToolTip:U.t("Replay"),visible:!1,callback:()=>{}},{key:"voice",visible:Ye,label:U.t("Read aloud"),defaultToolTip:U.t("Read aloud"),disabledTooltip:U.t("Currently, only Chinese and English are supported. More languages are coming soon."),activeTooltip:U.t("Stop"),callback:()=>{Xe(yt)},guideInfo:{visible:ae,buttonVisible:oe,buttonText:U.t("Choose voice"),title:U.t("New! Text-to-Speech"),content:U.t("Tap the play icon, and turn text into speech effortlessly. Make your reading experience more dynamic!"),onCloseClick:re,onButtonClick:le,onOpenChange:e=>{e||re()}}}]}),[it,at,ot,st,U,N,xt,St,_t,Ke,gt,wt,Ct,ae,oe,re,le,Xe,ue,he,ct,dt,vt,ft,yt,Ye]),Pt=O.useMemo(()=>({controls:rt,disableControls:at,activeControls:ot,loadingControls:st,list:[{key:"artifacts",label:U.t("Preview"),callback:xt},{key:"image_edit",label:U.t("Image Edit"),callback:St},{key:"publish",label:U.t("Publish"),callback:_t,visible:Ke},{key:"good",label:U.t("Good Response"),callback:ue},{key:"bad",label:U.t("Bad Response"),callback:he},{key:"regenerate",label:U.t("Regenerate"),callback:ct},{key:"copy",label:U.t("Copy"),callback:dt},{key:"edit",label:U.t("Edit"),callback:vt},{key:"select",label:U.t("Select text"),callback:pt},{key:"share",label:U.t("Share"),callback:ft},{key:"download",label:U.t("Download"),callback:gt},{key:"translation",label:U.t("Translate"),callback:bt,dropdown:{options:je.map(e=>({key:e.code,label:e.title,value:e.translate})),value:ye,onChange:bt}},{key:"voice",label:U.t("Read aloud"),callback:yt,visible:Ye}]}),[rt,at,ot,st,U,xt,St,_t,Ke,ue,he,ct,dt,vt,pt,ft,gt,bt,je,ye,yt,Ye]);return tn.jsxs("div",{className:"response-message-footer",onClick:e=>e.stopPropagation(),children:[!m&&Z&&tn.jsx(kG,{editedData:kt,siblingsData:Tt,sourceListData:jt,controlData:Nt,moreText:U.t("More actions"),type:k,fullShowControl:T}),tn.jsx("button",{className:`${qf.COPY_RESPONSE_BUTTON} response-message-footer-none`,onClick:()=>dt()}),N&&tn.jsx(TG,{className:"response-message-footer-vertical",controlData:Pt}),!N&&["normal","simplify"].includes(k)&&pe&&!S&&!bx()&&tn.jsx("div",{className:"response-message-footer-bad-feedback",id:`message-feedback-${h.id}`,children:tn.jsx(Qe,{title:U.t("Provide additional feedback"),defaultContents:me,contentsWithGroup:Oe,placeholder:U.t("(Optional) Feel free to add specific details"),submitBtnText:U.t("Submit"),defaultText:fe,onCancel:ge,onSubmit:ve})}),!N&&S&&!bx()&&tn.jsx(ht,{title:U.t("Provide additional feedback"),visible:pe,onCancel:ge,headerBorderNone:!0,size:"large",footer:null,children:tn.jsx(Qe,{className:"qwen-chat-response-message-footer-bad-feedback-multi-chat",header:!1,defaultContents:me,contentsWithGroup:Oe,placeholder:U.t("(Optional) Feel free to add specific details"),submitBtnText:U.t("Submit"),defaultText:fe,feedbackAreaProps:{minRows:4},submitButtonProps:{size:"middle"},onCancel:ge,onSubmit:ve})}),N&&pe&&!bx()&&tn.jsx(mt,{open:pe,title:U.t("Provide additional feedback"),heightType:"auto",onClose:ge,className:"mobile-feedback-popup",children:tn.jsx(Qe,{header:!1,title:"",defaultContents:me,contentsWithGroup:Oe,placeholder:U.t("(Optional) Feel free to add specific details"),submitBtnText:U.t("Submit"),defaultText:fe,onCancel:ge,onSubmit:ve})}),H&&ye&&tn.jsx(Me,{contentText:Se===Zf.WebSearch?ev(nG(h)):nG(h),title:U.t("Select text"),languageCode:ye,languages:je,menuList:Te,show:H,onClose:()=>{$(!1)},onCopyHandler:dt,onTranslateHandler:bt}),tn.jsx(NV,{chatId:z,show:B,setShow:q,messageId:h.id,onClose:()=>{q(!1)}}),tn.jsx(Mq,{open:xe,onCancel:()=>{we(!1)},messageId:h.id})]})});function MV(e){const t=Math.floor(e/60),n=Math.floor(e%60);return`${t.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`}function AV(e,t=!1){const n=new Date(1e3*e),i=e=>e.toString().padStart(2,"0"),a=n.getFullYear(),o=i(n.getMonth()+1),s=i(n.getDate()),r=i(n.getHours()),l=i(n.getMinutes()),c=i(n.getSeconds());return t?`${a}-${o}-${s} ${r}:${l}:${c}`:`${a}-${o}-${s}`}const RV=({currentTime:e,duration:t,onProgressChange:n,disabled:i,loading:a})=>{const[o,s]=O.useState(!1),[r,l]=O.useState(!1),c=O.useRef(null),u=O.useMemo(()=>{return n=e,0===(i=t)?0:Math.min(Math.max(n/i*100,0),100);var n,i},[e,t]),d=O.useCallback(e=>{const t=Math.max(0,Math.min(100,Math.round(e)));n(t)},[n]),h=O.useCallback(e=>{if(!c.current)return;const t=c.current.getBoundingClientRect();let n;n="touches"in e?e.touches[0].clientX:e.clientX;const i=(n-t.left)/t.width*100;d(i)},[d]),p=O.useCallback(e=>{e.preventDefault(),r&&h(e)},[r,h]),m=O.useCallback(()=>{l(!1)},[l]);O.useEffect(()=>{if(!r)return;const e=e=>p(e),t=()=>m(),n=e=>p(e),i=()=>m(),a=()=>m();return document.addEventListener("mousemove",e),document.addEventListener("mouseup",t),document.addEventListener("touchmove",n,{passive:!1}),document.addEventListener("touchend",i),document.addEventListener("touchcancel",a),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t),document.removeEventListener("touchmove",n),document.removeEventListener("touchend",i),document.removeEventListener("touchcancel",a)}},[r,p,m]);const f=e=>{i||(e.preventDefault(),l(!0),h(e.nativeEvent))};if(a)return tn.jsx("div",{className:"audio-progress-bar-container loading",children:tn.jsx("div",{className:"audio-progress-bar"})});const g=["audio-progress-bar-container",i?"disabled":""].filter(Boolean).join(" "),v=["audio-progress-container",o||r?"expand":""].filter(Boolean).join(" ");return tn.jsx("div",{className:g,onClick:e=>{e.stopPropagation()},onMouseUp:m,onTouchCancel:m,onTouchEnd:m,onMouseEnter:()=>!i&&s(!0),onTouchStart:f,children:tn.jsx("div",{className:v,ref:c,onMouseDown:f,style:{touchAction:"none"},children:tn.jsx("div",{className:"audio-progress-bar",style:{width:`${u}%`}})})})},OV=({menuData:e,playbackRate:t,onChange:n,children:i,disabled:a})=>{const o=O.useMemo(()=>({items:e.map(e=>({key:e.value,label:tn.jsx("div",{className:J("dialog-body-item",{active:t===e.value}),children:tn.jsx("span",{className:"dialog-body-item-label",children:e.label})}),onClick:()=>{n(e.value)}}))}),[e,n,t]);return tn.jsx(yt,{overlayClassName:"rate-selector",menu:o,trigger:["click"],placement:"topCenter",disabled:a,children:i})},DV=[{label:"2.0x",value:2,icon:"icon-a-2x"},{label:"1.5x",value:1.5,icon:"icon-a-15x"},{label:"1.0x",value:1,icon:"icon-a-1x"},{label:"0.5x",value:.5,icon:"icon-a-05x"}],LV=({playbackRate:e,onPlaybackRateChange:t,onTimeChange:n,onDownload:i,disabled:a,ready:o,messageId:s})=>{const{t:r}=G(),l=O.useMemo(()=>{var t;return(null==(t=DV.find(t=>t.value===e))?void 0:t.value)||"1.0"},[e]),c=e=>{t(e)};return tn.jsxs("div",{className:J("action-buttons",{disabled:a}),children:[tn.jsx("div",{className:"action-button",onClick:()=>{!a&&o&&n(-15)},children:tn.jsx(dt,{type:"icon-speed1"})}),tn.jsx("div",{className:"action-button",onClick:()=>{!a&&o&&n(15)},children:tn.jsx(dt,{type:"icon-speed"})}),(()=>{const t=tn.jsxs("div",{className:"action-button dropdown-button",children:[tn.jsx("span",{style:{letterSpacing:mx()?"-1px":0},children:l}),tn.jsx("span",{style:{marginLeft:2},children:"x"})]});return bx()?H.cloneElement(t,{onClick:()=>{a||oT.adapter.invoke({method:"openMediaRateWindow",params:{items:[.5,1,1.5,2],rate:e,id:s}})}}):tn.jsx(OV,{disabled:a,playbackRate:e,menuData:DV,onChange:c,children:t})})(),tn.jsx(ft,{title:r("Download the audio"),children:tn.jsx("div",{className:"action-button",onClick:()=>{a||i()},children:tn.jsx(dt,{type:"icon-line-download-02"})})})]})},FV=({track:e,autoplay:t=!1,messageStatus:n="normal",messageIdProp:i})=>{const{t:a}=G(),o=tx(e=>e.mobile),[s,r]=O.useState({isPlaying:!1,currentTime:0,duration:0,volume:1,isMuted:!1,playbackRate:1}),[l,c]=O.useState(!1),[u,d]=O.useState(""),[h,p]=O.useState(!1),[m,f]=O.useState(""),g=yE(e=>e.theme),v=O.useRef(null),y=O.useRef(i||ot()),b=O.useRef("");O.useEffect(()=>{e.duration&&bx()&&r(t=>C(_({},t),{duration:Math.floor(e.duration/1e3)}))},[e.duration]);const x=O.useMemo(()=>u?"error":h?"loading":n,[u,h,n]),w=O.useMemo(()=>["error","generating"].includes(x),[x]),S=O.useMemo(()=>"dark"===g?"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.2.8/static/images/media-generating-dark.png":"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.2.8/static/images/media-generating-light.png",[g]),E=O.useMemo(()=>"dark"===g?"https://img.alicdn.com/imgextra/i3/O1CN01GYWLuG1uWfKs6epLG_!!6000000006045-55-tps-276-276.svg":"https://img.alicdn.com/imgextra/i4/O1CN01UDhh9L1lxqIMhagLd_!!6000000004886-55-tps-276-276.svg",[g]),k=O.useCallback((e,t={})=>{y.current&&oT.adapter.invoke({method:"controlAudioPlayer",params:{id:y.current,action:e,content:t}})},[]),I=O.useCallback(()=>r(e=>C(_({},e),{isPlaying:!0})),[]),T=O.useCallback(()=>r(e=>C(_({},e),{isPlaying:!1})),[]),j=O.useCallback(()=>r(e=>C(_({},e),{isPlaying:!1,currentTime:0})),[]),N=O.useCallback(()=>{v.current&&r(e=>C(_({},e),{currentTime:v.current.currentTime,duration:v.current.duration}))},[]),P=O.useCallback(()=>{v.current&&r(e=>C(_({},e),{volume:v.current.volume,isMuted:v.current.muted}))},[]),M=O.useCallback(()=>{var e;(null==(e=v.current)?void 0:e.duration)&&(r(e=>C(_({},e),{duration:Math.floor(v.current.duration)})),c(!0))},[]),A=e=>{w||(bx()?k("seekTo",{position:e}):v.current&&l&&(v.current.currentTime=e,r(t=>C(_({},t),{currentTime:e}))))},R=t=>{var n;switch(t){case"resume":k("resume");break;case"play":k("play",{url:e.audioUrl,position:0,rate:null!=(n=s.playbackRate)?n:1,title:e.title})}};O.useEffect(()=>{const e=e=>{const{status:t,id:n,content:i}=e||{};if(n===y.current)switch(b.current=t,t){case"ready":c(!0),p(!1),r(e=>C(_({},e),{duration:Math.floor((null==i?void 0:i.duration)||0),isPlaying:!0}));break;case"position":r(e=>C(_({},e),{currentTime:(null==i?void 0:i.position)||0}));break;case"resumed":c(!0),p(!1),r(e=>C(_({},e),{isPlaying:!0}));break;case"paused":T();break;case"ended":case"stopped":r(e=>C(_({},e),{isPlaying:!1,currentTime:0}));break;case"error":f(a("Playback failed. Please try again")),d("error")}},n=({rate:e,id:t})=>{t===y.current&&r(t=>C(_({},t),{playbackRate:e||1}))},i=({id:e})=>{e!==y.current&&(T(),v.current&&v.current.pause())};if(bx())return oT.on(QC.MESSAGE_AUDIO_PLAYBACK_CHANGED,e),oT.on(QC.MESSAGE_AUDIO_PLAYBACK_RATE_CHANGED,n),()=>{k("stop"),oT.off(QC.MESSAGE_AUDIO_PLAYBACK_CHANGED,e),oT.off(QC.MESSAGE_AUDIO_PLAYBACK_RATE_CHANGED,n)};if(v.current){const e=v.current;return e.addEventListener("loadedmetadata",M),e.addEventListener("loadeddata",M),e.addEventListener("timeupdate",N),e.addEventListener("play",I),e.addEventListener("pause",T),e.addEventListener("ended",j),e.addEventListener("volumechange",P),oT.on(qC.MESSAGE_PODCAST_AUDIO_PLAY_START,i),t&&e.play().catch(console.error),()=>{e.removeEventListener("loadedmetadata",M),e.removeEventListener("loadeddata",M),e.removeEventListener("timeupdate",N),e.removeEventListener("play",I),e.removeEventListener("pause",T),e.removeEventListener("ended",j),e.removeEventListener("volumechange",P),oT.off(qC.MESSAGE_PODCAST_AUDIO_PLAY_START,i)}}},[t,M,j,T,I,N,P,k,a]);return tn.jsxs("div",{className:J("audio-tool-player",x,{disabled:w}),children:[tn.jsxs("div",{className:"audio-info",children:[tn.jsx("div",{className:"cover-container",children:"error"===x?tn.jsx(dt,{type:o?"icon-line-code-failed":"icon-line-Podcast-failed",className:"!text-24 podcast-icon podcast-icon-failed"}):"paused"===x?tn.jsx(dt,{type:o?"icon-line-code":"icon-line-Podcast-loading",className:"!text-24 podcast-icon podcast-icon-paused"}):"generating"===x?tn.jsxs(tn.Fragment,{children:[tn.jsx("img",{src:"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.2.8/static/images/line-podcast.png",alt:"cover",className:"cover-img-icon"}),tn.jsx("img",{src:S,alt:"cover",className:"cover-img"})]}):tn.jsx("img",{src:E,alt:"cover",className:"cover-img"})}),tn.jsxs("div",{className:"audio-tool-details",children:[w?tn.jsxs("div",{className:"skeleton-container",children:[tn.jsx(Ct,{className:"timestamp-skeleton",style:{height:20,width:"100%",marginBottom:"0.5rem"}}),tn.jsx(Ct,{className:"timestamp-skeleton",style:{height:20,width:"100%"}})]}):tn.jsx("h3",{className:"audio-tool-details-text",children:e.title}),tn.jsx("div",{className:"time-info",children:w?tn.jsx(Ct,{className:"timestamp-skeleton",style:{width:88,height:18}}):`${MV(s.currentTime)} / ${MV(s.duration)}`})]}),tn.jsx("div",{className:J("play-button-container",{disabled:!l&&!bx()}),children:tn.jsx("button",{className:"play-button",onClick:()=>{if(!w)if(bx()){if(s.isPlaying)return void k("pause",{position:s.currentTime});if("position"===b.current)return void R(l?"resume":"play");if("paused"===b.current)R("resume");else R("play"),p(!0)}else l&&v.current&&(s.isPlaying?v.current.pause():(v.current.play(),oT.emit(qC.MESSAGE_PODCAST_AUDIO_PLAY_START,{id:y.current})))},children:tn.jsx(dt,{type:s.isPlaying?"icon-play":"icon-pause",className:"play-button-icon"})})})]}),"generating"===x&&tn.jsx("div",{className:"generate-text info",children:a("Youll be informed immediately upon completion.")}),"error"===x&&tn.jsx("div",{className:"generate-text error",children:m||a("Generation failed. Please try again.")}),tn.jsx(RV,{currentTime:s.currentTime,duration:s.duration,onProgressChange:e=>{const t=Math.floor(e/100*s.duration);A(t)},disabled:w||!l,loading:"loading"===x}),tn.jsxs("div",{className:"bottom-section",children:[w?tn.jsx(Ct,{className:"timestamp-skeleton",style:{width:88,height:18}}):tn.jsx("div",{className:"timestamp",children:e.timestamp}),tn.jsx("div",{className:"actions-container",children:tn.jsx(LV,{playbackRate:s.playbackRate,onPlaybackRateChange:e=>{bx()?k("setRate",{rate:e}):v.current&&(v.current.playbackRate=e),r(t=>C(_({},t),{playbackRate:e}))},disabled:w,ready:l,messageId:y.current,onTimeChange:e=>A(s.currentTime+e),onDownload:()=>{K_({url:e.audioUrl,role:"assistant"})}})})]}),!bx()&&tn.jsx("audio",{ref:v,src:e.audioUrl,preload:"metadata"})]})},UV=({message:e,messageLoading:t})=>{var n,i,a;const o=O.useMemo(()=>!t&&(null==e?void 0:e.id)||(null==e?void 0:e.error)?(null==e?void 0:e.error)||!(null==e?void 0:e.content)?"error":(null==e?void 0:e.done)&&!(null==e?void 0:e.is_stop)?"normal":(null==e?void 0:e.is_stop)?"paused":"generating":"generating",[e,t]);return tn.jsx(FV,{messageStatus:o,messageIdProp:(null==e?void 0:e.id)||"",track:{title:null==(i=null==(n=null==e?void 0:e.extra)?void 0:n.aipodcast)?void 0:i.topic,audioUrl:null==e?void 0:e.content,timestamp:(s=null==e?void 0:e.timestamp,s?Y(1e3*s).format("DD/MM/YYYY HH:mm"):""),duration:null==(a=null==e?void 0:e.extra)?void 0:a.duration}});var s},zV=e=>{var t,n,i,a,o,s,r;const{message:l,podcastAsyncLoading:c,setPodcastAsyncLoading:u,onMediaError:d}=e,h=O.useRef(null),p=CV(l),m=_V(h.current),f=Wb(e=>e.chatId),g=Wb(e=>e.currentInputFeature),{i18n:v}=G(),y=tx(e=>e.mobile),b=tx(e=>e.config),x=yE(e=>e.realTheme),w=yE(e=>e.isSharePage),S=Zb(e=>e.setVisionGenerating),E=Zb(e=>e.setTaskRunning),k=Zb(e=>e.temporaryChatEnabled),I=rT(e=>e.updateFeatureType),[T,j]=O.useState(!1),[N,M]=O.useState(!1),[A,R]=O.useState(p.fromServerSize&&!m?p.width:0),[D,L]=O.useState(p.fromServerSize&&!m?p.height:0),[F,U]=O.useState(""),[z,H]=O.useState(0),$=O.useRef(!1),B=O.useRef(!1),q=O.useRef(void 0),V=O.useRef(void 0),W=O.useRef(0),Q=O.useRef(0),K=O.useRef(0),Y=O.useMemo(()=>[Zf.ImageGeneration,Zf.ImageEdit].includes(l.chat_type),[l.chat_type]),X=O.useMemo(()=>l.chat_type===Zf.VideoGeneration,[l.chat_type]),J=O.useMemo(()=>X?5:10,[X]),Z=O.useMemo(()=>l.sub_chat_type===Zf.Podcast,[l.sub_chat_type]),ee=O.useMemo(()=>{var e,t,n;return(null==(n=null==(t=null==(e=l.content_list)?void 0:e.findLast)?void 0:t.call(e,e=>e.phase===ng.IMAGE_GEN&&!!e.content))?void 0:n.content)||l.content},[l.content,l.content_list]),te=O.useMemo(()=>{const e=mx()?450:320,t=`x-oss-process=image/resize,m_mfit,w_${e},h_${e}`;return ee?ee.includes("qwen-webui")?ee:`${ee}${ee.includes("?")?"&":"?"}${t}`:""},[ee]),ne=O.useMemo(()=>X?y?{width:[114,300],height:[126,380]}:[400,448]:y?{width:[114,300],height:[126,380]}:[133,400],[X,y]),ie=O.useMemo(()=>{var e;if(w)return["download"];if(bT()||k)return Y?["video","edit","download"]:["download"];if(Y||X){const t=Y?["video","edit","download"]:["download"];return(null==(e=null==b?void 0:b.function_entry)?void 0:e.community)&&t.push("publish"),t}return["download"]},[null==(t=null==b?void 0:b.function_entry)?void 0:t.community,Y,X,w,k]),ae=Aq({mediaType:Y?"image":"video",messageId:l.id||"",preview:{actions:ie,tip:F}}),oe=O.useMemo(()=>{if(!ee)return{iconUrl:`//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.2.8/static/images/${Y?"image":"video"}-generating-icon.png`,skeletonUrl:`//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.2.8/static/images/media-generating-${x}-1.png`,percent:z}},[Y,x,ee,z]),se=O.useCallback(()=>{null==d||d();let e=(Y?"Image":"Video")+" Load Error";return T?e="Generate Error":N&&(e="The current content is empty, please regenerate."),{errorMessage:v.t(e)}},[v,N,T,Y,d]),re=O.useCallback(e=>{if(e.currentTarget){const{naturalWidth:t,naturalHeight:n}=e.currentTarget;R(t),L(n),e.currentTarget.removeEventListener("load",re)}},[]),le=O.useCallback((e,t)=>{oT.updateMessage(e,t)},[]),ce=O.useCallback(({status:e,content:t})=>{var n,i,a,o;const s={};"error"===e&&(s.error=t.error),s.content=(null==t?void 0:t.content)||"",s.chat_type=(null==t?void 0:t.chat_type)||g,s.done=!0;const r=(null==t?void 0:t.duration)||0;let c=_(_({},l),s);const u=(null==(i=null==(n=null==c?void 0:c.extra)?void 0:n.meta)?void 0:i.subChatType)?{meta:{subChatType:c.extra.meta.subChatType},duration:r}:{duration:r};c=C(_({},c),{extra:Pt({},(null==c?void 0:c.extra)||{},u)}),oT.updateChatInfo({id:f,status:"finished",subChatType:(null==(o=null==(a=null==l?void 0:l.extra)?void 0:a.meta)?void 0:o.subChatType)||l.sub_chat_type}),oT.updateMessage(l.id,c)},[l,f,g]),ue=O.useCallback((e,t)=>{var n;u(!1),j(!0),E(!1);const i=e||{},a=null==i?void 0:i.detail,o=null!=(n=null==l?void 0:l.selectedModelId)?n:l.model,s=(null==a?void 0:a.info)||(null==a?void 0:a.content),r=C(_({},i),{error:!0,content:v.t("Oops! There was an issue connecting to {{provider}}.",{provider:o})+(s?"\n"+v.t(s):"")});"error"===(null==a?void 0:a.type)&&(r.error={content:(null==r?void 0:r.content)||(null==a?void 0:a.info),errorMessage:null==a?void 0:a.info,errorCode:null==a?void 0:a.content}),ce({status:"error",content:r}),le(t,{done:!0})},[v,null==l?void 0:l.selectedModelId,l.model,E,j,ce,le]),de=O.useCallback(e=>{[Zf.Podcast].includes(e)&&I({chatType:Zf.Txt2Txt,subChatType:Zf.Txt2Txt})},[I]),he=O.useCallback((e,t)=>{if(!$.current&&!B.current){const i=ZC.getChatByChatId(f||"");$.current=!0,(n={task_id:t},P(void 0,null,function*(){const{task_id:e}=n;return yield Ox(`/tasks/status/${e}`,{baseURL:"/api/v1",method:"GET"})})).then(n=>{var a,o;if(clearTimeout(q.current),B.current)return void($.current=!1);const s=null==(a=n.data)?void 0:a.task_status;"running"===s?q.current=setTimeout(()=>{he(e,t)},Y?3e3:1e4):"success"===s?(u(!1),S(!1),E(!1),ce({status:"done",content:null==n?void 0:n.data}),de(null==l?void 0:l.sub_chat_type),le(e,{done:!0,content:(null==(o=n.data)?void 0:o.content)||""})):ue(null==n?void 0:n.data,e),S("running"===s),i&&(i.isChat="running"===s),$.current=!1}).catch(n=>{clearTimeout(q.current),W.current+=1,W.current>=J?(ue(null==n?void 0:n.data,e),S(!1),de(null==l?void 0:l.sub_chat_type),i&&(i.isChat=!1),$.current=!1):q.current=setTimeout(()=>{he(e,t)},Y?3e3:1e4)}).finally(()=>{oT.shareHistory=null})}var n},[f,S,Y,E,ce,de,null==l?void 0:l.sub_chat_type,le,ue,J]),pe=O.useCallback(()=>{V.current&&clearInterval(V.current),V.current=setInterval(()=>{let e=0;const t=+"360s".slice(0,-1),n=l.timestamp?Math.round(((new Date).getTime()-1e3*l.timestamp)/1e3):0;n&&(e=n<t?n:t-1);let i=e||n?(Math.round(e/t*1e4)/100).toFixed(0):0;+i>90?(clearInterval(V.current),i=99):e++,H(+i)})},[l.timestamp]),me=O.useMemo(()=>{const e=h.current;return e?{width:e.getBoundingClientRect().width,height:e.getBoundingClientRect().height}:{width:0,height:0}},[h.current]);O.useEffect(()=>{const e=_V(h.current);return()=>{null==e||e.removeEventListener("load",re)}},[re]),O.useEffect(()=>{var e,t,n,i,a,o,s,r;const c=(null==(t=null==(e=null==l?void 0:l.extra)?void 0:e.wanx)?void 0:t.task_id)||(null==(i=null==(n=null==l?void 0:l.extra)?void 0:n.aipodcast)?void 0:i.task_id),d=l.id||l.fid||"";w||!c||ee||((null==(o=null==(a=null==l?void 0:l.extra)?void 0:a.aipodcast)?void 0:o.task_id)&&u(!0),S(!0),oT.updateChatInfo({id:f,status:"running",subChatType:(null==(r=null==(s=null==l?void 0:l.extra)?void 0:s.meta)?void 0:r.subChatType)||l.sub_chat_type}),he(d,c),pe());const h=q.current,p=V.current;return()=>{clearTimeout(h),clearInterval(p)}},[w,null==(i=null==(n=null==l?void 0:l.extra)?void 0:n.wanx)?void 0:i.task_id,null==l?void 0:l.fid,null==l?void 0:l.id,he,ee,null==(o=null==(a=null==l?void 0:l.extra)?void 0:a.aipodcast)?void 0:o.task_id,S,null==l?void 0:l.extra,l.sub_chat_type,f,pe]),O.useEffect(()=>{var e;const{width:t,height:n,fromServerSize:i}=CV(l),a=_V(h.current);if(t&&n&&(i||!a)){const i=null==(e=l.content_list)?void 0:e.find(e=>{var t,n;return e.phase===ng.IMAGE_GEN&&(null==(n=null==(t=null==e?void 0:e.extra)?void 0:t.output_image_hw)?void 0:n[0])});h.current&&i&&(o=h.current,P(void 0,null,function*(){const e=_V(o);if(e){const t=e.src,n="x-oss-process=image/resize";if(t.includes(n)){const e=t.indexOf(n)-1;return yield new Promise(n=>{const i=new Image;i.onload=()=>{n({naturalWidth:i.naturalWidth,naturalHeight:i.naturalHeight})},i.onerror=()=>{n({naturalWidth:0,naturalHeight:0})},i.src=t.slice(0,e)})}{const{naturalWidth:t,naturalHeight:n}=e;return{naturalWidth:t,naturalHeight:n}}}})).then(e=>{e&&(e.naturalWidth>t||e.naturalHeight>n)&&U(v.t("The input image was too high in resolution, so the edited image has been downscaled."))}),R(t),L(n)}else if(a){const{naturalWidth:e,naturalHeight:t}=a;e&&t?(R(e),L(t)):(a.removeEventListener("load",re),a.addEventListener("load",re))}var o},[v,l,l.chat_type,l.content_list,null==(s=null==l?void 0:l.info)?void 0:s.size,re]),O.useEffect(()=>{if(l.done&&!ee&&Y)j(!0);else if(w&&!ee){const e=l.id||l.fid||"";M(!0),le(e,{done:!0})}},[Y,w,null==l?void 0:l.done,null==l?void 0:l.fid,null==l?void 0:l.id,le,ee]),O.useEffect(()=>{j(!1),M(!1),U(""),H(0)},[l.fid]),O.useEffect(()=>(Q.current=S_(),()=>{B.current=!0}),[]);const fe=O.useCallback((e,t,n)=>{BS("messageImgOnLoadTime",{params:{et:"OTHER",c4:f||"",c5:"answer",c6:n,c7:Math.round(e),c8:Math.round(t),c9:Math.round(t-e)}})},[f]);return tn.jsxs("div",{ref:h,className:"chat-response-media-render",children:[Y&&tn.jsx(Te,C(_({url:ee,thumbnailUrl:te,defaultWidth:1,defaultHeight:1,width:A,height:D,sizeScope:ne,generation:oe,error:T||N,onError:se},l.isShare?{}:ae),{onLoad:()=>{K.current=S_(),fe(Q.current,K.current,ee)}})),X&&tn.jsx(Oq,{url:ee,generation:oe,error:T||N,mediaProps:ae,onError:se,ratio:(null==(r=null==l?void 0:l.info)?void 0:r.size)||"",containerWidth:me.width,messageType:"answer"}),Z&&tn.jsx(UV,{message:l,messageLoading:c})]})},HV=({info:e,timestamp:t,messageId:n,message:i})=>{const a=Zb(e=>e.currentControlsId),o=Zb(e=>e.setCurrentControlsId),s=Zb(e=>e.currentShowControl),r=yE(e=>e.setShowControls),l=Zb(e=>e.setCurrentShowControl),[c,u]=O.useState(We.GEN_PROCESS);O.useEffect(()=>{if(i){let e=We.GEN_PROCESS;(null==i?void 0:i.error)?e=We.GEN_ERROR:((null==i?void 0:i.done)||(null==i?void 0:i.is_stop))&&(e=We.FINISH),u(e)}},[i]);return tn.jsx("div",{children:tn.jsx(ze,{info:{time:N_(t),name:(null==e?void 0:e.slides_title)||"Slides"},type:He.SLIDES,onCardClick:()=>{c!==We.GEN_PROCESS&&(a===n&&s===tg.Slides?oT.closeShowControls():(l(tg.Slides),r(!0),o(n||"")))},status:c,toolsOption:{download:{onDownload:()=>{if(null==e?void 0:e.pdf_url)try{K_({url:null==e?void 0:e.pdf_url,errorTexts:!0})}catch(t){const e=q();ut.openOnce({type:"error",content:e.t("Download failed")})}}}}})})},$V=aG(e=>{const t=e,{children:n}=t,i=E(t,["children"]),a=Wb(e=>e.badFeedbackVisible),{message:o}=i,s=O.useMemo(()=>{var e;const t=!!(null==(e=o.content_list)?void 0:e.find(e=>[ng.IMAGE_GEN].includes(e.phase)));return[Zf.ImageGeneration,Zf.ImageEdit].includes(o.chat_type)||t},[o.chat_type,o.content_list]),r=O.useRef(null),l=O.useRef(null),[c,u]=O.useState(!0),d=O.useMemo(()=>{var e,t,n;return(null==(n=null==(t=null==(e=o.content_list)?void 0:e.findLast)?void 0:t.call(e,e=>e.phase===ng.IMAGE_GEN&&!!e.content))?void 0:n.content)||o.content},[o.content,o.content_list]);return tn.jsxs(tn.Fragment,{children:[tn.jsxs("div",{className:"qwen-chat-response-control-card",ref:l,onMouseEnter:()=>{r.current&&l.current&&r.current.offsetWidth>l.current.offsetWidth&&u(!1)},children:[d?tn.jsxs(tn.Fragment,{children:[tn.jsx("div",{className:"qwen-chat-response-control-card-top",style:a?{display:"block"}:{},children:tn.jsx(PV,C(_({},i),{type:"upper-right-corner"}))}),tn.jsx("div",{className:"qwen-chat-response-control-card-bottom",style:a&&s?{display:"block"}:{},ref:r,children:tn.jsx(PV,C(_({},i),{fullShowControl:c,type:"lower-center"}))})]}):null,n]}),tn.jsx(PV,_({type:"simplify"},i))]})}),BV=({slidesCount:e,hasThinking:t})=>{const n=G();return tn.jsx("div",{className:"qwen-chat-comp-chat-slides-loading",style:{marginLeft:t?"28px":"0"},children:n.t("Generating {{num}} slides for you, please wait",{num:e})})},qV={[ng.WEB_SEARCH]:{[ig.TYPING]:{text:"Searching the web"},[ig.FINISHED]:{icon:"icon-line-globe-01",text:"Search web Completed"},pause:{icon:"icon-fill-stop",text:"Search web stopped"},error:{icon:"icon-fill-x-circle-contained",text:"Search web pages failed",class:"icon-fail"}},[ng.THINK]:{[ig.FINISHED]:{icon:"icon-fill-check-contained"},pause:{icon:"icon-fill-stop",text:"Search web stopped"},error:{icon:"icon-fill-x-circle-contained",text:"Search web pages failed",class:"icon-fail"}},[ng.IMAGE_ZOOM_IN_TOOL]:{[ig.TYPING]:{text:"Analyzing image"},[ig.FINISHED]:{icon:"icon-line-image-01",text:"Analyzed image"},pause:{icon:"icon-fill-stop",text:"Analyzed image stopped"},error:{icon:"icon-fill-x-circle-contained",text:"Analyzed image failed",class:"icon-fail"}},[ng.CODE_INTERPRETER]:{[ig.TYPING]:{text:"Code Interpreter is running"},[ig.FINISHED]:{icon:"icon-line-code-01",text:"Code Interpreter executed successfully"}}},GV={[ng.THINK]:{label:{process:"Thinking...",completed:"Thinking completed"},icon:"icon-line-lightbulb-031"},[ng.THINKING_SUMMARY]:{label:{process:"Thinking...",completed:"Thinking completed"},icon:"icon-line-lightbulb-031"},[ng.WEB_SEARCH]:{label:{process:"Searching the web",completed:"Searched the web"},icon:"icon-line-globe-01"},[ng.IMAGE_SEARCH]:{label:{process:"Searching for images",completed:"Search complete"},icon:"icon-line-image-Searching"},[ng.WEB_SEARCH_IMAGE]:{label:{process:"Searching for images",completed:"Search complete"},icon:"icon-line-image-Searching"},[ng.CODE_INTERPRETER]:{label:{process:"Running code interpreter",completed:"Code interpreter finished"},icon:"icon-line-code-01"},[ng.WEB_EXTRACTOR]:{label:{process:"Reading sources",completed:"Sources read"},icon:"icon-fill-check-contained"},[ng.HISTORY_RETRIEVER]:{label:{process:"Searching memory",completed:"Searched memory"},icon:"icon-line-brain-02"},[ng.BIO]:{label:{process:"Updating memory",completed:"Updated memory"},icon:"icon-line-brain-02"}},VV=H.memo(e=>{const{type:t=iV.THINKING,status:n=aV.PROCESS_STATE,customTitle:i="",customIcon:a="",children:o,controlConfig:s}=e,r=G(),l=O.useMemo(()=>GV[t],[GV,t]);return l?tn.jsxs(Z,{className:"qwen-chat-tool-status-card-wraper",children:[tn.jsxs(Z,{className:J("qwen-chat-tool-status-card",{"qwen-chat-thinking-status-card-completed":n===aV.RESULT_STATE}),gap:8,onClick:null==s?void 0:s.onClick,children:[tn.jsx(Z,{vertical:!0,align:"center",justify:"center",style:{width:"20px",height:"20px"},children:tn.jsx(dt,{className:"qwen-chat-thinking-status-card-icon",type:a||(null==l?void 0:l.icon)})}),tn.jsxs(Z,{vertical:!0,align:"flex-start",className:"qwen-chat-thinking-status-card-content",children:[tn.jsxs(Z,{align:"center",className:"qwen-chat-thinking-status-card-title",gap:8,children:[tn.jsx("div",{className:J("qwen-chat-thinking-status-card-title-text",{"qwen-chat-status-card-title-animate":n===aV.PROCESS_STATE}),children:n===aV.PROCESS_STATE?i||r.t(l.label.process):i||r.t(l.label.completed)}),(null==s?void 0:s.visibly)?tn.jsx(dt,{className:"qwen-chat-status-card-after",type:"icon-line-chevron-right"}):null]}),o]})]}),tn.jsx("div",{style:{flex:1}})]}):null}),WV=H.memo(e=>{var t;const{phaseContent:n,contentList:i,status:a=aV.PROCESS_STATE,customTitle:o="",customIcon:s="",children:r,controlConfig:l,message:c}=e,u=G(),d=O.useMemo(()=>{const e=null==i?void 0:i.filter(e=>e.groupIndex===(null==n?void 0:n.groupIndex));return null==e?void 0:e[e.length-1]},[i,null==n?void 0:n.groupIndex]),h=null==(t=null==i?void 0:i[i.length-1])?void 0:t.groupIndex,p=O.useMemo(()=>(null==c?void 0:c.is_stop)&&h===(null==d?void 0:d.groupIndex)?2:(null==c?void 0:c.done)||h!==(null==d?void 0:d.groupIndex)?1:0,[null==c?void 0:c.done,null==c?void 0:c.is_stop,null==d?void 0:d.groupIndex,h]),m=O.useMemo(()=>0===p?GV[(null==d?void 0:d.phase)||""]:{label:{process:"Thinking...",completed:2===p?"Thought stopped":"Thought completed"},icon:"icon-line-lightbulb-031"},[null==d?void 0:d.phase,p]),f=0===p?aV.PROCESS_STATE:aV.RESULT_STATE,g=O.useMemo(()=>{var e,t;if(f!==aV.PROCESS_STATE)return!1;const n=aI.getState().models,i=Wb.getState().history,a=n.find(e=>e.id===(null==c?void 0:c.model)),o=null==i?void 0:i.messages[(null==c?void 0:c.parentId)||""];if(!a||!o)return!1;const{enable:s=!1,support_files:r=[]}=(null==(t=null==(e=null==a?void 0:a.info)?void 0:e.meta)?void 0:t.think_skip)||{},l=((null==o?void 0:o.files)||[]).map(e=>e.type),u=!(null==c?void 0:c.is_stop_in_thinking_flag);return s&&l.every(e=>r.includes(e))&&u},[null==c?void 0:c.model,null==c?void 0:c.parentId,f,null==c?void 0:c.is_stop_in_thinking_flag]),v=O.useMemo(()=>null==c?void 0:c.is_stop_in_thinking,[null==c?void 0:c.is_stop_in_thinking]);return!m||v?null:tn.jsxs(Z,{className:"qwen-chat-thinking-tool-status-card-wraper",children:[tn.jsxs(Z,{className:J("qwen-chat-tool-status-card",{"qwen-chat-thinking-status-card-completed":f===aV.RESULT_STATE}),gap:8,onClick:null==l?void 0:l.onClick,children:[tn.jsx(Z,{vertical:!0,align:"center",justify:"center",style:{width:"20px",height:"20px"},children:tn.jsx(dt,{className:"qwen-chat-thinking-status-card-icon",type:s||(null==m?void 0:m.icon)})}),tn.jsxs(Z,{vertical:!0,align:"flex-start",className:"qwen-chat-thinking-status-card-content",children:[tn.jsxs(Z,{align:"center",className:"qwen-chat-thinking-status-card-title",gap:8,children:[tn.jsx("div",{className:J("qwen-chat-thinking-status-card-title-text",{"qwen-chat-status-card-title-animate":f===aV.PROCESS_STATE}),children:f===aV.PROCESS_STATE?o||u.t(m.label.process):o||u.t(m.label.completed)}),(null==l?void 0:l.visibly)?tn.jsx(dt,{className:"qwen-chat-status-card-after",type:"icon-line-chevron-right"}):null]}),r]})]}),tn.jsx("div",{className:"qwen-chat-tool-status-card-right",children:g&&tn.jsx("div",{className:"qwen-chat-mobile-chat-status-answer-now",onClick:()=>{oT.onExpandHandler({messageId:(null==c?void 0:c.id)||"",next:!1}),oT.stopThinkingPhase((null==c?void 0:c.id)||"")},children:u.t("Skip")})})]})}),QV=e=>{var t,n,i,a,o,s,r,l,c;const{message:u,isOldMessageInNewBranch:d,isMultiChat:h,active:p,isModelComparison:m,boxId:f}=e,{i18n:g}=G(),v=tx(e=>e.mobile),y=yE(e=>e.isSharePage),{chatId:b,historyCurrentId:x}=Wb(nj(e=>({chatId:e.chatId,historyCurrentId:e.history.currentId}))),{voicePlayingMessageId:w,unsupportedLanguageVoicePlayMessageIds:S,setUnsupportedLanguageVoicePlayMessageIds:E}=dT(nj(e=>({voicePlayingMessageId:e.voicePlayingMessageId,unsupportedLanguageVoicePlayMessageIds:e.unsupportedLanguageVoicePlayMessageIds,setUnsupportedLanguageVoicePlayMessageIds:e.setUnsupportedLanguageVoicePlayMessageIds}))),[k,I]=O.useState(!0),[T,j]=O.useState(!1),[N,M]=O.useState({}),[A,R]=O.useState(null),[D,L]=O.useState(!1),F=O.useRef(!1),[U,z]=O.useState(!1),H=O.useRef(null),$=O.useMemo(()=>u.sub_chat_type===Zf.Podcast,[u.sub_chat_type]),B=O.useMemo(()=>[Zf.ImageGeneration,Zf.ImageEdit,Zf.VideoGeneration].includes(u.chat_type)||$,[u.chat_type,$]),q=O.useMemo(()=>{var e;return"data_inspection_failed"===(null==(e=null==u?void 0:u.error)?void 0:e.errorCode)},[null==u?void 0:u.error]),V=O.useMemo(()=>{var e,t;return!(q||u.sub_chat_type!==Zf.DeepResearchWebDev&&u.chat_type!==Zf.Artifacts&&u.chat_type!==Zf.WebDev)||(u.sub_chat_type&&[Zf.DeepResearchWebDev].includes(u.sub_chat_type)||[Zf.DeepResearchWebDev].includes(null==(t=null==(e=null==u?void 0:u.extra)?void 0:e.meta)?void 0:t.subChatType))},[q,u.sub_chat_type,u.chat_type,null==(n=null==(t=null==u?void 0:u.extra)?void 0:t.meta)?void 0:n.subChatType]),W=O.useMemo(()=>!B,[B]),Q=O.useMemo(()=>{var e,t;return u.sub_chat_type===Zf.DeepResearchWebDev||(null==(t=null==(e=u.extra)?void 0:e.meta)?void 0:t.subChatType)===Zf.DeepResearchWebDev},[u.sub_chat_type,null==(a=null==(i=u.extra)?void 0:i.meta)?void 0:a.subChatType]),K=O.useMemo(()=>{var e;return!(null==u?void 0:u.is_stop_in_thinking)&&(null==(e=u.content_list)?void 0:e.some(e=>{var t;return[ng.THINK,ng.TOOL,ng.LOCAL_TOOL,ng.DEEPTHINKING,ng.CODE_INTERPRETER,ng.INTERRUPT,ng.IMAGE_GEN_TOOL,ng.IMAGE_EDIT_TOOL,ng.WEB_SEARCH,ng.WEB_SEARCH_IMAGE,ng.IMAGE_SEARCH].includes(e.phase)||e.phase===ng.ANSWER&&(null==(t=e.content)?void 0:t.length)}))},[null==u?void 0:u.is_stop_in_thinking,u.content_list]),Y=O.useMemo(()=>{var e;return(null==u?void 0:u.is_stop_in_thinking)&&(null==(e=u.content_list||[])?void 0:e.filter(e=>{var t;return e.phase===ng.ANSWER&&(null==(t=e.content)?void 0:t.length)}).length)>0},[null==u?void 0:u.is_stop_in_thinking,u.content_list]),X=mg((null==u?void 0:u.sub_chat_type)||(null==(s=null==(o=null==u?void 0:u.extra)?void 0:o.meta)?void 0:s.subChatType))&&(null==(r=u.content_list)?void 0:r.find(e=>[ng.RESEARCHPLANNING].includes(e.phase))),Z=O.useMemo(()=>{var e;return null==(e=u.content_list)?void 0:e.some(e=>e.phase===ng.SLIDES)},[u.content_list]),ee=O.useMemo(()=>!(null==u?void 0:u.done)&&!K&&!Y&&!X&&!Z&&!Q&&W,[null==u?void 0:u.done,K,Y,X,Z,Q,W]),te=O.useMemo(()=>!(u.done||!(null==u?void 0:u.functionCallType)||![Yf.CODE_INTERPRETER].includes(null==u?void 0:u.functionCallType)),[u]),ne=O.useMemo(()=>!!(null==u?void 0:u.error),[null==u?void 0:u.error]),ie=O.useMemo(()=>{var e;return(!u.is_stop_in_thinking&&iG((null==u?void 0:u.content_list)||[])&&jt(null==u?void 0:u.content)||!!(null==u?void 0:u.is_stop_in_thinking)&&iG(null==(e=(null==u?void 0:u.content_list)||[])?void 0:e.filter(e=>e.phase===ng.ANSWER)))&&(null==u?void 0:u.done)&&!B&&!ne},[ne,B,null==u?void 0:u.done,null==u?void 0:u.content,null==u?void 0:u.content_list,u.is_stop_in_thinking]),ae=(e,t,n=!0)=>P(void 0,null,function*(){const i=Wb.getState().history;oT.editMessage({messageId:e,content:t,history:i,submit:n})}),oe=O.useCallback((e,t=!1)=>P(void 0,null,function*(){var n,i;if(z(!1),bx()&&!F.current)return;L(!1);const a=e.replace(/\s+/g,"");if(""===e||0===a.length)return ut.open({type:"error",content:g.t("The content cannot be empty!")}),!1;let o;w===u.id&&Jk.getInstance().stopAllPlayer();o=[u.chat_type,u.sub_chat_type,null==(i=null==(n=null==u?void 0:u.extra)?void 0:n.meta)?void 0:i.subChatType].includes(Zf.WebSearch)?tG(u):nG(u);const{success:s,data:r}=yield IS({origin_content:o,new_content:e});if(!s&&"data_inspection_passed"!==r.message)return;const l=((e,t)=>{const{thinkingQuoteText:n}=eG((null==t?void 0:t.content)||""),i=(null==n?void 0:n.length)?`<think>${n}</think>`:"";return(null==i?void 0:i.length)?i+e:e})(e,u);t?ae(u.id,e?l:""):ae(u.id,e?l:"",!1),R(null),Jk.getInstance().destroyTTS(b,u.id||""),E(S.filter(e=>e!==u.id))}),[b,g,u,E,S,w]),se=O.useCallback(()=>{M(e=>C(_({},e),{media:!0}))},[]);O.useEffect(()=>{F.current=D},[D]),O.useEffect(()=>{oT.collectAllSearchAndThinList([u])},[u]);const re=O.useMemo(()=>u.id===x,[x,u.id]),[le,ce]=O.useState(!1),ue=O.useMemo(()=>v||$?tn.jsx(zV,{message:u,onMediaError:se,podcastAsyncLoading:le,setPodcastAsyncLoading:ce}):tn.jsx($V,{isMultiChat:h,active:p,setCanHideMenu:I,showMenu:T,message:u,isOldMessageInNewBranch:d,isEdit:U,setIsEdit:z,error:N,isRenderEmpty:ie,setEditedContent:R,setNativeEditing:L,editSaveHandler:e=>oe(e),children:tn.jsx(zV,{message:u,onMediaError:se,podcastAsyncLoading:le,setPodcastAsyncLoading:ce})},u.fid||u.id),[N,p,U,v,u,T,h,$,ie,le,d,se,oe]);return tn.jsx("div",{className:J("chat-response-message"),id:`chat-response-message-${u.id||""}`,children:tn.jsxs("div",{className:"chat-response-message-right",children:[!ee&&!ne&&null===A&&tn.jsx(tn.Fragment,{children:B?ue:tn.jsxs(gV,{menuRef:H,canHideMenu:k,setCanHideMenu:I,setShowMenu:j,message:u,children:[tn.jsx(KG,{message:u}),tn.jsx(tV,{message:u}),W&&(u.content_list||((null==u?void 0:u.content)?[{phase:ng.ANSWER,content:null==u?void 0:u.content}]:null)||[]).map((e,t)=>{var n,i,a,o,s,r,l,c,d,h,p,m,g,v;switch(e.phase){case ng.INTERRUPT:case ng.ANSWER:case ng.DEEPTHINKING:return V?null:tn.jsx(AG,{message:u,boxId:f,phase:e.phase,children:tn.jsx(FG,{message:u,phaseContentIndex:t,content:null==e?void 0:e.content},t)});case ng.THINK:case ng.THINKING_SUMMARY:{const a=null==u?void 0:u.content_list;return Array.isArray(a)&&t>0&&(null==(n=a[t-1])?void 0:n.groupIndex)===(null==(i=a[t])?void 0:i.groupIndex)?null:tn.jsx(WV,{phaseContent:e,contentList:a||[],message:u,status:u.done||u.is_stop?aV.RESULT_STATE:aV.PROCESS_STATE,controlConfig:{visibly:!0,onClick:()=>{oT.onExpandHandler({messageId:u.id||"",phaseId:`${t}`,next:!0})}}})}case ng.CODE_INTERPRETER:case ng.WEB_SEARCH:case ng.WEB_SEARCH_IMAGE:case ng.WEB_EXTRACTOR:case ng.HISTORY_RETRIEVER:case ng.BIO:case ng.IMAGE_SEARCH:return"answer"!==(null==(a=null==e?void 0:e.extra)?void 0:a.display_position)?null:tn.jsx(VV,{type:e.phase,status:u.done||u.is_stop||"finished"===e.status?aV.RESULT_STATE:aV.PROCESS_STATE,controlConfig:{visibly:!0,onClick:()=>{oT.onExpandHandler({messageId:u.id||"",phaseId:`${t}`,next:!0})}}});case ng.PdfMdGen:return tn.jsx(eV,{timestamp:u.timestamp,info:C(_({},(null==(o=null==e?void 0:e.extra)?void 0:o.deep_research)||(null==(s=null==e?void 0:e.extra)?void 0:s.travel_research)||{}),{messageId:u.id}),subChatType:(null==u?void 0:u.sub_chat_type)||(null==(l=null==(r=null==u?void 0:u.extra)?void 0:r.meta)?void 0:l.subChatType)},t);case ng.RESEARCHPLANNING:return null;case ng.TOOL:case ng.LOCAL_TOOL:return tn.jsx(tV,{message:u,phaseContentIndex:t},t);case ng.IMAGE_ZOOM_IN_TOOL:return tn.jsx(SV,{detail:e,message:u,isStop:u.is_stop});case ng.IMAGE_GEN_TOOL:case ng.IMAGE_EDIT_TOOL:return tn.jsx(kV,{detail:e,message:u,onMediaError:se},e.function_id||t);case ng.SLIDES:return(null==(d=null==(c=null==e?void 0:e.extra)?void 0:c.slides)?void 0:d.slides_title)?tn.jsx(HV,{info:null==(v=null==e?void 0:e.extra)?void 0:v.slides,timestamp:u.timestamp,messageId:u.id||"",message:u},u.id):(null==(h=u.content_list)?void 0:h[t+1])?null:tn.jsx(BV,{hasThinking:!!(null==(p=u.content_list)?void 0:p.some(e=>e.phase===ng.THINKING_SUMMARY)),slidesCount:(null==(g=null==(m=null==e?void 0:e.extra)?void 0:m.slides)?void 0:g.slides_count)||0});default:return null}}),V&&tn.jsx(IV,{message:u,isDeepResearch:u.sub_chat_type===Zf.DeepResearchWebDev||(null==(c=null==(l=u.extra)?void 0:l.meta)?void 0:c.subChatType)===Zf.DeepResearchWebDev,isLastMessage:re})]})}),null!==A&&tn.jsx(nV,{editedContent:A||"",setEditedContent:R,setIsEdit:z,handleSaveEditMessage:oe}),ee&&tn.jsx(dV,{message:u}),te&&tn.jsx(hV,{}),ne&&tn.jsx(pV,{message:u}),ie&&W&&tn.jsx(fV,{}),!m&&(v||$||!B)&&tn.jsx(PV,{isMultiChat:h,active:p,setCanHideMenu:I,showMenu:T,message:u,isOldMessageInNewBranch:d,isEdit:U,setIsEdit:z,error:N,isRenderEmpty:ie,setEditedContent:R,setNativeEditing:L,editSaveHandler:e=>oe(e),podcastAsyncLoading:le},u.fid||u.id),re&&!y&&!m&&tn.jsx(yV,{message:u})]})})},KV=e=>{const{messageId:t,boxId:n}=e,i=tx(e=>e.mobile),a=Zb(e=>e.temporaryChatEnabled),o=yE(e=>e.isSharePage),s=Wb(e=>e.chatId),r=Wb(e=>e.history.currentId),l=O.useRef(null),[c,u]=O.useState(0),[d,h]=O.useState(!1),[p,m]=O.useState(0),[f,g]=O.useState(0),{groupedMessageIds:v,groupedMessageIdsIdx:y}=((e,t)=>{const[n,i]=O.useState({}),[a,o]=O.useState({});return O.useEffect(()=>{if(!e||!t)return;const n=Wb.getState().history,a=n.messages[e].parentId?n.messages[n.messages[e].parentId]:null,s=null==a?void 0:a.models.reduce((e,t,i)=>{let o=null==a?void 0:a.childrenIds.map(e=>n.messages[e]).filter(e=>(null==e?void 0:e.modelIdx)===i).map(e=>e.id);if(0===o.length){const e=null==a?void 0:a.childrenIds.map(e=>n.messages[e]).filter(e=>(null==e?void 0:e.model)===t);e.forEach(e=>{e.modelIdx=i}),o=e.map(e=>e.id)}return C(_({},e),{[i]:{messageIds:o}})},{}),r=null==a?void 0:a.models.reduce((t,n,i)=>{var a;const o=null==(a=null==s?void 0:s[i])?void 0:a.messageIds,r=o.findIndex(t=>t===e);return C(_({},t),-1!==r?{[i]:o[r]}:{[i]:o[o.length-1]})},{});i(s),o(r)},[e,t]),{groupedMessageIds:n,groupedMessageIdsIdx:a}})(t,r),b=O.useMemo(()=>Object.keys(v).length,[v]),x=O.useCallback(e=>{var n;if(e&&t!==e){let t=e;const i=Wb.getState().history;let a=i.messages[t||""].childrenIds;for(;0!==a.length;)t=a.slice(-1)[0],a=(null==(n=i.messages[t||""])?void 0:n.childrenIds)||[];oT.updateChatHistory({currentId:t})}},[t,o,a]),w=O.useCallback(e=>{i&&(e.preventDefault(),h(!0),m(e.touches[0].clientX))},[i]),S=O.useCallback(e=>{var t;if(!i||!d)return;e.preventDefault(),e.stopPropagation();const n=e.touches[0].clientX,a=100*-c+(n-p)/((null==(t=l.current)?void 0:t.offsetWidth)||1)*100,o=100*-(b-1);g(Math.max(o,Math.min(0,a)))},[i,d,p,c,b]),E=O.useCallback(e=>{if(!i||!d)return;e.preventDefault(),h(!1);const t=e.changedTouches[0].clientX-p;let n=c;if(Math.abs(t)>50&&(t>0&&c>0?n=c-1:t<0&&c<b-1&&(n=c+1)),u(n),g(100*-n),n!==c){const e=y[n];e&&x(e)}},[i,d,p,c,b,y,x]);O.useEffect(()=>{if(i){const e=Object.entries(y).findIndex(([e,n])=>n===t);-1!==e&&e!==c&&(u(e),g(100*-e))}},[t,y,i,c]),O.useEffect(()=>{if(i&&d)return document.body.style.overflow="hidden",document.body.style.touchAction="none",()=>{document.body.style.overflow="",document.body.style.touchAction=""}},[i,d]);const k=()=>tn.jsx(tn.Fragment,{children:Object.keys(v).map(Number).map(e=>{var i;const a=y[e];let o=Wb.getState().history.messages[a||""];const r=null==(i=v[e])?void 0:i.messageIds;return o=C(_({},o),{siblings:r}),tn.jsxs("div",{className:J("chat-multi-response-message-card",{active:t===a,"one-response-share":s.startsWith("t_")}),onClick:()=>x(a),children:[tn.jsx("div",{className:"chat-multi-response-message-card-header",children:null==o?void 0:o.modelName}),tn.jsx(QV,{isMultiChat:!0,boxId:n,active:t===a,message:o})]},a)})});return tn.jsx("div",{className:J("chat-multi-response-message",{mobile:i,swiping:d,"chat-multi-response-message-mac":"MACOS"===_x(),"chat-multi-response-message-windows":"MACOS"!==_x()}),children:i?tn.jsx("div",{ref:l,className:"chat-multi-response-message-container",style:{transform:`translateX(${f}%)`},onTouchStart:w,onTouchMove:S,onTouchEnd:E,children:k()}):k()})},YV=({line:e=!0,children:t})=>tn.jsxs("div",{className:"message-divider",children:[tn.jsx("div",{className:"message-divider-line",style:{opacity:e?1:0}}),tn.jsx("div",{className:"message-divider-text",children:t}),tn.jsx("div",{className:"message-divider-line",style:{opacity:e?1:0}})]}),XV=e=>{const{multiResponseMessagesLength:t,messageIds:n,parentId:i,currentIndex:a,className:o,setCurrentIndex:s}=e,r=tx(e=>e.mobile),l=O.useRef(null),[c,u]=O.useState(!1),[d,h]=O.useState(0),[p,m]=O.useState(0),f=O.useCallback(e=>{r&&(e.preventDefault(),u(!0),h(e.touches[0].clientX))},[r]),g=O.useCallback(e=>{var n;if(!r||!c)return;e.preventDefault(),e.stopPropagation();const i=e.touches[0].clientX,o=100*-a+(i-d)/((null==(n=l.current)?void 0:n.offsetWidth)||1)*100,s=100*-(t-1);m(Math.max(s,Math.min(0,o)))},[r,c,d,a,t]),v=O.useCallback(e=>{var o,h;if(!r||!c)return;u(!1);const p=e.changedTouches[0].clientX-d;let f=a;Math.abs(p)>50&&(p>0&&a>0?f=a-1:p<0&&a<t-1&&(f=a+1)),s(f);const g=(null==(o=l.current)?void 0:o.offsetWidth)||0,v=(null==(h=document.getElementById(i))?void 0:h.offsetWidth)||0;m(g&&v&&f?-f*Math.floor((g-(v-g-15))/g*100):100*-f),f!==a&&n[f]},[r,c,d,a,t,i,n]);return O.useEffect(()=>{if(r&&c)return document.body.style.overflow="hidden",document.body.style.touchAction="none",()=>{document.body.style.overflow="",document.body.style.touchAction=""}},[r,c]),tn.jsx("div",{ref:l,className:o,style:{transform:`translateX(${p}%)`},onTouchStart:f,onTouchMove:g,onTouchEnd:v,children:e.children})},JV=({message:e,regenerateResponse:t,boxId:n})=>{const{t:i,i18n:a}=G(),o=O.useRef(null),s=O.useRef([]);yE(e=>e.showSidebar);const r=Wb(e=>e.chatId),l=tx(e=>e.mobile),[c,u]=O.useState(0),d=Wb(e=>e.history.messages),h=O.useMemo(()=>{var t;const n=e.id?null==(t=d[e.id])?void 0:t.parentId:void 0;return n?d[n]:null},[d,e]),p=O.useMemo(()=>{var e;return(null==(e=null==h?void 0:h.childrenIds.filter(e=>e))?void 0:e.slice(-2))||[]},[h]),m=O.useMemo(()=>p.map(e=>d[e]).filter(e=>e),[d,p]),{scrollStates:f,updateScrollState:g}=(e=>{const[t,n]=O.useState(Array(e).fill({showUp:!1,showDown:!1}));return{scrollStates:t,updateScrollState:O.useCallback((e,t,i)=>{n(n=>{var a,o;if((null==(a=n[e])?void 0:a.showUp)!==t||(null==(o=n[e])?void 0:o.showDown)!==i){const a=[...n];return a[e]={showUp:t,showDown:i},a}return n})},[])}})(m.length),v=O.useCallback(e=>{const t=s.current[e];if(!t)return;const{scrollTop:n,scrollHeight:i,clientHeight:a}=t;g(e,n>1,n<i-a-1)},[g]),y=O.useCallback(e=>{var t;null==(t=s.current[e])||t.scrollTo({top:0,behavior:"smooth"})},[]),b=O.useCallback(e=>{const t=s.current[e];t&&t.scrollTo({top:t.scrollHeight,behavior:"smooth"})},[]);O.useEffect(()=>{const e=[];return s.current.forEach((t,n)=>{if(t){v(n);const i=new ResizeObserver(()=>v(n));i.observe(t.getElementsByClassName("chat-response-message")[0]),e.push(i)}}),()=>{e.forEach(e=>e.disconnect())}},[v]);const x=O.useCallback(e=>P(void 0,null,function*(){var t,n,i,a;const s=m[e].id;if(!s)return;const l=null==(t=d[s])?void 0:t.parentId;if(!l)return;var c;yield(c={id:r,messageIds:[s]},P(void 0,[c],function*({id:e,messageIds:t}){return yield Ox(`/chats/${e}/messages/select`,{method:"POST",data:{ids:t}})}));const u=(null==(n=d[l])?void 0:n.childrenIds)||[],h=u.find(e=>e!==s),p=It(d);(null==(i=p[s])?void 0:i.parentId)&&(p[null==(a=p[s])?void 0:a.parentId].childrenIds=u.filter(e=>e!==h)),u.forEach(e=>{p[e].isMultiResponse=!1}),h&&Reflect.deleteProperty(p,h),oT.updateChatHistory({messages:p,currentId:s,currentResponseIds:[s]}),requestAnimationFrame(()=>{var e;null==(e=o.current)||e.scrollIntoView({behavior:"smooth",block:"nearest"})})}),[m,d,r]),w=O.useCallback((e,a)=>{var o,r,l,c;const u="data_inspection_failed"===(null==(o=null==e?void 0:e.error)?void 0:o.errorCode);return tn.jsxs("div",{className:"response-message-box",id:`${e.id}-response-message-box`,children:[tn.jsx("div",{className:"smulti-o-header",children:i("Response {{num}}",{num:a+1})}),tn.jsx("div",{className:"smulti-o-content",ref:e=>{s.current[a]=e},onScroll:()=>v(a),children:tn.jsx(QV,{isModelComparison:m.length>1,message:e,regenerateResponse:t,boxId:n})}),(null==(r=f[a])?void 0:r.showDown)&&tn.jsx("div",{className:"smuti-o-content-mask"}),(null==(l=f[a])?void 0:l.showDown)&&tn.jsx("div",{className:"smuti-o-content-scroll-bottom",onClick:()=>b(a),children:tn.jsx(dt,{type:"icon-line-arrow-down"})}),(null==(c=f[a])?void 0:c.showUp)&&tn.jsx("div",{className:"smuti-o-content-scroll-top",onClick:()=>y(a),children:tn.jsx(dt,{type:"icon-line-arrow-up"})}),!u&&tn.jsx("div",{className:"smulti-o-footer",children:tn.jsx(pt,{type:"brandsecondary",rounded:"circle",className:"smulti-make-better",onClick:()=>x(a),disabled:!(null==e?void 0:e.done),children:i("{{param}} is better",{param:0===a?"A":"B"})})})]},e.id||a)},[f,v,b,y,x,i,t,m.length,n]),S=O.useCallback(()=>tn.jsx(tn.Fragment,{children:m.map((e,t)=>w(e,t))}),[m,w]),_=O.useCallback(()=>tn.jsx(XV,{className:"smulti-o-response-message-container",multiResponseMessagesLength:2,messageIds:m.map(e=>e.id),parentId:C,setCurrentIndex:u,currentIndex:c,children:S()}),[m,S,c]),C=O.useMemo(()=>"smulti-o-response-message",[]);return tn.jsxs("div",{className:"smulti-o-response-message",ref:o,id:C,children:[m.length>1&&tn.jsxs("div",{className:"smulti-o-prefer-choice-tip",children:[tn.jsx("p",{className:"tip-title",children:i("This feedback will help us evaluate and enhance Qwen Chats performance.")}),tn.jsx("p",{className:"tip-text",children:i("Which response do you prefer? Select one to continue.")})]}),m.length?tn.jsx("div",{className:J("smulti-o-response-message-wrapper",{"smulti-o-response-message-mac":"MACOS"===_x()&&!l,"smulti-o-response-message-windows":"MACOS"!==_x()&&!l}),children:l?_():S()}):tn.jsx(QV,{message:e,regenerateResponse:t,boxId:n}),m.length>1&&l&&tn.jsx("div",{className:"smulti-o-response-message-pagination",children:m.map((e,t)=>tn.jsx("div",{className:J("smulti-o-response-message-pagination-dot",{"smulti-dot-active":t===c})},t))})]})},ZV=O.memo(({message:e,handleDeleteMessage:t,isOldMessageInNewBranch:n})=>{const i=G(),a=tx(e=>e.mobile),o=Wb(e=>e.branchInfo),s=iy(),r=O.useMemo(()=>`qwen-chat-message-${"user"===e.role?"user":"assistant"}-${e.id}`,[e]),l=Wb(e=>e.history.messages),c=O.useMemo(()=>!("assistant"!==e.role||!e.parentId)&&EC(e.parentId),[e.parentId,e.role]),u=O.useMemo(()=>{var t;const n=e.id?null==(t=l[e.id])?void 0:t.parentId:void 0;if(n)return l[n]},[e,l]),d=O.useMemo(()=>{var t,n;return e.id&&u&&(null==(t=null==u?void 0:u.childrenIds)?void 0:t.length)>1&&(null==(n=l[e.id])?void 0:n.isMultiResponse)},[l,u,e.id]),h=()=>{if(!o)return null;if((null==o?void 0:o.branch_message_id)===e.id){const e=(null==o?void 0:o.origin_chat_title)||"",t=i.t("Branched from {{chat_title}}",{chat_title:e}),n=t.split(e)[0],r=t.split(e)[1];return tn.jsxs(YV,{line:!a,children:[n?tn.jsx("div",{className:"message-divider-new-branch-label",style:{marginRight:a?"4px":"12px"},children:n.trim()}):null,tn.jsx("div",{className:"message-divider-new-branch-text",onClick:()=>{bx()?oT.adapter.invoke({method:"openHistoryChat",params:{chatId:(null==o?void 0:o.origin_chat_id)||""}}):s(`/c/${(null==o?void 0:o.origin_chat_id)||""}`)},children:e}),r?tn.jsx("div",{className:"message-divider-new-branch-label",style:{marginLeft:a?"4px":"12px"},children:r.trim()}):null]})}return null},p=O.useMemo(()=>{if(!c)return 1;const t=Wb.getState().history,n=e.parentId?t.messages[e.parentId]:null,i=null==n?void 0:n.models.reduce((e,i,a)=>{let o=null==n?void 0:n.childrenIds.map(e=>t.messages[e]).filter(e=>(null==e?void 0:e.modelIdx)===a).map(e=>e.id);if(0===o.length){const e=null==n?void 0:n.childrenIds.map(e=>t.messages[e]).filter(e=>(null==e?void 0:e.model)===i);e.forEach(e=>{e.modelIdx=a}),o=e.map(e=>e.id)}return C(_({},e),{[a]:{messageIds:o}})},{});return Object.keys(i).length},[c,e]);return tn.jsxs("div",{className:J("qwen-chat-message",{"qwen-chat-message-user":"user"===e.role,"qwen-chat-message-assistant":"assistant"===e.role,"qwen-chat-message-dual-message":"assistant"===e.role&&(c&&2===p||d&&!a),"qwen-chat-message-multi-message":"assistant"===e.role&&c&&p>2}),id:r,children:["user"===e.role&&tn.jsx(MG,{message:e,handleDeleteMessage:t,isOldMessageInNewBranch:n}),"assistant"===e.role&&(c?tn.jsx(KV,{messageId:e.id||e.fid,boxId:r}):tn.jsxs(tn.Fragment,{children:[d?tn.jsx(JV,{message:e,boxId:r}):tn.jsx(QV,{message:e,boxId:r,isOldMessageInNewBranch:n}),h()]}))]})},(e,t)=>Mt(e,t)),eW=({children:e,onVisible:t=()=>{}})=>{const n=O.useRef(null),i=O.useRef(null),a=O.useRef(null);return O.useEffect(()=>{const e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting?a.current=setInterval(()=>{t()},1e3):a.current&&(clearInterval(a.current),a.current=null)})},{root:null,rootMargin:"0px",threshold:.1});return i.current=e,n.current&&e.observe(n.current),()=>{i.current&&i.current.disconnect(),a.current&&clearInterval(a.current)}},[]),tn.jsx("div",{ref:n,children:e})},tW=e=>{const{onVisible:t}=e,{i18n:n}=G();return tn.jsx(eW,{onVisible:t,children:tn.jsxs("div",{className:"more-messages-loading",children:[tn.jsx(bt,{className:"size-4"}),tn.jsx("div",{children:n.t("Loading...")})]})})},nW=Math.floor(3*Math.random())+1,iW=({chatIdProp:e})=>{const t=tx(e=>e.config),n=Wb(e=>e.setChatLoaded),i=Wb(e=>e.setChatId),a=Wb(e=>e.chatId),o=Wb(e=>e.history),s=Wb(e=>e.chatMode),r=Wb(e=>e.setChatMode),l=cT(e=>e.settings),c=Zb(e=>e.visionGenerating),u=Zb(e=>e.setVisionGenerating),d=Wb(e=>e.isChat);Wb(e=>e.setIsChat);const h=Wb(e=>e.currentInputFeature),p=tx(e=>e.mobile);Zb(e=>e.taskRunning);const m=Zb(e=>e.setTaskRunning),f=Zb(e=>e.temporaryChatEnabled),g=Zb(e=>e.setThinkingEnabled),v=Zb(e=>e.setThinkingMode),y=Zb(e=>e.setMcpEnabled),b=Zb(e=>e.setResearchMode),x=yE(e=>e.isSharePage),w=Zb(e=>e.setWelcomeModalShow),S=Zb(e=>e.setDeepResearchVersion),E=Zb(e=>e.setPodcastCount),[k,I]=O.useState(20),T=Wb(e=>e.branchInfo),j=xE(e=>e.user),N=rT(e=>e.updateFeatureType),M=iy(),A=Zb(e=>e.setCurrentControlsId),R=Zb(e=>e.setCurrentShowControl),D=Zb(e=>e.setCurrentSlidesInfo);O.useEffect(()=>{E(kC(o.messages)),S(tk(o))},[o,S,E]);const L=O.useMemo(()=>{const e=[];let t=o.messages[(null==o?void 0:o.currentId)||""]||null;for(;t&&e.length<=k;){if(["user","assistant"].includes(t.role)){const n=t;e.push(n)}t=o.messages[(null==t?void 0:t.parentId)||""]||null}return e.reverse()},[o,k]),F=O.useMemo(()=>{var e;if(!(null==(e=L[0])?void 0:e.parentId))return!1;const t=o.messages[L[0].parentId];return!!t&&["user","assistant"].includes(t.role)},[L,o.messages]),U=O.useCallback(()=>P(void 0,null,function*(){if(!e)return;if(["local","guest","new-branch"].includes(e))return void(ZC.currentId||M("/",{replace:!0}));if("normal"!==s){const e=ZC.currentId||"",t=ZC.getChat(e);t&&i(t.chatId||"")}else i(e);oT.createChat({id:ZC.currentId||void 0,chatId:e});(yield oT.loadChat(e))||x?n(!0):M("/")}),[e,n,s,i,M,x]),z=e=>P(void 0,[e],function*({id:e,userMessageLength:t,responseMessage:n,isFirstConversation:i}){var a;e===ZC.currentId&&(c&&(n.extra&&(null==(a=n.extra.wanx)?void 0:a.task_id)||u(!1)),t>=nW&&bT()&&(bx()?oT.adapter.invoke({method:"showAlert",params:{type:"login"}}):w(!0))),"normal"===s&&(i&&(yield new Promise(e=>setTimeout(e,1500))),dC(),hC())}),H=()=>{var e,n,i,a,o,s,r,l;const c=oT.getChatOptions();if(!c)return;const u=null==c?void 0:c.history,d=u.messages[u.currentId||""]||{},h=null!=(a=null==(e=null==d?void 0:d.feature_config)?void 0:e.thinking_enabled)?a:3===(null==(i=null==(n=null==t?void 0:t.permissions)?void 0:n.chat)?void 0:i.thinking);g(h),(null==(o=null==d?void 0:d.feature_config)?void 0:o.auto_thinking)?v("Auto"):v(h?"Thinking":"Fast"),b((null==(s=null==d?void 0:d.feature_config)?void 0:s.research_mode)||"normal"),y(!!(null==(r=null==d?void 0:d.feature_config)?void 0:r.local_mcp)||((null==(l=null==d?void 0:d.feature_config)?void 0:l.mcp)||[]).length>0),(({history:e,currentMessage:t})=>{if(null==e?void 0:e.currentId){if((null==t?void 0:t.sub_chat_type)===Zf.INTERRUPT){const t=VE(e.messages,(null==e?void 0:e.currentId)||"");if(null==t?void 0:t.done)return void N({chatType:Zf.Txt2Txt,subChatType:Zf.Txt2Txt})}[Zf.DeepResearch,Zf.TRAVEL_RESEARCH,Zf.DeepResearchWebDev,Zf.Podcast].includes(null==t?void 0:t.sub_chat_type)&&(null==t?void 0:t.done)&&N({chatType:Zf.Txt2Txt,subChatType:Zf.Txt2Txt})}})({history:u,currentMessage:d})},$=()=>{},B=O.useCallback(t=>{m(t);const n=location.pathname.length>=36||bT()||location.pathname.includes("local");fx()&&n&&oT.adapter.invoke({method:"updateChatInfo",params:{chatId:_C(a||e||"",f),status:t?"running":"finished"}})},[a,e,f,m]),q=O.useCallback((t,n,i)=>{if(bx()){const{status:o,errorMsg:s="",errorCode:r=""}=i,l={};sC(t,n).slice(-2).forEach(e=>{l[(null==e?void 0:e.id)||""]=e});const c=_C(a||e||"",f);let u={chatId:c,messages:l,status:o,errorMsg:s,errorCode:r,messageId:t};"error"===o&&(u=C(_({},u),{errorMsg:s,errorCode:r})),(bT()||"temporary"===c)&&oT.adapter.invoke({method:"updateChatInfo",params:u})}},[a,e,f]),G=O.useCallback(({responseMessage:e,responseMessageId:t,history:n})=>{var i,a,o,s;if(j&&Nk.subscribePolling(),[Zf.DeepResearch,Zf.TRAVEL_RESEARCH,Zf.DeepResearchWebDev].includes(null==e?void 0:e.sub_chat_type)&&N({chatType:Zf.Txt2Txt,subChatType:Zf.Txt2Txt}),e.chat_type===Zf.Artifacts?p||oT.openArtifacts(e.id,!0):e.chat_type===Zf.Slides&&(p||!(null==(i=e.content_list)?void 0:i.some(e=>e.phase===ng.SLIDES))||e.error||(A(e.id||""),R(tg.Slides),D(Ak(e)))),l.ui.responseAutoCopy){let t=e.content;(null==e?void 0:e.content_list)&&(null==(a=null==e?void 0:e.content_list)?void 0:a.length)&&(t=(null==(s=null==(o=null==e?void 0:e.content_list)?void 0:o.find(e=>(null==e?void 0:e.phase)===ng.ANSWER||(null==e?void 0:e.phase)===ng.DEEPTHINKING))?void 0:s.content)||""),C_(h===Zf.WebSearch?ev(t):t)}oT.shareHistory=null,q(t,n,{status:"finished"})},[h,q,p,l.ui.responseAutoCopy,N]),V=()=>{},W=({id:e,errorType:t,responseMessageId:n,history:i,errorMessage:a})=>{e===ZC.currentId&&(q(n,i,{status:"error",errorMsg:a,errorCode:t}),B(!1))},Q=e=>P(void 0,null,function*(){yield oT.deleteMessage(e,a)});return O.useEffect(()=>(XC.on(BC.CHAT_SSE_BEGIN,V),XC.on(BC.CHAT_SSE_PROCESS,$),XC.on(BC.CHAT_MESSAGE_END,z),XC.on(BC.CHAT_HISTORY_LOADED,H),XC.on(BC.CHAT_SSE_END,G),XC.on(BC.CHAT_SSE_ERROR,W),()=>{XC.off(BC.CHAT_MESSAGE_END,z),XC.off(BC.CHAT_HISTORY_LOADED,H),XC.off(BC.CHAT_SSE_PROCESS,$),XC.off(BC.CHAT_SSE_END,G),XC.off(BC.CHAT_SSE_BEGIN,V),XC.off(BC.CHAT_SSE_ERROR,W)}),[e]),O.useEffect(()=>{const e=location.pathname,t=e.length>=36||bT()||e.includes("local");B(d||c),fx()&&t&&oT.adapter.setNativeStopButton(d||c)},[e,d,B,c]),O.useEffect(()=>{I(20),e&&!["new-chat"].includes(e)&&U()},[e]),O.useEffect(()=>{r(x?"share":void 0===j?"guest":f?"local":"normal")},[f,x,r,j]),O.useEffect(()=>{const e=Wb.subscribe(({chatId:e},{chatId:t})=>{e!==t&&Jk.getInstance().destroyAllTTS()});return()=>{e()}},[a]),tn.jsxs("div",{id:"chat-message-container",className:"chat-container",children:[F&&tn.jsx(tW,{onVisible:()=>(I(e=>e+20),void Promise.resolve().then(()=>{const e=document.querySelector(`#${gg}`);e.scrollTop=e.scrollTop+100}))}),L.map((e,t)=>{const n=o.messages[e.parentId||""]||{};return tn.jsx(ZV,{message:e,isOldMessageInNewBranch:!!(T&&t<=L.findLastIndex(e=>e.id===(null==T?void 0:T.branch_message_id))),handleDeleteMessage:Q},n?n.fid||n.id:"root")})]})},aW=({show:e=!1,publicSuccess:t=!1,methodValue:n="Public",methodValueChange:i=()=>{},children:a,onOpenChange:o=()=>{}})=>{const{t:s}=G(),r=tx().mobile,[l,c]=O.useState(0),[u,d]=O.useState(e),[h,p]=O.useState(n),m=[{value:"Public",label:s("Public"),icon:"icon-line-public",desc:s("Anyone with the link can access")},{value:"Private",label:s("Private"),icon:"icon-line-lock",desc:s("Only you can access")}];return O.useEffect(()=>{var e;const t=null==(e=document.querySelector(".qwen-modal-body"))?void 0:e.clientWidth;t&&c(t-32)},[]),tn.jsx(oe,{options:m,defaultValue:"Public",popupMatchSelectWidth:r?void 0:328,open:u,value:h,className:"deploy-method-select",getPopupContainer:e=>e.parentNode,onChange:e=>{p(e),i(e)},prefix:tn.jsx(dt,{type:m.filter(e=>e.value===h)[0].icon,className:"deploy-method-select-icon"}),onDropdownVisibleChange:e=>{d(e),o(e)},disabled:t,suffixIcon:tn.jsx(dt,{type:"icon-line-chevron-down",onClick:()=>{d(!u)}}),optionRender:e=>tn.jsxs("div",{className:"deploy-method-item "+(h===e.data.value?"deploy-method-item-active":""),children:[tn.jsxs("div",{className:"left",children:[tn.jsx(dt,{type:e.data.icon,style:{fontSize:"20px"},className:"icon-font-deploy-method"}),tn.jsxs("div",{className:"method-introduce",children:[tn.jsx("div",{className:"method-name",children:s(e.data.label)}),tn.jsx("div",{className:"method-desc",children:s(e.data.desc)})]})]}),n===e.data.value&&tn.jsx("div",{className:"right",children:tn.jsx(dt,{type:"icon-line-check-02",style:{fontSize:"20px"},className:"deploy-method-icon-active"})})]})})},oW=({show:e=!1,deployLoading:t=!1,className:n="",onDeploy:i=e=>{},currentDeployData:a})=>{const{i18n:o}=G();yE().theme;const s=Zb().setShowDeleteDeployConfirm,r=tx().mobile,[l,c]=O.useState(void 0===a||a.isPublic?"Public":"Private"),[u,d]=O.useState(!1),[h,p]=O.useState(!!(null==a?void 0:a.shareUrl)),[m,f]=O.useState((null==a?void 0:a.shareUrl)||"");O.useEffect(()=>{p(!!(null==a?void 0:a.shareUrl)),f((null==a?void 0:a.shareUrl)||""),c(void 0===a||a.isPublic?"Public":"Private")},[a]);const g=o.t('By clicking "Deploy", you acknowledge and agree to use this feature in compliance with the {{UsagePolicy}} and applicable laws and regulations.',{UsagePolicy:`<a href='/legal-agreement/usage-policy' target="_blank" class="deploy-desc-btn"> ${o.t("Usage Policy")} </a>`});return tn.jsxs("div",{className:"deploy-container "+(r?"deploy-container-mobile":""),children:[tn.jsxs("div",{className:"deploy-artifacts",children:[tn.jsxs("div",{className:"title",children:[tn.jsx("div",{className:"name",children:o.t("Deploy")}),tn.jsx("div",{className:"undeployed "+(h?"deployed":""),children:o.t(h?"Deployed":"Undeployed")})]}),tn.jsx("div",{className:"description",children:"Public"===l?o.t("Anyone with the link can access. Your chat messages will not be shared."):o.t("Only you can access")})]}),tn.jsxs("div",{className:"deploy-groups",children:[t?tn.jsx(xt,{className:"deploy-url "+(m?"":"text-decoration-none"),placeholder:o.t("example.qwen.site"),readOnly:!0,value:"",prefix:tn.jsx(bt,{fontSize:20}),noBorder:!0}):h?tn.jsx(xt,{className:"deploy-url "+(m?"":"text-decoration-none"),value:m,readOnly:!0,onClick:()=>{window.open(m)},noBorder:!0,prefix:tn.jsx(dt,{type:"icon-line-globe-01",className:"icon-font icon-line-globe-01"}),suffix:tn.jsx("div",{className:"deploy-copy",onClick:()=>{C_(m),d(!0),setTimeout(()=>{d(!1)},3e3)},children:u?tn.jsx(dt,{type:"icon-line-check-02",className:"icon-font "}):tn.jsx(ft,{title:o.t("Copy"),children:tn.jsx(dt,{type:"icon-line-copy-right",className:"icon-font "})})})},`${m}_success`):tn.jsx(xt,{className:"deploy-url "+(m?"":"text-decoration-none"),placeholder:o.t("example.qwen.site"),readOnly:!0,value:"",noBorder:!0,prefix:tn.jsx(dt,{type:"icon-line-globe-01",className:"icon-font"})},`${m}_none`),tn.jsx(aW,{methodValue:l,methodValueChange:e=>{c(e)},publicSuccess:h})]}),tn.jsx("div",{className:"deploy-desc",dangerouslySetInnerHTML:{__html:g}}),h?tn.jsx(pt,{size:r?"large":"middle",rounded:"circle",className:"deploy-btn",type:"tertiary",onClick:()=>{s(!0)},children:o.t("Undeploy")}):tn.jsx(pt,{size:r?"large":"middle",rounded:"circle",className:"deploy-btn",type:"brandprimary",loading:t,onClick:()=>{i("Public"===l)},children:t?o.t("Deploying"):o.t("Deploy")})]})},sW=e=>{const{isMobile:t}=e,{i18n:n}=G();return tn.jsx(tn.Fragment,{children:t?tn.jsxs("div",{className:"artifact-error-container",children:[tn.jsx("div",{className:"artifact-error-icon-wrap",children:tn.jsx(dt,{type:"icon-line-package-fail-02",className:"artifact-error-icon"})}),tn.jsx("div",{className:"artifact-error-title",children:n.t("Preview failed")}),tn.jsx("div",{className:"artifact-error-text",children:n.t("No HTML, CSS, or JavaScript content found.")})]}):tn.jsx("div",{className:"artifact-error-container",children:tn.jsx("div",{className:"artifact-error-content",children:tn.jsx("div",{className:"error-message",children:n.t("No HTML, CSS, or JavaScript content found.")})})})})},rW=e=>{var t,n;const{message:i,phaseContentIndex:a,currentContent:o}=e,s=null==(t=i.content_list)?void 0:t[a],{i18n:r}=G(),{openNativePopup:l}=RG({message:i}),c=yE(e=>e.realTheme),u=tx(e=>e.mobile),d=Zb(e=>e.setCurrentShowControl),h=Wb(e=>e.setCurrentCitationInfo),p=yE(e=>e.setShowControls),m=O.useMemo(()=>i.done?"iframe"===o.type?`\`\`\`${o.iframeType||"html"}\n${o.content}\n\`\`\``:"svg"===o.type?`\`\`\`svg\n${o.content}\n\`\`\``:`\`\`\`plaintext\n${(null==s?void 0:s.content)||""}\n\`\`\``:Array.isArray(null==s?void 0:s.content)?"":(null==s?void 0:s.content)||"",[s,o]),f=Aq({mediaType:"image",messageId:i.id}),g=O.useCallback(e=>P(void 0,null,function*(){(yield C_(e))&&ut.openOnce({type:"success",content:r.t("Copying to clipboard was successful!")})}),[r]),v=O.useCallback((e,t="")=>{const n=new Date,i=`Qwen_${t}_${`${n.getFullYear()}${String(n.getMonth()+1).padStart(2,"0")}${String(n.getDate()).padStart(2,"0")}`}_${Math.random().toString(36).slice(-9)}${OG(t)}`;ax.saveAs(new Blob([e],{type:"text/plain;charset=utf-8"}),i)},[]),y=O.useMemo(()=>{var e;return!!(null==(e=null==i?void 0:i.feature_config)?void 0:e.thinking_enabled)},[null==(n=null==i?void 0:i.feature_config)?void 0:n.thinking_enabled]),b=O.useCallback(e=>{if(i.chat_type===Zf.DeepResearch)oT.emit(GC.SOURCE_CILCK,{Tab:De.sources,citationIndex:Number(e)||0});else{if(bx())return void l({type:y?tg.ThinkingAndSearch:tg.WebSearch,currentTab:De.sources,citationIndex:Number(e)});p(!0),d(y?tg.ThinkingAndSearch:tg.WebSearch),h({messageId:i.id||"",citationIndex:Number(e),tab:De.sources})}},[i.chat_type,i.id,l,h,d,p,y]),x=O.useMemo(()=>({code:{headerActionsRender:e=>tn.jsxs(tn.Fragment,{children:[tn.jsx(ft,{title:r.t("Copy"),children:tn.jsx("div",{className:"qwen-markdown-code-header-action-item",onClick:()=>g(e.text),children:tn.jsx(dt,{type:"icon-line-copy-right"})})}),!u&&tn.jsx(ft,{title:r.t("Download"),children:tn.jsx("div",{className:"qwen-markdown-code-header-action-item",onClick:()=>v(e.text,e.lang),children:tn.jsx(dt,{type:"icon-line-download-02"})})})]}),theme:c},codespan:{onClick:e=>P(void 0,[e],function*({text:e}){(yield C_(e))&&ut.openOnce({type:"success",content:r.t("Copying to clipboard was successful!")})})},image:_({defaultWidth:1,defaultHeight:1,sizeScope:u?{width:[114,300],height:[126,380]}:[400,448],onError:()=>({errorMessage:r.t("Image Load Error")})},f),table:{headerActionsRender:fx()?void 0:e=>tn.jsx(tn.Fragment,{children:tn.jsx(yt,{placement:"bottomRight",menu:{items:[{key:"csv",label:tn.jsx("div",{className:"qwen-markdown-table-header-export-item",onClick:()=>{const t=`table-${i.id||""}.csv`;T_(e,t)},children:r.t("Export to CSV")})},{key:"excel",label:tn.jsx("div",{className:"qwen-markdown-table-header-export-item",onClick:()=>{const t=`table-${i.id||""}.xlsx`;j_(e,t)},children:r.t("Export to Excel")})}]},getPopupContainer:e=>e||document.body,children:tn.jsx("div",{className:"qwen-markdown-table-header-action-item",children:tn.jsx(dt,{type:"icon-line-download-02"})})})})},citation:{onClick:e=>b(e)}}),[r,f,i.id,u,b,g,v,c]);return tn.jsx(tn.Fragment,{children:""===m?tn.jsx(sW,{isMobile:u}):tn.jsx(Le,{content:m,loose:!["ja-JP","ko-KR","zh-CN","zh-TW"].includes(r.language),tokenProps:x})})},lW=e=>{const{message:t,currentContent:n}=e;return((null==t?void 0:t.content_list)||[]).map((e,i)=>[ng.ANSWER,ng.DEEPTHINKING].includes(e.phase)?tn.jsx(rW,{message:t,phaseContentIndex:i,currentContent:n},i):null)},cW=e=>{var t,n,i,a,o,s;const{message:r={},nativeLoading:l}=e,c=Zb(e=>e.temporaryChatEnabled),u=Zb(e=>e.showDeleteDeployConfirm),d=tx(e=>e.mobile),h=yE(e=>e.isSharePage),p=Wb(e=>e.currentInputFeature),m=Wb(e=>e.chatId),f=Zb(e=>e.visionGenerating),g=Zb(e=>e.taskRunning),v=Wb(e=>e.branchInfo),y=xE(e=>e.user),b=Zb(e=>e.setShowDeleteDeployConfirm),x=O.useMemo(()=>l||!(oT.getCurrentChatCurrentId()!==(null==r?void 0:r.id)&&!bx())&&(f||g),[f,g,r,l]),{i18n:w}=G(),{qArtifactsDeployArtifacts:S,qArtifactsDeployDeepResearch:E,qArtifactsDeployWebDev:k,checkEquityPassByEquity:I}=HN(),T=O.useMemo(()=>{var e,t;return p===Zf.Artifacts?"artifacts"===(null==(t=null==(e=null==r?void 0:r.extra)?void 0:e.meta)?void 0:t.subChatType)?S:k:E},[p,null==(n=null==(t=null==r?void 0:r.extra)?void 0:t.meta)?void 0:n.subChatType,S,E,k]),j=O.useRef(null),[N,M]=O.useState(!0),[A,R]=O.useState(!1),[D,L]=O.useState(!1),[F,U]=O.useState(!1),[z,H]=O.useState(!1),[$,B]=O.useState(!1),[q,V]=O.useState({content:"",type:"iframe",iframeType:"html",id:"",done:!0}),[W,Q]=O.useState(void 0),[K,Y]=O.useState(!1),[X,Z]=O.useState(""),[ee,te]=O.useState(!1),[ne,ie]=O.useState(!1),[oe,se]=O.useState(!0),[re,le]=O.useState(!1),ce=O.useRef(0),ue=O.useRef(!1),de=O.useRef(!1),he=O.useRef(!1),pe=O.useRef(A);O.useEffect(()=>{pe.current=A},[A]),O.useEffect(()=>{if(x)R(!0);else{const e="1"===localStorage.getItem("artifactsShowCode");R(e)}},[x]),O.useEffect(()=>{if(r){const t=document.getElementById("artifact-content-scroll");e=t,!(he.current||ue.current||de.current)&&pe.current&&x&&e&&(null==e||e.scrollTo({top:e.scrollHeight,behavior:"smooth"}))}var e},[r]);const me=e=>{ge(e.message),se(!0)},fe=e=>{var t,n;Q(e),void 0!==e?oT.updateChatHistory({messages:C(_({},(null==(t=null==oT?void 0:oT.getChatOptions())?void 0:t.history.messages)||{}),{[r.id]:C(_({},r),{extra:C(_({},r.extra),{meta:C(_({},r.extra.meta),{deploy:e})})})})}):oT.updateChatHistory({messages:C(_({},(null==(n=null==oT?void 0:oT.getChatOptions())?void 0:n.history.messages)||{}),{[r.id]:C(_({},r),{extra:C(_({},r.extra),{meta:C(_({},r.extra.meta),{deploy:void 0})})})})})};O.useEffect(()=>{const e=document.getElementById("artifact-content-scroll");if(!e)return;const t=e=>{1===e.touches.length&&(ce.current=e.touches[0].clientY,he.current=!0)},n=e=>{if(1===e.touches.length){const t=e.touches[0].clientY;Math.abs(t-ce.current)>5&&a()}},i=()=>{he.current=!1},a=()=>{de.current=!0},o=()=>{const e=document.getElementById("artifact-content-scroll");if(e){if(de.current){const{scrollTop:t,scrollHeight:n,clientHeight:i}=e,a=t+i>=n-5;ue.current=!a}de.current=!1}},s={passive:!0,capture:!0};return e.addEventListener("touchstart",t,s),e.addEventListener("touchmove",n,s),e.addEventListener("touchend",i,s),e.addEventListener("wheel",a),e.addEventListener("scrollend",o),oT.firstOn(qC.MESSAGE_ARTIFACT_DEPLOY_CHANGE,fe),XC.on(qC.MESSAGE_EDIT_ARTIFACTS,me),()=>{e.removeEventListener("touchstart",t,s),e.removeEventListener("touchmove",n,s),e.removeEventListener("touchend",i,s),e.removeEventListener("wheel",a),e.removeEventListener("scrollend",o),XC.off(qC.MESSAGE_EDIT_ARTIFACTS,me),oT.off(qC.MESSAGE_ARTIFACT_DEPLOY_CHANGE,fe)}},[]);const ge=e=>{var t,n;se(!0),(null==(n=null==(t=null==e?void 0:e.extra)?void 0:t.meta)?void 0:n.deploy)&&Object.keys(e.extra.meta.deploy).length>0?Q(e.extra.meta.deploy):Q(void 0),Z(JE(e));const i=(e=>{var t,n;const i=JE(e);if((null==e?void 0:e.error)||"data_inspection_failed"===(null==(t=null==e?void 0:e.error)?void 0:t.errorMessage)||"data_inspection_failed"===(null==(n=null==e?void 0:e.error)?void 0:n.errorCode))return{type:"error",iframeType:"html",id:e.id,content:"",done:!0};let a;return"user"!==(null==e?void 0:e.role)&&i&&(null==i?void 0:i.length)&&(a=C(_({id:e.id},ak(i)),{done:!0})),a})(e);"svg"!==(null==i?void 0:i.type)&&"error"!==(null==i?void 0:i.type)||se(!1),V(i||C(_({},q),{type:"error"}))};O.useEffect(()=>{ge(r)},[r]),O.useEffect(()=>{B(N||c||bT()||oe||!(null==W?void 0:W.shareUrl)&&(null===(null==T?void 0:T.remains)||0===(null==T?void 0:T.remains)))},[null==W?void 0:W.shareUrl,oe,N,null==T?void 0:T.remains,c,y]),O.useEffect(()=>{L(void 0!==q&&"error"!==q.type&&""!==q.content)},[q]);O.useEffect(()=>{const e=e=>{"Escape"===e.key&&re&&le(!1)},t=()=>{document.fullscreenElement||le(!1)};return document.addEventListener("keydown",e),document.addEventListener("fullscreenchange",t),()=>{document.removeEventListener("keydown",e),document.removeEventListener("fullscreenchange",t)}},[re]);const ve=O.useCallback(e=>{var t,n,i,a;BS(e?"artifactsPreviewFailed":"artifactsPreviewSuccess",{params:{et:"OTHER"},aesParams:{c5:m,c6:`${null==r?void 0:r.id}`,c7:null==(n=null==(t=null==r?void 0:r.extra)?void 0:t.meta)?void 0:n.subChatType,c8:null==r?void 0:r.chat_type},paramsExtend:{chat_id:m,msg_id:`${null==r?void 0:r.id}`,msg_type:null==r?void 0:r.chat_type,sub_chat_type:null==(a=null==(i=null==r?void 0:r.extra)?void 0:i.meta)?void 0:a.subChatType}})},[m,null==r?void 0:r.chat_type,null==(a=null==(i=null==r?void 0:r.extra)?void 0:i.meta)?void 0:a.subChatType,null==r?void 0:r.id]);O.useEffect(()=>{U(!d&&!h&&D&&!(null==v?void 0:v.isTemp))},[p,D,h,d,v]),O.useEffect(()=>{H(d&&!h&&D&&!(null==v?void 0:v.isTemp)&&(!bx()||!kx("1.3.0")))},[p,D,h,d,v]);const ye=(e=!1)=>P(void 0,null,function*(){var t,n,i;if($)return;Y(!0);const a=(null==r?void 0:r.chat_type)===Zf.DeepResearch?null==r?void 0:r.chat_type:null==(n=null==(t=null==r?void 0:r.extra)?void 0:t.meta)?void 0:n.subChatType;Q({shareId:"",shareUrl:"",type:a,isPublic:e});const o=yield(s={chat_id:m,message_id:r.id,content:X,type:a,public:e},P(void 0,null,function*(){return yield Ox("/share/artifacts/new",{method:"POST",data:s})}));var s;if(o.success){const t=C(_({},W),{shareId:o.data.share_id,shareUrl:o.data.share_url,type:a,isPublic:e});Q(t),oT.updateChatHistory({messages:C(_({},(null==(i=null==oT?void 0:oT.getChatOptions())?void 0:i.history.messages)||{}),{[r.id]:C(_({},r),{extra:C(_({},r.extra),{meta:C(_({},r.extra.meta),{deploy:t})})})})})}Y(!1),yield TE.getState().updateEquity()}),be=O.useMemo(()=>bT()?w.t("Deployment is unavailable in guest mode"):-1!==(null==T?void 0:T.remains)?gE({remains:(null==T?void 0:T.remains)||0,unit:null==T?void 0:T.unit,capability:"Deploy",allowHtml:!0,currentI18n:w}):c?w.t("Deployment is unavailable in temporary chat."):"",[w,null==T?void 0:T.remains,null==T?void 0:T.unit,c,y]),xe=O.useMemo(()=>{var e,t,n,i,a,o,s;return(null==(t=null==(e=null==r?void 0:r.extra)?void 0:e.meta)?void 0:t.subChatType)===Zf.DeepResearchWebDev?(null==(a=null==(i=null==(n=(null==r?void 0:r.content_list)||[])?void 0:n.find(e=>e.phase===ng.ANSWER||e.phase===ng.DEEPTHINKING))?void 0:i.extra)?void 0:a.topic)||w.t("Web Dev"):"artifacts"===(null==(s=null==(o=null==r?void 0:r.extra)?void 0:o.meta)?void 0:s.subChatType)?w.t("Artifacts"):w.t("Web Dev")},[r,d]),we={code:w.t("Code"),preview:w.t("Preview"),disabledPreview:w.t("Please wait until the generation is complete.")};return tn.jsxs(tn.Fragment,{children:[tn.jsxs("div",{className:"artifact-wrapper",children:[tn.jsxs("div",{className:"artifacts-header",children:[tn.jsxs("div",{className:"artifact-header-title-header",children:[!d&&tn.jsx(dt,{type:"artifacts"===(null==(s=null==(o=null==r?void 0:r.extra)?void 0:o.meta)?void 0:s.subChatType)?"icon-a-line-package-0211":"icon-line-web-dev",className:"chat-artifact-header-icon"}),d?tn.jsx(tn.Fragment,{children:tn.jsx(Ke,{showCode:A,setShowCode:e=>{localStorage.setItem("artifactsShowCode",e?"1":"0"),R(e)},isLoading:x,tabsTitles:we})}):tn.jsx("div",{className:"artifact-header-title",children:xe})]}),tn.jsxs("div",{className:"artifact-header-right",children:[F?tn.jsx(ae,{placement:"bottom",title:"",arrow:!1,trigger:"click",className:"deploy-dropdown-menu",getPopupContainer:e=>e.parentNode,align:{offset:[-40,12]},open:ne,onOpenChange:ie,content:tn.jsx("div",{className:"deploy-dropdown-menu-content",children:tn.jsx(oW,{onDeploy:ye,currentDeployData:W,deployLoading:K})}),children:(null==W?void 0:W.shareUrl)?tn.jsx(pt,{rounded:"circle",buttonClass:"chat-artifact-header-deploy",disabled:$,type:"brandtertiary",iconFontType:"icon-line-check-02",size:"small",children:w.t("Deployed")}):tn.jsx(ft,{title:be?tn.jsx("span",{dangerouslySetInnerHTML:{__html:be}}):"",children:tn.jsx(pt,{disabled:$,rounded:"circle",buttonClass:"chat-artifact-header-deploy",type:"brandsecondary",iconFontType:"icon-line-upload-03",size:"small",children:w.t("Deploy")})})}):null,A&&!x&&d&&tn.jsx("div",{onClick:()=>{var e;E_(null!=(e=null==q?void 0:q.content)?e:"")},className:"copy-code-button",children:tn.jsx(dt,{type:"icon-line-copy-right",className:"copy-icon"})}),tn.jsx("div",{className:"artifact-header-close",onClick:()=>{oT.closeShowControls()},children:tn.jsx(dt,{type:"icon-line-x-02",className:"chat-artifact-header-close-icon"})})]})]}),z&&tn.jsxs("div",{className:"header-tip",children:[tn.jsx("div",{className:"header-tip-title",children:bT()?w.t("Deployment is unavailable in guest mode"):w.t("Share your creativity by deploying.")}),tn.jsx("div",{onClick:()=>{var e,t;if(((null==W?void 0:W.shareUrl)||I(T))&&!$)if(bx()){const n=p===Zf.DeepResearch?p:null==(t=null==(e=null==r?void 0:r.extra)?void 0:e.meta)?void 0:t.subChatType,i=(null==W?void 0:W.shareUrl)?{method:"requestToUndeploy",params:{type:n,shareId:null==W?void 0:W.shareId,shareUrl:null==W?void 0:W.shareUrl,isPublic:!!(null==W?void 0:W.isPublic),chatId:m,msgId:null==q?void 0:q.id}}:{method:"requestToDeploy",params:{type:n,chatId:m,msgId:null==q?void 0:q.id}};oT.adapter.invoke(i)}else te(!0)},children:(null==W?void 0:W.shareUrl)?tn.jsx(pt,{size:"small",rounded:"circle",buttonClass:"header-tip-button brandghost-button "+($?"chat-artifact-header-deploy-brandtertiary-disabled":""),type:"brandghost",iconFontType:"icon-line-check-02",children:w.t("Deployed")}):tn.jsx(pt,{buttonClass:"header-tip-button  "+($?"chat-artifact-header-deploy-brandprimary-disabled":""),size:"small",rounded:"circle",type:"brandprimary",iconFontType:"icon-line-upload-03",children:w.t("Deploy")})})]}),tn.jsxs("div",{className:"artifacts-body",children:[!d&&tn.jsxs("div",{className:"artifacts-body-header",style:{height:re?"56px":"52px"},children:[re?tn.jsx("div",{className:"artifacts-body-header-title",children:xe}):tn.jsx(Ke,{showCode:A,setShowCode:e=>{localStorage.setItem("artifactsShowCode",e?"1":"0"),R(e)},isLoading:x,tabsTitles:we}),A?!x&&tn.jsx("div",{className:"artifacts-body-header-extra",onClick:()=>{var e;E_(null!=(e=null==q?void 0:q.content)?e:"")},children:tn.jsx(dt,{type:"icon-line-copy-right",className:"artifacts-body-header-extra-icon"})}):tn.jsx("div",{className:"artifacts-body-header-extra",onClick:()=>{var e;re?(document.exitFullscreen(),le(!1)):(null==(e=document.querySelector(".artifacts-body"))||e.requestFullscreen(),le(!0))},children:tn.jsx(dt,{type:re?"icon-line-minimise":"icon-line-maximise",className:"artifacts-body-header-extra-icon"})})]}),tn.jsxs("div",{className:"artifact-content",children:[tn.jsx("div",{className:J("artifact-content-outer artifacts-body-code",{"artifact-content-hide":!A}),id:"artifact-content-scroll",children:tn.jsx(lW,{message:r,currentContent:q})}),tn.jsx("div",{className:J("artifact-content-outer",{"artifact-content-hide":A}),children:tn.jsx(Ye,{currentContent:q,onIframeFull:e=>j.current=e,onPreviewStatusChange:e=>{M(e),se(!1),ve(e)},isIframeLoading:oe,previewIframeOrigin:Vg,failedText:w.t("Preview failed"),emptyText:w.t("No HTML, CSS, or JavaScript content found."),loadingText:w.t("Loading...")})})]})]})]}),tn.jsx(ht,{bodyPaddingNone:!0,visible:ee,header:!1,footer:!1,onCancel:()=>te(!1),zIndex:9999,children:tn.jsx(oW,{onDeploy:ye,currentDeployData:W,deployLoading:K})}),tn.jsx(ht,{visible:u,title:w.t("Undeploy?"),headerBorderNone:!0,className:"deploy-delete-modal",onCancel:()=>b(!1),getPopupContainer:()=>document.body,actions:[{text:w.t("Close"),type:"tertiary",onClick:()=>{b(!1)},size:"middle",rounded:"circle"},{text:w.t("Undeploy"),type:"dangerprimary",onClick:()=>P(void 0,null,function*(){var e,t;try{(yield(t={share_id:null==W?void 0:W.shareId},P(void 0,null,function*(){return yield Ox("/share/artifacts/cancel",{method:"POST",data:t})}))).success&&(Q(void 0),null!==(null==T?void 0:T.remains)&&0!==(null==T?void 0:T.remains)||(ie(!1),te(!1)))}catch(qY){}finally{Y(!1),b(!1),oT.updateChatHistory({messages:C(_({},(null==(e=null==oT?void 0:oT.getChatOptions())?void 0:e.history.messages)||{}),{[r.id]:C(_({},r),{extra:C(_({},r.extra),{meta:C(_({},r.extra.meta),{deploy:void 0})})})})})}}),size:"middle",rounded:"circle"}],zIndex:9999,size:"small",children:w.t("Are you sure you want to undeploy? This will take effect immediately, and you can always redeploy it later if needed.")})]})},uW=e=>{const{status:t,imageUrl:n,messageId:i}=e,a=G();return tn.jsxs("div",{className:"image-reason-popup",children:[tn.jsxs("div",{className:"image-reason-popup-header",children:[tn.jsx("div",{className:"image-reason-popup-title",children:a.t("Thinking with image")}),tn.jsx("div",{className:"image-reason-popup-close",onClick:()=>oT.closeShowControls(),children:tn.jsx(dt,{type:"icon-close-4"})})]}),tn.jsxs("div",{className:"image-reason-popup-content",children:[tn.jsx("div",{className:"image-reason-popup-content-status",children:a.t(bV[t||ig.TYPING]||"")}),t===ig.FINISHED&&tn.jsx(wV,{imageUrl:n,messageId:i})]})]})},dW=O.memo(e=>{const{cardStatus:t,stepList:n}=e,i=yE(e=>e.deepDetailTitle),a=Zb(e=>e.visionGenerating),o=Zb(e=>e.taskRunning),s=O.useRef(0),r=O.useRef(!1),l=O.useRef(!1),c=O.useMemo(()=>!!mg(null==oT?void 0:oT.getCurrentChatsubChatType())&&(a||o),[a,o]);const u=Ot(function(e){!r.current&&!l.current&&c&&e&&(null==e||e.scrollTo({top:e.scrollHeight,behavior:"smooth"}))},100);return O.useEffect(()=>{if(c){const e=document.getElementById("research-panel-detail-content");u(e)}},[c,n]),O.useEffect(()=>{const e=document.getElementById("research-panel-detail-content"),t=e=>{1===e.touches.length&&(s.current=e.touches[0].clientY)},n=e=>{if(1===e.touches.length){const t=e.touches[0].clientY;Math.abs(t-s.current)>10&&(r.current=!0)}},i=()=>{if(!e)return;const{scrollTop:t,scrollHeight:n,clientHeight:i}=e;t+i>=n-5&&(r.current=!1)},a=()=>{l.current=!0},o=()=>{if(e){if(l.current){const{scrollTop:t,scrollHeight:n,clientHeight:i}=e,a=t+i>=n-5;r.current=!a}l.current=!1}},c=()=>{l.current=!0};return oT.on(qC.MESSAGE_STOP_SCROLL_TO_BOTTOM,c),null==e||e.addEventListener("touchstart",t,{passive:!0}),null==e||e.addEventListener("touchmove",n,{passive:!0}),null==e||e.addEventListener("touchend",i,{passive:!0}),null==e||e.addEventListener("wheel",a),null==e||e.addEventListener("scrollend",o),()=>{oT.off(qC.MESSAGE_STOP_SCROLL_TO_BOTTOM,c),null==e||e.removeEventListener("touchstart",t),null==e||e.removeEventListener("touchmove",n),null==e||e.removeEventListener("touchend",i),null==e||e.removeEventListener("wheel",a),null==e||e.removeEventListener("scrollend",o)}},[]),O.useEffect(()=>()=>{oT.emit(qC.MESSAGE_DEEP_RESEARCH_CLOSE_DETAIL,!1)},[]),tn.jsxs("div",{className:"research-panel-detail",children:[tn.jsxs("div",{className:"research-panel-detail-header",children:[tn.jsx("div",{className:"research-panel-detail-title",children:tn.jsx(Xe,{loading:!1,searchTitle:i,className:"research-panel-detail-title-text"})}),tn.jsx("div",{className:"research-panel-detail-close",onClick:()=>{oT.closeShowControls()},children:tn.jsx(dt,{type:"icon-close-4",style:{fontSize:24}})})]}),tn.jsx("div",{className:"research-panel-detail-content",id:"research-panel-detail-content",children:tn.jsx(Je,{stepList:n,cardStatus:t,isCurrent:!0,linkCardType:"list",stepIdPrefix:"deepDetail",onLinkCard:({url:e})=>{e&&window.open(e,"_blank","noopener,noreferrer")},className:"research-panel-detail-content-markdown-steps"})})]})}),hW=({detail:e})=>{var t,n;const i=G(),a=O.useMemo(()=>{var t;return(null==(t=null==e?void 0:e.extra)?void 0:t.code_interpreter_info)||""},[null==(t=null==e?void 0:e.extra)?void 0:t.code_interpreter_info]),o=O.useMemo(()=>{var t;return k_(null==(t=null==e?void 0:e.function_call)?void 0:t.arguments,{})},[null==(n=null==e?void 0:e.function_call)?void 0:n.arguments]),s=O.useMemo(()=>(e=>{if(!e)return"";const t=e.match(/```[^\n]*\n([\s\S]+?)```/);return t?`\`\`\`python\n${t[1]}\`\`\``:`\`\`\`python\n${e}\n\`\`\``})(null==o?void 0:o.code),[null==o?void 0:o.code]),r=O.useMemo(()=>{return e=a,Array.from(e.matchAll(/!\[.*?\]\((.*?)\)/g),e=>e[1]);var e},[a]),l=O.useMemo(()=>r.map(e=>`![](${e})`).join("\n"),[r]);return tn.jsxs("div",{className:"message-inner-ci",children:[tn.jsxs("div",{className:"image-reasoning-detail",children:[tn.jsx(Le,{content:s}),a&&jt(r)&&tn.jsxs(tn.Fragment,{children:[tn.jsx("div",{className:"image-reasoning-detail-status",children:i.t("Result")}),tn.jsx(Le,{content:a})]})]}),(null==r?void 0:r.length)>0&&tn.jsx(Le,{content:l})]})},pW={[Ze.Running]:ig.TYPING,[Ze.Finish]:ig.FINISHED,[Ze.Stop]:ig.PAUSE,[Ze.Error]:ig.ERROR},mW=({detail:e,cardStatus:t})=>{var n,i;const a=G().t((null==(i=null==(n=null==qV?void 0:qV[null==e?void 0:e.phase])?void 0:n[pW[t]])?void 0:i.text)||"");return tn.jsxs("div",{children:[tn.jsx("p",{children:a}),tn.jsx(hW,{detail:C(_({},e),{extra:C(_({},null==e?void 0:e.extra),{title:a})})})]})},fW=({current:e,total:t,className:n})=>tn.jsxs("div",{className:J("page-counter",n),children:[tn.jsx("div",{className:"page-counter-current",children:e}),tn.jsx("div",{className:"page-counter-separator",children:"/"}),tn.jsx("div",{className:"page-counter-total",children:t})]}),gW=({imageList:e,visible:t,initialIndex:n=0,onClose:i})=>{const[a,o]=O.useState(n),[s,r]=O.useState(!1),l=O.useRef(null);O.useEffect(()=>{t&&(o(n),r(!1))},[t,n]),O.useEffect(()=>{if(!t)return;const n=t=>{"ArrowLeft"===t.key?a>0&&!s&&(r(!0),o(a-1),setTimeout(()=>{r(!1)},500)):"ArrowRight"===t.key?a<e.length-1&&!s&&(r(!0),o(a+1),setTimeout(()=>{r(!1)},500)):"Escape"===t.key&&i()};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[t,a,e.length,s,i]),O.useEffect(()=>(document.body.style.overflow=t?"hidden":"",()=>{document.body.style.overflow=""}),[t]);const c=O.useCallback(()=>{a>0&&!s&&(r(!0),o(a-1),setTimeout(()=>{r(!1)},500))},[a,s]),u=O.useCallback(()=>{a<e.length-1&&!s&&(r(!0),o(a+1),setTimeout(()=>{r(!1)},500))},[a,e.length,s]);if(!t)return null;const d=e.length,h=a+1;return be.createPortal(tn.jsx("div",{className:"image-list-preview-overlay",onClick:i,children:tn.jsxs("div",{className:"image-list-preview-container",onClick:e=>e.stopPropagation(),children:[tn.jsxs("div",{className:"image-list-preview-images-container",children:[tn.jsx("div",{ref:l,className:"image-list-preview-images-wrapper",style:{transform:`translateX(-${100*a}%)`,transition:s?"transform 500ms ease-in-out":"none"},children:e.map((e,t)=>tn.jsx("div",{className:J("image-list-preview-image-item",{"image-list-preview-image-active":t===a,"image-list-preview-image-left":t===a-1,"image-list-preview-image-right":t===a+1}),children:tn.jsx("img",{src:e,alt:`Preview ${t+1}`})},t))}),tn.jsx("button",{className:"image-list-preview-close",onClick:i,children:tn.jsx(dt,{type:"icon-close-4"})}),tn.jsx(fW,{current:h,total:d,className:"image-list-preview-counter"})]}),tn.jsx("button",{className:"image-list-preview-nav image-list-preview-nav-prev",onClick:c,disabled:s||0===a,children:tn.jsx(dt,{type:"icon-line-chevron-left"})}),tn.jsx("button",{className:"image-list-preview-nav image-list-preview-nav-next",onClick:u,disabled:s||a===e.length-1,children:tn.jsx(dt,{type:"icon-line-chevron-right"})})]})}),document.body)},vW=({onClose:e,onDownload:t,fileName:n,info:i})=>{const{i18n:a}=G(),o=tx(e=>e.mobile),[s,r]=O.useState(!1),[l,c]=O.useState(!1),u=O.useMemo(()=>{var e;return(null==(e=null==i?void 0:i.slide_pages)?void 0:e.map(e=>e.image))||[]},[null==i?void 0:i.slide_pages]);return o?tn.jsxs("div",{className:"mb-ppt-container-header",children:[tn.jsx("div",{className:"mb-ppt-viewer-header-title",children:n}),tn.jsxs("div",{className:"mb-ppt-viewer-header-actions",children:[tn.jsx("div",{onClick:t,children:tn.jsx(dt,{type:"icon-line-download-02"})}),tn.jsx("div",{className:"mb-ppt-viewer-header-close",onClick:e,children:tn.jsx(dt,{type:"icon-close1",className:"close-icon"})})]})]}):tn.jsxs("div",{className:"pc-ppt-viewer-header",children:[tn.jsxs("div",{className:"pc-ppt-viewer-header-title",children:[tn.jsx(dt,{type:"icon-line-presentation-01",className:"pc-ppt-viewer-icon"}),tn.jsx("div",{className:"pc-ppt-viewer-header-title-text",children:n})]}),tn.jsxs("div",{className:"pc-ppt-viewer-header-actions",children:[tn.jsx(ae,{arrow:!1,trigger:"click",open:s,onOpenChange:r,placement:"bottom",classNames:{root:"pc-ppt-viewer-more-popover"},content:tn.jsx("div",{className:"pc-ppt-viewer-more-content",children:tn.jsxs("div",{className:"pc-ppt-viewer-more-content-item",onClick:()=>{null==t||t(),r(!1)},children:[tn.jsx(dt,{className:"pc-ppt-viewer-more-content-item-icon",type:"icon-line-download-02"}),a.t("Download")]})}),children:tn.jsx("div",{className:"pc-ppt-viewer-more-icon",children:tn.jsx(dt,{type:"icon-line-more-01"})})}),tn.jsx("div",{className:"pc-ppt-viewer-fullscreen-icon",onClick:()=>{c(!0)},children:tn.jsx(dt,{type:"icon-line-maximise"})}),tn.jsx("div",{onClick:e,className:"pc-ppt-viewer-close-icon",children:tn.jsx(dt,{type:"icon-close1"})})]}),tn.jsx(gW,{imageList:u,visible:l,initialIndex:0,onClose:()=>c(!1)})]})},yW=({imageList:e,visible:t,initialIndex:n=0,onClose:i})=>{const[a,o]=O.useState(n),[s,r]=O.useState(!1),[l,c]=O.useState(()=>window.innerWidth),[u,d]=O.useState(()=>window.innerHeight),[h,p]=O.useState(!0),m=O.useRef(null),f=O.useRef(null),g=O.useRef(!0);O.useEffect(()=>{const e=()=>{c(window.innerWidth),d(window.innerHeight)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]);const v=O.useMemo(()=>16*l/9,[l]);O.useEffect(()=>{t&&(o(n),r(!1),p(!0),g.current=!0)},[t,n]),O.useEffect(()=>{g.current=h},[h]);const y=O.useCallback(()=>{f.current&&clearTimeout(f.current),p(!0),g.current=!0,f.current=setTimeout(()=>{p(!1),g.current=!1},5e3)},[]);O.useEffect(()=>{if(!t)return;y();const e=()=>{g.current&&y()},n=()=>{g.current,y()};return window.addEventListener("touchstart",e),window.addEventListener("touchmove",e),window.addEventListener("click",n,!0),window.addEventListener("touchend",n,!0),()=>{f.current&&clearTimeout(f.current),window.removeEventListener("touchstart",e),window.removeEventListener("touchmove",e),window.removeEventListener("click",n,!0),window.removeEventListener("touchend",n,!0)}},[t,y]),O.useEffect(()=>{if(!t)return;const n=t=>{"ArrowUp"===t.key?a>0&&!s&&(r(!0),o(a-1),setTimeout(()=>{r(!1)},500)):"ArrowDown"===t.key?a<e.length-1&&!s&&(r(!0),o(a+1),setTimeout(()=>{r(!1)},500)):"Escape"===t.key&&i()};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[t,a,e.length,s,i]),O.useEffect(()=>(document.body.style.overflow=t?"hidden":"",()=>{document.body.style.overflow=""}),[t]);const b=O.useCallback(()=>{a>0&&!s&&(r(!0),o(a-1),y(),setTimeout(()=>{r(!1)},500))},[a,s,y]),x=O.useCallback(()=>{a<e.length-1&&!s&&(r(!0),o(a+1),y(),setTimeout(()=>{r(!1)},500))},[a,e.length,s,y]),w=O.useCallback(()=>{y(),i()},[i,y]),S=O.useCallback(e=>{g.current?i():(e.preventDefault(),e.stopPropagation(),y())},[y,i]),_=H.useRef(0),C=H.useRef(0);if(!t)return null;const E=e.length,k=a+1;return be.createPortal(tn.jsx("div",{className:"image-list-full-overlay",onClick:S,children:tn.jsxs("div",{className:"image-list-full-container",onClick:e=>e.stopPropagation(),children:[tn.jsxs("div",{className:"image-list-full-images-container",children:[tn.jsx("div",{ref:m,className:"image-list-full-images-wrapper",onTouchStart:e=>{_.current=e.touches[0].clientY},onTouchEnd:e=>{C.current=e.changedTouches[0].clientY;const t=_.current-C.current;Math.abs(t)>50&&(t>0?x():b())},style:{transform:`translateY(-${100*a}%)`,transition:s?"transform 500ms ease-in-out":"none"},children:e.map((e,t)=>tn.jsx("div",{className:J("image-list-full-image-item",{"image-list-full-image-active":t===a,"image-list-full-image-top":t===a-1,"image-list-full-image-bottom":t===a+1}),style:{paddingTop:t===a-1?2.25*(u-v)+"px":"0",paddingBottom:t===a+1?2.25*(u-v)+"px":"0"},children:tn.jsx("img",{src:e,alt:`Preview ${t+1}`})},t))}),tn.jsx("button",{className:J("image-list-full-close",{"image-list-full-controls-hidden":!h}),onClick:w,children:tn.jsx(dt,{type:"icon-a-line-landscapescreen"})}),tn.jsx(fW,{current:k,total:E,className:J("image-list-full-counter",{"image-list-full-controls-hidden":!h})})]}),tn.jsx("button",{className:J("image-list-full-nav","image-list-full-nav-prev",{"image-list-full-controls-hidden":!h}),onClick:b,disabled:s||0===a,children:tn.jsx(dt,{type:"icon-line-chevron-up"})}),tn.jsx("button",{className:J("image-list-full-nav","image-list-full-nav-next",{"image-list-full-controls-hidden":!h}),onClick:x,disabled:s||a===e.length-1,children:tn.jsx(dt,{type:"icon-line-chevron-down"})})]})}),document.body)},bW=({imageList:e,visible:t,initialIndex:n=0,onClose:i})=>{const[a,o]=O.useState(n),[s,r]=O.useState(!1),[l,c]=O.useState(!1),[u,d]=O.useState(!0),h=H.useRef(0),p=H.useRef(0),m=H.useRef(0),f=H.useRef(0),[g,v]=O.useState(new Map),y=O.useRef(!1),b=O.useRef(!1),x=O.useRef(0),w=O.useRef(1),S=O.useRef(0),C=O.useRef(null),E=O.useRef({translateX:0,translateY:0}),k=O.useCallback(e=>g.get(e)||{scale:1,translateX:0,translateY:0},[g]),I=O.useCallback((e,t)=>{v(n=>{const i=new Map(n),a=k(e);return i.set(e,_(_({},a),t)),i})},[k]),T=O.useCallback(e=>{v(t=>{const n=new Map(t);return n.set(e,{scale:1,translateX:0,translateY:0}),n})},[]);O.useEffect(()=>{t&&(o(n),c(!1),d(!0),v(new Map))},[t,n]),O.useEffect(()=>{1===k(a).scale&&d(!0)},[a,g,k]),O.useEffect(()=>(document.body.style.overflow=t?"hidden":"",()=>{document.body.style.overflow=""}),[t]),O.useEffect(()=>()=>{C.current&&(clearTimeout(C.current),C.current=null)},[]);const j=O.useCallback(()=>{a>0&&!l&&!y.current&&(c(!0),T(a),o(a-1),setTimeout(()=>{c(!1)},300))},[a,l,T]),N=O.useCallback(()=>{a<e.length-1&&!l&&!y.current&&(c(!0),T(a),o(a+1),setTimeout(()=>{c(!1)},300))},[a,e.length,l,T]),P=(e,t)=>{const n=e.clientX-t.clientX,i=e.clientY-t.clientY;return Math.sqrt(n*n+i*i)},M=O.useCallback(e=>{const t=Date.now(),n=t-S.current;if(n<300&&n>0){1===k(e).scale?(I(e,{scale:2,translateX:0,translateY:0}),d(!1)):(T(e),d(!0)),S.current=0,C.current&&(clearTimeout(C.current),C.current=null)}else S.current=t},[k,I,T]);if(!t)return null;const A=e.length,R=a+1;return be.createPortal(tn.jsxs("div",{className:"image-list-preview-h5-overlay",children:[tn.jsxs("div",{className:"image-list-preview-h5-header",children:[tn.jsx("button",{className:"image-list-preview-h5-header-btn",onClick:i,children:tn.jsx(dt,{type:"icon-ArrowLeft"})}),tn.jsx("button",{className:"image-list-preview-h5-header-btn",onClick:()=>r(!s),children:tn.jsx(dt,{type:"icon-a-line-landscapescreen"})})]}),s&&tn.jsx(yW,{imageList:e,visible:s,initialIndex:a,onClose:()=>r(!1)}),tn.jsxs("div",{className:"image-list-preview-h5-content",children:[tn.jsx("div",{className:"image-list-preview-h5-images-wrapper",style:{transform:`translateX(-${100*a}%)`,transition:l?"transform 300ms ease-in-out":"none"},children:e.map((e,t)=>{const n=k(t),i=t===a;return tn.jsx("div",{className:"image-list-preview-h5-image-item",onTouchStart:e=>((e,t)=>{if(1===e.touches.length){h.current=e.touches[0].clientX,m.current=e.touches[0].clientY,y.current=!1;const n=k(t);n.scale>1?(b.current=!0,E.current={translateX:n.translateX,translateY:n.translateY}):b.current=!1}else if(2===e.touches.length){y.current=!0,b.current=!1;const n=P(e.touches[0],e.touches[1]);x.current=n;const i=k(t);w.current=i.scale}})(e,t),onTouchMove:e=>((e,t)=>{if(2===e.touches.length&&y.current){e.preventDefault(),e.stopPropagation();const n=P(e.touches[0],e.touches[1])/x.current*w.current,i=Math.max(.5,Math.min(3,n));I(t,{scale:i}),i>1&&d(!1)}else if(1===e.touches.length&&b.current){e.preventDefault(),e.stopPropagation();const n=k(t);if(n.scale>1){const i=e.touches[0].clientX-h.current,a=e.touches[0].clientY-m.current;let o=E.current.translateX+i,s=E.current.translateY+a;const r=window.innerWidth,l=window.innerHeight,c=r*(n.scale-1)/2,u=l*(n.scale-1)/2;o=Math.max(-c,Math.min(c,o)),s=Math.max(-u,Math.min(u,s)),I(t,{translateX:o,translateY:s})}}})(e,t),onTouchEnd:e=>((e,t)=>{if(y.current)return y.current=!1,b.current=!1,void(k(t).scale>1&&d(!1));if(0===e.touches.length){if(1===e.changedTouches.length){p.current=e.changedTouches[0].clientX,f.current=e.changedTouches[0].clientY;const n=h.current-p.current,i=m.current-f.current,a=50,o=10,s=k(t);if(b.current){if(b.current=!1,Math.abs(n)<o&&Math.abs(i)<o){const e=Date.now(),n=e-S.current;n<300&&n>0?M(t):(S.current=e,s.scale>1&&(C.current&&clearTimeout(C.current),C.current=setTimeout(()=>{d(e=>!e),C.current=null},300)))}return}if(Math.abs(n)>a&&Math.abs(n)>Math.abs(i)&&1===s.scale)n>0?N():j();else if(Math.abs(n)<o&&Math.abs(i)<o){const e=Date.now(),n=e-S.current;n<300&&n>0?M(t):(S.current=e,s.scale>1&&(C.current&&clearTimeout(C.current),C.current=setTimeout(()=>{d(e=>!e),C.current=null},300)))}}}else if(1===e.touches.length){y.current=!1;const n=k(t);n.scale>1&&(b.current=!0,h.current=e.touches[0].clientX,m.current=e.touches[0].clientY,E.current={translateX:n.translateX,translateY:n.translateY})}})(e,t),children:tn.jsx("img",{src:e,alt:`Preview ${t+1}`,style:{transform:i?`scale(${n.scale}) translate(${n.translateX}px, ${n.translateY}px)`:"none",transition:!i||y.current||b.current?"none":"transform 0.1s ease-out",transformOrigin:"center center",touchAction:"none",userSelect:"none",WebkitUserSelect:"none"},draggable:!1})},t)})}),u&&tn.jsx("button",{className:"image-list-preview-h5-nav image-list-preview-h5-nav-prev",onClick:j,disabled:l||0===a,children:tn.jsx(dt,{type:"icon-line-chevron-left"})}),u&&tn.jsx("button",{className:"image-list-preview-h5-nav image-list-preview-h5-nav-next",onClick:N,disabled:l||a===e.length-1,children:tn.jsx(dt,{type:"icon-line-chevron-right"})}),u&&tn.jsx(fW,{current:R,total:A,className:"image-list-preview-h5-counter"})]})]}),document.body)},xW=({info:e})=>{const{i18n:t}=G(),[n,i]=O.useState(!1),a=O.useMemo(()=>{var t;return(null==(t=null==e?void 0:e.slide_pages)?void 0:t.map(e=>e.image))||[]},[null==e?void 0:e.slide_pages]);return tn.jsxs(tn.Fragment,{children:[tn.jsx(et,{onClose:()=>oT.closeShowControls(),header:tn.jsx(vW,{info:e,onClose:()=>oT.closeShowControls(),fileName:null==e?void 0:e.slides_title,onDownload:()=>{try{K_({url:null==e?void 0:e.pdf_url,errorTexts:!0})}catch(t){const e=q();ut.openOnce({type:"error",content:e.t("Download failed")})}}}),info:{pdfUrl:null==e?void 0:e.pdf_url,name:null==e?void 0:e.slides_title,imageList:a},loadingText:`PPT ${t.t("Loading...")}`,onClickImage:e=>{i(!0)},errorInfo:{title:t.t("Not Found")}}),tn.jsx(bW,{imageList:a,visible:n,initialIndex:0,onClose:()=>i(!1)})]})};function wW(e){if(!e)return"";try{const t=e.trim().startsWith("http")?e.trim():`https://${e.trim()}`;return new URL(t).hostname}catch(qY){const n=e.trim().match(/^(?:https?:\/\/)?([^/\s]+)(?:\/|$)/i);return n?n[1]:""}}const SW=H.memo(e=>{const{hostlogo:t,url:n="",onClick:i=()=>{},getRectHandler:a=()=>{}}=e,o=O.useRef(null);return O.useEffect(()=>{o.current&&a(o.current)},[a]),n?tn.jsxs(Z,{ref:o,gap:4,align:"center",justify:"center",className:"qwen-chat-search-card",onClick:i,children:[tn.jsx(Z,{justify:"center",align:"center",className:"qwen-chat-search-card-logo",children:tn.jsx(oG,{src:t||""})}),tn.jsx("div",{children:wW(n)})]}):null}),_W=H.memo(e=>{const{sources:t=[]}=e,n=O.useMemo(()=>Array.isArray(t)&&t.length?t.filter(({url:e})=>e):[],[t]),[i,a]=O.useState(!1),o=O.useRef(null),s=O.useMemo(()=>new Map,[]),r=O.useRef(0),[l,c]=O.useState(-1),u=O.useRef(-1);O.useEffect(()=>{if(!o.current)return;const e=new ResizeObserver(e=>{if(e.length>0){if(-1!==u.current)return;const t=e[0].contentRect.height;if(r.current!==t){r.current=t;const e=329;let n=0,i=0,a=0;c(a-1),Array.from(s.values()).forEach((t,o)=>{const s=t.offsetWidth;if(n>=2)return;a=o;const r=i?i+s+8:s;r>e?(i=s,n++):i=r}),u.current=a-1,c(a-1)}}});return e.observe(o.current),()=>{e.disconnect()}},[s]);const d=O.useCallback(e=>Array.isArray(e)&&e.length?tn.jsx(tn.Fragment,{children:e.map(({hostlogo:e,url:t},n)=>tn.jsx(SW,{url:t,hostlogo:e,onClick:()=>{window.open(t)},getRectHandler:e=>{s.set(n,e)}},`${n}-${t}`))}):null,[s]),h=O.useMemo(()=>i||-1===l?null:tn.jsx(sG,{onClick:()=>{a(!0)},sources:n.slice(l)}),[i,l,n]);return tn.jsxs(Z,{ref:o,wrap:"wrap",gap:8,align:"flex-start",children:[d(-1===l||i?n:n.slice(0,l)),h]})}),CW=e=>tn.jsx("svg",C(_({xmlns:"http://www.w3.org/2000/svg",fill:"none",version:"1.1",width:"16",height:"16",viewBox:"0 0 16 16"},e),{children:tn.jsx("g",{children:tn.jsxs("g",{children:[tn.jsxs("g",{style:{opacity:.23999999463558197},children:[tn.jsx("ellipse",{cx:"7.9999799728393555",cy:"7.9997968673706055",rx:"6.6666669845581055",ry:"6.6666669845581055",fill:"#615CED",fillOpacity:"1"}),tn.jsx("path",{d:"M14.66664698828125,7.9997968828125Q14.66664698828125,8.1634540828125,14.65861698828125,8.3269147828125Q14.65058598828125,8.4903754828125,14.63454498828125,8.653244982812499Q14.61850398828125,8.8161143828125,14.59448998828125,8.978000182812501Q14.57047698828125,9.1398858828125,14.53854798828125,9.3003987828125Q14.50661898828125,9.4609117828125,14.46685398828125,9.6196641828125Q14.42708998828125,9.7784175828125,14.37958198828125,9.9350280828125Q14.33207498828125,10.0916385828125,14.27693998828125,10.2457294828125Q14.22180598828125,10.3998202828125,14.15917598828125,10.5510196828125Q14.09654598828125,10.7022189828125,14.02657398828125,10.8501643828125Q13.95660198828125,10.9981078828125,13.87945498828125,11.1424417828125Q13.80230698828125,11.2867746828125,13.71816998828125,11.4271478828125Q13.63403298828125,11.5675218828125,13.54310998828125,11.7035978828125Q13.45218698828125,11.8396738828125,13.35469598828125,11.9711258828125Q13.25720598828125,12.1025768828125,13.15338298828125,12.2290858828125Q13.04956098828125,12.3555948828125,12.93965398828125,12.4768558828125Q12.82974798828125,12.5981188828125,12.71402598828125,12.7138428828125Q12.59830198828125,12.8295648828125,12.47703998828125,12.9394708828125Q12.35577798828125,13.0493778828125,12.22926898828125,13.1531998828125Q12.10275998828125,13.2570228828125,11.97130898828125,13.3545128828125Q11.83985698828125,13.4520038828125,11.70378098828125,13.5429268828125Q11.56770498828125,13.6338498828125,11.42733198828125,13.7179868828125Q11.28695678828125,13.8021238828125,11.14262388828125,13.8792728828125Q10.99829098828125,13.9564198828125,10.85034658828125,14.0263918828125Q10.70240208828125,14.0963648828125,10.55120178828125,14.1589938828125Q10.40000248828125,14.2216228828125,10.24591158828125,14.2767578828125Q10.09182068828125,14.3318928828125,9.93521018828125,14.3793998828125Q9.77859978828125,14.4269068828125,9.61984728828125,14.4666718828125Q9.46109388828125,14.5064368828125,9.30058148828125,14.5383648828125Q9.14006898828125,14.5702938828125,8.97818278828125,14.5943068828125Q8.81629658828125,14.6183208828125,8.65342758828125,14.6343618828125Q8.49055818828125,14.6504028828125,8.32709788828125,14.6584338828125Q8.16363718828125,14.6664638828125,7.99997998828125,14.6664638828125Q7.83632278828125,14.6664638828125,7.67286208828125,14.6584338828125Q7.50940178828125,14.6504028828125,7.34653238828125,14.6343618828125Q7.18366238828125,14.6183208828125,7.02177618828125,14.5943068828125Q6.85988998828125,14.5702938828125,6.69937708828125,14.5383648828125Q6.53886408828125,14.5064358828125,6.38011168828125,14.4666708828125Q6.22135828828125,14.4269068828125,6.06474828828125,14.3793988828125Q5.90813778828125,14.3318918828125,5.75404738828125,14.2767568828125Q5.59995648828125,14.2216228828125,5.44875668828125,14.1589928828125Q5.29755688828125,14.0963628828125,5.14961238828125,14.0263908828125Q5.00166798828125,13.9564188828125,4.85733508828125,13.8792718828125Q4.71300168828125,13.8021238828125,4.5726279882812495,13.7179868828125Q4.43225428828125,13.6338498828125,4.29617808828125,13.5429268828125Q4.16010188828125,13.4520038828125,4.02865078828125,13.3545128828125Q3.89720008828125,13.2570228828125,3.77069118828125,13.1531998828125Q3.64418218828125,13.0493778828125,3.52291988828125,12.9394708828125Q3.40165778828125,12.8295648828125,3.2859344882812502,12.7138428828125Q3.17021108828125,12.5981188828125,3.06030558828125,12.4768568828125Q2.9503998882812503,12.3555948828125,2.84657668828125,12.2290858828125Q2.74275348828125,12.1025768828125,2.64526268828125,11.9711258828125Q2.54777208828125,11.8396738828125,2.4568488882812503,11.7035978828125Q2.36592558828125,11.5675218828125,2.28178882828125,11.4271488828125Q2.19765209828125,11.2867736828125,2.12050443828125,11.1424407828125Q2.04335683828125,10.9981078828125,1.97338425828125,10.8501634828125Q1.90341168828125,10.7022189828125,1.84078269828125,10.5510186828125Q1.7781537182812501,10.3998193828125,1.72301917828125,10.2457284828125Q1.66788458828125,10.0916375828125,1.62037735828125,9.9350270828125Q1.57287010828125,9.7784166828125,1.53310461828125,9.6196641828125Q1.49333908828125,9.4609107828125,1.46141110828125,9.3003983828125Q1.42948311528125,9.1398858828125,1.40546958128125,8.9779996828125Q1.38145604728125,8.8161134828125,1.36541480928125,8.6532444828125Q1.34937357128125,8.4903750828125,1.34134327988125,8.3269147828125Q1.33331298828125,8.1634540828125,1.33331298828125,7.9997968828125Q1.33331298828125,7.8361396828125,1.34134327988125,7.6726789828125Q1.34937357128125,7.5092186828125,1.36541480928125,7.3463492828125Q1.38145604728125,7.1834792828125,1.40546958128125,7.0215930828125Q1.42948311528125,6.8597068828125,1.46141110828125,6.6991939828125Q1.49333908828125,6.5386809828125,1.5331045982812501,6.3799285828125Q1.57287013828125,6.2211751828125,1.62037738828125,6.0645651828125Q1.6678846182812501,5.9079546828125,1.72301914828125,5.7538642828125Q1.7781537182812501,5.5997733828125,1.84078269828125,5.4485735828125Q1.90341168828125,5.2973737828125,1.97338425828125,5.1494292828125Q2.04335689828125,5.0014848828125,2.12050449828125,4.8571519828125Q2.19765209828125,4.7128185828125,2.28178882828125,4.5724448828124995Q2.36592558828125,4.4320711828125,2.4568488882812503,4.2959949828125Q2.54777208828125,4.1599187828125,2.64526268828125,4.0284676828125Q2.74275348828125,3.8970169828125,2.84657668828125,3.7705080828125Q2.9503998882812503,3.6439990828125,3.06030558828125,3.5227367828125Q3.17021108828125,3.4014746828125,3.2859344882812502,3.2857513828125002Q3.40165778828125,3.1700279828125,3.52291988828125,3.0601224828125Q3.64418218828125,2.9502167828125003,3.77069118828125,2.8463935828125Q3.89719988828125,2.7425703828125,4.02865078828125,2.6450795828125Q4.16010168828125,2.5475889828125,4.29617788828125,2.4566657828125003Q4.43225428828125,2.3657424828125,4.57262778828125,2.2816057228125Q4.71300168828125,2.1974689928125,4.85733458828125,2.1203213328125Q5.0016674882812495,2.0431737328125,5.14961218828125,1.9732011528125Q5.29755688828125,1.9032285828125,5.44875668828125,1.8405995928125Q5.59995648828125,1.7779706128125001,5.75404738828125,1.7228360728125Q5.90813778828125,1.6677014828125,6.06474828828125,1.6201942528125Q6.22135878828125,1.5726870028125,6.38011168828125,1.5329215128125Q6.53886458828125,1.4931559828125,6.69937748828125,1.4612280028125Q6.85989048828125,1.4293000098125,7.02177618828125,1.4052864758125Q7.18366288828125,1.3812729418125,7.34653238828125,1.3652317038125Q7.50940178828125,1.3491904658125,7.67286208828125,1.3411601744125Q7.83632278828125,1.3331298828125,7.99997998828125,1.3331298828125Q8.16363718828125,1.3331298828125,8.32709788828125,1.3411601744125Q8.49055858828125,1.3491904658125,8.653428088281249,1.3652317038125Q8.81629748828125,1.3812729418125,8.978183288281251,1.4052864758125Q9.14006898828125,1.4293000098125,9.30058188828125,1.4612280028125Q9.46109488828125,1.4931559828125,9.61984728828125,1.5329214928125001Q9.77860068828125,1.5726870328125,9.93521118828125,1.6201942828125Q10.09182168828125,1.6677015128125001,10.24591258828125,1.7228360428125Q10.40000338828125,1.7779706128125001,10.55120278828125,1.8405995928125Q10.70240208828125,1.9032285828125,10.85034748828125,1.9732011528125Q10.99829098828125,2.0431737928125,11.14262488828125,2.1203213928125Q11.28695778828125,2.1974689928125,11.42733098828125,2.2816057228125Q11.56770498828125,2.3657424828125,11.70378098828125,2.4566657828125003Q11.83985698828125,2.5475889828125,11.97130898828125,2.6450795828125Q12.10275998828125,2.7425703828125,12.22926898828125,2.8463935828125Q12.35577798828125,2.9502167828125003,12.47703898828125,3.0601224828125Q12.59830198828125,3.1700279828125,12.71402598828125,3.2857513828125002Q12.82974798828125,3.4014746828125,12.93965398828125,3.5227367828125Q13.04956098828125,3.6439990828125,13.15338298828125,3.7705080828125Q13.25720598828125,3.8970167828125,13.35469598828125,4.0284676828125Q13.45218698828125,4.1599185828125,13.54310998828125,4.2959947828125Q13.63403298828125,4.4320711828125,13.71816998828125,4.5724446828125Q13.80230698828125,4.7128185828125,13.87945598828125,4.8571514828125Q13.95660298828125,5.0014843828124995,14.02657498828125,5.1494290828125Q14.09654798828125,5.2973737828125,14.15917698828125,5.4485735828125Q14.22180598828125,5.5997733828125,14.27694098828125,5.7538642828125Q14.33207598828125,5.9079546828125,14.37958298828125,6.0645651828125Q14.42708998828125,6.2211756828125,14.46685498828125,6.3799285828125Q14.50661998828125,6.5386814828125,14.53854798828125,6.6991943828125Q14.57047698828125,6.8597073828125,14.59448998828125,7.0215930828125Q14.61850398828125,7.1834797828125,14.63454498828125,7.3463492828125Q14.65058598828125,7.5092186828125,14.65861698828125,7.6726789828125Q14.66664698828125,7.8361396828125,14.66664698828125,7.9997968828125ZM12.96562698828125,7.9997968828125Q12.96562598828125,7.8778972828125,12.95964498828125,7.7561444828125Q12.95366298828125,7.6343912828125,12.94171498828125,7.5130786828125Q12.92976698828125,7.3917655828125,12.91188098828125,7.2711848828125Q12.89399298828125,7.1506042828125,12.87021298828125,7.0310468828125Q12.84643098828125,6.9114894828125,12.81681298828125,6.7932424828125Q12.78719198828125,6.6749963828125,12.75180698828125,6.5583452828125Q12.71642098828125,6.4416942828125,12.67535398828125,6.3269204828125Q12.63428698828125,6.2121462828125,12.58763798828125,6.0995254828125Q12.54098898828125,5.9869050828125,12.48886998828125,5.8767089828125Q12.43675098828125,5.7665128828125,12.37928898828125,5.6590070828125Q12.32182498828125,5.5515012828125,12.25915598828125,5.4469437828125Q12.19648698828125,5.3423871828125,12.12876298828125,5.2410308828125Q12.06103898828125,5.1396751828125,11.98842398828125,5.0417647828125Q11.91580898828125,4.943853882812499,11.83847598828125,4.8496241828125Q11.76114298828125,4.7553941828125,11.67927998828125,4.6650724828125Q11.59741798828125,4.5747503828125,11.51122198828125,4.4885544828125Q11.42502598828125,4.4023582828125,11.33470298828125,4.3204955828125Q11.24438188828125,4.2386326828125,11.15015218828125,4.161300382812501Q11.05592158828125,4.0839676828125,10.95801068828125,4.0113520828125Q10.86009978828125,3.9387364828125,10.75874428828125,3.8710126828125Q10.65738868828125,3.8032886828125,10.55283168828125,3.7406196828125Q10.44827458828125,3.6779508828125,10.34076878828125,3.6204876828125Q10.23326298828125,3.5630244828125,10.12306688828125,3.5109054828125Q10.01287078828125,3.4587866828125,9.90024948828125,3.4121374828125Q9.78762908828125,3.3654884828125,9.67285538828125,3.3244218828125Q9.55808158828125,3.2833552828125,9.44143108828125,3.2479695828125Q9.32477948828125,3.2125839828125002,9.20653298828125,3.1829647828125003Q9.08828638828125,3.1533455828125003,8.96872898828125,3.1295640828125Q8.849171688281249,3.1057825828125,8.728590988281251,3.0878961828125Q8.60801128828125,3.0700099828125,8.48669858828125,3.0580615828125Q8.36538598828125,3.0461132828124997,8.24363278828125,3.0401317828125Q8.12187958828125,3.0341504828125,7.99997998828125,3.0341504828125Q7.87808038828125,3.0341504828125,7.75632758828125,3.0401317828125Q7.63457438828125,3.0461132828124997,7.51326178828125,3.0580615828125Q7.39194868828125,3.0700099828125,7.27136798828125,3.0878963828124997Q7.15078738828125,3.1057825828125,7.03122998828125,3.1295640828125Q6.91167258828125,3.1533455828125003,6.79342558828125,3.1829647828125003Q6.67517948828125,3.2125839828125002,6.55852838828125,3.2479695828125Q6.44187738828125,3.2833552828125,6.32710358828125,3.3244219828125Q6.21232938828125,3.3654887828125,6.09970858828125,3.4121377828125Q5.98708818828125,3.4587869828125,5.87689208828125,3.5109057828125Q5.76669598828125,3.5630244828125,5.65919018828125,3.6204878828125Q5.55168438828125,3.6779508828125,5.44712688828125,3.7406196828125Q5.34257028828125,3.8032886828125,5.24121398828125,3.8710126828125Q5.13985828828125,3.9387364828125,5.04194788828125,4.0113520828125Q4.944036988281249,4.0839676828125,4.84980728828125,4.161300382812501Q4.75557728828125,4.2386326828125,4.66525558828125,4.3204953828125Q4.57493348828125,4.4023582828125,4.48873758828125,4.4885544828125Q4.40254138828125,4.5747503828125,4.32067868828125,4.6650724828125Q4.23881578828125,4.7553941828125,4.161483488281251,4.8496241828125Q4.08415078828125,4.943853882812499,4.01153518828125,5.0417647828125Q3.93891958828125,5.1396753828125,3.87119578828125,5.2410311828125Q3.80347178828125,5.3423871828125,3.74080278828125,5.4469442828125Q3.67813398828125,5.5515012828125,3.62067078828125,5.6590070828125Q3.56320758828125,5.7665128828125,3.51108858828125,5.8767089828125Q3.45896978828125,5.9869050828125,3.41232058828125,6.0995258828125Q3.36567158828125,6.2121467828125,3.32460498828125,6.3269209828125Q3.28353818828125,6.4416947828125,3.24815258828125,6.5583457828125Q3.2127668882812497,6.6749963828125,3.1831476882812497,6.7932428828125Q3.1535284882812498,6.9114894828125,3.1297468882812502,7.0310468828125Q3.10596548828125,7.1506042828125,3.0880791882812497,7.2711848828125Q3.07019278828125,7.3917655828125,3.0582444882812503,7.5130781828125Q3.0462962882812503,7.6343907828125,3.04031488828125,7.7561440828125Q3.03433358828125,7.8778972828125,3.03433358828125,7.9997968828125Q3.03433358828125,8.1216964828125,3.04031488828125,8.2434496828125Q3.0462963882812497,8.3652028828125,3.0582445882812497,8.4865154828125Q3.07019278828125,8.6078281828125,3.0880790882812503,8.728407882812501Q3.10596548828125,8.848988582812499,3.1297468882812502,8.9685458828125Q3.1535284882812498,9.0881032828125,3.1831476882812497,9.206350282812501Q3.2127668882812497,9.3245963828125,3.24815258828125,9.4412479828125Q3.28353818828125,9.5578984828125,3.32460498828125,9.6726722828125Q3.36567158828125,9.7874459828125,3.41232058828125,9.9000663828125Q3.45896978828125,10.0126876828125,3.51108888828125,10.1228837828125Q3.56320758828125,10.2330798828125,3.62067078828125,10.3405866828125Q3.67813398828125,10.4480924828125,3.74080278828125,10.5526485828125Q3.80347178828125,10.6572055828125,3.87119578828125,10.7585620828125Q3.93891958828125,10.8599185828125,4.01153518828125,10.9578284828125Q4.08415078828125,11.0557393828125,4.161483488281251,11.1499690828125Q4.23881578828125,11.2441987828125,4.32067848828125,11.3345198828125Q4.40254138828125,11.4248428828125,4.48873758828125,11.5110388828125Q4.57493348828125,11.5972348828125,4.66525558828125,11.6790968828125Q4.75557728828125,11.7609598828125,4.84980728828125,11.8382928828125Q4.944036988281249,11.9156258828125,5.04194788828125,11.9882408828125Q5.13985848828125,12.0608558828125,5.24121428828125,12.1285798828125Q5.34257028828125,12.1963038828125,5.44712738828125,12.2589738828125Q5.55168438828125,12.3216428828125,5.65919018828125,12.3791068828125Q5.76669598828125,12.4365688828125,5.87689208828125,12.4886888828125Q5.98708818828125,12.5408068828125,6.09970898828125,12.5874558828125Q6.21232988828125,12.6341048828125,6.32710408828125,12.6751718828125Q6.44187788828125,12.7162388828125,6.55852888828125,12.7516248828125Q6.67517948828125,12.7870098828125,6.79342598828125,12.8166298828125Q6.91167258828125,12.8462488828125,7.03122998828125,12.8700298828125Q7.15078738828125,12.8938098828125,7.27136798828125,12.9116978828125Q7.39194868828125,12.9295848828125,7.51326128828125,12.9415328828125Q7.63457388828125,12.9534808828125,7.75632718828125,12.9594618828125Q7.87808038828125,12.9654428828125,7.99997998828125,12.9654438828125Q8.12187958828125,12.9654428828125,8.24363278828125,12.9594618828125Q8.36538598828125,12.9534798828125,8.48669858828125,12.9415318828125Q8.60801128828125,12.9295838828125,8.728590988281251,12.9116978828125Q8.849171688281249,12.8938098828125,8.96872898828125,12.8700298828125Q9.08828638828125,12.8462478828125,9.206533388281251,12.8166298828125Q9.32477948828125,12.7870088828125,9.44143108828125,12.7516238828125Q9.55808158828125,12.7162378828125,9.67285538828125,12.6751708828125Q9.78762908828125,12.6341038828125,9.90024948828125,12.5874548828125Q10.01287078828125,12.5408058828125,10.12306688828125,12.4886868828125Q10.23326298828125,12.4365678828125,10.34076978828125,12.3791058828125Q10.44827558828125,12.3216418828125,10.55283168828125,12.2589728828125Q10.65738868828125,12.1963038828125,10.75874518828125,12.1285798828125Q10.86010168828125,12.0608558828125,10.95801158828125,11.9882408828125Q11.05592248828125,11.9156258828125,11.15015218828125,11.8382928828125Q11.24438188828125,11.7609598828125,11.33470298828125,11.6790968828125Q11.42502598828125,11.5972348828125,11.51122198828125,11.5110388828125Q11.59741798828125,11.4248428828125,11.67927998828125,11.3345198828125Q11.76114298828125,11.2441987828125,11.83847598828125,11.1499690828125Q11.91580898828125,11.0557384828125,11.98842398828125,10.9578275828125Q12.06103898828125,10.8599166828125,12.12876298828125,10.7585611828125Q12.19648698828125,10.6572055828125,12.25915698828125,10.5526485828125Q12.32182598828125,10.4480914828125,12.37928998828125,10.3405856828125Q12.43675198828125,10.2330798828125,12.48887198828125,10.1228837828125Q12.54098998828125,10.0126876828125,12.58763898828125,9.9000663828125Q12.63428798828125,9.7874459828125,12.67535498828125,9.6726722828125Q12.71642198828125,9.5578984828125,12.75180798828125,9.4412479828125Q12.78719298828125,9.3245963828125,12.81681298828125,9.2063498828125Q12.84643198828125,9.0881032828125,12.87021298828125,8.9685458828125Q12.89399298828125,8.848988582812499,12.91188098828125,8.728407882812501Q12.92976798828125,8.6078281828125,12.94171598828125,8.4865154828125Q12.95366398828125,8.3652028828125,12.95964498828125,8.2434496828125Q12.96562598828125,8.1216964828125,12.96562698828125,7.9997968828125Z",fill:"#615CED",fillOpacity:"1"})]}),tn.jsx("g",{children:tn.jsx("path",{d:"M8.00008546921875,1.4351806640625Q10.71931364921875,1.4351806640625,12.642097449218749,3.3579648640624997Q14.56488034921875,5.2807481640625,14.56488034921875,7.9999766640625L14.56488034921875,7.9999766640625C14.56437064921875,8.4694185640625,14.183812649218751,8.8499765640625,13.71437074921875,8.8499765640625C13.24492934921875,8.8499765640625,12.86437134921875,8.4694185640625,12.86437134921875,7.9999766640625L12.86437134921875,7.9999766640625Q12.86386064921875,5.9853343640625,11.43929434921875,4.5607678640625Q10.014727549218751,3.1362012640625,8.00008546921875,3.1362011640625003L8.00008546921875,3.1362011640625003C7.53064339921875,3.1356909640625,7.15008544921875,2.7551328640625,7.15008544921875,2.2856909040625C7.15008544921875,1.8162488340625,7.53064339921875,1.4356908798225,8.00008546921875,1.4351806640625L8.00008546921875,1.4351806640625Z",fillRule:"evenodd",fill:"#615CED",fillOpacity:"1"})})]})})})),EW=H.memo(e=>{const{type:t=iV.THINKING,status:n=aV.PROCESS_STATE,hiddenContent:i=!1,customTitle:a="",customIcon:o="",children:s,controlConfig:r,id:l}=e,c=G(),u=O.useMemo(()=>[{label:{process:c.t("Thinking..."),completed:c.t("Thinking completed")},key:iV.THINKING,icon:"icon-fill-check-contained"},{label:{process:c.t("Analyzing"),completed:c.t("Analyzed")},key:iV.THINKING_AND_ANALYSING,icon:"icon-fill-check-contained"},{label:{process:c.t("Analyzing image"),completed:c.t("Analyzed image")},key:iV.ANALYZING_IMAGE,icon:"icon-line-image"},{label:{process:c.t("Searching the web"),completed:c.t("Searched the web")},key:iV.SEARCHING_WEB_PAGES,icon:"icon-line-globe-01"},{label:{process:c.t("Searching for images"),completed:c.t("Search complete")},key:iV.IMAGE_SEARCH,icon:"icon-line-image-Searching"},{label:{process:c.t("Running code interpreter"),completed:c.t("Code interpreter finished")},key:iV.CALLING_CODE_INTERPRETER,icon:"icon-line-code-01"},{label:{process:c.t("Searching memory"),completed:c.t("Searched memory")},key:iV.SEARCHING_MEMORIES,icon:"icon-line-brain-02"},{label:{process:c.t("Updating memory"),completed:c.t("Updated memory")},key:iV.UPDATING_MEMORIES,icon:"icon-line-brain-02"},{label:{process:c.t("Reading sources"),completed:c.t("Sources read")},key:iV.READING_SOURCES,icon:"icon-fill-check-contained"}],[c]),d=O.useMemo(()=>u.find(({key:e})=>e===t),[u,t]);return d?tn.jsxs(Z,{className:J("qwen-chat-thinking-status-card",{"qwen-chat-thinking-status-card-completed":n===aV.RESULT_STATE}),gap:8,"data-phase-id":l,children:[tn.jsxs(Z,{vertical:!0,gap:8,align:"center",justify:"space-between",children:[n===aV.PROCESS_STATE?tn.jsx("div",{className:J("qwen-chat-thinking-status-card-icon","qwen-chat-thinking-status-card-icon-processing"),children:tn.jsx(CW,{})}):tn.jsx(dt,{className:"qwen-chat-thinking-status-card-icon",type:o||(null==d?void 0:d.icon)}),i?null:tn.jsx("div",{className:"qwen-chat-thinking-status-card-border"})]}),tn.jsxs(Z,{vertical:!0,gap:8,align:"flex-start",className:"qwen-chat-thinking-status-card-content",children:[tn.jsxs(Z,{align:"center",justify:"space-between",className:"qwen-chat-thinking-status-card-title",children:[tn.jsx("div",{className:"qwen-chat-thinking-status-card-title-text",children:n===aV.PROCESS_STATE?a||d.label.process:a||d.label.completed}),(null==r?void 0:r.visibly)?tn.jsxs(Z,{align:"center",gap:4,className:"qwen-chat-thinking-status-card-button",onClick:null==r?void 0:r.onClick,children:[tn.jsx("div",{children:(null==r?void 0:r.label)||c.t("View")}),tn.jsx(dt,{className:"qwen-chat-thinking-status-card-button-icon",type:"icon-line-chevron-right"})]}):null]}),s]})]}):null});O.memo(e=>{var t,n,i;const{message:a,detail:o,isStop:s}=e,r=yE(e=>e.realTheme),[l,c]=O.useState(!1),u=G(),d=O.useMemo(()=>(null==o?void 0:o.status)===ig.FINISHED?"finished":a.is_stop?"stoped":"loading",[a.is_stop,null==o?void 0:o.status]),h=O.useCallback(e=>P(void 0,null,function*(){(yield C_(e))&&ut.openOnce({type:"success",content:u.t("Copying to clipboard was successful!")})}),[u]),p=O.useCallback(e=>tn.jsxs(tn.Fragment,{children:[tn.jsx(ft,{title:u.t("Copy"),children:tn.jsx("div",{className:"qwen-markdown-code-header-action-item",onClick:()=>h(e.text),children:tn.jsx(dt,{type:"icon-line-copy-right"})})}),tn.jsx(ft,{title:u.t("Download"),children:tn.jsx("div",{className:"qwen-markdown-code-header-action-item",onClick:()=>DG(e.text,"Qwen","python"),children:tn.jsx(dt,{type:"icon-line-download-02"})})})]}),[u,h]),m=(null==(t=null==o?void 0:o.extra)?void 0:t.code_interpreter_info)||"",f=k_(null==(n=null==o?void 0:o.function_call)?void 0:n.arguments,{}),g=(e=>{if(!e)return"";const t=e.match(/```[^\n]*\n([\s\S]+?)```/);return t?`\`\`\`python\n${t[1]}\`\`\``:`\`\`\`python\n${e}\n\`\`\``})(null==f?void 0:f.code),v=(y=m,Array.from(y.matchAll(/!\[.*?\]\((.*?)\)/g),e=>e[1]));var y;v.map(e=>`![](${e})`).join("\n");const b=(x=null==o?void 0:o.status,w=s,"error"===d||x===ig.ERROR?u.t("Code Interpreter executed failed"):w||x===ig.PAUSE?u.t("Code Interpreter has been stopped"):x===ig.TYPING?u.t("Code Interpreter is running"):u.t("Code Interpreter executed successfully"));var x,w;const S=[ig.TYPING,ig.FINISHED].includes(null==o?void 0:o.status);return tn.jsx("div",{children:tn.jsxs("div",{className:"code-interpreter",children:[tn.jsxs("div",{className:"image-reasoning-card",onClick:e=>{e.stopPropagation(),c(e=>!e)},children:[tn.jsx("div",{className:"image-reasoning-card-icon",children:tn.jsx(dt,{className:"iconfont",type:"icon-line-code-01",style:{color:S?"var(--character-brandprimary-text)":"var(--character-tertiary-text)"}})}),tn.jsx("div",{className:"image-reasoning-card-title "+((null==o?void 0:o.status)===ig.TYPING?"image-reasoning-card-title-animate":""),children:b}),tn.jsx("div",{className:"image-reasoning-card-open",children:l?tn.jsx(dt,{type:"icon-line-chevron-down",className:"iconfont"}):tn.jsx(dt,{type:"icon-line-chevron-right",className:"iconfont"})})]}),l&&tn.jsxs("div",{className:"image-reasoning-detail "+((null==o?void 0:o.status)===ig.TYPING?"content-typing":""),children:[tn.jsx(Le,{content:g,tokenProps:{code:{theme:r,headerActionsRender:p}}}),m&&jt(v)&&tn.jsxs(tn.Fragment,{children:[tn.jsx("div",{className:"image-reasoning-detail-status",children:null!=(i=null==u?void 0:u.t("Result"))?i:"Result"}),tn.jsx(Le,{content:m,tokenProps:{code:{theme:r,headerActionsRender:p}}})]})]})]})})});const kW=H.memo(e=>{var t,n;const{detail:i,status:a=aV.RESULT_STATE}=e,o=yE(e=>e.realTheme),s=G(),[r,l]=O.useState(!1),[c,u]=O.useState(!1),d=O.useRef(!1),h=O.useRef(!1),p=O.useRef(null),m=O.useRef(200),f=O.useRef(null),g=O.useCallback(e=>P(void 0,null,function*(){(yield C_(e))&&ut.openOnce({type:"success",content:s.t("Copying to clipboard was successful!")})}),[s]),v=O.useCallback(e=>tn.jsxs(tn.Fragment,{children:[tn.jsx(ft,{title:s.t("Copy"),children:tn.jsx("div",{className:"qwen-markdown-code-header-action-item",onClick:()=>g(e.text),children:tn.jsx(dt,{type:"icon-line-copy-right"})})}),tn.jsx(ft,{title:s.t("Download"),children:tn.jsx("div",{className:"qwen-markdown-code-header-action-item",onClick:()=>DG(e.text,"Qwen","python"),children:tn.jsx(dt,{type:"icon-line-download-02"})})}),r&&tn.jsx(ft,{title:s.t(c?"View Results":"Collapse Code"),children:tn.jsx("div",{className:"qwen-markdown-code-header-action-item",onClick:()=>{d.current=!c,h.current=!0,u(d.current)},children:tn.jsx(dt,{type:"icon-line-maximise"})})})]}),[s,c,r,g]),y=(null==(t=null==i?void 0:i.extra)?void 0:t.code_interpreter_info)||"",b=k_(null==(n=null==i?void 0:i.function_call)?void 0:n.arguments,{}),x=(e=>{var t;if(!e)return"";const n=e.match(/```[^\n]*\n([\s\S]+?)```/);if(n&&n[1])return`\`\`\`python\n${n[1]}\`\`\``;return`\`\`\`python\n${e}\n # Result ${(null==(t=null==i?void 0:i.extra)?void 0:t.code_interpreter_info)?i.extra.code_interpreter_info.replace(/```/g,""):""} \`\`\``})(null==b?void 0:b.code),w=(S=y,Array.from(S.matchAll(/!\[.*?\]\((.*?)\)/g),e=>e[1]));var S;const _=w.map(e=>`![](${e})`).join("\n"),C=O.useCallback(()=>{p.current&&setTimeout(()=>{if(p.current){const e=p.current.querySelectorAll(".qwen-markdown-code");if(e.length>0){const t=e[0];f.current=new ResizeObserver(()=>{t.getBoundingClientRect().height>m.current?(l(!0),d.current||h.current||u(!0)):l(!1)}),f.current.observe(t)}}},0)},[]);return O.useEffect(()=>{if(a===aV.RESULT_STATE)return requestAnimationFrame(()=>{C()}),()=>{f.current&&f.current.disconnect()}},[a,C]),tn.jsxs("div",{className:"code-interpreter code-interpreter-single",children:[tn.jsx("div",{className:`image-reasoning-detail image-reasoning-detail-single ${(null==i?void 0:i.status)===ig.TYPING&&a!==aV.RESULT_STATE?"content-typing":""} ${c?"image-reasoning-detail-collapse":""}`,ref:p,children:tn.jsx(Le,{content:x,tokenProps:{code:{theme:o,headerActionsRender:v}}})}),(null==w?void 0:w.length)>0&&tn.jsx(Le,{content:_,tokenProps:{image:{preview:{mask:null}},code:{theme:o}}})]})}),{Text:IW}=xe,TW="https://gw.alicdn.com/imgextra/i2/O1CN01Oh9Mj51reVGqbvq9Y_!!6000000005656-2-tps-40-40.png",jW=H.memo(e=>{const{search_results:t=[],getRectHandler:n=()=>{}}=e,i=O.useRef(null);return O.useEffect(()=>{i.current&&n(i.current)},[n]),t.length?tn.jsx("div",{className:"qwen-chat-search-image-card-group",children:t.map(({image_url:e,url:t,title:n})=>{const a=e||TW;return tn.jsxs("div",{ref:i,className:"qwen-chat-search-image-card",onClick:()=>{window.open(t)},children:[tn.jsx(Z,{justify:"center",align:"center",className:"qwen-chat-search-image-card-logo",children:tn.jsx(oG,{src:a,style:{borderRadius:"4px"},errorImage:TW})}),tn.jsx(IW,{ellipsis:!0,className:"qwen-chat-search-image-card-title",children:n})]},a)})}):null}),NW=()=>tn.jsx("div",{className:"web-search-skeleton",children:tn.jsx("div",{className:"web-search-skeleton-main",children:tn.jsxs("div",{className:"web-search-skeleton-main-content",children:[tn.jsx("div",{className:"web-search-skeleton-main-content-list-1 web-search-skeleton-main-content-list-bg"}),tn.jsx("div",{className:"web-search-skeleton-main-content-list-2 web-search-skeleton-main-content-list-bg"}),tn.jsx("div",{className:"web-search-skeleton-main-content-list-3 web-search-skeleton-main-content-list-bg"}),tn.jsx("div",{className:"web-search-skeleton-main-content-list-4 web-search-skeleton-main-content-list-bg"}),tn.jsx("div",{className:"web-search-skeleton-main-content-list-5 web-search-skeleton-main-content-list-bg"}),tn.jsx("div",{className:"web-search-skeleton-main-content-list-6 web-search-skeleton-main-content-list-bg"}),tn.jsx("div",{className:"web-search-skeleton-main-content-list-7 web-search-skeleton-main-content-list-bg"})]})})}),PW="https://img.alicdn.com/imgextra/i4/O1CN01XFV3QG1XsQyyaWqLS_!!6000000002979-55-tps-20-20.svg",MW="https://img.alicdn.com/imgextra/i3/O1CN01VEjCND1WAdUW23ZML_!!6000000002748-55-tps-20-20.svg",AW="https://img.alicdn.com/imgextra/i4/O1CN016bqlLa23NoCdx8Q06_!!6000000007244-55-tps-20-20.svg",RW="https://img.alicdn.com/imgextra/i2/O1CN01LKZmDT1eWB2u31TnV_!!6000000003878-55-tps-20-20.svg",OW="https://img.alicdn.com/imgextra/i3/O1CN01NEEWHV1nysPE7DHcJ_!!6000000005159-55-tps-20-20.svg",DW="https://img.alicdn.com/imgextra/i1/O1CN010tEY0e1uRcxnebwGz_!!6000000006034-55-tps-20-20.svg",LW="https://img.alicdn.com/imgextra/i2/O1CN01yMiryC1qg2yCYljWz_!!6000000005524-55-tps-20-20.svg",FW="https://img.alicdn.com/imgextra/i4/O1CN01QSVe5u1wUUfpRdhYZ_!!6000000006311-55-tps-20-20.svg";function UW(e){try{const t=new URL(e),n=t.pathname.split("/").pop(),i=null==n?void 0:n.split(".").pop();return i===n?"":null==i?void 0:i.toLowerCase()}catch(qY){return""}}const zW=(e,t,n)=>{if(n)return"File Source";if("vision"===t)return"Image Source";if("txt"===t)return"TXT Source";if("doc"===t){switch(UW(e)){case"pdf":return"PDF Source";case"doc":case"docx":default:return"File Source";case"xlsx":case"xls":return"EXCEL Source";case"md":return"MD Source"}}return"audio"===t?"Audio Source":"video"===t?"Video Source":void 0},HW=(e,t)=>{const n=UW(e);let i=e;if("vision"===t)return i=e,i;if(n)switch(t){case"audio":i=PW;break;case"video":i=MW;break;case"txt":i=RW;break;case"doc":i=(e=>{switch(UW(e)){case"pdf":return AW;case"doc":case"docx":return FW;case"xlsx":case"xls":return DW;case"md":return LW;default:return OW}})(e);break;default:i=OW}return i},$W=e=>{var t=e,{src:n,alt:i,size:a,fallbackComponent:o,loadingComponent:s}=t,r=E(t,["src","alt","size","fallbackComponent","loadingComponent"]);const[l,c]=O.useState(!1),[u,d]=O.useState(!0);return l?o:tn.jsxs(tn.Fragment,{children:[u&&s,tn.jsx("img",_({width:a,height:a,src:n,alt:i,onLoad:()=>{d(!1)},onError:()=>{d(!1),c(!0)},style:{display:u?"none":"block"}},r))]})},BW=O.memo(e=>{const{isLoading:t,listData:n,citationIndex:i,webSourceOption:a}=e,{headerTitle:o="",noSourceText:s="",showHeader:r=!0,id:l="",style:c={},highlightClassName:u,theme:d,onClickItem:h=()=>{},onClose:p}=a,m=O.useRef(null),f=O.useRef(null),g=O.useRef(null),v=O.useRef(null),y=tx(e=>e.mobile),[b,x]=O.useState(!1),{i18n:w}=G(),S=O.useCallback(e=>{const t=document.getElementById(`${e}-content`);if(t)if(void 0!==d)t.style.backgroundColor="";else{const e=u||"sources-item-highlight-bg";t.classList.remove(e)}},[d,u]),_=O.useCallback(e=>{v.current&&v.current!==e&&(S(v.current),f.current&&(clearTimeout(f.current),f.current=null));const t=document.getElementById(e);if(t){t.scrollIntoView({behavior:"smooth"});const n=document.getElementById(`${e}-content`);if(n){if(void 0!==d)n.style.backgroundColor="dark"===d?"#21204A":"#F3F2FF",f.current&&clearTimeout(f.current),f.current=setTimeout(function(){n.style.backgroundColor="",v.current=null},2e3);else{const e=u||"sources-item-highlight-bg";n.classList.add(e),f.current&&clearTimeout(f.current),f.current=setTimeout(function(){n.classList.remove(e),v.current=null},2e3)}v.current=e}}},[d,u,S]),C=O.useCallback(e=>{try{return decodeURIComponent(e)}catch(qY){return e}},[]),E=O.useMemo(()=>t&&!y?tn.jsx(NW,{}):null,[t,y]),k=O.useMemo(()=>{if(r)return tn.jsxs("div",{className:"content-header",children:[tn.jsxs("div",{className:"content-title",children:[!y&&tn.jsx(dt,{type:"icon-line-globe-01",className:"title-icon"}),o]}),tn.jsx("div",{className:"content-close",onClick:p,children:tn.jsx(dt,{type:""+(y?"icon-close":"icon-line-x-02"),className:"close-icon"})})]})},[y,r,o,p]),I=O.useMemo(()=>0!==(null==n?void 0:n.length)&&(null==n?void 0:n.length)?null:tn.jsx("div",{className:"no-sources-wrap",children:tn.jsx("span",{className:"no-sources text-center",children:s})}),[s,null==n?void 0:n.length]),T=O.useMemo(()=>tn.jsxs("div",{className:"content-list",children:[y?tn.jsxs(Z,{align:"center",gap:4,className:"web-search-origins-header",children:[tn.jsx("div",{children:w.t("Search Sources")}),tn.jsx("div",{className:"web-search-origins-header-point"}),tn.jsx("div",{className:"web-search-origins-header-count",children:(null==n?void 0:n.length)||0})]}):null,null==n?void 0:n.map((e,t)=>tn.jsxs(H.Fragment,{children:[t>0&&!y&&tn.jsx("div",{className:"content-list-divider"}),tn.jsx("div",{className:"sources-item-wrap",id:`${l}-${t+1}`,onClick:()=>{h(e)},children:tn.jsx("div",{className:"sources-item content-list-item",id:`${l}-${t+1}-content`,children:tn.jsxs("div",{className:"content-list-item-box",children:[tn.jsx("div",{className:"content-list-item-title",children:e.fileType&&"web"!==e.fileType?tn.jsxs("span",{className:"host-name-text",children:[tn.jsxs("span",{children:[t+1,"."]}),tn.jsx("span",{className:"host-name-text host-name-text-deep-research",children:zW(e.url,e.fileType,b)})]}):tn.jsxs("span",{className:"sources-item-index",children:[tn.jsxs("span",{children:[t+1,"."]}),e.hostlogo&&tn.jsx($W,{size:12,src:e.hostlogo,alt:"",className:"imgIcon ml-1 w-3",loadingComponent:tn.jsx(dt,{className:"search-icon",type:"icon-line-globe-01"}),fallbackComponent:tn.jsx(dt,{className:"search-icon",type:"icon-line-globe-01"})}),!e.hostlogo&&tn.jsx(dt,{className:"search-icon",type:"icon-line-globe-01"}),tn.jsx("span",{className:"host-name-text",children:e.hostname?e.hostname:C(e.url)}),!y&&e.date&&tn.jsxs(tn.Fragment,{children:[tn.jsx("span",{className:"dot-separator",children:""}),tn.jsx("span",{className:"date-text",children:e.date.replace(/[()\s]/g,"").replace(/[-]/g,"/")})]})]})}),e.fileType&&"web"!==e.fileType&&tn.jsxs("div",{className:"deep-research-origins-item-file",children:[tn.jsxs("div",{className:"deep-research-origins-item-icon",children:[tn.jsx("img",{src:C(HW(e.url,e.fileType)),alt:"",onError:()=>{x(!0)}}),"vision"===e.fileType&&!b&&!y&&tn.jsx("div",{onClick:e=>{e.stopPropagation()},className:"deep-research-origins-item-img",style:{backgroundImage:`url(${e.url})`}})]}),tn.jsx("div",{className:"deep-research-origins-item-link",children:e.url})]}),e.title&&("web"===e.fileType||!e.fileType)&&tn.jsx("div",{className:"content-text content-item-des-title",children:e.title}),e.snippet&&("web"===e.fileType||!e.fileType)&&tn.jsx("div",{className:"snippet-text content-item-des",children:e.snippet}),y&&e.date&&tn.jsx("div",{className:"content-item-date",children:e.date.replace(/[()\s]/g,"").replace(/[-]/g,"/")})]})})})]},`${e.url}_${t}`))]}),[y,w,n,l,b,C,h]),j=O.useMemo(()=>t&&!y||!n?null:tn.jsxs(tn.Fragment,{children:[k,I,T]}),[t,n,y,k,I,T]);return O.useLayoutEffect(()=>{if(i&&l){const e={id:l,citationIndex:i},t=g.current;null===t||t.id!==e.id||t.citationIndex!==e.citationIndex?(clearTimeout(m.current),m.current=setTimeout(()=>{_(`${l}-${i}`)},500),g.current=e):t.id===e.id&&t.citationIndex===e.citationIndex&&(clearTimeout(m.current),m.current=setTimeout(()=>{_(`${l}-${i}`)},300),g.current=e)}}),O.useEffect(()=>()=>{clearTimeout(m.current)},[]),tn.jsxs("div",{className:"custom-web-search-origins",style:c,children:[E,j]})}),qW=H.memo(e=>{var t,n,i,a;const{searchMessageId:o,setUnfoldedHeight:s=()=>{}}=e,{i18n:r}=G(),l=Wb(e=>e.history),c=tx(e=>e.mobile),u=Zb(e=>e.currentActionMessageId),d=Zb(e=>e.setCurrentActionMessageId),h=yE(e=>e.isSharePage),p=Zb(e=>e.setLocateTheSearchSource),m=xx(),f=yE(e=>e.realTheme),g=Wb(e=>e.chatId),v=pT(e=>e.setMemoryNotification),y=yE(e=>e.setShowMemoryUpdatedModal),b=H.useRef(null),x=H.useRef(null),w=H.useRef(null),S=Wb(e=>e.setCurrentCitationInfo),C=yE(e=>e.setShowControls),E=Zb(e=>e.setCurrentShowControl),k=Wb(e=>e.allSearchAndThinkLists),{citationIndex:I}=Wb(e=>e.currentCitationInfo),T=O.useMemo(()=>u?l.messages[u]:null,[u,l.messages]),j=O.useMemo(()=>{var e,t;return mg((null==T?void 0:T.sub_chat_type)||(null==(t=null==(e=null==T?void 0:T.extra)?void 0:e.meta)?void 0:t.subChatType))},[null==(n=null==(t=null==T?void 0:T.extra)?void 0:t.meta)?void 0:n.subChatType,null==T?void 0:T.sub_chat_type]),N=O.useMemo(()=>null==T?void 0:T.is_stop,[null==T?void 0:T.is_stop]),M=O.useMemo(()=>{var e,t;if(j)return(null==(e=null==k?void 0:k[(null==T?void 0:T.id)||""])?void 0:e.webSearchInfo)||[];let n=[];return null==(t=null==T?void 0:T.content_list)||t.forEach(({phase:e,extra:t={}})=>{e===ng.WEB_SEARCH&&(n=[...n,...(null==t?void 0:t.web_search_info)||[]])}),n},[k,j,null==T?void 0:T.content_list,null==T?void 0:T.id]),A=O.useCallback(()=>{C(!1),E(tg.None),p(!1),d(""),S({messageId:"",citationIndex:0})},[d,S,E,p,C]);O.useEffect(()=>{var e;["Internal_Server_Error","data_inspection_failed"].includes((null==(e=null==T?void 0:T.error)?void 0:e.errorCode)||"")&&A()},[null==(i=null==T?void 0:T.error)?void 0:i.errorCode,A]);const R=O.useMemo(()=>{var e,t;return!!((null==(e=null==T?void 0:T.content_list)?void 0:e.some(({phase:e})=>e===ng.ANSWER))&&(null==T?void 0:T.content_list)&&(null==(t=null==T?void 0:T.content_list)?void 0:t.length)>1||(null==T?void 0:T.done))},[T]),D=O.useMemo(()=>{var e;return!!T&&(null==(e=T.content_list)?void 0:e.some(e=>[ng.WEB_SEARCH].includes(e.phase)))},[T]),L=O.useMemo(()=>{var e;return!!(null==(e=null==T?void 0:T.feature_config)?void 0:e.thinking_enabled)},[null==(a=null==T?void 0:T.feature_config)?void 0:a.thinking_enabled]),{openNativePopup:F}=RG({message:T}),U=O.useCallback(e=>P(void 0,null,function*(){(yield C_(e))&&ut.openOnce({type:"success",content:r.t("Copying to clipboard was successful!")})}),[r]),z=O.useCallback((e=0)=>{bx()?F({type:tg.WebSearch,currentTab:De.sources,citationIndex:e}):(C(!0),E(tg.WebSearch),S({messageId:(null==T?void 0:T.id)||"",citationIndex:e,tab:De.sources}))},[null==T?void 0:T.id,F,S,E,C]),$=O.useCallback((e,t="")=>{const n=new Date,i=`Qwen_${t}_${`${n.getFullYear()}${String(n.getMonth()+1).padStart(2,"0")}${String(n.getDate()).padStart(2,"0")}`}_${Math.random().toString(36).slice(-9)}${OG(t)}`;ax.saveAs(new Blob([e],{type:"text/plain;charset=utf-8"}),i)},[]),B=Aq({mediaType:"image",messageId:(null==T?void 0:T.id)||""}),q=O.useMemo(()=>({code:{headerActionsRender:e=>tn.jsxs(tn.Fragment,{children:[tn.jsx(we,{title:r.t("Copy"),children:tn.jsx("div",{className:"qwen-markdown-code-header-action-item",onClick:()=>U(e.text),children:tn.jsx(dt,{type:"icon-line-copy-right"})})}),!c&&tn.jsx(we,{title:r.t("Download"),children:tn.jsx("div",{className:"qwen-markdown-code-header-action-item",onClick:()=>$(e.text,e.lang),children:tn.jsx(dt,{type:"icon-line-download-02"})})})]}),theme:f},codespan:{onClick:e=>P(void 0,[e],function*({text:e}){(yield C_(e))&&ut.openOnce({type:"success",content:r.t("Copying to clipboard was successful!")})})},image:_({defaultWidth:1,defaultHeight:1,sizeScope:c?{width:[114,300],height:[126,380]}:[400,448],onError:()=>({errorMessage:r.t("Image Load Error")})},B),table:{headerActionsRender:fx()?void 0:e=>tn.jsx(tn.Fragment,{children:tn.jsx(yt,{placement:"bottomRight",menu:{items:[{key:"csv",label:tn.jsx("div",{className:"qwen-markdown-table-header-export-item",onClick:()=>{const t=`table-${(null==T?void 0:T.id)||""}.csv`;T_(e,t)},children:r.t("Export to CSV")})},{key:"excel",label:tn.jsx("div",{className:"qwen-markdown-table-header-export-item",onClick:()=>{const t=`table-${(null==T?void 0:T.id)||""}.xlsx`;j_(e,t)},children:r.t("Export to Excel")})}]},getPopupContainer:e=>e||document.body,children:tn.jsx("div",{className:"qwen-markdown-table-header-action-item",children:tn.jsx(dt,{type:"icon-line-download-02"})})})})},citation:{contentRender:e=>{const t=e.map(e=>{if(!Array.isArray(M)||!M.length)return null;const t=M[Number(e)-1];if(!t)return null;const{snippet:n,icon:i,title:a,url:o,hostname:s}=t;return{description:n,icon:i,title:a,url:o,hostIndex:e,hostname:s}}).filter(e=>e);return c?t.map(e=>tn.jsx("div",{className:"qwen-markdown-citation-item",children:tn.jsx(LG,{hostList:[e],onHostNameClick:()=>{z(Number(null==e?void 0:e.hostIndex)||0)}})},null==e?void 0:e.url)):t.length?tn.jsx(LG,{hostList:t,onClick:e=>window.open(e)}):null}}}),[f,c,B,r,U,$,null==T?void 0:T.id,M,z]),{chatStatusTitle:V}=lV(T),W=O.useMemo(()=>{if(!Array.isArray(null==T?void 0:T.content_list)||!T.content_list.length)return null;const e=[...T.content_list,{content:"",phase:ng.FINISHED,status:ig.FINISHED,role:"assistant"}],t=e.every(e=>e.status===ig.FINISHED);return tn.jsx(tn.Fragment,{children:e.map((e,n)=>{var i,a,o,s,l,c,d,p;const m=`${u}_${n}`,f=e.status;switch(e.phase){case ng.THINKING_SUMMARY:{const t=e.extra,n=(null==(i=null==t?void 0:t.summary_thought)?void 0:i.content)||[],o=(null==(a=null==t?void 0:t.summary_title)?void 0:a.content)||[];return tn.jsx(tn.Fragment,{children:Array.isArray(o)&&o.length?o.map((e,t)=>tn.jsx(EW,{id:m,type:iV.THINKING_AND_ANALYSING,status:aV.RESULT_STATE,customTitle:e,children:tn.jsx(Le,{content:n[t]||"",loose:!["ja-JP","ko-KR","zh-CN","zh-TW"].includes(r.language),tokenProps:q})},`${m}_${t}`)):null})}case ng.THINK:{const t=e.content;return tn.jsx(EW,{type:iV.THINKING,status:"finished"===f||N?aV.RESULT_STATE:aV.PROCESS_STATE,id:m,children:tn.jsx("div",{className:"qwen-chat-thinking-and-sources-summary",children:tn.jsx(Le,{content:t||"",loose:!["ja-JP","ko-KR","zh-CN","zh-TW"].includes(r.language),tokenProps:q})})},m)}case ng.WEB_SEARCH:{const t=(null==(o=e.extra)?void 0:o.web_search_info)||[];return tn.jsx(EW,{type:iV.SEARCHING_WEB_PAGES,status:"finished"===f||N?aV.RESULT_STATE:aV.PROCESS_STATE,id:m,children:tn.jsx(_W,{sources:t})},m)}case ng.IMAGE_ZOOM_IN_TOOL:return tn.jsx(SV,{detail:e,message:T,isStop:T.is_stop,id:m},m);case ng.WEB_EXTRACTOR:{const t=Array.isArray(null==(s=null==e?void 0:e.extra)?void 0:s.web_extract_info)?null==(l=null==e?void 0:e.extra)?void 0:l.web_extract_info:[];return tn.jsx(EW,{type:iV.READING_SOURCES,status:"finished"===f||N?aV.RESULT_STATE:aV.PROCESS_STATE,id:m,children:tn.jsx(Z,{wrap:"wrap",gap:8,align:"flex-start",children:t.map(({url:e})=>tn.jsx(SW,{url:e,onClick:()=>{window.open(e)}},e))})},m)}case ng.WEB_SEARCH_IMAGE:case ng.IMAGE_SEARCH:return tn.jsx(EW,{type:iV.IMAGE_SEARCH,status:"finished"===f||N?aV.RESULT_STATE:aV.PROCESS_STATE,id:m,children:tn.jsx(jW,{search_results:null==(c=null==e?void 0:e.extra)?void 0:c.search_result})},m);case ng.HISTORY_RETRIEVER:return tn.jsx(EW,{type:iV.SEARCHING_MEMORIES,status:"finished"===f||N?aV.RESULT_STATE:aV.PROCESS_STATE,id:m,children:"finished"===f?tn.jsx("div",{className:"qwen-chat-thinking-and-sources-summary",children:r.t("Search completed.")}):null},m);case ng.BIO:{const t=(null==(p=null==(d=null==e?void 0:e.extra)?void 0:d.tool_result)?void 0:p.memory_operation_result)||{},{updated_memories:n=[],new_memories:i=[],cleared_memories:a=[]}=t,o=[...n,...i],s=[...o,...a];v({notification_id:(null==e?void 0:e.function_id)||"",type:"functionCallType",detail:_({chat_id:g},t)});const l="finished"===f||N,c=!(!l||!s.length||h);return tn.jsx(EW,{type:iV.UPDATING_MEMORIES,status:l?aV.RESULT_STATE:aV.PROCESS_STATE,controlConfig:{visibly:c,label:r.t("View"),onClick:()=>{y(!0)}},id:m,children:tn.jsxs(Z,{vertical:!0,gap:8,className:"qwen-chat-thinking-and-sources-summary",children:[a.map(({content:e})=>tn.jsxs(Z,{gap:8,className:"qwen-chat-thinking-and-sources-summary-line-through",children:[tn.jsx("div",{className:"qwen-chat-thinking-and-sources-summary-point "}),tn.jsx("div",{className:"qwen-chat-thinking-and-sources-summary-text",children:e})]},e)),o.map(({content:e})=>tn.jsxs(Z,{gap:8,children:[tn.jsx("div",{className:"qwen-chat-thinking-and-sources-summary-point"}),tn.jsx("div",{className:"qwen-chat-thinking-and-sources-summary-text",children:e})]},e))]})},m)}case ng.CODE_INTERPRETER:{const t="finished"===f||N||(null==T?void 0:T.is_stop_in_thinking);return tn.jsx(EW,{type:iV.CALLING_CODE_INTERPRETER,status:t?aV.RESULT_STATE:aV.PROCESS_STATE,id:m,children:tn.jsx(kW,{status:t?aV.RESULT_STATE:aV.PROCESS_STATE,detail:e})},m)}case ng.FINISHED:return t?tn.jsx("div",{style:{marginBottom:24},children:tn.jsx(EW,{type:iV.THINKING,status:aV.RESULT_STATE,hiddenContent:!0,customTitle:V,customIcon:"icon-line-lightbulb-031",id:`${u}_finished`})}):null;default:return null}})})},[T,N,V,u,r,q,v,g,h,y,L]),Q=O.useMemo(()=>c?null:(R||N)&&(D||M.length)?tn.jsx("div",{ref:x,children:tn.jsxs("div",{children:[tn.jsxs(Z,{align:"center",gap:4,className:"qwen-chat-web-search-origins-header",children:[tn.jsx("div",{children:r.t("Search Sources")}),tn.jsx("div",{className:"qwen-chat-web-search-origins-header-point"}),tn.jsx("div",{className:"qwen-chat-web-search-origins-header-count",children:(null==M?void 0:M.length)||0})]}),tn.jsx(BW,{citationIndex:I,listData:M||[],webSourceOption:{id:o,noSourceText:r.t("no sources"),showHeader:!1,style:{width:m?"100%":340},onClickItem:e=>wC(e.url,e.fileType),theme:f}})]})}):null,[r,c,f,M,R,N,D,I,o,m]);return T?tn.jsxs(Z,{vertical:!0,className:J("qwen-chat-thinking-and-sources",{"qwen-chat-thinking-and-sources-share":h}),children:[tn.jsx(Z,{align:"center",justify:c?"flex-end":"center",className:"qwen-chat-thinking-and-sources-header",children:tn.jsx(dt,{type:c?"icon-line-x-01":"icon-line-x-03",onClick:A})}),tn.jsxs("div",{className:"qwen-chat-thinking-and-sources-content",onTouchMove:()=>{s(!0)},ref:w,onScroll:()=>{s(!0)},children:[tn.jsx("div",{ref:b,className:"qwen-chat-thinking-and-sources-content-thinking-container",children:W}),Q]})]}):null}),GW=({onClose:e,onDownload:t,fileName:n,info:i})=>{var a,o,s,r,l;const{i18n:c}=G(),u=yE(e=>e.isSharePage),d=Wb(e=>e.branchInfo),h=Zb(e=>e.taskRunning),p=tx(e=>e.mobile),m=tx(e=>e.config),[f,g]=O.useState(!1),v=O.useRef(null),y=yE(e=>e.setShowH5PodcastDetail),[b,x]=O.useState(!1),w=Zb(e=>e.deepResearchVersion),S=Zb(e=>e.pdfCardType),{qDeepResearchAipodcast:_,checkEquityPassByEquity:C}=HN(),E=Zb(e=>e.podcastCount),k=Zb(e=>e.visionGenerating),I=Zb(e=>e.temporaryChatEnabled),T=cT(e=>e.settings),j=Wb(e=>e.history),N=rT(e=>e.setFiles),M=O.useMemo(()=>{var e;return(null==(e=null==T?void 0:T.aipodcast)?void 0:e.host)||hg},[null==(a=null==T?void 0:T.aipodcast)?void 0:a.host]),A=O.useMemo(()=>{var e;return(null==(e=null==T?void 0:T.aipodcast)?void 0:e.guest)||hg},[null==(o=null==T?void 0:T.aipodcast)?void 0:o.guest]),R=h||k,D=!!(null==(r=null==(s=j.messages)?void 0:s[(null==i?void 0:i.messageId)||""])?void 0:r.isShare);O.useEffect(()=>{const e=e=>{const t=e.target;!v.current||v.current.contains(t)||t.closest(".pdf-header-menu-box")||g(!1)};return f&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[f]);const L=O.useMemo(()=>[Zf.DeepResearch,Zf.INTERRUPT].includes(S),[S]),F=O.useMemo(()=>S===Zf.TRAVEL_RESEARCH||S===Zf.Travel,[S]),U=O.useMemo(()=>!u&&"v4"===w,[w,u]),z=O.useMemo(()=>!u&&L,[u,L]),H=Zb(e=>e.currentDPLanguageCode),$=O.useMemo(()=>H||c.language||Yb.en,[H,c]),B=O.useCallback(e=>{t&&t(e||Ce.pdf,i||{})},[t,i]),q=O.useMemo(()=>({icon:tn.jsx(dt,{type:"icon-line-file-01",style:{fontSize:24}}),key:Ce.pdf,label:tn.jsx("span",{className:"text",children:c.t("Download PDF")})}),[c]),V=O.useMemo(()=>({icon:tn.jsx(dt,{type:"icon-line-markdown",style:{fontSize:24}}),key:Ce.md,label:tn.jsx("span",{className:"text",children:c.t("Download Markdown")})}),[c]),W=O.useMemo(()=>({icon:tn.jsx(dt,{type:"icon-line-image",style:{fontSize:20,paddingLeft:2}}),key:Ce.image,label:tn.jsx("span",{className:"text",children:c.t("Download Long Image")})}),[c]),Q=O.useMemo(()=>{if(p){const e=[q];return F&&e.push(W),e}return L?[V,q]:F?[q,W]:[q]},[L,V,W,q,F,p]),K=O.useMemo(()=>{var e;return!u&&!bT()&&(null==(e=null==m?void 0:m.function_entry)?void 0:e.community)&&!(null==d?void 0:d.isTemp)&&!I},[u,null==(l=null==m?void 0:m.function_entry)?void 0:l.community,null==d?void 0:d.isTemp,I]),[Y,X]=O.useState(!1);return p?tn.jsxs("div",{className:"mb-pdf-container-header",children:[tn.jsx("div",{className:"mb-pdf-viewer-header-title",children:n}),tn.jsxs("div",{className:"mb-pdf-viewer-header-actions",children:[tn.jsx("div",{className:"mb-pdf-viewer-header-actions-close",ref:v,children:tn.jsx(yt,{menu:[],open:f,onOpenChange:g,popupRender:()=>{const e=null===(null==_?void 0:_.remains)||0===(null==_?void 0:_.remains),t=R||E>=5||D,n=R||D;return tn.jsxs("div",{className:"pdf-header-menu-box",children:[(U||z)&&tn.jsx("div",{className:"menu-item",children:tn.jsx("span",{className:"text",children:c.t("Create")})}),U&&tn.jsxs("div",{className:J("menu-item enable-click",{"disable-click-item":n}),onClick:()=>{n||(oT.closeShowControls(),g(!1),Zb.getState().setThinkingEnabled(!1),Wb.getState().setEmitSendPromptType(Qf.CHAT),bx()?oT.adapter.invoke({method:"postContentToMainChat",params:{content:c.t("Generate a web page preview"),name:Zf.DeepResearchWebDev}}):(oT.closeShowControls(),oT.beforeSendMessage({inputText:c.t("Generate a web page preview"),chatType:Zf.DeepResearch,subChatType:Zf.DeepResearchWebDev})))},children:[tn.jsx("span",{className:"text",children:c.t("Web Dev")}),tn.jsx(dt,{type:"icon-Cube",style:{fontSize:"1.25rem",lineHeight:"1.75rem",fontWeight:"400"}})]}),z&&tn.jsxs("div",{className:J("menu-item enable-click",{"disable-click-item":e||t}),onClick:()=>{C(_)&&(D||(t?oT.toast({content:"Youve reached the limit for podcast requests."}):(oT.closeShowControls(),g(!1),bx()?oT.adapter.invoke({method:"openPodcastWindow",params:{content:{host:M,guest:A},languageCode:$}}):y(!0),oT.closeShowControls())))},children:[tn.jsx("span",{className:"text",children:c.t("Podcast")}),tn.jsx(dt,{type:"icon-line-Podcast",style:{fontSize:"1.25rem",lineHeight:"1.75rem",fontWeight:"400"}})]}),(U||z)&&tn.jsx("div",{className:"menu-item",children:tn.jsx("span",{className:"text",children:c.t("Download")})}),tn.jsxs("div",{className:"menu-item enable-click",onClick:()=>{B(Ce.pdf),g(!1)},children:[tn.jsx("span",{className:"text",children:c.t("PDF")}),tn.jsx(dt,{type:"icon-line-file-01",style:{fontSize:"1.25rem",lineHeight:"1.75rem",fontWeight:"400"}})]}),F&&tn.jsxs("div",{className:"menu-item enable-click",onClick:()=>{B(Ce.image),g(!1)},children:[tn.jsx("span",{className:"text",children:c.t("Download Long Image")}),tn.jsx(dt,{type:"icon-line-image",style:{fontSize:"1rem",paddingRight:"0.12rem",lineHeight:"1.75rem",fontWeight:"400"}})]})]})},trigger:["click"],children:tn.jsx(dt,{type:"icon-line-more-01",style:{fontSize:"1.25rem",lineHeight:"1.75rem"}})})}),tn.jsx("div",{className:"mb-pdf-viewer-header-actions-close",onClick:e,children:tn.jsx(dt,{type:"icon-close1",className:"close-icon"})})]})]}):tn.jsxs("div",{className:"pc-pdf-viewer-header",children:[tn.jsx(Mq,{open:b,onCancel:()=>x(!1),messageId:(null==i?void 0:i.messageId)||""}),tn.jsxs("div",{className:"pc-pdf-viewer-header-title",children:[tn.jsx(dt,{type:"icon-line-file-01",className:"pc-pdf-viewer-icon"}),tn.jsx("div",{className:"pc-pdf-viewer-header-title-text",children:n})]}),tn.jsxs("div",{className:"pc-pdf-viewer-header-actions",children:[!u&&L&&!D&&tn.jsx(ZG,{className:"pdf-header-button"}),tn.jsx(ae,{arrow:!1,trigger:"click",classNames:{root:"pc-pdf-viewer-more-popover pc-pdf-viewer-more-popover-padding"},onOpenChange:e=>{e&&X(!1)},content:tn.jsx("div",{className:"pc-pdf-viewer-more-content",children:Y?tn.jsx(tn.Fragment,{children:Q.map(({icon:e,key:t,label:n})=>tn.jsxs("div",{className:"pc-pdf-viewer-more-content-item",onClick:()=>B(t),children:[e,n]},t))}):tn.jsxs(tn.Fragment,{children:[tn.jsxs(Z,{className:"pc-pdf-viewer-more-content-item",align:"center",justify:"space-between",onClick:()=>X(!0),children:[tn.jsxs(Z,{align:"center",gap:8,children:[tn.jsx(dt,{className:"pc-pdf-viewer-more-content-item-icon",type:"icon-line-download-02"}),c.t("Download")]}),tn.jsx(dt,{type:"icon-MessageTipArrow",className:"pc-pdf-viewer-expand-download"})]}),K?tn.jsxs(tn.Fragment,{children:[tn.jsxs("div",{onClick:()=>{D||x(!0)},className:J("pc-pdf-viewer-more-content-item",{"pc-pdf-viewer-more-content-item-disabled":D}),children:[tn.jsx(dt,{className:"pc-pdf-viewer-more-content-item-icon",type:"icon-line-Publish"}),c.t("Publish to community")]}),tn.jsxs("div",{onClick:()=>{D||P(void 0,null,function*(){var e,t;const n=[{type:"file",name:null==(e=null==i?void 0:i.pdf)?void 0:e.name,file_type:"application/pdf",showType:"file",file_class:"document",status:"uploaded",url:null==(t=null==i?void 0:i.pdf)?void 0:t.link,isQuote:!0}];N(n)})},className:"pc-pdf-viewer-more-content-item",children:[tn.jsx(dt,{className:"pc-pdf-viewer-more-content-item-icon",type:"icon-line-arrow-curve-left-right"}),c.t("Quote")]})]}):null]})}),children:tn.jsx("div",{className:"pc-pdf-viewer-more-icon",children:tn.jsx(dt,{type:"icon-line-more-01"})})}),tn.jsx("div",{onClick:e,children:tn.jsx(dt,{type:"icon-close1",className:"pc-pdf-viewer-icon"})})]})]})},VW=O.memo(e=>{var t;const{showControlsType:n,setUnfoldedHeight:i}=e,a=G(),o=xx(),s=tx(e=>e.mobile),r=Zb(e=>e.taskRunning),l=Zb(e=>e.pdfViewInfo),c=Zb(e=>e.websearchLoading),u=Wb(e=>e.history),{messageId:d,citationIndex:h,tab:p}=Wb(e=>e.currentCitationInfo),m=rT(e=>e.messageType),f=Wb(e=>e.allSearchAndThinkLists),g=Wb(e=>e.temporarySource),v=Wb(e=>e.currentSearchSource),y=Wb(e=>e.currentSearchLists),b=yE(e=>e.showControls),x=yE(e=>e.theme),w=Wb(e=>e.currentArtifactsMessage),S=yE(e=>e.realTheme),C=Wb(e=>e.imageReasonData),E=Zb(e=>e.currentControlsId),k=(Zb(e=>e.currentSlidesInfo),O.useMemo(()=>{const e=u.messages[d];return(null==e?void 0:e.error)?Ze.Error:(null==e?void 0:e.done)&&!(null==e?void 0:e.is_stop)?Ze.Finish:!r||(null==e?void 0:e.is_stop)?Ze.Stop:Ze.Running},[u.messages,d,r])),I=O.useMemo(()=>{var e;const t=null==(e=f[d])?void 0:e.webSearchInfo;if(b){if([tg.WebSearch,tg.ThinkingAndSearch,tg.ThinkingAndSources].includes(n))return g[d]||t||v[d]||[];if(v.type===tg.DeepResearch||v.type===tg.DeepResearchLinkSource)return tt((null==v?void 0:v[d])||[],z_)}return g[d]||v[d]||[]},[f,v,d,b,n,g]),T=O.useMemo(()=>{var e;return n===tg.DeepResearchLinkSource||n===tg.DeepResearch||n===tg.DeepResearchDetail?y[d]||[]:(n===tg.ThinkingAndSearch||n===tg.Thinking)&&((null==(e=f[d])?void 0:e.contentList)||v[d])||[]},[f,v,d,n,y]),j=O.useMemo(()=>null==l?void 0:l[E],[E,l]),N=O.useMemo(()=>{const e=u.messages[E];return Ak(e)},[E,u.messages]),P=e=>{Array.isArray(e)||window.open(e.url)};switch(n){case tg.WebSearch:return tn.jsx(BW,{isLoading:c,citationIndex:h,listData:I,webSourceOption:{id:d,noSourceText:a.t("no sources"),headerTitle:a.t("Sources"),style:{width:o?"100%":340},onClickItem:e=>wC(e.url,e.fileType),onClose:()=>oT.closeShowControls(),theme:S}});case tg.DeepResearch:return tn.jsx(at,{isLoading:c,citationIndex:h,listData:I,webSourceOption:{id:d,noSourceText:a.t("no sources"),headerTitle:a.t("Search Source  {{Number}}",{Number:null==I?void 0:I.length}),style:{width:o?"100%":340},onClickItem:e=>wC(e.url,e.fileType),onClose:()=>oT.closeShowControls(),theme:S,triggerTimestamp:Date.now()}});case tg.ThinkingAndSearch:case tg.DeepResearchLinkSource:case tg.Thinking:{let e=n===tg.DeepResearchLinkSource?[{text:a.t("Research"),key:De.step},{text:a.t("Sources"),key:De.sources}]:[{text:a.t("Details"),key:De.step},{text:a.t("Sources"),key:De.sources}];return n===tg.Thinking&&(e=[{text:a.t("Details"),key:De.step}]),m===Zf.Travel&&(e=[{text:a.t("Travel Research"),key:De.step}]),tn.jsx(it,{citationIndex:h,currentTab:p,cardStatus:k,isCurrent:s&&n===tg.DeepResearchLinkSource,sourceList:I,stepList:T,onLinkCard:P,tabs:e,webSourceOption:{headerTitle:a.t("Sources"),noSourceText:a.t("no sources"),id:d,onClickItem:e=>wC(e.url,e.fileType),theme:x},onClose:()=>oT.closeShowControls(),customPlugings:{code_interpreter:e=>tn.jsx(mW,{detail:e,cardStatus:k})}})}case tg.Artifacts:return tn.jsx(cW,{message:w});case tg.PdfViewer:return tn.jsx(nt,{info:j,header:tn.jsx(GW,{onClose:()=>oT.closeShowControls(),fileName:(null==(t=null==j?void 0:j.pdf)?void 0:t.name)||"",onDownload:ik,info:j}),loadingText:`PDF ${a.t("Loading...")}`,onClose:()=>oT.closeShowControls(),errorInfo:{title:a.t("PDF preview failed"),content:a.t("Preview failed due to version compatibility issues. You can switch to a browser for preview.")}});case tg.ImageReason:return tn.jsx(uW,_({},C));case tg.DeepResearchDetail:return tn.jsx(dW,{cardStatus:k,stepList:T});case tg.ThinkingAndSources:return tn.jsx(qW,{searchMessageId:d,setUnfoldedHeight:i});case tg.Slides:return tn.jsx(xW,{info:N});default:return null}}),WW=O.memo(e=>{const{open:t,showControlsType:n}=e,i=`calc(${window.innerHeight}px - ${Cx()} - ${Ex()} - 48px)`,[a,o]=O.useState(!1),s=yE(e=>e.setShowControls),r=Zb(e=>e.setCurrentShowControl),l=Zb(e=>e.setCurrentActionMessageId),c=Zb(e=>e.setLocateTheSearchSource);O.useEffect(()=>{o(n!==tg.ThinkingAndSources)},[n]);const u=O.useCallback(()=>{s(!1),r(tg.None),c(!1),l("")},[l,r,c,s]);return tn.jsx(le,{placement:"bottom",height:a?i:488,open:!t,onClose:()=>{n===tg.ThinkingAndSources&&u()},drawerRender:()=>tn.jsx("div",{className:"chat-mobile-drawer",style:{maxHeight:a?i:488},children:tn.jsx(VW,{showControlsType:n,setUnfoldedHeight:o})})})}),QW=({closeModal:e})=>{const{t:t,i18n:n}=G(),i=Zb(e=>e.taskRunning),[a,o]=O.useState(""),s=yE(e=>e.setShowH5PodcastDetail),[r,l]=O.useState(!1),{hostMenu:c,guestMenu:u,guestItem:d,hostItem:h,Audio:p,audioWaiting:m,audioPlaying:f,updateSetting:g,setHostItem:v,setGuestItem:y,stopCurrentAudio:b,setActiveItemValue:x}=XG({id:"mobile-pdf-tts-audio"}),w=O.useMemo(()=>"host"===a?null==h?void 0:h.label:null==d?void 0:d.label,[a,d,h]),S=O.useMemo(()=>"host"===a?c:u,[a,c,u]);return O.useEffect(()=>()=>{null==b||b()},[]),tn.jsxs(tn.Fragment,{children:[p,tn.jsxs("div",{className:"timbre-select-modal-content",children:[tn.jsxs("div",{className:"timbre-select-modal-content-title",children:[tn.jsx("span",{className:"content-title-text",children:t("Select the voice")}),tn.jsx("div",{className:"content-title-close-button",onClick:()=>e(),children:tn.jsx(dt,{type:"icon-close-4",className:"icon-close-button"})})]}),tn.jsx("div",{className:"timbre-select-modal-content-list",children:tn.jsxs("div",{className:"podcast-detail-content",children:[tn.jsxs("div",{className:"podcast-detail-content-item",children:[tn.jsx("div",{className:"podcast-detail-content-item-title",children:t("Host")}),tn.jsxs("button",{className:"podcast-selector-button",onClick:()=>{o("host"),l(!0),x(h)},children:[null==h?void 0:h.label,tn.jsx(dt,{type:"icon-line-chevron-down"})]})]}),tn.jsxs("div",{className:"podcast-detail-content-item",children:[tn.jsx("div",{className:"podcast-detail-content-item-title",children:t("Guest")}),tn.jsxs("button",{className:"podcast-selector-button",onClick:()=>{o("guest"),l(!0),x(d)},children:[null==d?void 0:d.label,tn.jsx(dt,{type:"icon-line-chevron-down"})]})]})]})}),tn.jsx("div",{className:"timbre-select-modal-content-footer",children:tn.jsx("button",{className:"create-podcast-button",onClick:()=>P(void 0,null,function*(){i||(s(!1),bT()||(yield g()),Zb.getState().setThinkingEnabled(!1),Wb.getState().setEmitSendPromptType(Qf.CHAT),oT.beforeSendMessage({inputText:n.t("Create a podcast"),chatType:Zf.DeepResearch,subChatType:Zf.Podcast}))}),children:t("Create a podcast")})})]}),tn.jsx(mt,{title:t("Select the voice"),open:r,heightType:"auto",className:"timbre-detail-modal",onClose:()=>{b(),l(!1)},children:tn.jsx("div",{className:"timbre-detail-modal-content",children:tn.jsx("div",{className:"timbre-detail-modal-content-list",children:S.map(e=>tn.jsxs("div",{className:"timbre-detail-modal-content-list-item",onClick:()=>{"host"===a?v(e):y(e),x(e)},children:[tn.jsxs("div",{className:"item-left",children:[tn.jsx("div",{className:"list-item-title",children:e.label}),tn.jsx("div",{className:"list-item-description",children:e.description})]}),tn.jsxs("div",{className:"item-right",children:[tn.jsx("img",{src:Xb(m,g$()),alt:"speaking",className:J("item-right-icon",{"item-right-icon-hidden":!(e.label===w&&(f||m))})}),e.label===w?tn.jsx(dt,{type:"icon-fill-check-03",className:"icon-fill-check-03 item-right-icon"}):null]})]},e.value))})})})]})},KW=({chatId:e})=>{const t=bx(),n=xx(),i=new URLSearchParams(window.location.search).get("shareId"),a=O.useRef(null),o=G(),[s,r]=O.useState(!0),l=tx(e=>e.mobile),c=Zb(e=>e.currentShowControl),u=Wb(e=>e.chatLoaded),d=Wb(e=>e.history.currentId),h=Wb(e=>e.isChat);Wb(e=>e.currentInputFeature);const p=O.useRef(null),m=Wb(e=>e.history.messages),f=yE(e=>e.setShowHeaderBorder),g=yE(e=>e.showHeaderBorder),v=t||n,[y,b]=O.useState(!1),x=O.useRef(s),w=O.useRef(0),S=yE(e=>e.setShowH5PodcastDetail),C=yE(e=>e.showH5PodcastDetail),E=O.useRef(null),k=O.useMemo(()=>l?c:tg.None,[c,l]),I=O.useMemo(()=>k===tg.None,[k]),T=O.useCallback(e=>{bx()&&oT.adapter.invoke({method:"setSendButtonEnabled",params:{value:e}})},[]),j=Object.keys(m).length>0,N=O.useMemo(()=>null==m?void 0:m[d||""],[m,d]),P=O.useCallback(e=>{x.current=e,r(e)},[]),M=O.useMemo(()=>!!(N&&"error"in N&&N.error),[N]),A=O.useCallback(e=>{a.current&&a.current.scrollTo(_({top:a.current.scrollHeight},e))},[]),R=O.useCallback(e=>{a.current&&a.current.scrollTo(_({top:0},e))},[]),D=O.useCallback(()=>{P(!0),A({behavior:"smooth"})},[A,P]),L=O.useCallback(()=>{P(!0),R({behavior:"smooth"})},[R,P]),F=()=>{if(a.current){const{scrollTop:e,clientHeight:t,scrollHeight:n}=a.current;return n-e-t<100}return!1},U=O.useCallback(()=>{if(a.current){const{clientHeight:e,scrollHeight:t}=a.current;return Math.abs(t-e)>0}},[]),z=()=>{if(!a.current||!U())return;const{scrollTop:e,scrollHeight:t,clientHeight:n}=a.current;if(!g&&e>45?f(!0):g&&e<=45&&f(!1),e+n>t)return;w.current+n>t&&(w.current=e);e<w.current?P(!1):F()&&P(!0),w.current=e},H=O.useMemo(()=>{var e;return t?!!i:!!(null==(e=oT.shareHistory)?void 0:e.currentId)},[t,i]);return O.useEffect(()=>{h&&b(!1)},[h]),O.useEffect(()=>{const e=()=>{a.current&&!h&&b(!0);p.current=setTimeout(()=>{a.current&&(P(!U()||!F()),E.current=setTimeout(()=>{a.current&&(A(),requestAnimationFrame(()=>{b(!1)}))},200))},300)},t=()=>{requestAnimationFrame(()=>{x.current&&A({behavior:v?"auto":"smooth"})})},n=()=>{P(!0),A({behavior:"smooth"})};return XC.on(BC.CHAT_HISTORY_LOADED,e),XC.on(BC.CHAT_SSE_BEGIN,n),XC.on(BC.CHAT_SSE_PROCESS,t),()=>{XC.off(BC.CHAT_HISTORY_LOADED,e),XC.off(BC.CHAT_SSE_BEGIN,n),XC.off(BC.CHAT_SSE_PROCESS,t)}},[A,P,U,h]),O.useEffect(()=>()=>{E.current&&(clearTimeout(E.current),E.current=null),p.current&&(clearTimeout(p.current),p.current=null)},[]),O.useEffect(()=>{var t;if(bx())return(u||j)&&!y&&e||M||!e||(null==(t=oT.shareHistory)?void 0:t.currentId)?T(!0):T(!1),()=>{T(!0)}},[e,u,M,y,T,j]),O.useEffect(()=>{f(!1)},[e,f]),tn.jsx(tn.Fragment,{children:tn.jsxs("div",{className:J("chat-layout",{"chat-desktop":!v,"chat-mobile":v}),children:[t&&tn.jsx("div",{className:"chat-content",children:tn.jsxs("div",{className:"chat-messages",id:gg,ref:a,onScroll:z,children:[tn.jsx(iW,{chatIdProp:e}),!s&&tn.jsx("div",{className:"scroll-down-button-container",children:tn.jsx("div",{className:"scroll-down-button",onClick:D,children:tn.jsx(dt,{type:"icon-line-arrow-down",className:"scroll-down-button-icon"})})}),s&&tn.jsx("div",{className:"scroll-down-button-container",children:tn.jsx("div",{className:"scroll-down-button",onClick:L,children:tn.jsx(dt,{type:"icon-line-arrow-down",className:"scroll-down-button-icon up-button-icon"})})})]})}),n&&tn.jsxs(tn.Fragment,{children:[tn.jsxs("div",{className:"chat-content",children:[tn.jsx("div",{className:"chat-messages",id:gg,ref:a,onScroll:z,children:tn.jsx(iW,{chatIdProp:e})}),tn.jsx("div",{className:"chat-layout-input-container",children:tn.jsx(lB,{inDetail:!0,onScrollDown:D,onScrollTop:L,scrollDownBtnVisible:!s})})]}),tn.jsx(ht,{className:"timbre-select-modal",visible:C,header:!1,footer:!1,closable:!1,children:tn.jsx(QW,{closeModal:()=>S(!1)})}),tn.jsx(WW,{open:I,showControlsType:k})]}),!t&&!n&&tn.jsx(tn.Fragment,{children:tn.jsx("div",{className:"chat-content",id:"dropzone-container",children:tn.jsx(iq,{direction:"horizontal",className:"panel-group",children:tn.jsx(EB,{className:"chat-left-panel",children:tn.jsxs("div",{className:J("chat-left",{"chat-left-border":!I}),children:[tn.jsx("div",{className:"chat-messages",id:gg,ref:a,onScroll:z,children:tn.jsx(iW,{chatIdProp:e})}),tn.jsx("div",{className:"chat-layout-input-container",children:tn.jsx(lB,{inDetail:!0,onScrollDown:D,onScrollTop:L,scrollDownBtnVisible:!s})}),tn.jsx("div",{className:"chat-container-statement",children:o.t("AI-generated content may not be accurate.")})]})})})})}),tn.jsx(Tk,{fixed:!1,absolute:!0,loaded:(u||j)&&!y&&!!e||M||!e||H})]})})},YW=()=>{const{id:e}=oy();return tn.jsx(KW,{chatId:e||""})},XW=({leftPanel:e,rightPanel:t,open:n,draggable:i,miniSplitScreen:a})=>{const o=O.useRef(null),s=O.useRef(null),r=O.useRef(null),l=O.useRef(!0),c=O.useRef(null),u=O.useRef(null),d=O.useRef(!1),[h,p]=O.useState(!1),[m,f]=O.useState(!1),[g,v]=O.useState(!1),y=yE(e=>e.setShowSidebar),b=yE(e=>e.setIsSmallScreen),x=yE(e=>e.setIsMiddleScreen),w=yE(e=>e.setSidebarFloatingPlaceholder),S=e=>{if(!o.current||!r.current)return;const t=o.current.getBoundingClientRect(),n=e.clientX-t.left,i=t.width-480,a=Math.min(Math.max(n,440),i);r.current.style.width=t.width-a+"px"},_=()=>{v(!1),document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",_)},C=()=>{u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{u.current=null,r.current&&r.current.style.removeProperty("transition")},500)},E=O.useCallback(()=>n?window.innerWidth>=(a?1100:1180):window.innerWidth>=760,[a,n]),k=O.useCallback(()=>{var e,t;const n=E(),i=null==(e=document.querySelector("#sidebar"))?void 0:e.getBoundingClientRect();return n&&null!=(t=null==i?void 0:i.width)?t:60},[E]),I=O.useCallback(()=>{const e=E();TT()||y(e),w(!e);const t=window.innerWidth<760;b(t),x(!t&&window.innerWidth<1100)},[E,y,w,b,x]),T=O.useCallback(()=>{const e=E();if(d.current||!e?I():w(!e),!o.current||!r.current||!s.current)return;if(d.current&&(r.current.style.transition="none"),!i)return r.current&&(r.current.style.width="400px",l.current=!0,setTimeout(()=>{r.current.style.minWidth="400px"},300)),void C();if(f(window.innerWidth>980),window.innerWidth<980)return s.current.style.display="none",r.current.style.width=window.innerWidth-60+"px",void C();const t=window.innerWidth-k();if(l.current&&t/2>Math.max(440,480))return l.current=!1,r.current.style.width=t/2+"px",void C();const n=s.current.getBoundingClientRect(),c=Math.max(n.width,440),u=Math.max(t-c,480);r.current.style.width=`${a?400:u}px`,s.current.style.display="block",C()},[i,a,I,E,k,w]);return O.useEffect(()=>{n?(c.current&&clearTimeout(c.current),p(!0)):(r.current&&(r.current.style.width=r.current.style.minWidth="0px"),s.current&&s.current.style.removeProperty("display"),l.current=!0,c.current=setTimeout(()=>{c.current=null,p(!1)},300))},[n]),O.useLayoutEffect(()=>{n&&h&&setTimeout(()=>T(),50),n||w(!E());const e=()=>{d.current=!0,n?T():I(),d.current=!1};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[h,n,E,T,I,w]),tn.jsxs("div",{className:J("splitter-container",{"splitter-container-dragging":g}),ref:o,children:[tn.jsx("div",{className:"splitter-container-left-panel",ref:s,children:e}),h&&tn.jsxs("div",{className:"splitter-container-right-panel",ref:r,children:[t,i&&m&&tn.jsx("div",{className:"resize-bar",onMouseDown:()=>{document.addEventListener("mousemove",S),document.addEventListener("mouseup",_),v(!0)}})]})]})},JW=({showProjectChatInsModal:e,onCloseModal:t,inputValue:n})=>{const{getNewProjectList:i}=Xj(),a=G(),o=tx(e=>e.mobile),[s,r]=H.useState(n||""),[l,c]=H.useState(!1),u=fT(e=>e.projectInfo),d=fT(e=>e.setProjectInfo),h=()=>P(void 0,null,function*(){try{(yield i_({custom_instruction:s},u.id)).data.status&&(i(),d(C(_({},u),{custom_instruction:s})),ut.openOnce({type:"success",content:a.t("Instruction saved successfully.")}),t(),c(!1))}catch(e){}}),p=()=>{t(),c(!1)},m=()=>tn.jsx(vN,{props:{value:s||"",onChange:e=>{r(e),l||c(!0)},minRows:o?10:1,maxRows:10,maxLength:1e3,placeholder:a.t("What should the AI know about this project? (e.g., specific rules, tone, or formatting)")}});return o?tn.jsx(mt,{open:e,title:a.t("Instructions"),heightType:"auto",onClose:t,size:"large",className:"mobile-project-ins-popup",children:tn.jsx("div",{className:"qwen-chat-comp-project-ins-popup",children:tn.jsxs("div",{className:"qwen-chat-comp-project-ins-popup-content",children:[m(),tn.jsxs("div",{className:"qwen-chat-comp-project-ins-popup-footer",children:[tn.jsx(pt,{type:"tertiary",size:"large",rounded:"circle",className:"qwen-chat-comp-project-ins-popup-footer-btn",onClick:p,children:a.t("Cancel")}),tn.jsx(pt,{type:"brandprimary",size:"large",rounded:"circle",className:"qwen-chat-comp-project-ins-popup-footer-btn",disabled:s===n,onClick:h,children:a.t("Save")})]})]})})}):tn.jsxs(ht,{size:"medium",visible:e,className:"qwen-chat-comp-project-ins-modal",title:a.t("Instructions"),headerBorderNone:!0,onCancel:p,onOk:h,footer:!1,okText:a.t("Save"),cancelText:a.t("Cancel"),children:[m(),tn.jsxs("div",{className:"qwen-chat-comp-project-ins-modal-footer",children:[tn.jsx(pt,{type:"ghost",rounded:"circle",className:"qwen-chat-comp-project-ins-modal-footer-btn",onClick:p,children:a.t("Cancel")}),tn.jsx(pt,{type:"brandprimary",rounded:"circle",className:"qwen-chat-comp-project-ins-modal-footer-btn",onClick:h,disabled:s===n,children:a.t("Save")})]})]})},ZW=({showProjectChatFileModal:e,onCloseModal:t,projectId:n})=>{const{getProjectFilesList:i}=Xj(),a=G(),o=tx(e=>e.mobile),s=fT(e=>e.operationProjectFiles),r=fT(e=>e.deleteFiles),l=fT(e=>e.setDeleteFiles),c=fT(e=>e.setOperationProjectFiles),[u,d]=O.useState(!1),h=O.useRef(null),p=e=>P(void 0,null,function*(){var t,n,i,a;e&&"failed"===(null==(i=null==(n=null==(t=e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)?null==(a=null==h?void 0:h.current)||a.startParse(e,!0):e&&e.uploadTaskId&&(yield dE.resumeUpload(e.uploadTaskId))}),m=O.useMemo(()=>s.filter(e=>!r.includes(e.itemId)).some(e=>{var t,n,i;return"uploading"===e.status||"running"===(null==(i=null==(n=null==(t=null==e?void 0:e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)}),[r,s]);O.useEffect(()=>{n&&i(n)},[n]);const f=e=>{var t;null==(t=null==h?void 0:h.current)||t.removeFile(e),l([...r,e.file_id||e.itemId])},g=()=>{d(!1),P(void 0,null,function*(){const e=s.filter(e=>"uploading"===e.uploadStatus).map(e=>e.itemId);if(m)return s.forEach(e=>{var t,n,i,a;"running"===(null==(i=null==(n=null==(t=e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)&&(null==(a=null==h?void 0:h.current)||a.removeFile(e))}),void l(e);const t=s.filter(e=>!e.file_id&&"success"===e.uploadStatus&&"success"===e.greenNet).filter(e=>!r.includes(e.itemId));(yield i_({add_files:t,delete_files:r},n)).success&&(l(e),CN(n))}),t(),c([])},v=()=>{m?d(!0):g()},y=()=>tn.jsx(bN,{files:s,actions:["download","delete"],onReUpload:p,onDownload:e=>{const{path:t,url:n}=e,i=t||n;i.includes("img.alicdn.com")?W_(i):K_({role:"user",url:i})},onDelete:f,isMobileProjectDetail:o});return tn.jsxs(tn.Fragment,{children:[o?tn.jsxs(mt,{open:e,title:a.t("Files"),heightType:"full",onClose:v,className:"mobile-project-ins-popup",children:[tn.jsx("div",{className:"qwen-chat-comp-project-file-popup-list",children:y()}),tn.jsx(SN,{styles:{width:"calc(100% - 30px)",height:"48px",margin:"0 15px"},ref:h})]}):tn.jsxs(ht,{size:"medium",visible:e,className:"qwen-chat-comp-project-file-modal",footer:!1,header:!1,bodyPaddingNone:!0,onCancel:v,children:[tn.jsxs("div",{className:"qwen-chat-comp-project-file-modal-herder",children:[tn.jsx("div",{className:"qwen-chat-comp-project-file-modal-title",children:a.t("Files")}),tn.jsxs("div",{className:"qwen-chat-comp-project-file-modal-action",children:[tn.jsx(SN,{styles:{width:"88px"},ref:h}),tn.jsx("button",{onClick:v,className:"qwen-chat-comp-project-file-modal-close",children:tn.jsx(dt,{type:"icon-line-x-01"})})]})]}),tn.jsx("div",{className:"qwen-chat-comp-project-file-modal-list",children:y()})]}),u&&tn.jsx(kN,{onCancel:()=>{d(!1)},onConfirm:()=>{g()}})]})},eQ=({showEditProjectNameModal:e,onCloseModal:t,projectTitle:n})=>{const{getNewProjectList:i}=Xj(),a=G(),o=tx(e=>e.mobile),[s,r]=H.useState(n||""),l=fT(e=>e.projectInfo),c=fT(e=>e.setProjectInfo),u=()=>P(void 0,null,function*(){if(localStorage.getItem("token")&&(null==l?void 0:l.id))try{(yield i_({name:s},l.id)).data.status&&(i(),c(C(_({},l),{name:s})),t())}catch(e){}}),d=()=>{t()},h=()=>o?tn.jsx(vN,{props:{value:s||"",onChange:e=>{r(e)},minRows:3,maxRows:3,maxLength:150,placeholder:a.t("Project Name")}}):tn.jsx(xt,{value:s,onChange:e=>{r(e)},maxLength:150,placeholder:a.t("Project Name"),className:"project-new-name-edit-input"});return o?tn.jsx(mt,{open:e,title:a.t("Edit Project Name"),heightType:"auto",onClose:t,size:"large",className:"mobile-project-name-popup",children:tn.jsx("div",{className:"qwen-chat-comp-project-name-popup",children:tn.jsxs("div",{className:"qwen-chat-comp-project-name-popup-content",children:[h(),tn.jsx("div",{className:"qwen-chat-comp-project-name-popup-footer",children:tn.jsx(pt,{type:"brandprimary",size:"large",rounded:"circle",className:"qwen-chat-comp-project-name-popup-footer-btn",onClick:u,disabled:!s.trim()||s===n,children:a.t("Save")})})]})})}):tn.jsxs(ht,{size:"small",visible:e,className:"qwen-chat-comp-project-name-modal",title:a.t("Edit Project Name"),headerBorderNone:!0,onCancel:d,onOk:u,footer:!1,children:[h(),tn.jsxs("div",{className:"qwen-chat-comp-project-name-modal-footer",children:[tn.jsx(pt,{type:"ghost",rounded:"circle",className:"qwen-chat-comp-project-name-modal-footer-btn",onClick:d,children:a.t("Cancel")}),tn.jsx(pt,{type:"brandprimary",rounded:"circle",className:"qwen-chat-comp-project-name-modal-footer-btn",onClick:u,disabled:!s.trim()||s===n,children:a.t("Save")})]})]})},tQ=({projectTitle:e,projectIns:t})=>{const n=fT(e=>e.projectInfo),i=fT(e=>e.projectChats),a=fT(e=>e.setInstructionValue),o=G(),s=tx(e=>e.mobile),[r,l]=O.useState(!1),[c,u]=O.useState(!1),[d,h]=O.useState(!1),p=fT(e=>e.setProjectInfo),{getNewProjectList:m}=Xj();return tn.jsxs("div",{className:"project-title "+(s&&i.length<1?"project-title-full-center":""),children:[tn.jsxs("div",{className:"project-title-left",children:[tn.jsx(pN,{data:n,setData:e=>P(void 0,null,function*(){(yield i_({icon:e.icon},n.id)).data.status&&(m(),p(C(_({},n),{icon:e.icon})))}),isProjectDetail:!0}),tn.jsx("div",{className:"project-title-text",onClick:()=>{l(!r)},children:e})]}),tn.jsxs("div",{className:"project-title-right",children:[n.fileLength>0&&tn.jsx(ft,{title:o.t("{{count}}  Files",{count:n.fileLength}),children:tn.jsxs("button",{className:"project-title-button",style:s?{}:{transform:(null==t?void 0:t.length)>0?"translateX(10px)":""},onClick:()=>{h(!d)},children:[tn.jsx(dt,{type:"icon-line-file-02",className:"project-title-action-icon"}),s?o.t("{{count}}  Files",{count:n.fileLength}):""]})}),t&&(null==t?void 0:t.length)>0&&tn.jsx(ft,{title:o.t("Projects Instructions"),children:tn.jsxs("button",{className:"project-title-button",onClick:()=>{u(!c),a(n.custom_instruction)},children:[tn.jsx(dt,{type:"icon-line-customize",className:"project-title-action-icon"}),s?o.t("Projects Instructions"):""]})})]}),s&&i.length<1&&tn.jsxs("div",{className:"project-placeholder",children:[tn.jsx(dt,{type:"icon-line-package-empty",className:"project-placeholder-icon"}),tn.jsx("div",{className:"project-placeholder-text",children:o.t("All project-related chats will be displayed here.")})]}),c&&tn.jsx(JW,{showProjectChatInsModal:c,onCloseModal:()=>{u(!1)},inputValue:t}),d&&tn.jsx(ZW,{projectId:n.id,showProjectChatFileModal:d,onCloseModal:()=>{h(!1)}}),r&&tn.jsx(eQ,{showEditProjectNameModal:r,onCloseModal:()=>{l(!1)},projectTitle:e})]})},nQ=O.createContext({dragDropManager:void 0});function iQ(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var aQ="function"==typeof Symbol&&Symbol.observable||"@@observable",oQ=function(){return Math.random().toString(36).substring(7).split("").join(".")},sQ={INIT:"@@redux/INIT"+oQ(),REPLACE:"@@redux/REPLACE"+oQ()};function rQ(e,t,n){var i;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(iQ(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(iQ(1));return n(rQ)(e,t)}if("function"!=typeof e)throw new Error(iQ(2));var a=e,o=t,s=[],r=s,l=!1;function c(){r===s&&(r=s.slice())}function u(){if(l)throw new Error(iQ(3));return o}function d(e){if("function"!=typeof e)throw new Error(iQ(4));if(l)throw new Error(iQ(5));var t=!0;return c(),r.push(e),function(){if(t){if(l)throw new Error(iQ(6));t=!1,c();var n=r.indexOf(e);r.splice(n,1),s=null}}}function h(e){if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw new Error(iQ(7));if(void 0===e.type)throw new Error(iQ(8));if(l)throw new Error(iQ(9));try{l=!0,o=a(o,e)}finally{l=!1}for(var t=s=r,n=0;n<t.length;n++){(0,t[n])()}return e}return h({type:sQ.INIT}),(i={dispatch:h,subscribe:d,getState:u,replaceReducer:function(e){if("function"!=typeof e)throw new Error(iQ(10));a=e,h({type:sQ.REPLACE})}})[aQ]=function(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(iQ(11));function n(){e.next&&e.next(u())}return n(),{unsubscribe:t(n)}}})[aQ]=function(){return this},e},i}function lQ(e,t,...n){if("undefined"!=typeof process&&void 0===t)throw new Error("invariant requires an error message argument");if(!e){let e;if(void 0===t)e=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let i=0;e=new Error(t.replace(/%s/g,function(){return n[i++]})),e.name="Invariant Violation"}throw e.framesToPop=1,e}}function cQ(e){return"object"==typeof e}const uQ="dnd-core/INIT_COORDS",dQ="dnd-core/BEGIN_DRAG",hQ="dnd-core/PUBLISH_DRAG_SOURCE",pQ="dnd-core/HOVER",mQ="dnd-core/DROP",fQ="dnd-core/END_DRAG";function gQ(e,t){return{type:uQ,payload:{sourceClientOffset:t||null,clientOffset:e||null}}}const vQ={type:uQ,payload:{clientOffset:null,sourceClientOffset:null}};function yQ(e){return function(t=[],n={publishSource:!0}){const{publishSource:i=!0,clientOffset:a,getSourceClientOffset:o}=n,s=e.getMonitor(),r=e.getRegistry();e.dispatch(gQ(a)),function(e,t,n){lQ(!t.isDragging(),"Cannot call beginDrag while dragging."),e.forEach(function(e){lQ(n.getSource(e),"Expected sourceIds to be registered.")})}(t,s,r);const l=function(e,t){let n=null;for(let i=e.length-1;i>=0;i--)if(t.canDragSource(e[i])){n=e[i];break}return n}(t,s);if(null==l)return void e.dispatch(vQ);let c=null;if(a){if(!o)throw new Error("getSourceClientOffset must be defined");!function(e){lQ("function"==typeof e,"When clientOffset is provided, getSourceClientOffset must be a function.")}(o),c=o(l)}e.dispatch(gQ(a,c));const u=r.getSource(l).beginDrag(s,l);if(null==u)return;!function(e){lQ(cQ(e),"Item must be an object.")}(u),r.pinSource(l);const d=r.getSourceType(l);return{type:dQ,payload:{itemType:d,item:u,sourceId:l,clientOffset:a||null,sourceClientOffset:c||null,isSourcePublic:!!i}}}}function bQ(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xQ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){bQ(e,t,n[t])})}return e}function wQ(e){return function(t={}){const n=e.getMonitor(),i=e.getRegistry();!function(e){lQ(e.isDragging(),"Cannot call drop while not dragging."),lQ(!e.didDrop(),"Cannot call drop twice during one drag operation.")}(n);const a=function(e){const t=e.getTargetIds().filter(e.canDropOnTarget,e);return t.reverse(),t}(n);a.forEach((a,o)=>{const s=function(e,t,n,i){const a=n.getTarget(e);let o=a?a.drop(i,e):void 0;(function(e){lQ(void 0===e||cQ(e),"Drop result must either be an object or undefined.")})(o),void 0===o&&(o=0===t?{}:i.getDropResult());return o}(a,o,i,n),r={type:mQ,payload:{dropResult:xQ({},t,s)}};e.dispatch(r)})}}function SQ(e){return function(){const t=e.getMonitor(),n=e.getRegistry();!function(e){lQ(e.isDragging(),"Cannot call endDrag while not dragging.")}(t);const i=t.getSourceId();if(null!=i){n.getSource(i,!0).endDrag(t,i),n.unpinSource()}return{type:fQ}}}function _Q(e,t){return null===t?null===e:Array.isArray(e)?e.some(e=>e===t):e===t}function CQ(e){return function(t,{clientOffset:n}={}){!function(e){lQ(Array.isArray(e),"Expected targetIds to be an array.")}(t);const i=t.slice(0),a=e.getMonitor(),o=e.getRegistry();return function(e,t,n){for(let i=e.length-1;i>=0;i--){const a=e[i];_Q(t.getTargetType(a),n)||e.splice(i,1)}}(i,o,a.getItemType()),function(e,t,n){lQ(t.isDragging(),"Cannot call hover while not dragging."),lQ(!t.didDrop(),"Cannot call hover after drop.");for(let i=0;i<e.length;i++){const t=e[i];lQ(e.lastIndexOf(t)===i,"Expected targetIds to be unique in the passed array.");lQ(n.getTarget(t),"Expected targetIds to be registered.")}}(i,a,o),function(e,t,n){e.forEach(function(e){n.getTarget(e).hover(t,e)})}(i,a,o),{type:pQ,payload:{targetIds:i,clientOffset:n||null}}}}function EQ(e){return function(){if(e.getMonitor().isDragging())return{type:hQ}}}class kQ{receiveBackend(e){this.backend=e}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){const e=this,{dispatch:t}=this.store;const n=function(e){return{beginDrag:yQ(e),publishDragSource:EQ(e),hover:CQ(e),drop:wQ(e),endDrag:SQ(e)}}(this);return Object.keys(n).reduce((i,a)=>{const o=n[a];var s;return i[a]=(s=o,(...n)=>{const i=s.apply(e,n);void 0!==i&&t(i)}),i},{})}dispatch(e){this.store.dispatch(e)}constructor(e,t){this.isSetUp=!1,this.handleRefCountChange=()=>{const e=this.store.getState().refCount>0;this.backend&&(e&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!e&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=e,this.monitor=t,e.subscribe(this.handleRefCountChange)}}function IQ(e,t){return{x:e.x-t.x,y:e.y-t.y}}const TQ=[],jQ=[];TQ.__IS_NONE__=!0,jQ.__IS_ALL__=!0;class NQ{subscribeToStateChange(e,t={}){const{handlerIds:n}=t;lQ("function"==typeof e,"listener must be a function."),lQ(void 0===n||Array.isArray(n),"handlerIds, when specified, must be an array of strings.");let i=this.store.getState().stateId;return this.store.subscribe(()=>{const t=this.store.getState(),a=t.stateId;try{const o=a===i||a===i+1&&!function(e,t){if(e===TQ)return!1;if(e===jQ||void 0===t)return!0;const n=(i=e,t.filter(e=>i.indexOf(e)>-1));var i;return n.length>0}(t.dirtyHandlerIds,n);o||e()}finally{i=a}})}subscribeToOffsetChange(e){lQ("function"==typeof e,"listener must be a function.");let t=this.store.getState().dragOffset;return this.store.subscribe(()=>{const n=this.store.getState().dragOffset;n!==t&&(t=n,e())})}canDragSource(e){if(!e)return!1;const t=this.registry.getSource(e);return lQ(t,`Expected to find a valid source. sourceId=${e}`),!this.isDragging()&&t.canDrag(this,e)}canDropOnTarget(e){if(!e)return!1;const t=this.registry.getTarget(e);if(lQ(t,`Expected to find a valid target. targetId=${e}`),!this.isDragging()||this.didDrop())return!1;return _Q(this.registry.getTargetType(e),this.getItemType())&&t.canDrop(this,e)}isDragging(){return Boolean(this.getItemType())}isDraggingSource(e){if(!e)return!1;const t=this.registry.getSource(e,!0);if(lQ(t,`Expected to find a valid source. sourceId=${e}`),!this.isDragging()||!this.isSourcePublic())return!1;return this.registry.getSourceType(e)===this.getItemType()&&t.isDragging(this,e)}isOverTarget(e,t={shallow:!1}){if(!e)return!1;const{shallow:n}=t;if(!this.isDragging())return!1;const i=this.registry.getTargetType(e),a=this.getItemType();if(a&&!_Q(i,a))return!1;const o=this.getTargetIds();if(!o.length)return!1;const s=o.indexOf(e);return n?s===o.length-1:s>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return Boolean(this.store.getState().dragOperation.isSourcePublic)}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return function(e){const{clientOffset:t,initialClientOffset:n,initialSourceClientOffset:i}=e;return t&&n&&i?IQ((o=i,{x:(a=t).x+o.x,y:a.y+o.y}),n):null;var a,o}(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return function(e){const{clientOffset:t,initialClientOffset:n}=e;return t&&n?IQ(t,n):null}(this.store.getState().dragOffset)}constructor(e,t){this.store=e,this.registry=t}}const PQ="undefined"!=typeof global?global:self,MQ=PQ.MutationObserver||PQ.WebKitMutationObserver;function AQ(e){return function(){const t=setTimeout(i,0),n=setInterval(i,50);function i(){clearTimeout(t),clearInterval(n),e()}}}const RQ="function"==typeof MQ?function(e){let t=1;const n=new MQ(e),i=document.createTextNode("");return n.observe(i,{characterData:!0}),function(){t=-t,i.data=t}}:AQ;class OQ{call(){try{this.task&&this.task()}catch(e){this.onError(e)}finally{this.task=null,this.release(this)}}constructor(e,t){this.onError=e,this.release=t,this.task=null}}const DQ=new class{enqueueTask(e){const{queue:t,requestFlush:n}=this;t.length||(n(),this.flushing=!0),t[t.length]=e}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:e}=this;for(;this.index<e.length;){const t=this.index;if(this.index++,e[t].call(),this.index>this.capacity){for(let t=0,n=e.length-this.index;t<n;t++)e[t]=e[t+this.index];e.length-=this.index,this.index=0}}e.length=0,this.index=0,this.flushing=!1},this.registerPendingError=e=>{this.pendingErrors.push(e),this.requestErrorThrow()},this.requestFlush=RQ(this.flush),this.requestErrorThrow=AQ(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}},LQ=new class{create(e){const t=this.freeTasks,n=t.length?t.pop():new OQ(this.onError,e=>t[t.length]=e);return n.task=e,n}constructor(e){this.onError=e,this.freeTasks=[]}}(DQ.registerPendingError);const FQ="dnd-core/ADD_SOURCE",UQ="dnd-core/ADD_TARGET",zQ="dnd-core/REMOVE_SOURCE",HQ="dnd-core/REMOVE_TARGET";function $Q(e,t){t&&Array.isArray(e)?e.forEach(e=>$Q(e,!1)):lQ("string"==typeof e||"symbol"==typeof e,t?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}var BQ,qQ;(qQ=BQ||(BQ={})).SOURCE="SOURCE",qQ.TARGET="TARGET";let GQ=0;function VQ(e){const t=(GQ++).toString();switch(e){case BQ.SOURCE:return`S${t}`;case BQ.TARGET:return`T${t}`;default:throw new Error(`Unknown Handler Role: ${e}`)}}function WQ(e){switch(e[0]){case"S":return BQ.SOURCE;case"T":return BQ.TARGET;default:throw new Error(`Cannot parse handler ID: ${e}`)}}function QQ(e,t){const n=e.entries();let i=!1;do{const{done:e,value:[,a]}=n.next();if(a===t)return!0;i=!!e}while(!i);return!1}class KQ{addSource(e,t){$Q(e),function(e){lQ("function"==typeof e.canDrag,"Expected canDrag to be a function."),lQ("function"==typeof e.beginDrag,"Expected beginDrag to be a function."),lQ("function"==typeof e.endDrag,"Expected endDrag to be a function.")}(t);const n=this.addHandler(BQ.SOURCE,e,t);return this.store.dispatch(function(e){return{type:FQ,payload:{sourceId:e}}}(n)),n}addTarget(e,t){$Q(e,!0),function(e){lQ("function"==typeof e.canDrop,"Expected canDrop to be a function."),lQ("function"==typeof e.hover,"Expected hover to be a function."),lQ("function"==typeof e.drop,"Expected beginDrag to be a function.")}(t);const n=this.addHandler(BQ.TARGET,e,t);return this.store.dispatch(function(e){return{type:UQ,payload:{targetId:e}}}(n)),n}containsHandler(e){return QQ(this.dragSources,e)||QQ(this.dropTargets,e)}getSource(e,t=!1){lQ(this.isSourceId(e),"Expected a valid source ID.");return t&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)}getTarget(e){return lQ(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)}getSourceType(e){return lQ(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)}getTargetType(e){return lQ(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)}isSourceId(e){return WQ(e)===BQ.SOURCE}isTargetId(e){return WQ(e)===BQ.TARGET}removeSource(e){var t;lQ(this.getSource(e),"Expected an existing source."),this.store.dispatch(function(e){return{type:zQ,payload:{sourceId:e}}}(e)),t=()=>{this.dragSources.delete(e),this.types.delete(e)},DQ.enqueueTask(LQ.create(t))}removeTarget(e){lQ(this.getTarget(e),"Expected an existing target."),this.store.dispatch(function(e){return{type:HQ,payload:{targetId:e}}}(e)),this.dropTargets.delete(e),this.types.delete(e)}pinSource(e){const t=this.getSource(e);lQ(t,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=t}unpinSource(){lQ(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(e,t,n){const i=VQ(e);return this.types.set(i,t),e===BQ.SOURCE?this.dragSources.set(i,n):e===BQ.TARGET&&this.dropTargets.set(i,n),i}constructor(e){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=e}}const YQ=(e,t)=>e===t;function XQ(e=TQ,t){switch(t.type){case pQ:break;case FQ:case UQ:case HQ:case zQ:return TQ;default:return jQ}const{targetIds:n=[],prevTargetIds:i=[]}=t.payload,a=function(e,t){const n=new Map,i=e=>{n.set(e,n.has(e)?n.get(e)+1:1)};e.forEach(i),t.forEach(i);const a=[];return n.forEach((e,t)=>{1===e&&a.push(t)}),a}(n,i);if(!(a.length>0||!function(e,t,n=YQ){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!n(e[i],t[i]))return!1;return!0}(n,i)))return TQ;const o=i[i.length-1],s=n[n.length-1];return o!==s&&(o&&a.push(o),s&&a.push(s)),a}function JQ(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ZQ={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function eK(e=ZQ,t){const{payload:n}=t;switch(t.type){case uQ:case dQ:return{initialSourceClientOffset:n.sourceClientOffset,initialClientOffset:n.clientOffset,clientOffset:n.clientOffset};case pQ:return i=e.clientOffset,a=n.clientOffset,!i&&!a||i&&a&&i.x===a.x&&i.y===a.y?e:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){JQ(e,t,n[t])})}return e}({},e,{clientOffset:n.clientOffset});case fQ:case mQ:return ZQ;default:return e}var i,a}function tK(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nK(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){tK(e,t,n[t])})}return e}const iK={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function aK(e=iK,t){const{payload:n}=t;switch(t.type){case dQ:return nK({},e,{itemType:n.itemType,item:n.item,sourceId:n.sourceId,isSourcePublic:n.isSourcePublic,dropResult:null,didDrop:!1});case hQ:return nK({},e,{isSourcePublic:!0});case pQ:return nK({},e,{targetIds:n.targetIds});case HQ:return-1===e.targetIds.indexOf(n.targetId)?e:nK({},e,{targetIds:(i=e.targetIds,a=n.targetId,i.filter(e=>e!==a))});case mQ:return nK({},e,{dropResult:n.dropResult,didDrop:!0,targetIds:[]});case fQ:return nK({},e,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return e}var i,a}function oK(e=0,t){switch(t.type){case FQ:case UQ:return e+1;case zQ:case HQ:return e-1;default:return e}}function sK(e=0){return e+1}function rK(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lK(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){rK(e,t,n[t])})}return e}function cK(e={},t){return{dirtyHandlerIds:XQ(e.dirtyHandlerIds,{type:t.type,payload:lK({},t.payload,{prevTargetIds:(n=e,i="dragOperation.targetIds",a=[],i.split(".").reduce((e,t)=>e&&e[t]?e[t]:a||null,n))})}),dragOffset:eK(e.dragOffset,t),refCount:oK(e.refCount,t),dragOperation:aK(e.dragOperation,t),stateId:sK(e.stateId)};var n,i,a}function uK(e,t=void 0,n={},i=!1){const a=function(e){const t="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__;return rQ(cK,e&&t&&t({name:"dnd-core",instanceId:"dnd-core"}))}(i),o=new NQ(a,new KQ(a)),s=new kQ(a,o),r=e(s,t,n);return s.receiveBackend(r),s}function dK(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}let hK=0;const pK=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");var mK=O.memo(function(e){var{children:t}=e,n=dK(e,["children"]);const[i,a]=function(e){if("manager"in e){return[{dragDropManager:e.manager},!1]}const t=function(e,t=fK(),n,i){const a=t;a[pK]||(a[pK]={dragDropManager:uK(e,t,n,i)});return a[pK]}(e.backend,e.context,e.options,e.debugMode),n=!e.context;return[t,n]}(n);return O.useEffect(()=>{if(a){const e=fK();return++hK,()=>{0===--hK&&(e[pK]=null)}}},[]),tn.jsx(nQ.Provider,{value:i,children:t})});function fK(){return"undefined"!=typeof global?global:window}const gK=B(function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var i,a,o;if(Array.isArray(t)){if((i=t.length)!=n.length)return!1;for(a=i;0!==a--;)if(!e(t[a],n[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((i=(o=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(a=i;0!==a--;)if(!Object.prototype.hasOwnProperty.call(n,o[a]))return!1;for(a=i;0!==a--;){var s=o[a];if(!e(t[s],n[s]))return!1}return!0}return t!=t&&n!=n}),vK="undefined"!=typeof window?O.useLayoutEffect:O.useEffect;function yK(e,t,n){const[i,a]=function(e,t,n){const[i,a]=O.useState(()=>t(e)),o=O.useCallback(()=>{const o=t(e);gK(i,o)||(a(o),n&&n())},[i,e,n]);return vK(o),[i,o]}(e,t,n);return vK(function(){const t=e.getHandlerId();if(null!=t)return e.subscribeToStateChange(a,{handlerIds:[t]})},[e,a]),i}function bK(e,t,n){return yK(t,e||(()=>({})),()=>n.reconnect())}function xK(e,t){const n=[...t||[]];return null==t&&"function"!=typeof e&&n.push(e),O.useMemo(()=>"function"==typeof e?e():e,n)}function wK(e){return O.useMemo(()=>e.hooks.dragSource(),[e])}function SK(e){return O.useMemo(()=>e.hooks.dragPreview(),[e])}let _K=!1,CK=!1;class EK{receiveHandlerId(e){this.sourceId=e}getHandlerId(){return this.sourceId}canDrag(){lQ(!_K,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return _K=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{_K=!1}}isDragging(){if(!this.sourceId)return!1;lQ(!CK,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return CK=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{CK=!1}}subscribeToStateChange(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}isDraggingSource(e){return this.internalMonitor.isDraggingSource(e)}isOverTarget(e,t){return this.internalMonitor.isOverTarget(e,t)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(e){return this.internalMonitor.subscribeToOffsetChange(e)}canDragSource(e){return this.internalMonitor.canDragSource(e)}canDropOnTarget(e){return this.internalMonitor.canDropOnTarget(e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.sourceId=null,this.internalMonitor=e.getMonitor()}}function kK(e,t,n){const i=n.getRegistry(),a=i.addTarget(e,t);return[a,()=>i.removeTarget(a)]}function IK(e,t,n,i){let a;if(void 0!==a)return!!a;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;const o=Object.keys(e),s=Object.keys(t);if(o.length!==s.length)return!1;const r=Object.prototype.hasOwnProperty.bind(t);for(let l=0;l<o.length;l++){const n=o[l];if(!r(n))return!1;const i=e[n],s=t[n];if(a=void 0,!1===a||void 0===a&&i!==s)return!1}return!0}function TK(e){return null!==e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function jK(e){return(t=null,n=null)=>{if(!O.isValidElement(t)){const i=t;return e(i,n),i}const i=t;!function(e){if("string"==typeof e.type)return;const t=e.type.displayName||e.type.name||"the component";throw new Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${t} into a <div>, or turn it into a drag source or a drop target itself.`)}(i);return function(e,t){const n=e.ref;return lQ("string"!=typeof n,"Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),n?O.cloneElement(e,{ref:e=>{PK(n,e),PK(t,e)}}):O.cloneElement(e,{ref:t})}(i,n?t=>e(t,n):e)}}function NK(e){const t={};return Object.keys(e).forEach(n=>{const i=e[n];if(n.endsWith("Ref"))t[n]=e[n];else{const e=jK(i);t[n]=()=>e}}),t}function PK(e,t){"function"==typeof e?e(t):e.current=t}class MK{receiveHandlerId(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(e){this.dragSourceOptionsInternal=e}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(e){this.dragPreviewOptionsInternal=e}reconnect(){const e=this.reconnectDragSource();this.reconnectDragPreview(e)}reconnectDragSource(){const e=this.dragSource,t=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return t&&this.disconnectDragSource(),this.handlerId?e?(t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)),t):(this.lastConnectedDragSource=e,t):t}reconnectDragPreview(e=!1){const t=this.dragPreview,n=e||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();n&&this.disconnectDragPreview(),this.handlerId&&(t?n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=t,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,t,this.dragPreviewOptions)):this.lastConnectedDragPreview=t)}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!IK(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!IK(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(e){this.hooks=NK({dragSource:(e,t)=>{this.clearDragSource(),this.dragSourceOptions=t||null,TK(e)?this.dragSourceRef=e:this.dragSourceNode=e,this.reconnectDragSource()},dragPreview:(e,t)=>{this.clearDragPreview(),this.dragPreviewOptions=t||null,TK(e)?this.dragPreviewRef=e:this.dragPreviewNode=e,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}}function AK(){const{dragDropManager:e}=O.useContext(nQ);return lQ(null!=e,"Expected drag drop context"),e}class RK{beginDrag(){const e=this.spec,t=this.monitor;let n=null;return n="object"==typeof e.item?e.item:"function"==typeof e.item?e.item(t):{},null!=n?n:null}canDrag(){const e=this.spec,t=this.monitor;return"boolean"==typeof e.canDrag?e.canDrag:"function"!=typeof e.canDrag||e.canDrag(t)}isDragging(e,t){const n=this.spec,i=this.monitor,{isDragging:a}=n;return a?a(i):t===e.getSourceId()}endDrag(){const e=this.spec,t=this.monitor,n=this.connector,{end:i}=e;i&&i(t.getItem(),t),n.reconnect()}constructor(e,t,n){this.spec=e,this.monitor=t,this.connector=n}}function OK(e,t,n){const i=AK(),a=function(e,t,n){const i=O.useMemo(()=>new RK(e,t,n),[t,n]);return O.useEffect(()=>{i.spec=e},[e]),i}(e,t,n),o=function(e){return O.useMemo(()=>{const t=e.type;return lQ(null!=t,"spec.type must be defined"),t},[e])}(e);vK(function(){if(null!=o){const[e,s]=function(e,t,n){const i=n.getRegistry(),a=i.addSource(e,t);return[a,()=>i.removeSource(a)]}(o,a,i);return t.receiveHandlerId(e),n.receiveHandlerId(e),s}},[i,t,n,a,o])}function DK(e,t){const n=xK(e,t);lQ(!n.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const i=function(){const e=AK();return O.useMemo(()=>new EK(e),[e])}(),a=function(e,t){const n=AK(),i=O.useMemo(()=>new MK(n.getBackend()),[n]);return vK(()=>(i.dragSourceOptions=e||null,i.reconnect(),()=>i.disconnectDragSource()),[i,e]),vK(()=>(i.dragPreviewOptions=t||null,i.reconnect(),()=>i.disconnectDragPreview()),[i,t]),i}(n.options,n.previewOptions);return OK(n,i,a),[bK(n.collect,i,a),wK(a),SK(a)]}(new Image).src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=";const LK=O.memo(e=>{const{id:t,pinned:n,title:i,folders:a,className:o,selected:s=!1,isActive:r=!1,onEditChatChange:l=()=>{},onChange:c=()=>{},onSelect:u=()=>{},onUnSelect:d=()=>{},isProjectDetailChat:h=!1,projectDetailChat:p=null,projectChatPined:m,time:f,projectChat:g=!1,projectId:v}=e,y=G(),b=iy(),[x,w]=O.useState(!1),[S,_]=O.useState(!1),[C,E]=O.useState(!1),[k,I]=O.useState(!1),[T,j]=O.useState(i||""),[N,M]=O.useState(""),[A,R]=O.useState([]),D=O.useRef(null),L=O.useRef(0),F=O.useRef(0),U=O.useRef(null),z=fT(e=>e.setActiveChatDetails),H=yE(e=>e.activeChatMenuId),$=yE(e=>e.setActiveChatMenuId),B=fT(e=>e.setActiveProjectId),q=tx(e=>e.mobile),V=Wb(e=>e.chatId),W=Wb(e=>e.setChatTitle),Q=Kb(e=>e.chats),K=Kb(e=>e.pinnedChats),Y=Kb(e=>e.setPinnedChats),X=yE(e=>e.setShowSidebar),J=Zb(e=>e.setTaskRunning),Z=Zb(e=>e.setTemporaryChatEnabled),ee=Zb(e=>e.temporaryChatEnabled);Zb(e=>e.setCurrentShowControl);const[te,ne]=O.useState(!1),[{isDragging:ie},ae]=DK(()=>({type:"chat",item:{id:t,type:"chat"},collect:e=>({isDragging:!!e.isDragging()})})),oe=O.useMemo(()=>q?H===t:h?H===`${t}_project_detail_chat`:H===t,[H,h,t,q]),se=O.useCallback((t,n)=>P(void 0,null,function*(){if(0!==n.trim().length)if(""===n)ut.open({type:"error",content:y.t("Title cannot be an empty string.")});else{if(!(yield mS({chat_id:t,chat:{title:n}}).catch(e=>{ut.open({type:"error",content:y.t(e.message)})})).success)return void j(e.title||"");t===V&&W(n),c()}else j(e.title||"")}),[V,y,c,e.title,W]),re=O.useCallback(e=>P(void 0,null,function*(){const t=yield ES(e).catch(e=>(ut.open({type:"error",content:y.t(e.message)}),null));if(null==t?void 0:t.success){oT.shareHistory=null,b(`/c/${t.data.id}`),yield dC();const e=yield dS();Array.isArray(e.data)&&Y(e.data),hC()}else ut.open({type:"error",content:y.t(null==t?void 0:t.data.message)})}),[y,Y]),le=O.useCallback(()=>P(void 0,null,function*(){q&&X(!1),oT.openNewChat()}),[q,X]),ce=O.useCallback(e=>{let t=[];if(e)for(const n in e)e[n].items&&Array.isArray(e[n].items.chats)&&(t=t.concat(e[n].items.chats));return t},[]),ue=O.useCallback(e=>P(void 0,null,function*(){var t,n,i;E(!1),e===V&&J(!1);const o=yield _S(e).catch(e=>(ut.open({type:"error",content:y.t(e.message)}),null)),s=1===(null==(t=null==Q?void 0:Q.filter(e=>e.id===V))?void 0:t.length),r=1===(null==(n=null==K?void 0:K.filter(e=>e.id===V))?void 0:n.length),l=ce(a),u=1===(null==(i=null==l?void 0:l.filter(e=>e.id===V))?void 0:i.length);o&&(V!==e&&(s||u||r)||h||(V===e&&v?b(`/p/${v}`,{replace:!0}):yield le()),c())}),[V,Q,a,ce,le,y,h,b,c,K,v,J]),de=O.useCallback(e=>P(void 0,null,function*(){(yield SS(e).catch(e=>{ut.open({type:"error",content:y.t(e.message)})}))&&(V===e&&(J(!1),v?b(`/p/${v}`,{replace:!0}):yield le()),c())}),[V,le,y,b,c,v,J]),he=O.useCallback((e,t)=>e.length>t?e.slice(0,t-3)+"...":e,[]),pe=O.useCallback(()=>{t!==V&&(J(!1),u(),oT.closeShowControls(),q&&(X(!1),$(null)),aT.reset(["inputValue","files"]),oT.shareHistory=null,h&&z(p),d(),b(`/c/${t}`))},[t,V,J,u,q,h,d,b,X,$,z,p]),me=O.useCallback(e=>{if(!q)return;e.stopPropagation(),e.preventDefault();const n=e.touches[0];L.current=n.clientX,F.current=n.clientY,clearTimeout(U.current),U.current=setTimeout(()=>{$(oe?null:t),B(null)},500)},[t,q,$,B,oe]),fe=O.useCallback(()=>{q&&clearTimeout(U.current)},[q]),ge=O.useCallback(()=>{ut.openOnce({type:"caution",content:tn.jsxs("div",{className:"temporary-chat-close-toast-content",children:[y.t("You are now in temporary chat"),tn.jsx("span",{onClick:()=>{Z(!1),pe()},children:y.t("Exit")})]}),className:"temporary-chat-close-toast"})},[pe,y,Z]),ve=O.useCallback(()=>P(void 0,null,function*(){var e;$(null),M(i||""),_(!0),null==(e=D.current)||e.focus()}),[$,i]),ye=O.useCallback(e=>P(void 0,null,function*(){const t=yield(n=e,P(void 0,null,function*(){return yield Ox("/share/artifacts/query",{method:"POST",data:{chat_id:n}})}));var n;I(!1),R(t.data.share_list.map(e=>e.share_url))}),[A]),be=O.useMemo(()=>ee&&q?tn.jsx("div",{className:"chat-item-drag-main",onClick:ge}):null,[q,ge,ee]),xe=O.useMemo(()=>q||S&&r?null:tn.jsx(ft,{title:y.t("More"),placement:"top",arrow:!1,children:tn.jsx("button",{"aria-label":"Chat Menu",className:"chat-item-drag-web-default-btn",onClick:()=>{$(h?`${t}_project_detail_chat`:t),u()},children:tn.jsx(dt,{type:"icon-line-more-01",className:"chat-item-drag-web-default-btn-icon"})})}),[q,S,r,y,$,h,t,u]),we=O.useMemo(()=>tn.jsx(nN,{show:oe,chatId:t,projectChat:g,projectId:v,cloneChatHandler:()=>{$(null),re(t),BS("clkCloneChat",{params:{et:"CLK"},aesParams:{c4:t},paramsExtend:{chat_id:t}})},shareHandler:()=>{$(null),w(!0)},archiveChatHandler:()=>{de(t)},renameHandler:ve,deleteHandler:()=>{$(null),E(!0)},onClose:()=>{$(null),d()},onChange:c,children:null,projectChatPined:m,tagsDropdownOffsetAuto:h}),[h,oe,t,g,v,ve,c,m,$,re,de,d]),Se=O.useMemo(()=>!n||te||t===V||s?null:tn.jsx(dt,{type:"icon-line-pin-01",className:"chat-item-title-pined-icon"}),[n,V,t,te,s]),_e=O.useMemo(()=>ee?null:tn.jsxs("div",{className:"chat-item-drag-web "+(t===V||oe||h?"chat-item-drag-web-active":""),children:[xe,we]}),[ee,t,V,oe,h,xe,we]),Ce=O.useMemo(()=>tn.jsx(Yj,{show:x,chatId:t,onClose:()=>w(!1)}),[t,x]),Ee=O.useMemo(()=>h?tn.jsx("div",{className:"project-chat-item",onClick:pe,onDoubleClick:()=>{q||(M(i||""),null==l||l(t),_(!0))},onTouchStart:me,onTouchEnd:fe,onTouchCancel:fe,children:tn.jsxs("div",{className:"project-chat-item-content",children:[tn.jsxs("div",{className:"project-chat-item-content-top",children:[tn.jsx("div",{className:"project-chat-item-title",children:i}),m&&tn.jsx(dt,{type:"icon-line-pin-01",className:"project-chat-item-title-pined-icon"})]}),tn.jsx("div",{className:"project-chat-item-time",children:f})]})}):tn.jsx("a",{"aria-label":"chat-item",className:`chat-item-drag-link  ${t===V&&location.pathname.includes("/c/")?"chat-item-drag-active":s&&location.pathname.includes("/c/")||ee&&q?"chat-item-drag-selected "+(q?ee?"chat-item-mobile-temporary":"chat-item-mobile-not-temporary":""):""} ${ee?"chat-item-temporary":""} ${q?"chat-item-drag-link-mobile":""}\n          `,onClick:pe,onDoubleClick:()=>{q||(M(i||""),null==l||l(t),_(!0))},onTouchStart:me,onTouchEnd:fe,onTouchCancel:fe,children:tn.jsxs("div",{className:"chat-item-drag-link-content",children:[tn.jsx(ft,{open:!ee&&!q&&void 0,title:T,placement:"bottom",className:"chat-item-drag-link-content-tip",children:tn.jsx("div",{className:"chat-item-drag-link-content-tip-text",style:oe?{paddingRight:"16px"}:{},children:he(T||"",100)})}),Se]})}),[h,t,V,s,ee,q,pe,me,fe,T,oe,he,Se,i,m,f,l]),ke=O.useMemo(()=>tn.jsxs(ht,{visible:C,title:y.t("Delete chat"),className:"chat-item-delete-confirm",closable:!1,headerBorderNone:!0,maskClosable:!0,onCancel:()=>E(!1),size:"small",actions:[{text:y.t("Cancel"),type:"tertiary",size:"large",rounded:"circle",onClick:()=>{E(!1)}},{text:y.t("Delete"),type:"dangerprimary",size:"large",rounded:"circle",onClick:()=>{ue(t)}}],children:[!(k||!A.length)&&tn.jsxs(tn.Fragment,{children:[y.t("The chat contains the following deployed content. Once the chat is deleted, the associated links will no longer be accessible. Please confirm to proceed."),tn.jsx("div",{className:"deploy-url-container",children:A.map(e=>tn.jsx("div",{className:"deploy-url-item",children:e},e))})]}),!k&&y.t("This action will permanently delete all the chats you've created and cannot be undone. Please confirm to proceed.")]}),[ue,k,A,y,t,C]),Ie=O.useMemo(()=>tn.jsx(ht,{visible:S,className:"qwen-chat-comp-item-rename-modal",title:y.t("Rename Chat"),headerBorderNone:!0,closable:!q,size:"small",cancelText:y.t("Cancel"),onCancel:()=>{_(!1),M("")},okText:y.t("Confirm"),actions:[{text:y.t("Cancel"),type:"tertiary",rounded:"circle",onClick:()=>{_(!1),M("")}},{text:y.t("Confirm"),rounded:"circle",disabled:!N.trim(),onClick:()=>P(void 0,null,function*(){yield se(t,N),c(),_(!1)})}],children:tn.jsx("div",{className:"rename-confirm",children:tn.jsx("div",{className:"rename-confirm-content",children:tn.jsx(iN,{showMaxLength:!1,value:N,onChange:M,maxLength:100,maxRows:4,placeholder:y.t("Enter your message"),autoFocus:!0})})})}),[se,y,t,q,c,N,S]);return O.useEffect(()=>{C&&ye(t)},[C]),tn.jsxs(tn.Fragment,{children:[Ce,ke,Ie,tn.jsxs("div",{ref:q||h?null:ae,draggable:!q&&!h,className:`chat-item-drag ${o}`,style:{opacity:ie?.5:1},onMouseEnter:()=>ne(!0),onMouseLeave:()=>ne(!1),children:[be,Ee,_e]})]})});function FK(){}class UK{profile(){return{}}setup(){this.didCallSetup=!0}teardown(){this.didCallTeardown=!0}connectDragSource(){return FK}connectDragPreview(){return FK}connectDropTarget(){return FK}simulateBeginDrag(e,t){this.actions.beginDrag(e,t)}simulatePublishDragSource(){this.actions.publishDragSource()}simulateHover(e,t){this.actions.hover(e,t)}simulateDrop(){this.actions.drop()}simulateEndDrag(){this.actions.endDrag()}constructor(e,t){this.didCallSetup=!1,this.didCallTeardown=!1,this.manager=e,this.context=t,this.actions=e.getActions()}}const zK=function(e,t={},n={}){const i=new UK(e,t);return(null==n?void 0:n.onCreate)&&n.onCreate(i),i},HK=({projectId:e,projectChats:t=[]})=>{const n=G(),i=fT(e=>e.setProjectChats),{getProjectChatList:a}=Xj(),[o,s]=O.useState(null),{getPinnedChatListData:r}=Jj(),l=Kb(e=>e.setPinnedChats),c=()=>P(void 0,null,function*(){const t=yield a(e);Array.isArray(t)&&i(t),hC();const n=yield r();Array.isArray(n)&&l(n)});return tn.jsx("div",{className:"project-chats",children:tn.jsxs(mK,{backend:zK,children:[(null==t?void 0:t.length)>0,tn.jsx("div",{className:"project-chats-title",children:n.t("Chats")}),t.map(e=>tn.jsx(LK,{id:e.id,projectId:e.project_id,time:n.t(IT(1e3*e.created_at)),title:e.title,selected:!0,onSelect:()=>{},onUnSelect:()=>{},onChange:c,isActive:o===e.id,onEditChatChange:()=>s(e.id),className:"project-chat-list",projectChatPined:e.pinned,isProjectDetailChat:!0,projectDetailChat:e,projectChat:!0},e.id+"project_detail_chat"))]})})},$K=({projectId:e=""})=>{const t=iy(),n=fT(e=>e.projectInfo),i=fT(e=>e.setChatProjectId),a=fT(e=>e.setProjectInfo),o=fT(e=>e.setProjectChats),s=fT(e=>e.setShowEditModal),r=fT(e=>e.setOperationProjectFiles),l=fT(e=>e.projectChats),c=fT(e=>e.setProjectName),u=tx(e=>e.mobile),[d,h]=O.useState(!1),{getProjectChatList:p,getNewProjectList:m}=Xj(),[f,g]=O.useState(1),[v,y]=O.useState(!1),b=O.useRef(null),x=O.useCallback(n=>P(void 0,null,function*(){if(localStorage.getItem("token"))try{const i=yield a_(e);if(!i.success&&"Not_Found"===i.data.code)return m(),s(!1),void t("/");const o=i.data.files.map(e=>C(_({},e),{uploadStatus:"success"}));a(C(_({},n),{fileLength:o.length})),r(o),h(!1)}catch(i){}}),[e,a,r,m,s,t]),w=O.useCallback(()=>P(void 0,null,function*(){if(localStorage.getItem("token"))try{const t=yield r_(e);x(t.data)}catch(t){}}),[e,x]),S=t=>P(void 0,null,function*(){const n=yield p(e,t);0===n.length&&y(!0),1===t?Array.isArray(n)&&o(n):Array.isArray(n)&&o([...l,...n])});O.useEffect(()=>{e&&(h(!0),w(),S(1),i(null),c(""),g(1),y(!1))},[e]);const E=Dt(e=>{const t=e.target,{scrollTop:n,scrollHeight:i,clientHeight:a}=t;i-n-a<=50&&(g(f+1),S(f+1))},200),k=O.useMemo(()=>tn.jsx(tQ,{projectTitle:n.name,projectIns:n.custom_instruction}),[n.custom_instruction,n.name]),I=O.useMemo(()=>d&&u?tn.jsxs("div",{className:"project-content-chats-skeleton",children:[tn.jsx(Ct,{className:"project-content-chats-skeleton-item",style:{width:"100%",height:"60px"}}),tn.jsx(Ct,{className:"project-content-chats-skeleton-item",style:{width:"100%",height:"60px"}}),tn.jsx(Ct,{className:"project-content-chats-skeleton-item",style:{width:"70%",height:"60px"}})]}):tn.jsx(HK,{projectChats:l,projectId:e}),[d,u,l,e]);return d&&!u?tn.jsx(Tk,{fixed:!1,absolute:!0}):tn.jsxs("div",{className:"qwen-project-content "+(l.length>0?"":"qwen-project-content-center"),style:l.length<1&&!u?{transform:"translateY(-102px)"}:{},children:[tn.jsxs("div",{className:"qwen-project-content-top "+(l.length>0&&!u?"project-content-top-sticky":""),children:[k,u&&l.length>0&&tn.jsx("div",{ref:b,onScroll:e=>{v||E(e)},className:"project-content-chats",children:I}),tn.jsx(lB,{projectId:e})]}),!u&&l.length>0&&tn.jsx("div",{ref:b,onScroll:e=>{v||E(e)},className:"project-content-chats",children:I})]})},BK=({projectId:e})=>{const t=Zb(e=>e.setTaskRunning),n=Zb(e=>e.setVisionGenerating),i=rT(e=>e.setShowDetail);return O.useEffect(()=>{t(!1),n(!1),i(!1),oT.createChat(),oT.initSelectedModels(),oT.resetChatState(),oT.closeShowControls()},[]),tn.jsx("div",{className:"project-layout",children:tn.jsx($K,{projectId:e})})},qK=[tg.Artifacts,tg.PdfViewer,tg.DeepResearchDetail,tg.WebDev,tg.Slides],GK=[tg.WebSearch,tg.DeepResearch],VK=()=>{const e=yE(e=>e.isSmallScreen),{pathname:t}=ty(),{id:n}=oy(),i=O.useMemo(()=>t.includes("/p/"),[t]),a=Zb(e=>e.currentShowControl),o=tx(e=>e.mobile),s=Zb(e=>e.temporaryChatEnabled),{messageId:r}=Wb(e=>e.currentCitationInfo),l=Wb(e=>e.allSearchAndThinkLists),c=O.useMemo(()=>i?n:"",[i,n]),u=O.useMemo(()=>{var e;if(o)return tg.None;if(a===tg.ThinkingAndSources)return a;const t=null==(e=l[r])?void 0:e.type;return[tg.ThinkingAndSearch].includes(t)?tg.WebSearch:a},[l,a,r,o]);return tn.jsx("div",{className:"chat-page-container "+(s&&!o?"chat-page-container-temporary":""),children:tn.jsx("div",{className:"layout-main",children:tn.jsx(XW,{leftPanel:tn.jsxs("div",{className:"layout-main-chat-panel",children:[tn.jsx(IN,{}),i?tn.jsx(BK,{projectId:c||""}):tn.jsxs(tn.Fragment,{children:[tn.jsx("main",{className:"main-content "+(e?"small-layout-main-content":""),children:tn.jsx(YW,{})}),tn.jsx(A$,{})]})]}),rightPanel:tn.jsx(VW,{showControlsType:u}),open:u!==tg.None&&!i,draggable:qK.includes(u),miniSplitScreen:GK.includes(u),chatId:n})})})},WK=()=>{const{id:e}=oy();return tn.jsx(KW,{chatId:e||""})};function QK(){return mx()?tn.jsx(VK,{}):tn.jsx(WK,{})}const KK=({title:e,operation:t})=>tn.jsxs("div",{className:"setting-content-title",children:[tn.jsx("div",{className:"setting-content-title-title",children:e}),t&&tn.jsx("div",{className:"setting-content-title-operation",children:t})]}),YK=({className:e})=>tn.jsx("div",{className:J(`voice-player-loading ${e}`)}),XK=({voiceUrl:e,voiceName:t,loading:n,error:i})=>{const{i18n:a}=G(),o=O.useRef(null),[s,r]=O.useState(!1),[l,c]=O.useState(0),[u,d]=O.useState(0),h=e=>{const t=Math.floor(e/60),n=Math.floor(e%60);return`${t.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`};return O.useEffect(()=>{e&&(r(!1),c(0),o.current&&(o.current.pause(),o.current.currentTime=0))},[e]),tn.jsx("div",{className:"voice-player-wrapper",children:tn.jsxs("div",{className:"recorder-wrapper",children:[tn.jsxs("div",{className:"left-container",children:[tn.jsx("div",{className:"record-title",children:n?tn.jsx(YK,{className:"voice-player-title-loading"}):t||a.t("Audio")}),tn.jsxs("div",{className:"record-time",children:[i&&!n&&tn.jsxs("div",{className:"record-time-left record-error",children:[tn.jsx(dt,{type:"icon-line-alert-circle"})," ",a.t(i)]}),!i&&!n&&tn.jsxs(tn.Fragment,{children:[tn.jsx("div",{className:"record-time-left",children:h(l)}),tn.jsxs("div",{className:"record-time-right",children:[" / ",h(u)]})]}),n&&tn.jsx(YK,{className:"voice-player-item-loading"})]})]}),tn.jsx("div",{className:"right-container",children:!i&&!n&&tn.jsx(ft,{title:s?a.t("Pause"):a.t("Play"),children:tn.jsx(pt,{type:"brandprimary",rounded:"circle",onClick:()=>{o.current&&e&&(s?o.current.pause():o.current.play(),r(!s))},buttonClass:"circle-button pause-button",disabled:!e,children:s?tn.jsx(dt,{type:"icon-line-waveform",className:"circle-icon"}):tn.jsx(dt,{type:"icon-fill-play-03",className:"circle-icon",style:{marginLeft:2}})})})}),e&&tn.jsx("audio",{ref:o,src:e,onLoadedMetadata:()=>{o.current&&d(o.current.duration)},onTimeUpdate:()=>{o.current&&c(o.current.currentTime)},onEnded:()=>{r(!1),c(0)},onError:()=>{}})]})})},JK=()=>{const{i18n:e}=G(),t=iy(),n=tx(e=>e.mobile),i=cT(e=>e.settings.ui.voiceLanguage),[a,o]=H.useState(300),[s,r]=H.useState(10),[l,c]=H.useState(20),[u,d]=H.useState(300),[h,p]=H.useState(""),[m,f]=H.useState(""),[g,v]=H.useState(""),[y,b]=H.useState({}),[x,w]=H.useState([]),[S,_]=H.useState([]),[C,E]=H.useState(""),[k,I]=H.useState(""),[T,j]=H.useState(!1),[N,M]=H.useState(!1),[A,R]=H.useState(!1),[D,L]=H.useState(!1),[F,U]=H.useState(!1),[z,$]=H.useState(""),[B,q]=H.useState(""),[V,W]=H.useState("https://download.qwen.ai/resources/tts/tibmres3/Cherry_zh.mp3"),[Q,K]=H.useState(""),[Y,X]=H.useState(1),[J,Z]=H.useState(!1),[ee,te]=O.useState(!1),ne=O.useRef(null),[ie,ae]=O.useState(!1),oe=e.language,se=i||e.language,re=(e,t=5)=>{const n=[...e];for(let a=n.length-1;a>0;a--){const e=Math.floor(Math.random()*(a+1));[n[a],n[e]]=[n[e],n[a]]}const i=n.slice(0,t);_(i),Z(!1)},le=()=>P(void 0,null,function*(){var e,t;const n=yield P(void 0,null,function*(){return yield Ox("/configs/?code=voiceDesignStyles",{method:"GET"})});n.success&&(r(n.data.promptMin),o(n.data.promptMax),c(n.data.textPreviewMin),d(n.data.textPreviewMax),b(n.data.language),E(null==(e=n.data.language[oe])?void 0:e.promptPlaceholder),I(null==(t=n.data.language[oe])?void 0:t.previewTextPlaceholder),w(n.data.voiceStyles),re(n.data.voiceStyles))});O.useEffect(()=>{le()},[]);const ce=()=>P(void 0,null,function*(){if(j(!1),M(!1),v(""),!h||h.length<s)return void(h.length<s&&j(!0));R(!0),v("");const t=yield(n={prompt:h,spoken_language:se||"en-US",language:e.language},P(void 0,null,function*(){return yield Ox("/tts/design/prompt",{method:"POST",headers:{"Accept-Language":`${n.language},${n.language.split("-")[0]};q=0.9`},data:n})}));var n;t.success?(R(!1),f(t.data.text)):(R(!1),v(t.data.message),j(!0),ut.openOnce({type:"error",content:e.t("Preview text generation failed. Please try again later.")}))}),ue=()=>P(void 0,null,function*(){if(j(!1),M(!1),v(""),!h||!m||h.length<s||m.length<l)return h.length<s&&j(!0),void(m.length<l&&M(!0));L(!0),$("");const t=yield(n={text:m,prompt:h,spoken_language:se||"en-US",language:e.language},P(void 0,null,function*(){return yield Ox("/tts/design/voice",{method:"POST",headers:{"Accept-Language":`${n.language},${n.language.split("-")[0]};q=0.9`},data:n})}));var n;t.success?(K(t.data.voice_id),W(t.data.voice_url),q(t.data.voice_name),L(!1),location.pathname.includes("/voice/design")&&ut.openOnce({type:"success",content:e.t("Voice created successfully.")})):(L(!1),$(t.data.message),"RateLimited"===t.data.code&&te(!0),t.data.message?ut.openOnce({type:"error",content:e.t(t.data.message)}):ut.openOnce({type:"error",content:e.t("Failed to generate voice. Please try again.")}))}),de=()=>P(void 0,null,function*(){U(!0);const n=yield(i={voice_id:Q},P(void 0,null,function*(){return yield Ox("/tts/design/save",{method:"POST",data:i})}));var i;n.success?n.data.status?(U(!1),ae(!0),ut.openOnce({type:"success",content:e.t("Voice saved successfully.")}),t(-1),setTimeout(()=>{t(-1)},0)):(U(!1),X(0),ut.openOnce({type:"error",content:e.t("Failed to save voice.")})):(U(!1),ut.openOnce({type:"error",content:e.t("Failed to save voice.")}))}),he=O.useCallback(()=>tn.jsxs("div",{className:"voice-design-rercord-item-shuffle",children:[tn.jsx(pt,{type:"ghost",rounded:"circle",size:"small",iconFontType:n?"":"icon-line-Shuffle",onClick:()=>re(x),children:n?tn.jsx(dt,{type:"icon-line-Shuffle"}):e.t("Shuffle")}),tn.jsx("div",{className:"voice-design-rercord-item-shuffle-list",children:tn.jsx("div",{className:"voice-design-rercord-item-shuffle-list-item",ref:ne,children:S.map(e=>tn.jsx(pt,{type:"ghost",rounded:"circle",size:"small",className:h===y[oe][e.prompt]&&J?"active":"",onClick:()=>{p(y[oe][e.prompt]),f(y[se][e.previewText]),Z(!0),v(""),j(!1),M(!1)},children:y[oe][e.name]},e.name))})})]}),[x,e,y,n,h,S,se]),[pe,me]=O.useState(!1),fe=O.useRef(!0);O.useEffect(()=>{const e=window.history.state;(null==e?void 0:e.isBlockerEntry)||window.history.pushState({isBlockerEntry:!0},"",window.location.href);const n=e=>{fe.current&&(h||m)&&!ie?(window.history.pushState({isBlockerEntry:!0},"",window.location.href),me(!0)):t(-1)};return window.addEventListener("popstate",n),()=>window.removeEventListener("popstate",n)},[t,ie,m,h]);const ge=O.useCallback(()=>{me(!1),fe.current=!1,setTimeout(()=>{t(-1)},10)},[t]),ve=O.useCallback(()=>{me(!1)},[]);O.useEffect(()=>{const e=e=>{if(h||m)return e.preventDefault(),e.returnValue="",""};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[h,m]);const ye=[{text:e.t("Cancel"),type:"tertiary",rounded:"circle",onClick:()=>{ve()}},{text:e.t("Discard"),type:"dangerprimary",rounded:"circle",onClick:()=>{ge()}}];return tn.jsxs(tn.Fragment,{children:[se&&tn.jsxs("div",{className:"voice-design-rercord",children:[tn.jsxs("div",{className:"voice-design-rercord-item",children:[tn.jsx("div",{className:"voice-design-rercord-item-title",children:e.t("Prompt")}),tn.jsxs("div",{className:"voice-design-rercord-item-content",children:[tn.jsx(wt,{rows:3,maxRows:3,minRows:3,maxLength:a,minLength:s,value:h,onChange:e=>{v(""),j(!1),M(!1),p(e)},placeholder:C,footerOperations:!!S.length&&n&&!!Object.keys(y).length&&tn.jsx(he,{}),error:!n&&T?0===h.length?g?e.t(g):e.t("Invalid input: The prompt should not be empty."):g?e.t(g):e.t("Prompt must be at least {{num}} characters.",{num:s}):void 0}),!!S.length&&!n&&!!Object.keys(y).length&&tn.jsx(he,{})]}),n&&tn.jsx("div",{className:"qwen-textarea-error",children:T?0===h.length?g?e.t(g):e.t("Invalid input: The prompt should not be empty."):g?e.t(g):e.t("Prompt must be at least {{num}} characters.",{num:s}):void 0})]}),tn.jsxs("div",{className:"voice-design-rercord-item",children:[tn.jsxs("div",{className:"voice-design-rercord-item-title",children:[e.t("Preview Text"),n&&tn.jsx(pt,{className:"voice-design-rercord-btn",iconFontType:A?"":"icon-line-star-01",rounded:"circle",type:"ghost",size:"small",onClick:ce,loading:A,children:A?e.t("Generating..."):e.t("Generate Text")})]}),tn.jsx(wt,{rows:3,maxRows:3,minRows:3,maxLength:u,minLength:l,value:m,onChange:e=>{v(""),j(!1),M(!1),f(e)},placeholder:k,operations:!n&&tn.jsx(pt,{className:"voice-design-rercord-btn",iconFontType:A?"":"icon-line-star-01",rounded:"circle",type:"ghost",size:"small",onClick:ce,loading:A,disabled:D,children:A?e.t("Generating..."):e.t("Generate Text")})}),N&&m.length<l&&tn.jsx("div",{className:"qwen-textarea-error",children:e.t("Prompt must be at least {{num}} characters.",{num:l})})]}),tn.jsx("div",{className:"voice-design-rercord-button",children:tn.jsx(pt,{className:"voice-design-rercord-button-btn",rounded:"circle",type:Q||z?"brandghost":"brandprimary",size:"large",iconFontType:D?"":"icon-a-lianji8",onClick:ue,loading:D,disabled:D||ee,children:Q||z?e.t("Regenerate"):e.t("Generate")})}),(Q||D||z)&&tn.jsxs(tn.Fragment,{children:[tn.jsxs("div",{className:"voice-design-rercord-item",children:[tn.jsx("div",{className:"voice-design-rercord-item-title",children:e.t("Voice Preview")}),tn.jsx(XK,{voiceUrl:V,loading:D,error:z,voiceName:B})]}),tn.jsx("div",{className:"voice-design-rercord-button",children:tn.jsx(pt,{className:"voice-design-rercord-button-btn",rounded:"circle",type:"brandprimary",size:"large",onClick:de,loading:F,disabled:!(Q&&!D&&!z&&Y),children:e.t("Save Voice")})})]})]}),tn.jsxs("div",{className:"voice-design-rercord-buttons",children:[(!Q&&!z||D)&&tn.jsx(pt,{className:"voice-design-rercord-button-btn",rounded:"circle",type:"brandprimary",size:"large",iconFontType:D?"":"icon-a-lianji8",onClick:ue,loading:D,disabled:D||ee,children:Q?e.t("Regenerate"):e.t("Generate")}),(Q||z)&&!D&&tn.jsxs(tn.Fragment,{children:[tn.jsx(pt,{className:"voice-design-rercord-button-btn",rounded:"circle",type:Q||z||D?"ghost":"brandprimary",size:"large",onClick:ue,loading:D,disabled:!h||!m||D||ee,children:e.t("Regenerate")}),tn.jsx(pt,{className:"voice-design-rercord-button-btn",rounded:"circle",type:"brandprimary",size:"large",onClick:de,loading:F,disabled:!(Q&&!D&&!z&&Y),children:e.t("Save Voice")})]})]}),tn.jsx(ht,{title:e.t("Discard changes?"),size:"small",visible:pe,className:"block-message-modal",actions:ye,headerBorderNone:!0,onCancel:ve,children:tn.jsx("p",{children:e.t("If you leave now, your changes will be lost.")})})]})},ZK=()=>{const{i18n:e}=G(),t=tx(e=>e.mobile);return tn.jsx(tn.Fragment,{children:tn.jsxs("div",{className:"voice-design-content",children:[!t&&tn.jsx(KK,{title:e.t("Design voice")}),tn.jsx(JK,{})]})})},eY=O.lazy(()=>_e(()=>import("./index46.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]))),tY=O.lazy(()=>_e(()=>import("./index34.js"),__vite__mapDeps([24,1,5,25,26,4,27,28,12,13,29,30,20,10,11,21,22,19,31]))),nY=O.lazy(()=>_e(()=>import("./index43.js"),__vite__mapDeps([32,1,4,5,33,34,35,36,3,6,12,13,37,25,26,27,28,38,20,10,11,21,22,19,39]))),iY=O.lazy(()=>_e(()=>import("./index24.js"),__vite__mapDeps([40,1,41,4,5,3,6,37,25,26,27,28,38,20,10,11,21,22,19,42]))),aY=O.lazy(()=>_e(()=>import("./index25.js"),__vite__mapDeps([43,1,3,4,5,6,37,25,26,27,28,38,20,10,11,21,22,19,44]))),oY=O.lazy(()=>_e(()=>import("./index.js"),__vite__mapDeps([45,1,5,20,10,4,11,21,22,19]))),sY=O.lazy(()=>_e(()=>import("./index2.js"),__vite__mapDeps([46,33,1,34,5,20,10,4,11,21,22,19]))),rY=O.lazy(()=>_e(()=>import("./index4.js"),__vite__mapDeps([47,35,1,36,5,20,10,4,11,21,22,19]))),lY=O.lazy(()=>_e(()=>import("./index26.js"),__vite__mapDeps([48,1,5,20,10,4,11,21,22,19,49]))),cY=O.lazy(()=>_e(()=>import("./index27.js"),__vite__mapDeps([50,1,4,5,20,10,11,21,22,19,51]))),uY=O.lazy(()=>_e(()=>import("./index6.js"),__vite__mapDeps([52,53,1,4,5,54,20,10,11,21,22,19]))),dY=O.lazy(()=>_e(()=>import("./index28.js"),__vite__mapDeps([55,4,1,5,20,10,11,21,22,19,56]))),hY=O.lazy(()=>_e(()=>import("./index37.js"),__vite__mapDeps([57,1,4,5,14,9,15,20,10,11,21,22,19,58]))),pY=O.lazy(()=>_e(()=>import("./index30.js"),__vite__mapDeps([59,1,60,4,5,16,17,61,20,10,11,21,22,19,62])).then(e=>({default:e.General}))),mY=O.lazy(()=>_e(()=>import("./index45.js"),__vite__mapDeps([63,4,1,5,10,64,65,20,11,21,22,19,66])).then(e=>({default:e.Mcp}))),fY=O.lazy(()=>_e(()=>import("./index11.js"),__vite__mapDeps([67,1,16,17,4,5,20,10,11,21,22,19,68])).then(e=>({default:e.Interface}))),gY=O.lazy(()=>_e(()=>import("./index13.js"),__vite__mapDeps([69,1,16,17,4,5,70,71,11,20,10,21,22,19,72])).then(e=>({default:e.Chats}))),vY=O.lazy(()=>_e(()=>import("./index15.js"),__vite__mapDeps([73,1,4,5,60,18,20,10,11,21,22,19,74]))),yY=O.lazy(()=>_e(()=>import("./index35.js"),__vite__mapDeps([75,1,26,4,5,27,20,10,11,21,22,19,76]))),bY=O.lazy(()=>_e(()=>import("./index41.js"),__vite__mapDeps([77,1,4,5,20,10,11,21,22,19,78]))),xY=O.lazy(()=>_e(()=>import("./index32.js"),__vite__mapDeps([79,4,1,5,80,60,70,71,9,81,10,82,18,61,20,11,21,22,19,83]))),wY=O.lazy(()=>_e(()=>import("./index19.js"),__vite__mapDeps([84,1,4,5,80,20,10,11,21,22,19,85]))),SY=O.lazy(()=>_e(()=>import("./index29.js"),__vite__mapDeps([86,4,1,5,20,10,11,21,22,19,87])).then(e=>({default:e.UpdatePasswordForm}))),_Y=O.lazy(()=>_e(()=>import("./index39.js"),__vite__mapDeps([88,1,4,5,89,11,20,10,21,22,19,90,91]))),CY=O.lazy(()=>_e(()=>import("./index36.js"),__vite__mapDeps([92,1,4,5,61,18,93,94,70,71,20,10,11,21,22,19,95]))),EY=O.lazy(()=>_e(()=>import("./index42.js"),__vite__mapDeps([96,1,4,5,12,13,20,29,30,41,10,11,21,22,19,97]))),kY=O.lazy(()=>_e(()=>import("./ModelsContainer.js"),__vite__mapDeps([98,1,53,4,5,54,20,10,11,21,22,19,99]))),IY=O.lazy(()=>_e(()=>import("./AccountContainer.js"),__vite__mapDeps([100,1,16,17,4,5,70,71,86,20,10,11,21,22,19,87,8,18,101]))),TY=O.lazy(()=>_e(()=>import("./index7.js"),__vite__mapDeps([102,4,1,5,20,10,11,21,22,19])).then(e=>({default:e.MemoryPersonalizationManage}))),jY=O.lazy(()=>_e(()=>import("./index40.js"),__vite__mapDeps([89,1,5,4,11,20,10,21,22,19,90]))),NY=O.lazy(()=>_e(()=>import("./index20.js"),__vite__mapDeps([103,1,4,5,9,81,10,82,20,11,21,22,19,104])).then(e=>({default:e.Subscription}))),PY=O.lazy(()=>_e(()=>import("./index33.js"),__vite__mapDeps([105,1,5,25,26,4,27,28,2,3,6,7,20,10,11,21,22,19,106]))),MY=O.lazy(()=>_e(()=>import("./index22.js"),__vite__mapDeps([107,1,61,4,5,16,17,93,94,70,71,20,10,11,21,22,19,108])).then(e=>({default:e.VoiceList}))),AY=O.lazy(()=>_e(()=>import("./index44.js"),__vite__mapDeps([109,1,4,5,20,10,11,21,22,19,110])).then(e=>({default:e.VoiceClone}))),RY=O.lazy(()=>_e(()=>import("./index8.js"),__vite__mapDeps([111,20,1,5,10,4,11,21,22,19]))),OY=()=>tn.jsx(by,{children:tn.jsxs(vy,{path:"/",element:tn.jsx(XT,{}),children:[tn.jsxs(vy,{element:tn.jsx(eY,{}),children:[tn.jsx(vy,{index:!0,element:tn.jsx(cB,{})}),tn.jsx(vy,{path:"c/:id",element:tn.jsx(QK,{})}),tn.jsx(vy,{path:"p/:id",element:tn.jsx(QK,{})})]}),tn.jsx(vy,{path:"mobile/chatcontrols/:currentid",element:tn.jsx(dY,{})}),tn.jsx(vy,{path:"native/webdev",element:tn.jsx(RY,{})}),tn.jsx(vy,{path:"/s/:id",element:tn.jsx(tY,{})}),tn.jsx(vy,{path:"/s/deploy/:id",element:tn.jsx(EY,{})}),tn.jsx(vy,{path:"/authorize",element:tn.jsx(PY,{})}),tn.jsx(vy,{path:"/auth",element:tn.jsx(nY,{})}),tn.jsx(vy,{path:"/forget",element:tn.jsx(iY,{})}),tn.jsx(vy,{path:"/reset",element:tn.jsx(aY,{})}),tn.jsx(vy,{path:"/error",element:tn.jsx(oY,{})}),tn.jsx(vy,{path:"/settings",element:tn.jsx(hY,{}),children:tn.jsxs(vy,{element:tn.jsx(bY,{}),children:[tn.jsx(vy,{index:!0,element:tn.jsx(xY,{})}),tn.jsx(vy,{path:"languages",element:tn.jsx(vY,{})}),tn.jsx(vy,{path:"theme",element:tn.jsx(wY,{})}),tn.jsx(vy,{path:"voice",element:tn.jsx(CY,{})}),tn.jsx(vy,{path:"about",element:tn.jsx(yY,{})}),tn.jsx(vy,{path:"terms-of-service",element:tn.jsx(sY,{})}),tn.jsx(vy,{path:"privacy-policy",element:tn.jsx(rY,{})}),tn.jsx(vy,{path:"contact-us",element:tn.jsx(cY,{})}),tn.jsx(vy,{path:"account",element:tn.jsx(IY,{})}),tn.jsx(vy,{path:"model",element:tn.jsx(kY,{})}),tn.jsx(vy,{path:"change-password",element:tn.jsx(SY,{})}),tn.jsx(vy,{path:"general",element:tn.jsx(pY,{})}),tn.jsx(vy,{path:"general/voice",element:tn.jsx(MY,{})}),tn.jsx(vy,{path:"general/voice/clone",element:tn.jsx(AY,{})}),tn.jsx(vy,{path:"general/voice/design",element:tn.jsx(ZK,{})}),tn.jsx(vy,{path:"voice/clone",element:tn.jsx(AY,{})}),tn.jsx(vy,{path:"voice/design",element:tn.jsx(ZK,{})}),tn.jsx(vy,{path:"mcp",element:tn.jsx(mY,{})}),tn.jsx(vy,{path:"interface",element:tn.jsx(fY,{})}),tn.jsx(vy,{path:"chats",element:tn.jsx(gY,{})}),tn.jsx(vy,{path:"personalization",element:tn.jsx(_Y,{})}),tn.jsx(vy,{path:"personalization/memory",element:tn.jsx(TY,{})}),tn.jsx(vy,{path:"personalization/custom-instr",element:tn.jsx(jY,{})}),tn.jsx(vy,{path:"subscription",element:tn.jsx(NY,{})})]})}),tn.jsx(vy,{path:"/legal-agreement/terms-of-service",element:tn.jsx(sY,{})}),tn.jsx(vy,{path:"/legal-agreement/privacy-policy",element:tn.jsx(rY,{})}),tn.jsx(vy,{path:"/legal-agreement/usage-policy",element:tn.jsx(lY,{})}),tn.jsx(vy,{path:"/legal-agreement/contact-us",element:tn.jsx(cY,{})}),tn.jsx(vy,{path:"/legal-agreement/models",element:tn.jsx(uY,{})}),tn.jsx(vy,{path:"/legal-agreement/about",element:tn.jsx(yY,{})})]})}),DY="//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.2.8/assets/editor.worker-6jafNAN9.js",LY=e=>{const t=`import ${JSON.stringify(new URL(e,import.meta.url))}`,n=new Blob([t],{type:"application/javascript"}),i=URL.createObjectURL(n),a=new Worker(i,{type:"module"});return a.addEventListener("error",()=>{URL.revokeObjectURL(i)}),a};function FY(){return tn.jsx(Ey,{basename:"/",children:tn.jsx(OY,{})})}self.MonacoEnvironment={getWorker(e,t){try{return LY("json"===t?"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.2.8/assets/json.worker-BqPgIoqM.js":"css"===t||"scss"===t||"less"===t?"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.2.8/assets/css.worker-BAnUvUvq.js":"html"===t||"handlebars"===t||"razor"===t?"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.2.8/assets/html.worker-0pmbLbCB.js":"typescript"===t||"javascript"===t?"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.2.8/assets/ts.worker-DhL4jcP4.js":DY)}catch(n){return LY(DY)}}},Se(function(e,t){t._reactRoot||(t._reactRoot=Lf.createRoot(t));var n=t._reactRoot;return n.render(e),function(){return new Promise(function(e){setTimeout(function(){n.unmount(),e()},0)})}});const UY=576,zY=768,HY=375;function $Y(e,t){if(e>=(px()?UY:zY))return t+"px";const n=e/HY;return t*Math.min(n,2)+"px"}function BY(){if(!px())return;const e=$Y(document.documentElement.clientWidth,16);document.documentElement.style.fontSize=e}BY(),window.addEventListener("resize",BY),!1!==window.shouldLoadViteApp&&(window.addEventListener("vite:preloadError",e=>{const t="preloadErrorRetryKey",n=sessionStorage.getItem(t);sessionStorage.setItem(t,"true"),n||(e.preventDefault(),window.location.reload())}),P(void 0,null,function*(){yield ov(),Lf.createRoot(document.getElementById("root")).render(tn.jsx(FY,{}))}));export{n_ as $,ij as A,vS as B,cS as C,xS as D,lS as E,TE as F,gT as G,iS as H,Zf as I,rS as J,ux as K,wx as L,Tx as M,aI as N,bx as O,Tk as P,Jk as Q,NC as R,KK as S,Kk as T,YG as U,AV as V,oT as W,Qk as X,Wk as Y,aS as Z,AC as _,iy as a,Ag as a$,Bf as a0,E_ as a1,oy as a2,Wb as a3,Zb as a4,tg as a5,bC as a6,xC as a7,VG as a8,WG as a9,BC as aA,iW as aB,WW as aC,iq as aD,EB as aE,VW as aF,yx as aG,rx as aH,Kj as aI,gy as aJ,iN as aK,$x as aL,Hx as aM,Vg as aN,sS as aO,nS as aP,gx as aQ,px as aR,zf as aS,Zw as aT,HS as aU,kE as aV,eS as aW,tS as aX,q$ as aY,iB as aZ,mE as a_,cW as aa,wC as ab,ik as ac,GW as ad,uW as ae,rI as af,k_ as ag,ig as ah,fx as ai,kx as aj,pS as ak,Cx as al,oS as am,Kf as an,Ay as ao,BS as ap,aT as aq,sq as ar,rq as as,ST as at,Ox as au,ty as av,bT as aw,xx as ax,pg as ay,XC as az,xE as b,OT as b$,Gk as b0,Vk as b1,lT as b2,oC as b3,aC as b4,b_ as b5,p_ as b6,v_ as b7,g_ as b8,m_ as b9,Xj as bA,o_ as bB,SS as bC,wS as bD,_S as bE,bS as bF,CS as bG,fS as bH,YS as bI,s_ as bJ,CT as bK,Kb as bL,Zj as bM,Jg as bN,oN as bO,eN as bP,SC as bQ,Zg as bR,WS as bS,qf as bT,Vf as bU,gq as bV,eW as bW,mK as bX,TT as bY,Gf as bZ,ox as b_,y_ as ba,V_ as bb,$f as bc,pT as bd,Ex as be,u_ as bf,_I as bg,f_ as bh,lQ as bi,IK as bj,NK as bk,TK as bl,AK as bm,vK as bn,kK as bo,xK as bp,bK as bq,sC as br,YT as bs,Jj as bt,QS as bu,XS as bv,LK as bw,DK as bx,yS as by,KS as bz,CE as c,UT as c0,FT as c1,LT as c2,zT as c3,Lg as c4,$g as c5,Ix as c6,Fg as c7,jS as c8,dC as c9,hC as ca,eT as cb,zI as cc,Hg as cd,Bg as ce,IN as cf,BK as cg,C_ as ch,dT as d,c_ as e,h_ as f,Jw as g,d_ as h,x_ as i,tn as j,w_ as k,yE as l,cT as m,WT as n,HT as o,l_ as p,$T as q,VT as r,GT as s,qT as t,tx as u,JS as v,ZS as w,ak as x,ax as y,fT as z};
